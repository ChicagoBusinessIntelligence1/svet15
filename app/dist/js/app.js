define("famous/core/Entity",["require","exports","module"],function(a,b,c){function d(a){return h[a]}function e(a,b){h[a]=b}function f(a){var b=h.length;return e(b,a),b}function g(a){e(a,null)}var h=[];c.exports={register:f,unregister:g,get:d,set:e}}),define("famous/core/Transform",["require","exports","module"],function(a,b,c){function d(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function e(a){return Math.sqrt(d(a))}function f(a){return 0>a?-1:1}var g={};g.precision=1e-6,g.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},g.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},g.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},g.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return g.thenMove(b,[c,d,e])},g.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},g.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},g.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},g.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},g.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},g.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},g.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},g.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},g.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return g.thenMove(b,[c,d,e])},g.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},g.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},g.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},g.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},g.getTranslate=function(a){return[a[12],a[13],a[14]]},g.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},g.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},g.interpret=function(a){var b=[a[0],a[1],a[2]],c=f(b[0]),h=e(b),i=[b[0]+c*h,b[1],b[2]],j=2/d(i);if(j>=1/0)return{translate:g.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=g.multiply(k,a),m=[l[5],l[6]],n=f(m[0]),o=e(m),p=[m[0]+n*o,m[1]],q=2/d(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=g.multiply(r,k),t=g.multiply(s,a),u=g.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=g.multiply(t,u),s=g.multiply(u,s);var v={};return v.translate=g.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},g.average=function(a,b,c){c=void 0===c?.5:c;for(var d=g.interpret(a),e=g.interpret(b),f={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)f.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],f.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],f.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],f.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return g.build(f)},g.build=function(a){var b=g.scale(a.scale[0],a.scale[1],a.scale[2]),c=g.skew(a.skew[0],a.skew[1],a.skew[2]),d=g.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return g.thenMove(g.multiply(g.multiply(d,c),b),a.translate)},g.equals=function(a,b){return!g.notEquals(a,b)},g.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},g.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},g.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],g.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],c.exports=g}),define("famous/core/SpecParser",["require","exports","module","./Transform"],function(a,b,c){function d(){this.result={}}function e(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var f=a("./Transform");d._instance=new d,d.parse=function(a,b){return d._instance.parse(a,b)},d.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,f.identity),this.result},d.prototype.reset=function(){this.result={}};var g=[0,0];d.prototype._parseSpec=function(a,b,c){var d,h,i,j,k,l,m;if("number"==typeof a){if(d=a,i=b.transform,l=b.align||g,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=f.thenMove(i,e(n,c))}this.result[d]={transform:i,opacity:b.opacity,origin:b.origin||g,align:b.align||g,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=f.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=f.thenMove(i,e([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=f.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},c.exports=d}),define("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(a,b,c){function d(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function e(a,b,c){for(var d=g.parse(a,b),h=Object.keys(d),i=0;i<h.length;i++){var j=h[i],k=f.get(j),l=d[j];l.allocator=b.allocator;var m=k.commit(l);m?e(m,b,c):c[j]=l}}var f=a("./Entity"),g=a("./SpecParser");d.prototype.add=function(a){var b=a instanceof d?a:new d(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},d.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},d.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof d?a:this},d.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},d.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var d=b[c];if(void 0===this._resultCache[d]){var g=f.get(d);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},e(this.render(),a,this._resultCache)},d.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},c.exports=d}),define("famous/core/EventEmitter",["require","exports","module"],function(a,b,c){function d(){this.listeners={},this._owner=this}d.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},d.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},d.prototype.bindThis=function(a){this._owner=a},c.exports=d}),define("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(a,b,c){function d(){e.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var e=a("./EventEmitter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},d.setOutputHandler=function(a,b){b instanceof d&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},d.prototype.emit=function(a,b){e.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},d.prototype.trigger=d.prototype.emit,d.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},d.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},d.prototype.on=function(a){if(e.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},d.prototype.addListener=d.prototype.on,d.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},d.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},c.exports=d}),define("famous/core/ElementAllocator",["require","exports","module"],function(a,b,c){function d(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}d.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},d.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},d.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},d.prototype.getNodeCount=function(){return this.nodeCount},c.exports=d}),define("famous/utilities/Utility",["require","exports","module"],function(a,b,c){var d={};d.Direction={X:0,Y:1,Z:2},d.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},d.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},d.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},d.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var c in a)if("object"==typeof a[c]&&null!==a[c])if(a[c]instanceof Array){b[c]=new Array(a[c].length);for(var e=0;e<a[c].length;e++)b[c][e]=d.clone(a[c][e])}else b[c]=d.clone(a[c]);else b[c]=a[c]}else b=a;return b},c.exports=d}),define("famous/transitions/MultipleTransition",["require","exports","module","../utilities/Utility"],function(a,b,c){function d(a){this.method=a,this._instances=[],this.state=[]}var e=a("../utilities/Utility");d.SUPPORTS_MULTIPLE=!0,d.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},d.prototype.set=function(a,b,c){for(var d=e.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,d)},d.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},c.exports=d}),define("famous/transitions/TweenTransition",["require","exports","module"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function e(a,b,c){return(1-c)*a+c*b}function f(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function g(a,b){var c={curve:b.curve};return b.duration&&(c.duration=b.duration),b.speed&&(c.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(c.duration=a.duration),a.curve&&(c.curve=a.curve),a.speed&&(c.speed=a.speed)),"string"==typeof c.curve&&(c.curve=d.getCurve(c.curve)),c}function h(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function i(a,b,c){var d;if(a instanceof Array){d=[];for(var f=0;f<a.length;f++)d[f]="number"==typeof a[f]?e(a[f],b[f],c):a[f]}else d=e(a,b,c);return d}d.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},d.SUPPORTS_MULTIPLE=!0,d.DEFAULT_OPTIONS={curve:d.Curves.linear,duration:500,speed:0};var j={};d.registerCurve=function(a,b){return j[a]?!1:(j[a]=b,!0)},d.unregisterCurve=function(a){return j[a]?(delete j[a],!0):!1},d.getCurve=function(a){var b=j[a];if(void 0!==b)return b;throw new Error("curve not registered")},d.getCurves=function(){return j},d.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=f(this.get()),b=g(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var e=0;for(var h in d)e+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(e)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=f(a),this._startVelocity=f(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},d.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=f(a),this.velocity=f(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},d.prototype.getVelocity=function(){return this.velocity},d.prototype.get=function(a){return this.update(a),this.state},d.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=h(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=i(this._startValue,this._endValue,this._curve(c)),this.velocity=h(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},d.prototype.isActive=function(){return this._active},d.prototype.halt=function(){this.reset(this.get())},d.registerCurve("linear",d.Curves.linear),d.registerCurve("easeIn",d.Curves.easeIn),d.registerCurve("easeOut",d.Curves.easeOut),d.registerCurve("easeInOut",d.Curves.easeInOut),d.registerCurve("easeOutBounce",d.Curves.easeOutBounce),d.registerCurve("spring",d.Curves.spring),d.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},c.exports=d}),define("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(a,b,c){function d(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function e(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],d=this.currentAction[1];d instanceof Object&&d.method?(b=d.method,"string"==typeof b&&(b=h[b])):b=g,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new f(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(d.velocity=this.velocity),this._engineInstance.set(c,d,e.bind(this))}var f=a("./MultipleTransition"),g=a("./TweenTransition"),h={};d.register=function(a){var b=!0;for(var c in a)d.registerMethod(c,a[c])||(b=!1);return b},d.registerMethod=function(a,b){return a in h?!1:(h[a]=b,!0)},d.unregisterMethod=function(a){return a in h?(delete h[a],!0):!1},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var d=[a,b];return this.actionQueue.push(d),this.callbackQueue.push(c),this.currentAction||e.call(this),this},d.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},d.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},d.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},d.prototype.isActive=function(){return!!this.currentAction},d.prototype.halt=function(){return this.set(this.get())},c.exports=d}),define("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","../transitions/Transitionable"],function(a,b,c){function d(a){return[a.clientWidth,a.clientHeight]}function e(a){this.container=a,this._allocator=new h(a),this._node=new f,this._eventOutput=new g,this._size=d(this.container),this._perspectiveState=new j(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:i.identity,opacity:1,origin:k,align:k,size:this._size},this._eventOutput.on("resize",function(){this.setSize(d(this.container))}.bind(this))}var f=a("./RenderNode"),g=a("./EventHandler"),h=a("./ElementAllocator"),i=a("./Transform"),j=a("../transitions/Transitionable"),k=[0,0],l=!("perspective"in document.documentElement.style),m=l?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};e.prototype.getAllocator=function(){return this._allocator},e.prototype.add=function(a){return this._node.add(a)},e.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},e.prototype.getSize=function(){return this._size},e.prototype.setSize=function(a){a||(a=d(this.container)),this._size[0]=a[0],this._size[1]=a[1]},e.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(m(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},e.prototype.getPerspective=function(){return this._perspectiveState.get()},e.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},e.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},e.prototype.on=function(a,b){return this._eventOutput.on(a,b)},e.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},e.prototype.pipe=function(a){return this._eventOutput.pipe(a)},e.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.exports=e}),define("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(a,b,c){function d(a){this._value=a,this.eventOutput=null}function e(){this.eventOutput=new f,this.eventOutput.bindThis(this),f.setOutputHandler(this,this.eventOutput)}var f=a("./EventHandler");d.patch=function(a){for(var b=new d(a),c=1;c<arguments.length;c++)b.patch(arguments[c]);return a},d.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},d.prototype.setOptions=d.prototype.patch,d.prototype.key=function(a){var b=new d(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},d.prototype.get=function(a){return a?this._value[a]:this._value},d.prototype.getOptions=d.prototype.get,d.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(a,b,c){function d(){y.runLoop?(o.step(),window.requestAnimationFrame(d)):v=!1}function e(){for(var a=0;a<p.length;a++)p[a].emit("resize");x.emit("resize")}function f(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),g()}function g(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void o.nextTick(g)}function h(a,b){return document.body?void document.body.addEventListener(a,b):void o.nextTick(addEventListener.bind(this,a,b))}function i(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void o.nextTick(i.bind(this,a,b))}var j,k,l=a("./Context"),m=a("./EventHandler"),n=a("./OptionsManager"),o={},p=[],q=[],r=0,s=0,t=[],u=Date.now(),v=!0,w={},x=new m,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},z=new n(y),A=10;o.step=function(){r++,s=r;var a=Date.now();if(!(k&&k>a-u)){var b=0;j=a-u,u=a,x.emit("prerender");for(var c=q.length;c--;)q.shift()(r);for(;t.length&&Date.now()-a<A;)t.shift().call(this);for(b=0;b<p.length;b++)p[b].update();x.emit("postrender")}},window.requestAnimationFrame(d),window.addEventListener("resize",e,!1),e();var B=!1;o.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(o):x.pipe(a)},o.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(o):x.unpipe(a)},o.on=function(a,b){return a in w||(w[a]=x.emit.bind(x,a),h(a,w[a])),x.on(a,b)},o.emit=function(a,b){return x.emit(a,b)},o.removeListener=function(a,b){return x.removeListener(a,b)},o.getFPS=function(){return 1e3/j},o.setFPSCap=function(a){k=Math.floor(1e3/a)},o.getOptions=function(a){return z.getOptions(a)},o.setOptions=function(){return z.setOptions.apply(z,arguments)},o.createContext=function(a){!B&&y.appMode&&o.nextTick(f);var b=!1;a||(a=document.createElement(y.containerType),a.classList.add(y.containerClass),b=!0);var c=new l(a);return o.registerContext(c),b&&i(c,a),c},o.registerContext=function(a){return p.push(a),a},o.getContexts=function(){return p},o.deregisterContext=function(a){var b=p.indexOf(a);b>=0&&p.splice(b,1)},o.nextTick=function(a){q.push(a)},o.defer=function(a){t.push(a)},z.on("change",function(a){"fpsCap"===a.id?o.setFPSCap(a.value):"runLoop"===a.id&&!v&&a.value&&(v=!0,window.requestAnimationFrame(d))}),c.exports=o}),define("famous/core/ElementOutput",["require","exports","module","./Entity","./EventHandler","./Transform"],function(a,b,c){function d(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new k,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=j.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function e(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function f(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function g(a){a[12]=Math.round(a[12]*n)/n,a[13]=Math.round(a[13]*n)/n;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function h(a){return 100*a[0]+"% "+100*a[1]+"%"}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./Entity"),k=a("./EventHandler"),l=a("./Transform"),m=!("transform"in document.documentElement.style),n=window.devicePixelRatio||1;d.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},d.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},d.prototype.render=function(){return this.id};var o;o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=g(b)}:m?function(a,b){a.style.webkitTransform=g(b)}:function(a,b){a.style.transform=g(b)};var p=m?function(a,b){a.style.webkitTransformOrigin=h(b)}:function(a,b){a.style.transformOrigin=h(b)},q=m?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};d.prototype.commit=function(a){var b=this._element;if(b){{var c=a.transform,d=a.opacity,e=a.origin;a.size}if(!c&&this._matrix)return this._matrix=null,this._opacity=0,void q(b);if(i(this._origin,e)&&(this._originDirty=!0),l.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,p(b,this._origin),this._originDirty=!1),c||(c=l.identity),this._matrix=c;var f=this._size?l.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;o(b,f),this._transformDirty=!1}}},d.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},d.prototype.attach=function(a){this._element=a,e.call(this,a)},d.prototype.detach=function(){var a=this._element;return a&&(f.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},c.exports=d}),define("famous/core/Surface",["require","exports","module","./ElementOutput"],function(a,b,c){function d(a){k.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function e(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function f(a){for(var b in this.properties)a.style[b]=this.properties[b]}function g(a){for(var b in this.properties)a.style[b]=""}function h(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function i(a){for(var b in this.attributes)a.removeAttribute(b)}function j(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var k=a("./ElementOutput");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');
this.attributes[b]=a[b]}this._attributesDirty=!0},d.prototype.getAttributes=function(){return this.attributes},d.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},d.prototype.getProperties=function(){return this.properties},d.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},d.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},d.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},d.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},d.prototype.getClassList=function(){return this.classList},d.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},d.prototype.getContent=function(){return this.content},d.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},d.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},d.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){e.call(this,b);for(var d=this.getClassList(),g=0;g<d.length;g++)b.classList.add(d[g]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(f.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(h.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var i=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=i[0]),void 0===c[1]&&(c[1]=i[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}j(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),k.prototype.commit.call(this,a)},d.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",g.call(this,c),i.call(this,c);var d=this.getClassList();for(e.call(this,c),b=0;b<d.length;b++)c.classList.remove(d[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},d.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},d.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},d.prototype.getSize=function(){return this._size?this._size:this.size},d.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},c.exports=d}),define("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","../core/Transform","../utilities/Utility"],function(a,b,c){function d(a){this._final=h.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new g(this._finalTranslate),this.rotate=new g(this._finalRotate),this.skew=new g(this._finalSkew),this.scale=new g(this._finalScale),a&&this.set(a)}function e(){return h.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function f(){return h.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var g=a("./Transitionable"),h=a("../core/Transform"),i=a("../utilities/Utility");d.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=f.call(this),this.translate.set(a,b,c),this},d.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=f.call(this),this.scale.set(a,b,c),this},d.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=f.call(this),this.rotate.set(a,b,c),this},d.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=f.call(this),this.skew.set(a,b,c),this},d.prototype.set=function(a,b,c){var d=h.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?i.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},d.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},d.prototype.get=function(){return this.isActive()?e.call(this):this._final},d.prototype.getFinal=function(){return this._final},d.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},d.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},c.exports=d}),define("famous/core/Modifier",["require","exports","module","./Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:f.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function e(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var f=a("./Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},d.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},d.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},d.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},d.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},d.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},d.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new h(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},d.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new g(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},d.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new g(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},d.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new g(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},d.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new g(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},d.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new g(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},d.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},d.prototype.getTransform=function(){return this._transformGetter()},d.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},d.prototype.getOpacity=function(){return this._opacityGetter()},d.prototype.getOrigin=function(){return this._originGetter()},d.prototype.getAlign=function(){return this._alignGetter()},d.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},d.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},d.prototype.modify=function(a){return e.call(this),this._output.target=a,this._output},c.exports=d}),define("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode","../utilities/Utility"],function(a,b,c){function d(a){this._node=new g,this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.options=h.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a)}var e=a("./EventHandler"),f=a("./OptionsManager"),g=a("./RenderNode"),h=a("../utilities/Utility");d.DEFAULT_OPTIONS={},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.setOptions=function(a){this._optionsManager.patch(a)},d.prototype.add=function(){return this._node.add.apply(this._node,arguments)},d.prototype._add=d.prototype.add,d.prototype.render=function(){return this._node.render()},d.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},c.exports=d}),define("famous/inputs/SyncUtils",["require","exports","module"],function(a,b,c){c.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}}),define("famous/inputs/MouseSync",["require","exports","module","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventInput=new j,this._eventOutput=new j,j.setInputHandler(this,this._eventInput),j.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",e.bind(this)),this._eventInput.on("mousemove",f.bind(this)),this._eventInput.on("mouseup",g.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",h.bind(this)):this._eventInput.on("mouseleave",g.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function e(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function f(a){if(0!==this._positionHistory.length){var b=i.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function g(a){if(this._down){var b=i.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function h(){if(this._down&&this._move&&!this._documentActive){var a=f.bind(this),b=function(c){g.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function i(a){var b,c,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],k=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(k)>Math.abs(n)?n=0:k=0),this.options.direction===d.DIRECTION_X?(c=k,this._position+=c):this.options.direction===d.DIRECTION_Y?(c=n,this._position+=c):(c=[k,n],this._position[0]+=k,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=k,this._displacement[1]+=n),e.delta=c,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=l.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,m);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/GenericSync",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b){this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function e(a,b){g[a]&&(this._syncs[a]=new g[a](b),this.pipeSync(a))}var f=a("../core/EventHandler");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DIRECTION_Z=2;var g={};d.register=function(a){for(var b in a)if(g[b]){if(g[b]!==a[b])throw new Error("Conflicting sync classes for key: "+b)}else g[b]=a[b]},d.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},d.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},d.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},d.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)e.call(this,a[b]);else if(a instanceof Object)for(var c in a)e.call(this,c,a[c])},c.exports=d}),define("famous/views/HeaderFooterLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._entityId=h.register(this),this.header=new i,this.footer=new i,this.content=new i}function e(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function f(a){return this.options.direction===d.DIRECTION_X?j.translate(a,0,0):j.translate(0,a,0)}function g(a,b){return this.options.direction===d.DIRECTION_X?[a,b[1]]:[b[0],a]}var h=a("../core/Entity"),i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},d.prototype.render=function(){return this._entityId},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,d=a.size,h=a.opacity,i=void 0!==this.options.headerSize?this.options.headerSize:e.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:e.call(this,this.footer,this.options.defaultFooterSize),l=d[this.options.direction]-i-k;d&&(b=j.moveThen([-d[0]*c[0],-d[1]*c[1],0],b));var m=[{size:g.call(this,i,d),target:this.header.render()},{transform:f.call(this,i),size:g.call(this,l,d),target:this.content.render()},{transform:f.call(this,i+l),size:g.call(this,k,d),target:this.footer.render()}];return{transform:b,opacity:h,size:d,target:m}},c.exports=d}),define("famous/utilities/Timer",["require","exports","module","../core/Engine"],function(a,b,c){function d(a){return k.on(l,a),a}function e(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),k.removeListener(l,e))};return d(e)}function f(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),c=m())};return d(e)}function g(a,b){if(void 0===b)return void 0;var c=function(){b--,0>=b&&(a.apply(this,arguments),i(c))};return d(c)}function h(a,b){b=b||1;var c=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=c)};return d(e)}function i(a){k.removeListener(l,a)}function j(a,b){var c,d,f,g,h;return function(){d=this,h=arguments,f=m();var j=function(){var i=m-f;b>i?c=e(j,b-i):(c=null,g=a.apply(d,h))};return i(c),c=e(j,b),g}}var k=a("../core/Engine"),l="prerender",m=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};c.exports={setTimeout:e,setInterval:f,debounce:j,after:g,every:h,clear:i}}),define("views/NavigationView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View"],function(a,b,c){function d(){g.apply(this,arguments),e.call(this)}function e(){var a=new f({content:'<img width="191" src="'+this.options.iconUrl+'"/>'});this._add(a)}var f=a("famous/core/Surface"),g=(a("famous/core/Modifier"),a("famous/core/Transform"),a("famous/core/View"));d.prototype=Object.create(g.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={width:null,height:null,iconUrl:null},c.exports=d}),define("views/MenuView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","famous/utilities/Timer","./NavigationView"],function(a,b,c){function d(){j.apply(this,arguments),e.call(this),f.call(this)}function e(){var a=new g({size:[this.options.width,this.options.height],properties:{backgroundColor:"#595153"}});this._add(a)}function f(){this.navModifiers=[];for(var a=[{iconUrl:"img/nav-icons/home.png"},{iconUrl:"img/nav-icons/about-us.png"},{iconUrl:"img/nav-icons/demographics.png"},{iconUrl:"img/nav-icons/clients.png"},{iconUrl:"img/nav-icons/radio.png"},{iconUrl:"img/nav-icons/contact-us.png"}],b=0;b<a.length;b++){var c=new l({width:this.options.navWidth,height:this.options.navHeight,iconUrl:a[b].iconUrl}),d=this.options.topOffset+this.options.navItemOffset*b,e=new h({transform:i.translate(0,d,0)});this.navModifiers.push(e),this._add(e).add(c)}}var g=a("famous/core/Surface"),h=a("famous/core/Modifier"),i=a("famous/core/Transform"),j=a("famous/core/View"),k=a("famous/utilities/Timer"),l=a("./NavigationView");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.resetNavItems=function(){for(var a=0;a<this.navModifiers.length;a++){var b=-this.options.navWidth/4,c=this.options.topOffset+this.options.navItemOffset*a+2*this.options.navHeight;this.navModifiers[a].setOpacity(0),this.navModifiers[a].setTransform(i.translate(b,c,0))}},d.prototype.animateNavItems=function(){this.resetNavItems();for(var a=0;a<this.navModifiers.length;a++)k.setTimeout(function(a){var b=this.options.topOffset+this.options.navItemOffset*a;this.navModifiers[a].setOpacity(1,{duration:this.options.duration,curve:"easeOut"}),this.navModifiers[a].setTransform(i.translate(0,b,0),{duration:this.options.duration,curve:"easeOut"})}.bind(this,a),a*this.options.staggerDelay)},d.DEFAULT_OPTIONS={navWidth:191,navHeight:81,topOffset:10,navItemOffset:90,duration:400,staggerDelay:35},c.exports=d}),define("famous/physics/PhysicsEngine",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=w(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function e(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function f(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},e.call(this,a).push(this._currAgentId),this._currAgentId++}function g(a){return this._agentData[a]}function h(a){var b=g.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function i(){for(var a=this._forces.length-1;a>-1;a--)h.call(this,a)}function j(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function k(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)j.call(this,c,a);b++}}function l(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function m(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function n(a,b){a.integrateOrientation(b)}function o(a,b){a.integratePosition(b),a.emit(x.update,a)}function p(a){i.call(this,a),this.forEach(l,a),this.forEachBody(m,a),k.call(this,a),this.forEachBody(n,a),this.forEach(o,a)}function q(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function r(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var s=a("../core/EventHandler"),t=17,u=1e3/120,v=17,w=Date.now,x={start:"start",update:"update",end:"end"};d.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},d.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},d.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},d.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],e=0;e<a.length;e++)d[e]=f.call(this,a[e],b,c);return d}return f.call(this,a,b,c)},d.prototype.attachTo=function(a,b){g.call(this,a).targets.push(b)},d.prototype.detach=function(a){var b=this.getAgent(a),c=e.call(this,b),d=c.indexOf(a);c.splice(d,1),delete this._agentData[a]},d.prototype.detachFrom=function(a,b){var c=g.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},d.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},d.prototype.getAgent=function(a){return g.call(this,a).agent},d.prototype.getParticles=function(){return this._particles},d.prototype.getBodies=function(){return this._bodies},d.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},d.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},d.prototype.getAgentEnergy=function(a){var b=g.call(this,a);return b.agent.getEnergy(b.targets,b.source)},d.prototype.getEnergy=function(){return q.call(this)+r.call(this)},d.prototype.step=function(){if(!this.isSleeping()){var a=w(),b=a-this._prevTime;this._prevTime=a,u>b||(b>v&&(b=v),p.call(this,t),this.emit(x.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},d.prototype.isSleeping=function(){return this._isSleeping},d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(x.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this._prevTime=w(),this.emit(x.start,this),this._isSleeping=!1)},d.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},d.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new s),this._eventHandler.on(a,b)},c.exports=d}),define("famous/math/Vector",["require","exports","module"],function(a,b,c){function d(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function e(a,b,c){return this.x=a,this.y=b,this.z=c,this}function f(a){return e.call(this,a[0],a[1],a[2]||0)}function g(a){return e.call(this,a.x,a.y,a.z)}function h(a){return e.call(this,a,0,0)}var i=new d(0,0,0);d.prototype.add=function(a){return e.call(i,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return e.call(i,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.mult=function(a){return e.call(i,a*this.x,a*this.y,a*this.z)},d.prototype.div=function(a){return this.mult(1/a)},d.prototype.cross=function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;return e.call(i,d*g-c*h,b*h-d*f,c*f-b*g)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.rotateX=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b,c*f-d*g,c*g+d*f)},d.prototype.rotateY=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,d*g+b*f,c,d*f-b*g)},d.prototype.rotateZ=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b*f-c*g,b*g+c*f,d)},d.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?g.call(i,this.mult(a/b)):e.call(i,a,0,0)},d.prototype.clone=function(){return new d(this)},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.set=function(a){return a instanceof Array?f.call(this,a):"number"==typeof a?h.call(this,a):g.call(this,a)},d.prototype.setXYZ=function(){return e.apply(this,arguments)},d.prototype.set1D=function(a){return h.call(this,a)},d.prototype.put=function(a){this===i?g.call(a,i):g.call(a,this)},d.prototype.clear=function(){return e.call(this,0,0,0)},d.prototype.cap=function j(j){if(1/0===j)return g.call(i,this);var a=this.norm();return a>j?g.call(i,this.mult(j/a)):g.call(i,this)},d.prototype.project=function(a){return a.mult(this.dot(a))},d.prototype.reflectAcross=function(a){return a.normalize().put(a),g(i,this.sub(this.project(a).mult(2)))},d.prototype.get=function(){return[this.x,this.y,this.z]},d.prototype.get1D=function(){return this.x},c.exports=d}),define("famous/physics/integrators/SymplecticEuler",["require","exports","module"],function(a,b,c){var d={};d.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},d.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},d.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},d.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},c.exports=d}),define("famous/physics/bodies/Particle",["require","exports","module","../../math/Vector","../../core/Transform","../../core/EventHandler","../integrators/SymplecticEuler"],function(a,b,c){function d(a){a=a||{};var b=d.DEFAULT_OPTIONS;this.position=new f,this.velocity=new f,this.force=new f,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=g.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}
}function e(){this._eventOutput=new h,this._eventOutput.bindThis(this),h.setOutputHandler(this,this._eventOutput)}var f=a("../../math/Vector"),g=a("../../core/Transform"),h=a("../../core/EventHandler"),i=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var j={start:"start",update:"update",end:"end"},k=Date.now;d.prototype.isBody=!1,d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.emit(j.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this.emit(j.start,this),this._isSleeping=!1,this._prevTime=k(),this._engine&&this._engine.wake())},d.prototype.setPosition=function(a){this.position.set(a)},d.prototype.setPosition1D=function(a){this.position.x=a},d.prototype.getPosition=function(){return this._engine.step(),this.position.get()},d.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},d.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},d.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},d.prototype.getVelocity=function(){return this.velocity.get()},d.prototype.setForce=function(a){this.force.set(a),this.wake()},d.prototype.getVelocity1D=function(){return this.velocity.x},d.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},d.prototype.getMass=function(){return this.mass},d.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},d.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},d.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},d.prototype.integrateVelocity=function(a){i.integrateVelocity(this,a)},d.prototype.integratePosition=function(a){i.integratePosition(this,a)},d.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},d.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},d.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},d.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},d.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/physics/forces/Force",["require","exports","module","../../math/Vector","../../core/EventHandler"],function(a,b,c){function d(a){this.force=new e(a),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},d.prototype.getEnergy=function(){return 0},c.exports=d}),define("famous/physics/forces/Drag",["require","exports","module","./Force"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this)}var e=a("./Force");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.DEFAULT_OPTIONS={strength:.01,forceFunction:d.FORCE_FUNCTIONS.LINEAR},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define("famous/physics/forces/Spring",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){h.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new i(0,0,0),g.call(this)}function e(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function f(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var j=Math.PI,k=150;d.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:d.FORCE_FUNCTIONS.HOOK},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof i&&(this.options.anchor=a.anchor.position),a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(a.period<k&&(a.period=k,console.warn("The period of a SpringTransition is capped at "+k+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},c.exports=d}),define("famous/core/ViewSequence",["require","exports","module"],function(a,b,c){function d(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}d.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},d.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},d.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},d.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},d.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},d.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},d.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},d.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},d.prototype.indexOf=function(a){return this._.array.indexOf(a)},d.prototype.getIndex=function(){return this.index},d.prototype.toString=function(){return""+this.index},d.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},d.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.get=function(){return this._.getValue(this.index)},d.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},d.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},c.exports=d}),define("famous/core/Group",["require","exports","module","./Context","./Transform","./Surface"],function(a,b,c){function d(a){g.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new e(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var e=a("./Context"),f=a("./Transform"),g=a("./Surface");d.SIZE_ZERO=[0,0],d.prototype=Object.create(g.prototype),d.prototype.elementType="div",d.prototype.elementClass="famous-group",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return g.prototype.render.call(this)},d.prototype.deploy=function(a){this.context.migrate(a)},d.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,e=a.opacity,h=a.size,i=g.prototype.commit.call(this,{allocator:a.allocator,transform:f.thenMove(b,[-c[0]*h[0],-c[1]*h[1],0]),opacity:e,origin:c,size:d.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:f.translate(-c[0]*h[0],-c[1]*h[1],0),origin:c,size:h}),i},c.exports=d}),define("famous/views/Scroller",["require","exports","module","../core/Entity","../core/Group","../core/OptionsManager","../core/Transform","../utilities/Utility","../core/ViewSequence","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new j,this.group.add({render:h.bind(this)}),this._entityId=i.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput)}function e(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function f(a,b,c){var d=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),e.call(this,d)}function g(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?e.call(this,this.getCumulativeSize()):e.call(this,this._contextSize)}function h(){for(var a=null,b=this._position,c=[],d=-this._positionOffset,h=g.call(this),i=this._node;i&&d-b<h+this.options.margin;)d+=f.call(this,i,d,c),i=i.getNext?i.getNext():null;var j=this._node,k=e.call(this,j.getSize());if(h>d){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=e.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=e.call(this,j.getSize()))}for(!i&&h-p>d-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:d-h})):!this._node.getPrevious()&&-p>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,d=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));i&&d-b>-(h+this.options.margin);)f.call(this,i,d,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));return c}var i=a("../core/Entity"),j=a("../core/Group"),k=a("../core/OptionsManager"),l=a("../core/Transform"),m=a("../utilities/Utility"),n=a("../core/ViewSequence"),o=a("../core/EventHandler");d.DEFAULT_OPTIONS={direction:m.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var p=0;d.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},d.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},d.prototype.onEdge=function(){return this._onEdge},d.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===m.Direction.X?l.translate(a,0):l.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return l.inverse(a(-b))}},d.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new n({array:a})),this._node=a,this._positionOffset=0},d.prototype.getSize=function(a){return a?this._contextSize:this._size},d.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===m.Direction.X?(this._size[0]=g.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=g.call(this)));var f=this._masterOutputFunction(-this._position);return{transform:l.multiply(b,f),size:e,opacity:c,origin:d,target:this.group.render()}},c.exports=d}),define("famous/inputs/ScrollSync",["require","exports","module","../core/EventHandler","../core/Engine","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",f.bind(this)),this._eventInput.on("wheel",f.bind(this)),this._inProgress=!1,this._loopBound=!1}function e(){if(this._inProgress&&k()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function f(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(h.on("prerender",e.bind(this)),this._loopBound=!0));var b=k(),c=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,g=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,g*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(g)?g=0:f=0);var i,l,m=Math.max(b-c,j),n=f/m,o=g/m,p=this.options.scale;this.options.direction===d.DIRECTION_X?(l=p*f,i=p*n,this._position+=l):this.options.direction===d.DIRECTION_Y?(l=p*g,i=p*o,this._position+=l):(l=[p*f,p*g],i=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=i,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=i}var g=a("../core/EventHandler"),h=a("../core/Engine"),i=a("../core/OptionsManager");d.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var j=8,k=Date.now;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/TouchTracker",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:k(),count:b.touches.length,history:c}}function e(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=d(c,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[c.identifier]||this.track(e)}}}function f(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function g(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[c.identifier]}}this.isTouched=!1}}function h(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function i(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new j,this.eventOutput=new j,j.setInputHandler(this,this.eventInput),j.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",e.bind(this)),this.eventInput.on("touchmove",f.bind(this)),this.eventInput.on("touchend",g.bind(this)),this.eventInput.on("touchcancel",g.bind(this)),this.eventInput.on("unpipe",h.bind(this)),this.isTouched=!1}var j=a("../core/EventHandler"),k=Date.now;i.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},c.exports=i}),define("famous/inputs/TouchSync",["require","exports","module","./TouchTracker","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventOutput=new j,this._touchTracker=new i({touchLimit:this.options.touchLimit}),j.setOutputHandler(this,this._eventOutput),j.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",e.bind(this)),this._touchTracker.on("trackmove",f.bind(this)),this._touchTracker.on("trackend",h.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function e(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function f(a){g.call(this,a)}function g(a){var b=a.history,c=b[b.length-1],e=l.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=c.timestamp,h=c.x-e.x,i=c.y-e.y,j=c.x-f,k=c.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(k)?k=0:j=0);var n,o,p=Math.max(g-f,m),q=j/p,r=k/p,s=this.options.scale;this.options.direction===d.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===d.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function h(a){g.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var i=a("./TouchTracker"),j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(){return this.options},c.exports=d}),define("famous/views/Scrollview",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Drag","../physics/forces/Spring","../core/EventHandler","../core/OptionsManager","../core/ViewSequence","../views/Scroller","../utilities/Utility","../inputs/GenericSync","../inputs/ScrollSync","../inputs/TouchSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new v(this.options),this._scroller=new x(this.options),this.sync=new z(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==y.Direction.Y}),this._physicsEngine=new q,this._particle=new r,this._physicsEngine.addBody(this._particle),this.spring=new t({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new s({forceFunction:s.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new s({forceFunction:s.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=C.NONE,this._onEdge=D.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new u,this._eventOutput=new u,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),h.call(this),a&&this.setOptions(a)}function e(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),j.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function f(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==D.NONE&&a.slip&&(0>b&&this._onEdge===D.TOP||b>0&&this._onEdge===D.BOTTOM?this._earlyEnd||(g.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&e.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var d=this.options.speedLimit;-d>b?b=-d:b>d&&(b=d),this.setVelocity(b);var f=16*d;c>f?c=f:-f>c&&(c=-f)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===C.NONE&&o.call(this)}}function g(a){if(this._touchCount=a.count||0,!this._touchCount){j.call(this),this._onEdge!==D.NONE&&n.call(this,this._edgeSpringPosition,C.EDGE),i.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function h(){this._eventInput.bindThis(this),this._eventInput.on("start",e),this._eventInput.on("update",f),this._eventInput.on("end",g),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,l.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===C.NONE&&o.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==C.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function i(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function j(){this._springState=C.NONE,this._physicsEngine.detachAll()}function k(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function l(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===C.EDGE||n.call(this,this._edgeSpringPosition,C.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(j.call(this),i.call(this))}function m(){if(!this._touchCount&&this._springState!==C.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=k.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():n.call(this,0,C.PAGE)}}}function n(a,b){var c;b===C.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===C.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(j.call(this),this._springState=b,i.call(this)),this._springState=b}function o(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=k.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=k.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=k.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&p.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function p(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===C.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===C.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Drag"),t=a("../physics/forces/Spring"),u=a("../core/EventHandler"),v=a("../core/OptionsManager"),w=a("../core/ViewSequence"),x=a("../views/Scroller"),y=a("../utilities/Utility"),z=a("../inputs/GenericSync"),A=a("../inputs/ScrollSync"),B=a("../inputs/TouchSync");z.register({scroll:A,touch:B});var C={NONE:0,EDGE:1,PAGE:2},D={TOP:-1,NONE:0,BOTTOM:1};d.DEFAULT_OPTIONS={direction:y.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},d.prototype.getCurrentIndex=function(){return this._node.index},d.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===D.TOP)return null;if(this.getPosition()>1&&this._springState===C.NONE)return n.call(this,0,C.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=k.call(this,a);this._scroller.sequenceFrom(a),this._node=a,p.call(this,b),n.call(this,0,C.PAGE)}return a},d.prototype.goToNextPage=function(){if(!this._node||this._onEdge===D.BOTTOM)return null;var a=this._node.getNext();if(a){var b=k.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,p.call(this,-b),n.call(this,0,C.PAGE)}return a},d.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},d.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},d.prototype.getPosition=function(){return this._particle.getPosition1D()},d.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},d.prototype.getOffset=d.prototype.getPosition,d.prototype.setPosition=function(a){this._particle.setPosition1D(a)},d.prototype.setOffset=d.prototype.setPosition,d.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},d.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},d.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=y.Direction.X:"y"===a.direction&&(a.direction=y.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===y.Direction.X?z.DIRECTION_X:z.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new w({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},d.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},d.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&m.call(this),this._scroller.render()
},c.exports=d}),define("famous/views/GridLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/ViewSequence","../core/EventHandler","../core/Modifier","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new m(this.options),a&&this.setOptions(a),this.id=h.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new k,k.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var e,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){e=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?f.call(this,k,[i,h],[e,j,0],1):g.call(this,k,[i,h],[e,j,0],1),k++,e+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)g.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function f(a,b,c,d){var e={transform:new o(i.translate.apply(null,c)),opacity:new n(d),size:new n(b)},f=new l({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function g(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var h=a("../core/Entity"),i=(a("../core/RenderNode"),a("../core/Transform")),j=a("../core/ViewSequence"),k=a("../core/EventHandler"),l=a("../core/Modifier"),m=a("../core/OptionsManager"),n=a("../transitions/Transitionable"),o=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new j(a)),this.sequence=a},d.prototype.getSize=function(){return this._contextSizeCache},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.size,g=this.options.dimensions[0],h=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||h!==this._dimensionsCache[1])&&e.call(this,f,g,h);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:d,target:m.render()})),j=j.getNext(),l++}return f&&(b=i.moveThen([-f[0]*d[0],-f[1]*d[1],0],b)),{transform:b,opacity:c,size:f,target:k}},c.exports=d}),define("views/HeaderView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View"],function(a,b,c){function d(){j.apply(this,arguments),e.call(this),f.call(this)}function e(){var a=new g({size:[void 0,void 0],properties:{backgroundColor:"#FC6E51"}});this.hamburgerSurface=new g({size:[53,void 0],content:'<img width="53" src="img/hamburger-template.png"/>'}),this.titleSurface=new g({size:[267,void 0],content:"SVET Media Group",properties:{fontSize:"22px",textAlign:"center",color:"white",lineHeight:"50px",fontWeight:"700"}}),this.hamburgerModifier=new h({transform:i.translate(0,0,1)}),this.titleModifier=new h({origin:[.5,0],align:[.5,0]}),this._add(this.hamburgerModifier).add(this.hamburgerSurface),this._add(this.titleModifier).add(this.titleSurface),this._add(a)}function f(){this.hamburgerSurface.on("touchstart",function(){this.hamburgerModifier.setOpacity(.5)}.bind(this)),this.hamburgerSurface.on("mousedown",function(){this.hamburgerModifier.setOpacity(.5)}.bind(this)),this.hamburgerSurface.on("click",function(){this.hamburgerModifier.setOpacity(1),this._eventOutput.emit("menuToggle")}.bind(this))}var g=a("famous/core/Surface"),h=a("famous/core/Modifier"),i=a("famous/core/Transform"),j=a("famous/core/View");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,c.exports=d}),define("text",["module"],function(a){var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(d){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;return 0===h.indexOf("empty:")?void d():void(!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d){if(n.hasOwnProperty(c)){var e=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("﻿")&&(e=e.substring(1)),b(e)}catch(f){d&&d(f)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status||0,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d&&d(e)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(j){throw new Error((h&&h.path||"")+": "+j)}}),b}),define("text!jade/homePage.html",[],function(){return'\n<section>\n  <article class="svet-media-group">\n    <h2 class="h-services text-center">SVET Russian Media Group</h2>\n    <h3 class="text-center">is the Midwest’s first and oldest publishing and advertising company serving the Russian, Ukrainian and Lithuanian communities since 1990.</h3>\n  </article>\n  <article class="svet-services">\n    <div class="productsServises">\n      <div class="home-icon-container"></div>\n      <h3>SVET<br/>Daily Newspaper</h3>\n      <p>Over 48 pages – circulation 12,000 copies weekly. It is the most up-to-date Russian language newspaper outside of Russia. It appears on the newsstands after 3:00 PM. It is free of charge. In addition, subscribers receive newspapers in their homes via second class mail.</p>\n    </div>\n    <div class="productsServises">\n      <div class="home-icon-container"></div>\n      <h3>Russian-American<br/>Yellow Pages</h3>\n      <p>The Russian Yellow Pages present over 650 full color pages of services and products to the Russian-speaking community in the Chicagoland area. Free distribution in Chicago and its North and Northwestern suburbs.</p>\n    </div>\n    <div class="productsServises">\n      <div class="home-icon-container"></div>\n      <h3>Saturday Plus<br/>Weekly Newspaper</h3>\n      <p>Free Paper with over 48 pages weekly. It covers entertainment and other social news in Unites States and abroad. It packs the latest information on travel destinations and hot vacation spots.</p>\n    </div>\n    <div class="productsServises">\n      <div class="home-icon-container"></div>\n      <h3>Radio<br/>Program “OSA”</h3>\n      <p>Sunday morning talk show with Alex Etman airs every Sunday on 1240 AM radio from 11:00 a.m. to 1:00 p.m. listen to Radio OSA programs.</p>\n    </div>\n  </article>\n</section>'}),define("views/PageView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","famous/views/Scrollview","famous/views/HeaderFooterLayout","famous/views/GridLayout","views/HeaderView","text!jade/page1.html"],function(a,b,c){function d(){f.apply(this,arguments),this.layout=new h({headerSize:50,footerSize:50}),this.header=new j,this.header.pipe(this),this.contents=[],this.content=new g,this.contentHome=new e({size:[void 0,void 0],content:k,properties:{fontSize:"16px",backgroundColor:"#FFFAE2"}}),this.contentAbout=new e({size:[void 0,void 0],content:'<h2>SVET International publishing house</h2><p>From the viewpoint of our partners SVET International Publishing House is a typical "company with the past", which basic philosophy is hinged upon well-taken conservatism, weighed approach and clear calculations. It was not for nothing that all previous outside convulsions and crises bypassed our publishing house. Our meticulous attitude towards entering into deals is completely justified by strict performance of undertaken liabilities and flawless financial stability. </p>',properties:{backgroundColor:"#E6FFEF"}}),this.contentDemographics=new e({size:[void 0,void 0],content:"<h2>Demographics</h2><p>The Russian - American population in the United States is estimated at nearly 2.9 million people</p>",properties:{backgroundColor:"#FFFAE2"}}),this.contentClients=new e({size:[void 0,void 0],content:"<h2>Demographics</h2><p>The Russian - American population in the United States is estimated at nearly 2.9 million people</p>",properties:{backgroundColor:"#E6FFDB"}}),this.contentRadio=new e({size:[void 0,void 0],content:"<h2>Radio Program “OSA”</h2><p>Sunday morning talk show with Alex Etman airs every Sunday on 1240 AM radio from 11:00 a.m. to 1:00 p.m.</p>",properties:{backgroundColor:"#FFF1E9"}}),this.contentContact=new e({size:[void 0,void 0],content:"<h2>Contact Us</h2><p>Sunday morning talk show with Alex Etman airs every Sunday on 1240 AM radio from 11:00 a.m. to 1:00 p.m.</p>",properties:{backgroundColor:"#FFE1D0"}}),this.contents.push(this.contentHome),this.contents.push(this.contentAbout),this.contents.push(this.contentDemographics),this.contents.push(this.contentClients),this.contents.push(this.contentRadio),this.contents.push(this.contentContact),this.content.sequenceFrom(this.contents),this.contentHome.pipe(this.content),this.contentAbout.pipe(this.content),this.contentDemographics.pipe(this.content),this.contentClients.pipe(this.content),this.contentRadio.pipe(this.content),this.contentContact.pipe(this.content),this.footers=[],this.footer=new i({dimensions:[3,1]}),this.footer.pipe(this),this.footerLeft=new e({size:[void 0,void 0],properties:{backgroundColor:"#F27649",backgroundSize:"cover"}}),this.footerCenter=new e({size:[void 0,void 0],properties:{backgroundColor:"#D95829",backgroundSize:"cover"}}),this.footerRight=new e({size:[void 0,void 0],properties:{backgroundColor:"#F27649",backgroundSize:"cover"}}),this.footers.push(this.footerLeft),this.footers.push(this.footerCenter),this.footers.push(this.footerRight),this.footer.sequenceFrom(this.footers),this.layout.content.add(this.content),this.layout.header.add(this.header),this.layout.footer.add(this.footer),this._eventInput.pipe(this._eventOutput),this.add(this.layout)}var e=a("famous/core/Surface"),f=(a("famous/core/Modifier"),a("famous/core/Transform"),a("famous/core/View")),g=a("famous/views/Scrollview"),h=a("famous/views/HeaderFooterLayout"),i=a("famous/views/GridLayout"),j=a("views/HeaderView"),k=a("text!jade/page1.html");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,c.exports=d}),define("views/AppView",["require","exports","module","famous/core/Surface","famous/core/Modifier","famous/core/Transform","famous/core/View","famous/inputs/MouseSync","famous/inputs/GenericSync","famous/transitions/Transitionable","famous/views/HeaderFooterLayout","./MenuView","./PageView"],function(a,b,c){function d(){h.apply(this,arguments),this.menuToggle=!1,this.menuView=new l,this.pageView=new m,this.pageViewPos=new k(0),this.pageModifier=new f,this.pageModifier.transformFrom(function(){return g.translate(this.pageViewPos.get(),0,0)}.bind(this)),this.pageView.on("menuToggle",this.toggleMenu.bind(this)),this.add(this.menuView),this.add(this.pageModifier).add(this.pageView),e.call(this)}function e(){j.register(i),this.sync=new j(function(){return this.pageViewPos.get(0)}.bind(this),{direction:j.DIRECTION_X}),this.pageView.pipe(this.sync),this.sync.on("update",function(a){0===this.pageViewPos.get()&&a.position>0&&this.menuView.animateNavItems(),this.pageViewPos.set(Math.min(Math.max(0,a.position),this.options.maxOpenPos))}.bind(this)),this.sync.on("end",function(a){{var b=a.velocity;this.pageViewPos.get()}this.pageViewPos.get()>this.options.posThreshold?b<-this.options.velThreshold?this.slideLeft():this.slideRight():b>this.options.velThreshold?this.slideRight():this.slideLeft()}.bind(this))}var f=(a("famous/core/Surface"),a("famous/core/Modifier")),g=a("famous/core/Transform"),h=a("famous/core/View"),i=a("famous/inputs/MouseSync"),j=a("famous/inputs/GenericSync"),k=a("famous/transitions/Transitionable"),l=(a("famous/views/HeaderFooterLayout"),a("./MenuView")),m=a("./PageView");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={posThreshold:95.5,velThreshold:.75,transition:{duration:300,curve:"easeOut"},maxOpenPos:191},d.prototype.toggleMenu=function(){this.menuToggle?this.slideLeft():(this.slideRight(),this.menuView.animateNavItems()),this.menuToggle=!this.menuToggle},d.prototype.slideLeft=function(){this.pageViewPos.set(0,this.options.transition,function(){this.menuToggle=!1}.bind(this))},d.prototype.slideRight=function(){this.pageViewPos.set(this.options.maxOpenPos,this.options.transition,function(){this.menuToggle=!0}.bind(this))},c.exports=d}),define("main",["require","famous/core/Engine","views/AppView"],function(a,b,c){var d=(a("famous/core/Transform"),b.createContext()),e=new c;d.add(e)}),define("main",function(){}),define(["require","famous/core/Engine","views/AppView"],function(a,b,c){var d=(a("famous/core/Transform"),b.createContext()),e=new c;d.add(e)}),define(["module"],function(a){"use strict";var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(d){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;return 0===h.indexOf("empty:")?void d():void(!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d){if(n.hasOwnProperty(c)){var e=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("﻿")&&(e=e.substring(1)),b(e)}catch(f){d&&d(f)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status||0,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d&&d(e)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(j){throw new Error((h&&h.path||"")+": "+j)}}),b}),define(function(a,b,c){function d(){h.apply(this,arguments),this.menuToggle=!1,this.menuView=new l,this.pageView=new m,this.pageViewPos=new k(0),this.pageModifier=new f,this.pageModifier.transformFrom(function(){return g.translate(this.pageViewPos.get(),0,0)}.bind(this)),this.pageView.on("menuToggle",this.toggleMenu.bind(this)),this.add(this.menuView),this.add(this.pageModifier).add(this.pageView),e.call(this)}function e(){j.register(i),this.sync=new j(function(){return this.pageViewPos.get(0)}.bind(this),{direction:j.DIRECTION_X}),this.pageView.pipe(this.sync),this.sync.on("update",function(a){0===this.pageViewPos.get()&&a.position>0&&this.menuView.animateNavItems(),this.pageViewPos.set(Math.min(Math.max(0,a.position),this.options.maxOpenPos))}.bind(this)),this.sync.on("end",function(a){{var b=a.velocity;this.pageViewPos.get()}this.pageViewPos.get()>this.options.posThreshold?b<-this.options.velThreshold?this.slideLeft():this.slideRight():b>this.options.velThreshold?this.slideRight():this.slideLeft()}.bind(this))}var f=(a("famous/core/Surface"),a("famous/core/Modifier")),g=a("famous/core/Transform"),h=a("famous/core/View"),i=a("famous/inputs/MouseSync"),j=a("famous/inputs/GenericSync"),k=a("famous/transitions/Transitionable"),l=(a("famous/views/HeaderFooterLayout"),a("./MenuView")),m=a("./PageView");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={posThreshold:95.5,velThreshold:.75,transition:{duration:300,curve:"easeOut"},maxOpenPos:191},d.prototype.toggleMenu=function(){this.menuToggle?this.slideLeft():(this.slideRight(),this.menuView.animateNavItems()),this.menuToggle=!this.menuToggle},d.prototype.slideLeft=function(){this.pageViewPos.set(0,this.options.transition,function(){this.menuToggle=!1}.bind(this))},d.prototype.slideRight=function(){this.pageViewPos.set(this.options.maxOpenPos,this.options.transition,function(){this.menuToggle=!0}.bind(this))},c.exports=d}),define(function(a,b,c){function d(){j.apply(this,arguments),e.call(this),f.call(this)}function e(){var a=new g({size:[void 0,void 0],properties:{backgroundColor:"#FC6E51"}});this.hamburgerSurface=new g({size:[53,void 0],content:'<img width="53" src="img/hamburger-template.png"/>'}),this.titleSurface=new g({size:[267,void 0],content:"SVET Media Group",properties:{fontSize:"22px",textAlign:"center",color:"white",lineHeight:"50px",fontWeight:"700"}}),this.hamburgerModifier=new h({transform:i.translate(0,0,1)}),this.titleModifier=new h({origin:[.5,0],align:[.5,0]}),this._add(this.hamburgerModifier).add(this.hamburgerSurface),this._add(this.titleModifier).add(this.titleSurface),this._add(a)}function f(){this.hamburgerSurface.on("touchstart",function(){this.hamburgerModifier.setOpacity(.5)}.bind(this)),this.hamburgerSurface.on("mousedown",function(){this.hamburgerModifier.setOpacity(.5)}.bind(this)),this.hamburgerSurface.on("click",function(){this.hamburgerModifier.setOpacity(1),this._eventOutput.emit("menuToggle")}.bind(this))}var g=a("famous/core/Surface"),h=a("famous/core/Modifier"),i=a("famous/core/Transform"),j=a("famous/core/View");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,c.exports=d}),define(function(a,b,c){function d(){j.apply(this,arguments),e.call(this),f.call(this)}function e(){var a=new g({size:[this.options.width,this.options.height],properties:{backgroundColor:"#595153"}});this._add(a)}function f(){this.navModifiers=[];for(var a=[{iconUrl:"img/nav-icons/home.png"},{iconUrl:"img/nav-icons/about-us.png"},{iconUrl:"img/nav-icons/demographics.png"},{iconUrl:"img/nav-icons/clients.png"},{iconUrl:"img/nav-icons/radio.png"},{iconUrl:"img/nav-icons/contact-us.png"}],b=0;b<a.length;b++){var c=new l({width:this.options.navWidth,height:this.options.navHeight,iconUrl:a[b].iconUrl}),d=this.options.topOffset+this.options.navItemOffset*b,e=new h({transform:i.translate(0,d,0)});this.navModifiers.push(e),this._add(e).add(c)}}var g=a("famous/core/Surface"),h=a("famous/core/Modifier"),i=a("famous/core/Transform"),j=a("famous/core/View"),k=a("famous/utilities/Timer"),l=a("./NavigationView");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.resetNavItems=function(){for(var a=0;a<this.navModifiers.length;a++){var b=-this.options.navWidth/4,c=this.options.topOffset+this.options.navItemOffset*a+2*this.options.navHeight;this.navModifiers[a].setOpacity(0),this.navModifiers[a].setTransform(i.translate(b,c,0))}},d.prototype.animateNavItems=function(){this.resetNavItems();for(var a=0;a<this.navModifiers.length;a++)k.setTimeout(function(a){var b=this.options.topOffset+this.options.navItemOffset*a;this.navModifiers[a].setOpacity(1,{duration:this.options.duration,curve:"easeOut"}),this.navModifiers[a].setTransform(i.translate(0,b,0),{duration:this.options.duration,curve:"easeOut"})}.bind(this,a),a*this.options.staggerDelay)},d.DEFAULT_OPTIONS={navWidth:191,navHeight:81,topOffset:10,navItemOffset:90,duration:400,staggerDelay:35},c.exports=d}),define(function(a,b,c){function d(){g.apply(this,arguments),e.call(this)}function e(){var a=new f({content:'<img width="191" src="'+this.options.iconUrl+'"/>'});this._add(a)}var f=a("famous/core/Surface"),g=(a("famous/core/Modifier"),a("famous/core/Transform"),a("famous/core/View"));d.prototype=Object.create(g.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={width:null,height:null,iconUrl:null},c.exports=d}),define(function(a,b,c){function d(){f.apply(this,arguments),this.layout=new h({headerSize:50,footerSize:50}),this.header=new j,this.header.pipe(this),this.contents=[],this.content=new g,this.contentHome=new e({size:[void 0,void 0],content:k,properties:{fontSize:"16px",backgroundColor:"#FFFAE2"}}),this.contentAbout=new e({size:[void 0,void 0],content:'<h2>SVET International publishing house</h2><p>From the viewpoint of our partners SVET International Publishing House is a typical "company with the past", which basic philosophy is hinged upon well-taken conservatism, weighed approach and clear calculations. It was not for nothing that all previous outside convulsions and crises bypassed our publishing house. Our meticulous attitude towards entering into deals is completely justified by strict performance of undertaken liabilities and flawless financial stability. </p>',properties:{backgroundColor:"#E6FFEF"}}),this.contentDemographics=new e({size:[void 0,void 0],content:"<h2>Demographics</h2><p>The Russian - American population in the United States is estimated at nearly 2.9 million people</p>",properties:{backgroundColor:"#FFFAE2"}}),this.contentClients=new e({size:[void 0,void 0],content:"<h2>Demographics</h2><p>The Russian - American population in the United States is estimated at nearly 2.9 million people</p>",properties:{backgroundColor:"#E6FFDB"}}),this.contentRadio=new e({size:[void 0,void 0],content:"<h2>Radio Program “OSA”</h2><p>Sunday morning talk show with Alex Etman airs every Sunday on 1240 AM radio from 11:00 a.m. to 1:00 p.m.</p>",properties:{backgroundColor:"#FFF1E9"}}),this.contentContact=new e({size:[void 0,void 0],content:"<h2>Contact Us</h2><p>Sunday morning talk show with Alex Etman airs every Sunday on 1240 AM radio from 11:00 a.m. to 1:00 p.m.</p>",properties:{backgroundColor:"#FFE1D0"}}),this.contents.push(this.contentHome),this.contents.push(this.contentAbout),this.contents.push(this.contentDemographics),this.contents.push(this.contentClients),this.contents.push(this.contentRadio),this.contents.push(this.contentContact),this.content.sequenceFrom(this.contents),this.contentHome.pipe(this.content),this.contentAbout.pipe(this.content),this.contentDemographics.pipe(this.content),this.contentClients.pipe(this.content),this.contentRadio.pipe(this.content),this.contentContact.pipe(this.content),this.footers=[],this.footer=new i({dimensions:[3,1]}),this.footer.pipe(this),this.footerLeft=new e({size:[void 0,void 0],properties:{backgroundColor:"#F27649",backgroundSize:"cover"}}),this.footerCenter=new e({size:[void 0,void 0],properties:{backgroundColor:"#D95829",backgroundSize:"cover"}}),this.footerRight=new e({size:[void 0,void 0],properties:{backgroundColor:"#F27649",backgroundSize:"cover"}}),this.footers.push(this.footerLeft),this.footers.push(this.footerCenter),this.footers.push(this.footerRight),this.footer.sequenceFrom(this.footers),this.layout.content.add(this.content),this.layout.header.add(this.header),this.layout.footer.add(this.footer),this._eventInput.pipe(this._eventOutput),this.add(this.layout)}var e=a("famous/core/Surface"),f=(a("famous/core/Modifier"),a("famous/core/Transform"),a("famous/core/View")),g=a("famous/views/Scrollview"),h=a("famous/views/HeaderFooterLayout"),i=a("famous/views/GridLayout"),j=a("views/HeaderView"),k=a("text!jade/page1.html");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,c.exports=d}),"undefined"==typeof document||"classList"in document.createElement("a")||!function(a){"use strict";var b="classList",c="prototype",d=(a.HTMLElement||a.Element)[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.className),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.className=this.toString()}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(a){a+="",-1===i(this,a)&&(this.push(a),this._updateClassName())},k.remove=function(a){a+="";var b=i(this,a);-1!==b&&(this.splice(b,1),this._updateClassName())},k.toggle=function(a){a+="",-1===i(this,a)?this.add(a):this.remove(a)},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}(self),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),require("./classList.js"),require("./functionPrototypeBind.js"),require("./requestAnimationFrame.js"),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(function(){a(+new Date)
},1e3/60)});var requirejs,require,define;!function(a){function b(a,b){return r.call(a,b)}function c(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=p.map,q=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,p.nodeIdCompat&&t.test(a[g])&&(a[g]=a[g].replace(t,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||q)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&q&&q[d]&&(i=q[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function d(b,c){return function(){return k.apply(a,s.call(arguments,0).concat([b,c]))}}function e(a){return function(b){return c(b,a)}}function f(a){return function(b){n[a]=b}}function g(c){if(b(o,c)){var d=o[c];delete o[c],q[c]=!0,j.apply(a,d)}if(!b(n,c)&&!b(q,c))throw new Error("No "+c);return n[c]}function h(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function i(a){return function(){return p&&p.config&&p.config[a]||{}}}var j,k,l,m,n={},o={},p={},q={},r=Object.prototype.hasOwnProperty,s=[].slice,t=/\.js$/;l=function(a,b){var d,f=h(a),i=f[0];return a=f[1],i&&(i=c(i,b),d=g(i)),i?a=d&&d.normalize?d.normalize(a,e(b)):c(a,b):(a=c(a,b),f=h(a),i=f[0],a=f[1],i&&(d=g(i))),{f:i?i+"!"+a:a,n:a,pr:i,p:d}},m={require:function(a){return d(a)},exports:function(a){var b=n[a];return"undefined"!=typeof b?b:n[a]={}},module:function(a){return{id:a,uri:"",exports:n[a],config:i(a)}}},j=function(c,e,h,i){var j,k,p,r,s,t,u=[],v=typeof h;if(i=i||c,"undefined"===v||"function"===v){for(e=!e.length&&h.length?["require","exports","module"]:e,s=0;s<e.length;s+=1)if(r=l(e[s],i),k=r.f,"require"===k)u[s]=m.require(c);else if("exports"===k)u[s]=m.exports(c),t=!0;else if("module"===k)j=u[s]=m.module(c);else if(b(n,k)||b(o,k)||b(q,k))u[s]=g(k);else{if(!r.p)throw new Error(c+" missing "+k);r.p.load(r.n,d(i,!0),f(k),{}),u[s]=n[k]}p=h?h.apply(n[c],u):void 0,c&&(j&&j.exports!==a&&j.exports!==n[c]?n[c]=j.exports:p===a&&t||(n[c]=p))}else c&&(n[c]=h)},requirejs=require=k=function(b,c,d,e,f){if("string"==typeof b)return m[b]?m[b](c):g(l(b,c).f);if(!b.splice){if(p=b,p.deps&&k(p.deps,p.callback),!c)return;c.splice?(b=c,c=d,d=null):b=a}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?j(a,b,c,d):setTimeout(function(){j(a,b,c,d)},4),k},k.config=function(a){return k(a)},requirejs._defined=n,define=function(a,c,d){c.splice||(d=c,c=[]),b(n,a)||b(o,a)||(o[a]=[a,c,d])},define.amd={jQuery:!0}}(),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.famous=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){return[a.clientWidth,a.clientHeight]}function d(a){this.container=a,this._allocator=new g(a),this._node=new e,this._eventOutput=new f,this._size=c(this.container),this._perspectiveState=new i(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:h.identity,opacity:1,origin:j,align:j,size:this._size},this._eventOutput.on("resize",function(){this.setSize(c(this.container))}.bind(this))}var e=a("./RenderNode"),f=a("./EventHandler"),g=a("./ElementAllocator"),h=a("./Transform"),i=a("../transitions/Transitionable"),j=[0,0],k=!("perspective"in document.documentElement.style),l=k?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};d.prototype.getAllocator=function(){return this._allocator},d.prototype.add=function(a){return this._node.add(a)},d.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},d.prototype.getSize=function(){return this._size},d.prototype.setSize=function(a){a||(a=c(this.container)),this._size[0]=a[0],this._size[1]=a[1]},d.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(l(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},d.prototype.getPerspective=function(){return this._perspectiveState.get()},d.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},d.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},d.prototype.on=function(a,b){return this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},b.exports=d},{"../transitions/Transitionable":89,"./ElementAllocator":2,"./EventHandler":7,"./RenderNode":11,"./Transform":15}],2:[function(a,b){function c(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}c.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},c.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},c.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},c.prototype.getNodeCount=function(){return this.nodeCount},b.exports=c},{}],3:[function(a,b){function c(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new j,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=i.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function d(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function e(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function f(a){a[12]=Math.round(a[12]*m)/m,a[13]=Math.round(a[13]*m)/m;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function g(a){return 100*a[0]+"% "+100*a[1]+"%"}function h(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var i=a("./Entity"),j=a("./EventHandler"),k=a("./Transform"),l=!("transform"in document.documentElement.style),m=window.devicePixelRatio||1;c.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},c.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},c.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},c.prototype.pipe=function(a){return this._eventOutput.pipe(a)},c.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.prototype.render=function(){return this.id};var n;n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=f(b)}:l?function(a,b){a.style.webkitTransform=f(b)}:function(a,b){a.style.transform=f(b)};var o=l?function(a,b){a.style.webkitTransformOrigin=g(b)}:function(a,b){a.style.transformOrigin=g(b)},p=l?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};c.prototype.commit=function(a){var b=this._element;if(b){{var c=a.transform,d=a.opacity,e=a.origin;a.size}if(!c&&this._matrix)return this._matrix=null,this._opacity=0,void p(b);if(h(this._origin,e)&&(this._originDirty=!0),k.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,o(b,this._origin),this._originDirty=!1),c||(c=k.identity),this._matrix=c;var f=this._size?k.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;n(b,f),this._transformDirty=!1}}},c.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},c.prototype.attach=function(a){this._element=a,d.call(this,a)},c.prototype.detach=function(){var a=this._element;return a&&(e.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},b.exports=c},{"./Entity":5,"./EventHandler":7,"./Transform":15}],4:[function(a,b){function c(){x.runLoop?(n.step(),window.requestAnimationFrame(c)):u=!1}function d(){for(var a=0;a<o.length;a++)o[a].emit("resize");w.emit("resize")}function e(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),f()}function f(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void n.nextTick(f)}function g(a,b){return document.body?void document.body.addEventListener(a,b):void n.nextTick(addEventListener.bind(this,a,b))}function h(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void n.nextTick(h.bind(this,a,b))}var i,j,k=a("./Context"),l=a("./EventHandler"),m=a("./OptionsManager"),n={},o=[],p=[],q=0,r=0,s=[],t=Date.now(),u=!0,v={},w=new l,x={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},y=new m(x),z=10;n.step=function(){q++,r=q;var a=Date.now();if(!(j&&j>a-t)){var b=0;i=a-t,t=a,w.emit("prerender");for(var c=p.length;c--;)p.shift()(q);for(;s.length&&Date.now()-a<z;)s.shift().call(this);for(b=0;b<o.length;b++)o[b].update();w.emit("postrender")}},window.requestAnimationFrame(c),window.addEventListener("resize",d,!1),d();var A=!1;n.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(n):w.pipe(a)},n.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(n):w.unpipe(a)},n.on=function(a,b){return a in v||(v[a]=w.emit.bind(w,a),g(a,v[a])),w.on(a,b)},n.emit=function(a,b){return w.emit(a,b)},n.removeListener=function(a,b){return w.removeListener(a,b)},n.getFPS=function(){return 1e3/i},n.setFPSCap=function(a){j=Math.floor(1e3/a)},n.getOptions=function(a){return y.getOptions(a)},n.setOptions=function(){return y.setOptions.apply(y,arguments)},n.createContext=function(a){!A&&x.appMode&&n.nextTick(e);var b=!1;a||(a=document.createElement(x.containerType),a.classList.add(x.containerClass),b=!0);var c=new k(a);return n.registerContext(c),b&&h(c,a),c},n.registerContext=function(a){return o.push(a),a},n.getContexts=function(){return o},n.deregisterContext=function(a){var b=o.indexOf(a);b>=0&&o.splice(b,1)},n.nextTick=function(a){p.push(a)},n.defer=function(a){s.push(a)},y.on("change",function(a){"fpsCap"===a.id?n.setFPSCap(a.value):"runLoop"===a.id&&!u&&a.value&&(u=!0,window.requestAnimationFrame(c))}),b.exports=n},{"./Context":1,"./EventHandler":7,"./OptionsManager":10}],5:[function(a,b){function c(a){return g[a]}function d(a,b){g[a]=b}function e(a){var b=g.length;return d(b,a),b}function f(a){d(a,null)}var g=[];b.exports={register:e,unregister:f,get:c,set:d}},{}],6:[function(a,b){function c(){this.listeners={},this._owner=this}c.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},c.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},c.prototype.addListener=c.prototype.on,c.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},c.prototype.bindThis=function(a){this._owner=a},b.exports=c},{}],7:[function(a,b){function c(){d.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var d=a("./EventEmitter");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},c.setOutputHandler=function(a,b){b instanceof c&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},c.prototype.emit=function(a,b){d.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},c.prototype.trigger=c.prototype.emit,c.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},c.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},c.prototype.on=function(a){if(d.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},c.prototype.addListener=c.prototype.on,c.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},c.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},b.exports=c},{"./EventEmitter":6}],8:[function(a,b){function c(a){f.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new d(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var d=a("./Context"),e=a("./Transform"),f=a("./Surface");c.SIZE_ZERO=[0,0],c.prototype=Object.create(f.prototype),c.prototype.elementType="div",c.prototype.elementClass="famous-group",c.prototype.add=function(){return this.context.add.apply(this.context,arguments)},c.prototype.render=function(){return f.prototype.render.call(this)},c.prototype.deploy=function(a){this.context.migrate(a)},c.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},c.prototype.commit=function(a){var b=a.transform,d=a.origin,g=a.opacity,h=a.size,i=f.prototype.commit.call(this,{allocator:a.allocator,transform:e.thenMove(b,[-d[0]*h[0],-d[1]*h[1],0]),opacity:g,origin:d,size:c.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:e.translate(-d[0]*h[0],-d[1]*h[1],0),origin:d,size:h}),i},b.exports=c},{"./Context":1,"./Surface":14,"./Transform":15}],9:[function(a,b){function c(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:e.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function d(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var e=a("./Transform"),f=a("../transitions/Transitionable"),g=a("../transitions/TransitionableTransform");c.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},c.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},c.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},c.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},c.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},c.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},c.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new g(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},c.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new f(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},c.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new f(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},c.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new f(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},c.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new f(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},c.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new f(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},c.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},c.prototype.getTransform=function(){return this._transformGetter()},c.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},c.prototype.getOpacity=function(){return this._opacityGetter()},c.prototype.getOrigin=function(){return this._originGetter()},c.prototype.getAlign=function(){return this._alignGetter()},c.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},c.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},c.prototype.modify=function(a){return d.call(this),this._output.target=a,this._output},b.exports=c},{"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90,"./Transform":15}],10:[function(a,b){function c(a){this._value=a,this.eventOutput=null}function d(){this.eventOutput=new e,this.eventOutput.bindThis(this),e.setOutputHandler(this,this.eventOutput)}var e=a("./EventHandler");c.patch=function(a){for(var b=new c(a),d=1;d<arguments.length;d++)b.patch(arguments[d]);return a},c.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},c.prototype.setOptions=c.prototype.patch,c.prototype.key=function(a){var b=new c(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},c.prototype.get=function(a){return a?this._value[a]:this._value},c.prototype.getOptions=c.prototype.get,c.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},c.prototype.on=function(){return d.call(this),this.on.apply(this,arguments)},c.prototype.removeListener=function(){return d.call(this),this.removeListener.apply(this,arguments)},c.prototype.pipe=function(){return d.call(this),this.pipe.apply(this,arguments)},c.prototype.unpipe=function(){return d.call(this),this.unpipe.apply(this,arguments)},b.exports=c},{"./EventHandler":7}],11:[function(a,b){function c(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function d(a,b,c){for(var g=f.parse(a,b),h=Object.keys(g),i=0;i<h.length;i++){var j=h[i],k=e.get(j),l=g[j];l.allocator=b.allocator;var m=k.commit(l);m?d(m,b,c):c[j]=l}}var e=a("./Entity"),f=a("./SpecParser");c.prototype.add=function(a){var b=a instanceof c?a:new c(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},c.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},c.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof c?a:this},c.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},c.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var f=b[c];if(void 0===this._resultCache[f]){var g=e.get(f);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},d(this.render(),a,this._resultCache)},c.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},b.exports=c},{"./Entity":5,"./SpecParser":13}],12:[function(a,b){function c(a){this.id=null,this._objects=null,this.node=new j,this._definition=null,a&&this.load(a)}function d(a){for(var b in k)if(b in a){var c=a[b];return c instanceof Array||(c=[c]),k[b].apply(this,c)}}function e(a){var b=a.transform,c=a.opacity,e=a.origin,f=a.align,g=a.size,j=h.identity;if(b instanceof Array)if(16===b.length&&"number"==typeof b[0])j=b;else for(var k=0;k<b.length;k++)j=h.multiply(j,d(b[k]));else b instanceof Function?j=b:b instanceof Object&&(j=d(b));var l=new i({transform:j,opacity:c,origin:e,align:f,size:g});return l}function f(a){for(var b=new j,c=0;c<a.length;c++){var d=g.call(this,a[c]);d&&b.add(d)}return b}function g(a){var b,c;if(a instanceof Array)b=f.call(this,a);else if(c=this._objects.length,a.render&&a.render instanceof Function)b=a;else if(a.target){var d=g.call(this,a.target),h=e.call(this,a);b=new j(h),b.add(d),a.id&&(this.id[a.id]=h)}else a.id&&(b=new j,this.id[a.id]=b);return this._objects[c]=b,b}var h=a("./Transform"),i=a("./Modifier"),j=a("./RenderNode"),k={translate:h.translate,rotate:h.rotate,rotateX:h.rotateX,rotateY:h.rotateY,rotateZ:h.rotateZ,rotateAxis:h.rotateAxis,scale:h.scale,skew:h.skew,matrix3d:function(){return arguments}};c.prototype.create=function(){return new c(this._definition)},c.prototype.load=function(a){this._definition=a,this.id={},this._objects=[],this.node.set(g.call(this,a))},c.prototype.add=function(){return this.node.add.apply(this.node,arguments)},c.prototype.render=function(){return this.node.render.apply(this.node,arguments)},b.exports=c},{"./Modifier":9,"./RenderNode":11,"./Transform":15}],13:[function(a,b){function c(){this.result={}}function d(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var e=a("./Transform");c._instance=new c,c.parse=function(a,b){return c._instance.parse(a,b)},c.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,e.identity),this.result},c.prototype.reset=function(){this.result={}};var f=[0,0];c.prototype._parseSpec=function(a,b,c){var g,h,i,j,k,l,m;if("number"==typeof a){if(g=a,i=b.transform,l=b.align||f,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=e.thenMove(i,d(n,c))}this.result[g]={transform:i,opacity:b.opacity,origin:b.origin||f,align:b.align||f,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=e.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=e.thenMove(i,d([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=e.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},b.exports=c},{"./Transform":15}],14:[function(a,b){function c(a){j.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function d(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function e(a){for(var b in this.properties)a.style[b]=this.properties[b]}function f(a){for(var b in this.properties)a.style[b]=""}function g(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function h(a){for(var b in this.attributes)a.removeAttribute(b)}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./ElementOutput");c.prototype=Object.create(j.prototype),c.prototype.constructor=c,c.prototype.elementType="div",c.prototype.elementClass="famous-surface",c.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[b]=a[b]}this._attributesDirty=!0},c.prototype.getAttributes=function(){return this.attributes},c.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},c.prototype.getProperties=function(){return this.properties},c.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},c.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},c.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},c.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},c.prototype.getClassList=function(){return this.classList},c.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},c.prototype.getContent=function(){return this.content},c.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},c.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},c.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){d.call(this,b);for(var f=this.getClassList(),h=0;h<f.length;h++)b.classList.add(f[h]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(e.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(g.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var k=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=k[0]),void 0===c[1]&&(c[1]=k[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}i(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),j.prototype.commit.call(this,a)
},c.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",f.call(this,c),h.call(this,c);var e=this.getClassList();for(d.call(this,c),b=0;b<e.length;b++)c.classList.remove(e[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},c.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},c.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},c.prototype.getSize=function(){return this._size?this._size:this.size},c.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},b.exports=c},{"./ElementOutput":3}],15:[function(a,b){function c(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function d(a){return Math.sqrt(c(a))}function e(a){return 0>a?-1:1}var f={};f.precision=1e-6,f.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},f.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},f.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},f.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return f.thenMove(b,[c,d,e])},f.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},f.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},f.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},f.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},f.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},f.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},f.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},f.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},f.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return f.thenMove(b,[c,d,e])},f.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},f.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},f.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},f.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},f.getTranslate=function(a){return[a[12],a[13],a[14]]},f.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},f.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},f.interpret=function(a){var b=[a[0],a[1],a[2]],g=e(b[0]),h=d(b),i=[b[0]+g*h,b[1],b[2]],j=2/c(i);if(j>=1/0)return{translate:f.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=f.multiply(k,a),m=[l[5],l[6]],n=e(m[0]),o=d(m),p=[m[0]+n*o,m[1]],q=2/c(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=f.multiply(r,k),t=f.multiply(s,a),u=f.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=f.multiply(t,u),s=f.multiply(u,s);var v={};return v.translate=f.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},f.average=function(a,b,c){c=void 0===c?.5:c;for(var d=f.interpret(a),e=f.interpret(b),g={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)g.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],g.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],g.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],g.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return f.build(g)},f.build=function(a){var b=f.scale(a.scale[0],a.scale[1],a.scale[2]),c=f.skew(a.skew[0],a.skew[1],a.skew[2]),d=f.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return f.thenMove(f.multiply(f.multiply(d,c),b),a.translate)},f.equals=function(a,b){return!f.notEquals(a,b)},f.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},f.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},f.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],f.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],b.exports=f},{}],16:[function(a,b){function c(a){this._node=new f,this._eventInput=new d,this._eventOutput=new d,d.setInputHandler(this,this._eventInput),d.setOutputHandler(this,this._eventOutput),this.options=g.clone(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a)}var d=a("./EventHandler"),e=a("./OptionsManager"),f=a("./RenderNode"),g=a("../utilities/Utility");c.DEFAULT_OPTIONS={},c.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},c.prototype.setOptions=function(a){this._optionsManager.patch(a)},c.prototype.add=function(){return this._node.add.apply(this._node,arguments)},c.prototype._add=c.prototype.add,c.prototype.render=function(){return this._node.render()},c.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},b.exports=c},{"../utilities/Utility":96,"./EventHandler":7,"./OptionsManager":10,"./RenderNode":11}],17:[function(a,b){function c(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}c.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},c.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},c.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},c.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},c.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},c.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},c.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},c.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},c.prototype.indexOf=function(a){return this._.array.indexOf(a)},c.prototype.getIndex=function(){return this.index},c.prototype.toString=function(){return""+this.index},c.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},c.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.get=function(){return this._.getValue(this.index)},c.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},c.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},b.exports=c},{}],18:[function(a,b){b.exports={Context:a("./Context"),ElementAllocator:a("./ElementAllocator"),ElementOutput:a("./ElementOutput"),Engine:a("./Engine"),Entity:a("./Entity"),EventEmitter:a("./EventEmitter"),EventHandler:a("./EventHandler"),Group:a("./Group"),Modifier:a("./Modifier"),OptionsManager:a("./OptionsManager"),RenderNode:a("./RenderNode"),Scene:a("./Scene"),SpecParser:a("./SpecParser"),Surface:a("./Surface"),Transform:a("./Transform"),View:a("./View"),ViewSequence:a("./ViewSequence")}},{"./Context":1,"./ElementAllocator":2,"./ElementOutput":3,"./Engine":4,"./Entity":5,"./EventEmitter":6,"./EventHandler":7,"./Group":8,"./Modifier":9,"./OptionsManager":10,"./RenderNode":11,"./Scene":12,"./SpecParser":13,"./Surface":14,"./Transform":15,"./View":16,"./ViewSequence":17}],19:[function(a,b){function c(a){this.dispatchers={},this.currMode=void 0,this.setMode(a)}var d=a("../core/EventHandler");c.prototype.setMode=function(a){if(a!==this.currMode){var b=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=a,this.dispatchers[a]&&this.dispatchers[a].emit("pipe"),this.emit("change",{from:b,to:a})}},c.prototype.forMode=function(a){return this.dispatchers[a]||(this.dispatchers[a]=new d),this.dispatchers[a]},c.prototype.emit=function(a,b){if(void 0===this.currMode)return!1;b||(b={});var c=this.dispatchers[this.currMode];return c?c.trigger(a,b):void 0},b.exports=c},{"../core/EventHandler":7}],20:[function(a,b){function c(a){d.call(this),this._condition=a}var d=a("../core/EventHandler");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.emit=function(a,b){return this._condition(a,b)?d.prototype.emit.apply(this,arguments):void 0},c.prototype.trigger=c.prototype.emit,b.exports=c},{"../core/EventHandler":7}],21:[function(a,b){function c(a){d.call(this),this._mappingFunction=a}var d=a("../core/EventHandler");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.subscribe=null,c.prototype.unsubscribe=null,c.prototype.emit=function(a,b){var c=this._mappingFunction.apply(this,arguments);c&&c.emit instanceof Function&&c.emit(a,b)},c.prototype.trigger=c.prototype.emit,b.exports=c},{"../core/EventHandler":7}],22:[function(a,b){b.exports={EventArbiter:a("./EventArbiter"),EventFilter:a("./EventFilter"),EventMapper:a("./EventMapper")}},{"./EventArbiter":19,"./EventFilter":20,"./EventMapper":21}],23:[function(a,b){b.exports={core:a("./core"),math:a("./math"),inputs:a("./inputs"),modifiers:a("./modifiers"),events:a("./events"),physics:a("./physics"),surfaces:a("./surfaces"),transitions:a("./transitions"),utilities:a("./utilities"),views:a("./views"),widgets:a("./widgets")}},{"./core":18,"./events":22,"./inputs":37,"./math":43,"./modifiers":48,"./physics":72,"./surfaces":83,"./transitions":93,"./utilities":97,"./views":112,"./widgets":117}],24:[function(a,b){function c(a,b){void 0===b&&(b="update"),this._state=a&&a.get&&a.set?a:new f(a||0),this._eventInput=new e,e.setInputHandler(this,this._eventInput),this._eventInput.on(b,d.bind(this))}function d(a){var b=a.delta,c=this.get();if(b.constructor===c.constructor){var d=b instanceof Array?[c[0]+b[0],c[1]+b[1]]:c+b;this.set(d)}}var e=a("../core/EventHandler"),f=a("../transitions/Transitionable");c.prototype.get=function(){return this._state.get()},c.prototype.set=function(a){this._state.set(a)},b.exports=c},{"../core/EventHandler":7,"../transitions/Transitionable":89}],25:[function(){function a(a){window.addEventListener(a,function(a){return a.stopPropagation(),!1},!0)}var b="ontouchstart"in window;b&&(a("mousedown"),a("mousemove"),a("mouseup"),a("mouseleave"))},{}],26:[function(){!function(){if(window.CustomEvent){var a=300,b=500,c={},d={},e=Date.now;window.addEventListener("touchstart",function(a){for(var b=e(),d=0;d<a.changedTouches.length;d++){var f=a.changedTouches[d];c[f.identifier]=b}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b];delete c[d.identifier]}}),window.addEventListener("touchend",function(b){for(var f=e(),g=0;g<b.changedTouches.length;g++){var h=b.changedTouches[g],i=c[h.identifier];if(i&&a>f-i){var j=new window.CustomEvent("click",{bubbles:!0,detail:h});d[f]=b,b.target.dispatchEvent(j)}delete c[h.identifier]}}),window.addEventListener("click",function(a){var c=e();for(var f in d){var g=d[f];b>c-f?a instanceof window.MouseEvent&&a.target===g.target&&a.stopPropagation():delete d[f]}},!0)}}()},{}],27:[function(a,b){function c(a,b){this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function d(a,b){f[a]&&(this._syncs[a]=new f[a](b),this.pipeSync(a))}var e=a("../core/EventHandler");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DIRECTION_Z=2;var f={};c.register=function(a){for(var b in a)if(f[b]){if(f[b]!==a[b])throw new Error("Conflicting sync classes for key: "+b)}else f[b]=a[b]},c.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},c.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},c.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},c.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)d.call(this,a[b]);else if(a instanceof Object)for(var c in a)d.call(this,c,a[c])},b.exports=c},{"../core/EventHandler":7}],28:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._eventInput=new i,this._eventOutput=new i,i.setInputHandler(this,this._eventInput),i.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",d.bind(this)),this._eventInput.on("mousemove",e.bind(this)),this._eventInput.on("mouseup",f.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",g.bind(this)):this._eventInput.on("mouseleave",f.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function d(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function e(a){if(0!==this._positionHistory.length){var b=h.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function f(a){if(this._down){var b=h.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function g(){if(this._down&&this._move&&!this._documentActive){var a=e.bind(this),b=function(c){f.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function h(a){var b,d,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],m=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(m)>Math.abs(n)?n=0:m=0),this.options.direction===c.DIRECTION_X?(d=m,this._position+=d):this.options.direction===c.DIRECTION_Y?(d=n,this._position+=d):(d=[m,n],this._position[0]+=m,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=m,this._displacement[1]+=n),e.delta=d,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=k.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,l);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var i=a("../core/EventHandler"),j=a("../core/OptionsManager"),k=a("./SyncUtils");c.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},c.DIRECTION_X=0,c.DIRECTION_Y=1;var l=8;c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"./SyncUtils":33}],29:[function(a,b){function c(a){d.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),this._displacement=0,this._previousDistance=0}var d=a("./TwoFingerSync"),e=a("../core/OptionsManager");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._previousDistance=d.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:d.calculateCenter(this.posA,this.posB)})},c.prototype._moveUpdate=function(a){var b=d.calculateDistance(this.posA,this.posB),c=d.calculateCenter(this.posA,this.posB),e=this.options.scale,f=e*(b-this._previousDistance),g=f/a;this._previousDistance=b,this._displacement+=f,this._eventOutput.emit("update",{delta:f,velocity:g,distance:b,displacement:this._displacement,center:c,touches:[this.touchAId,this.touchBId]})},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],30:[function(a,b){function c(a){d.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),this._angle=0,this._previousAngle=0}var d=a("./TwoFingerSync"),e=a("../core/OptionsManager");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._angle=0,this._previousAngle=d.calculateAngle(this.posA,this.posB);var b=d.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:a.touches.length,angle:this._angle,center:b,touches:[this.touchAId,this.touchBId]})},c.prototype._moveUpdate=function(a){var b=this.options.scale,c=d.calculateAngle(this.posA,this.posB),e=d.calculateCenter(this.posA,this.posB),f=b*(c-this._previousAngle),g=f/a;this._angle+=f,this._eventOutput.emit("update",{delta:f,velocity:g,angle:this._angle,center:e,touches:[this.touchAId,this.touchBId]}),this._previousAngle=c},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],31:[function(a,b){function c(a){e.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",d.bind(this))}function d(){this.touchAId=void 0,this.touchBId=void 0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");c.prototype=Object.create(e.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._scaleFactor=1,this._startDist=e.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:e.calculateCenter(this.posA,this.posB)})},c.prototype._moveUpdate=function(a){var b=this.options.scale,c=e.calculateDistance(this.posA,this.posB),d=e.calculateCenter(this.posA,this.posB),f=(c-this._startDist)/this._startDist,g=Math.max(1+b*f,0),h=(g-this._scaleFactor)/a;this._eventOutput.emit("update",{delta:f,scale:g,velocity:h,distance:c,center:d,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=g},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],32:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",e.bind(this)),this._eventInput.on("wheel",e.bind(this)),this._inProgress=!1,this._loopBound=!1}function d(){if(this._inProgress&&j()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function e(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(g.on("prerender",d.bind(this)),this._loopBound=!0));var b=j(),e=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,h=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,h*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(h)?h=0:f=0);var k,l,m=Math.max(b-e,i),n=f/m,o=h/m,p=this.options.scale;this.options.direction===c.DIRECTION_X?(l=p*f,k=p*n,this._position+=l):this.options.direction===c.DIRECTION_Y?(l=p*h,k=p*o,this._position+=l):(l=[p*f,p*h],k=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=k,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=k}var f=a("../core/EventHandler"),g=a("../core/Engine"),h=a("../core/OptionsManager");c.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},c.DIRECTION_X=0,c.DIRECTION_Y=1;var i=8,j=Date.now;c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/Engine":4,"../core/EventHandler":7,"../core/OptionsManager":10}],33:[function(a,b){b.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}},{}],34:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._eventOutput=new i,this._touchTracker=new h({touchLimit:this.options.touchLimit}),i.setOutputHandler(this,this._eventOutput),i.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",d.bind(this)),this._touchTracker.on("trackmove",e.bind(this)),this._touchTracker.on("trackend",g.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function d(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function e(a){f.call(this,a)}function f(a){var b=a.history,d=b[b.length-1],e=k.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=d.timestamp,h=d.x-e.x,i=d.y-e.y,j=d.x-f,m=d.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(m)?m=0:j=0);var n,o,p=Math.max(g-f,l),q=j/p,r=m/p,s=this.options.scale;this.options.direction===c.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===c.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function g(a){f.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var h=a("./TouchTracker"),i=a("../core/EventHandler"),j=a("../core/OptionsManager"),k=a("./SyncUtils");c.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},c.DIRECTION_X=0,c.DIRECTION_Y=1;var l=8;c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.getOptions=function(){return this.options},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"./SyncUtils":33,"./TouchTracker":35}],35:[function(a,b){function c(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:j(),count:b.touches.length,history:c}}function d(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=c(d,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[d.identifier]||this.track(e)}}}function e(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=this.touchHistory[d.identifier];if(e){var f=c(d,a,e);this.touchHistory[d.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function f(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=this.touchHistory[d.identifier];if(e){var f=c(d,a,e);this.touchHistory[d.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[d.identifier]}}this.isTouched=!1}}function g(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function h(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new i,this.eventOutput=new i,i.setInputHandler(this,this.eventInput),i.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",d.bind(this)),this.eventInput.on("touchmove",e.bind(this)),this.eventInput.on("touchend",f.bind(this)),this.eventInput.on("touchcancel",f.bind(this)),this.eventInput.on("unpipe",g.bind(this)),this.isTouched=!1
}var i=a("../core/EventHandler"),j=Date.now;h.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},b.exports=h},{"../core/EventHandler":7}],36:[function(a,b){function c(){this._eventInput=new d,this._eventOutput=new d,d.setInputHandler(this,this._eventInput),d.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var d=a("../core/EventHandler");c.calculateAngle=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.atan2(d,c)},c.calculateDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},c.calculateCenter=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};var e=Date.now;c.prototype.handleStart=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];this.touchAEnabled?this.touchBEnabled||(this.touchBId=c.identifier,this.touchBEnabled=!0,this.posB=[c.pageX,c.pageY],this.timestampB=e(),this._startUpdate(a)):(this.touchAId=c.identifier,this.touchAEnabled=!0,this.posA=[c.pageX,c.pageY],this.timestampA=e())}},c.prototype.handleMove=function(a){if(this.touchAEnabled&&this.touchBEnabled){for(var b,c=this.timestampA,d=this.timestampB,f=0;f<a.changedTouches.length;f++){var g=a.changedTouches[f];g.identifier===this.touchAId?(this.posA=[g.pageX,g.pageY],this.timestampA=e(),b=this.timestampA-c):g.identifier===this.touchBId&&(this.posB=[g.pageX,g.pageY],this.timestampB=e(),b=this.timestampB-d)}b&&this._moveUpdate(b)}},c.prototype.handleEnd=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];(c.identifier===this.touchAId||c.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},b.exports=c},{"../core/EventHandler":7}],37:[function(a,b){b.exports={Accumulator:a("./Accumulator"),DesktopEmulationMode:a("./DesktopEmulationMode"),FastClick:a("./FastClick"),GenericSync:a("./GenericSync"),MouseSync:a("./MouseSync"),PinchSync:a("./PinchSync"),RotateSync:a("./RotateSync"),ScaleSync:a("./ScaleSync"),ScrollSync:a("./ScrollSync"),SyncUtils:a("./SyncUtils"),TouchSync:a("./TouchSync"),TouchTracker:a("./TouchTracker"),TwoFingerSync:a("./TwoFingerSync")}},{"./Accumulator":24,"./DesktopEmulationMode":25,"./FastClick":26,"./GenericSync":27,"./MouseSync":28,"./PinchSync":29,"./RotateSync":30,"./ScaleSync":31,"./ScrollSync":32,"./SyncUtils":33,"./TouchSync":34,"./TouchTracker":35,"./TwoFingerSync":36}],38:[function(a,b){function c(a){return this.values=a||[[1,0,0],[0,1,0],[0,0,1]],this}var d=a("./Vector"),e=new c,f=new d;c.prototype.get=function(){return this.values},c.prototype.set=function(a){this.values=a},c.prototype.vectorMultiply=function(a){var b=this.get(),c=a.x,d=a.y,e=a.z,g=b[0],h=b[1],i=b[2],j=g[0],k=g[1],l=g[2],m=h[0],n=h[1],o=h[2],p=i[0],q=i[1],r=i[2];return f.setXYZ(j*c+k*d+l*e,m*c+n*d+o*e,p*c+q*d+r*e)},c.prototype.multiply=function(a){for(var b=this.get(),c=[[]],d=0;3>d;d++){c[d]=[];for(var f=0;3>f;f++){for(var g=0,h=0;3>h;h++)g+=b[d][h]*a[h][f];c[d][f]=g}}return e.set(c)},c.prototype.transpose=function(){for(var a=[],b=this.get(),c=0;3>c;c++)for(var d=0;3>d;d++)a[c][d]=b[d][c];return e.set(a)},c.prototype.clone=function(){for(var a=this.get(),b=[],d=0;3>d;d++)b[d]=a[d].slice();return new c(b)},b.exports=c},{"./Vector":42}],39:[function(a,b){function c(a,b,c,d){return 1===arguments.length?this.set(a):(this.w=void 0!==a?a:1,this.x=void 0!==b?b:0,this.y=void 0!==c?c:0,this.z=void 0!==d?d:0),this}var d=a("./Matrix"),e=new c(1,0,0,0);c.prototype.add=function(a){return e.setWXYZ(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)},c.prototype.sub=function(a){return e.setWXYZ(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)},c.prototype.scalarDivide=function(a){return this.scalarMultiply(1/a)},c.prototype.scalarMultiply=function(a){return e.setWXYZ(this.w*a,this.x*a,this.y*a,this.z*a)},c.prototype.multiply=function(a){var b=this.x,c=this.y,d=this.z,f=this.w,g=a.x,h=a.y,i=a.z,j=a.w||0;return e.setWXYZ(f*j-b*g-c*h-d*i,b*j+g*f+h*d-c*i,c*j+h*f+b*i-g*d,d*j+i*f+g*c-b*h)};var f=new c(1,0,0,0);c.prototype.rotateVector=function(a){return f.set(this.conj()),e.set(this.multiply(a).multiply(f))},c.prototype.inverse=function(){return e.set(this.conj().scalarDivide(this.normSquared()))},c.prototype.negate=function(){return this.scalarMultiply(-1)},c.prototype.conj=function(){return e.setWXYZ(this.w,-this.x,-this.y,-this.z)},c.prototype.normalize=function(a){return a=void 0===a?1:a,this.scalarDivide(a*this.norm())},c.prototype.makeFromAngleAndAxis=function(a,b){var c=b.normalize(),d=.5*a,e=-Math.sin(d);return this.x=e*c.x,this.y=e*c.y,this.z=e*c.z,this.w=Math.cos(d),this},c.prototype.setWXYZ=function(a,b,c,d){return e.clear(),this.w=a,this.x=b,this.y=c,this.z=d,this},c.prototype.set=function(a){return a instanceof Array?(this.w=0,this.x=a[0],this.y=a[1],this.z=a[2]):(this.w=a.w,this.x=a.x,this.y=a.y,this.z=a.z),this!==e&&e.clear(),this},c.prototype.put=function(a){a.set(e)},c.prototype.clone=function(){return new c(this)},c.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},c.prototype.isEqual=function(a){return a.w===this.w&&a.x===this.x&&a.y===this.y&&a.z===this.z},c.prototype.dot=function(a){return this.w*a.w+this.x*a.x+this.y*a.y+this.z*a.z},c.prototype.normSquared=function(){return this.dot(this)},c.prototype.norm=function(){return Math.sqrt(this.normSquared())},c.prototype.isZero=function(){return!(this.x||this.y||this.z)},c.prototype.getTransform=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return[1-2*c*c-2*d*d,2*b*c-2*d*e,2*b*d+2*c*e,0,2*b*c+2*d*e,1-2*b*b-2*d*d,2*c*d-2*b*e,0,2*b*d-2*c*e,2*c*d+2*b*e,1-2*b*b-2*c*c,0,0,0,0,1]};var g=new d;c.prototype.getMatrix=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return g.set([[1-2*c*c-2*d*d,2*b*c+2*d*e,2*b*d-2*c*e],[2*b*c-2*d*e,1-2*b*b-2*d*d,2*c*d+2*b*e],[2*b*d+2*c*e,2*c*d-2*b*e,1-2*b*b-2*c*c]])};var h=1e-5;c.prototype.slerp=function(a,b){var c,d,f,g,i;return d=this.dot(a),1-d>h?(c=Math.acos(d),f=Math.sin(c),g=Math.sin((1-b)*c)/f,i=Math.sin(b*c)/f):(g=1-b,i=b),e.set(this.scalarMultiply(g/i).add(a).multiply(i))},b.exports=c},{"./Matrix":38}],40:[function(a,b){function c(a,b){return a+e()*(b-a)}function d(a,b){return a+e()*(b-a+1)>>0}var e=Math.random,f={};f.integer=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var e=[],f=0;c>f;f++)e.push(d(a,b));return e}return d(a,b)},f.range=function(a,b,d){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==d){for(var e=[],f=0;d>f;f++)e.push(c(a,b));return e}return c(a,b)},f.sign=function(a){return a=void 0!==a?a:.5,e()<a?1:-1},f.bool=function(a){return a=void 0!==a?a:.5,e()<a},b.exports=f},{}],41:[function(a,b){var c={};c.clamp=function(a,b){return Math.max(Math.min(a,b[1]),b[0])},c.length=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)},b.exports=c},{}],42:[function(a,b){function c(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function d(a,b,c){return this.x=a,this.y=b,this.z=c,this}function e(a){return d.call(this,a[0],a[1],a[2]||0)}function f(a){return d.call(this,a.x,a.y,a.z)}function g(a){return d.call(this,a,0,0)}var h=new c(0,0,0);c.prototype.add=function(a){return d.call(h,this.x+a.x,this.y+a.y,this.z+a.z)},c.prototype.sub=function(a){return d.call(h,this.x-a.x,this.y-a.y,this.z-a.z)},c.prototype.mult=function(a){return d.call(h,a*this.x,a*this.y,a*this.z)},c.prototype.div=function(a){return this.mult(1/a)},c.prototype.cross=function(a){var b=this.x,c=this.y,e=this.z,f=a.x,g=a.y,i=a.z;return d.call(h,e*g-c*i,b*i-e*f,c*f-b*g)},c.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},c.prototype.rotateX=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,b,c*f-e*g,c*g+e*f)},c.prototype.rotateY=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,e*g+b*f,c,e*f-b*g)},c.prototype.rotateZ=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,b*f-c*g,b*g+c*f,e)},c.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},c.prototype.normSquared=function(){return this.dot(this)},c.prototype.norm=function(){return Math.sqrt(this.normSquared())},c.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?f.call(h,this.mult(a/b)):d.call(h,a,0,0)},c.prototype.clone=function(){return new c(this)},c.prototype.isZero=function(){return!(this.x||this.y||this.z)},c.prototype.set=function(a){return a instanceof Array?e.call(this,a):"number"==typeof a?g.call(this,a):f.call(this,a)},c.prototype.setXYZ=function(){return d.apply(this,arguments)},c.prototype.set1D=function(a){return g.call(this,a)},c.prototype.put=function(a){this===h?f.call(a,h):f.call(a,this)},c.prototype.clear=function(){return d.call(this,0,0,0)},c.prototype.cap=function i(i){if(1/0===i)return f.call(h,this);var a=this.norm();return a>i?f.call(h,this.mult(i/a)):f.call(h,this)},c.prototype.project=function(a){return a.mult(this.dot(a))},c.prototype.reflectAcross=function(a){return a.normalize().put(a),f(h,this.sub(this.project(a).mult(2)))},c.prototype.get=function(){return[this.x,this.y,this.z]},c.prototype.get1D=function(){return this.x},b.exports=c},{}],43:[function(a,b){b.exports={Matrix:a("./Matrix"),Quaternion:a("./Quaternion"),Random:a("./Random"),Utilities:a("./Utilities"),Vector:a("./Vector")}},{"./Matrix":38,"./Quaternion":39,"./Random":40,"./Utilities":41,"./Vector":42}],44:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._positionState=new j([0,0]),this._differential=[0,0],this._active=!0,this.sync=new m(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new k,k.setInputHandler(this,this.sync),k.setOutputHandler(this,this.eventOutput),h.call(this)}function d(a){var b=this.options,c=b.projection,d=b.snapX,e=b.snapY,f=c&p.x?a[0]:0,g=c&p.y?a[1]:0;return d>0&&(f-=f%d),e>0&&(g-=g%e),[f,g]}function e(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function f(a){if(this._active){var b=this.options;this._differential=a.position;var c=d.call(this,this._differential);this._differential[0]-=c[0],this._differential[1]-=c[1];var e=this.getPosition();if(e[0]+=c[0],e[1]+=c[1],b.xRange){var f=[b.xRange[0]+.5*b.snapX,b.xRange[1]-.5*b.snapX];e[0]=q(e[0],f)}if(b.yRange){var g=[b.yRange[0]+.5*b.snapY,b.yRange[1]-.5*b.snapY];e[1]=q(e[1],g)}this.eventOutput.emit("update",{position:e})}}function g(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function h(){this.sync.on("start",e.bind(this)),this.sync.on("update",f.bind(this)),this.sync.on("end",g.bind(this))}var i=a("../core/Transform"),j=a("../transitions/Transitionable"),k=a("../core/EventHandler"),l=a("../math/Utilities"),m=a("../inputs/GenericSync"),n=a("../inputs/MouseSync"),o=a("../inputs/TouchSync");m.register({mouse:n,touch:o});var p={x:1,y:2};c.DIRECTION_X=p.x,c.DIRECTION_Y=p.y;var q=l.clamp;c.DEFAULT_OPTIONS={projection:p.x|p.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},c.prototype.setOptions=function(a){var b=this.options;if(void 0!==a.projection){var c=a.projection;this.options.projection=0,["x","y"].forEach(function(a){-1!==c.indexOf(a)&&(b.projection|=p[a])})}void 0!==a.scale&&(b.scale=a.scale,this.sync.setOptions({scale:a.scale})),void 0!==a.xRange&&(b.xRange=a.xRange),void 0!==a.yRange&&(b.yRange=a.yRange),void 0!==a.snapX&&(b.snapX=a.snapX),void 0!==a.snapY&&(b.snapY=a.snapY)},c.prototype.getPosition=function(){return this._positionState.get()},c.prototype.setRelativePosition=function(a,b,c){var d=this.getPosition(),e=[d[0]+a[0],d[1]+a[1]];this.setPosition(e,b,c)},c.prototype.setPosition=function(a,b,c){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(a,b,c)},c.prototype.activate=function(){this._active=!0},c.prototype.deactivate=function(){this._active=!1},c.prototype.toggle=function(){this._active=!this._active},c.prototype.modify=function(a){var b=this.getPosition();return{transform:i.translate(b[0],b[1]),target:a}},b.exports=c},{"../core/EventHandler":7,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":34,"../math/Utilities":41,"../transitions/Transitionable":89}],45:[function(a,b){function c(a,b){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),b||(b=0),this.transitionHelper=new d(b)}var d=a("../transitions/Transitionable"),e=a("../core/OptionsManager");c.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.show=function(a,b){a=a||this.options.transition,this.set(1,a,b)},c.prototype.hide=function(a,b){a=a||this.options.transition,this.set(0,a,b)},c.prototype.set=function(a,b,c){this.halt(),this.transitionHelper.set(a,b,c)},c.prototype.halt=function(){this.transitionHelper.halt()},c.prototype.isVisible=function(){return this.transitionHelper.get()>0},c.prototype.modify=function(a){var b=this.transitionHelper.get();return this.options.cull&&!b?void 0:{opacity:b,target:a}},b.exports=c},{"../core/OptionsManager":10,"../transitions/Transitionable":89}],46:[function(a,b){function c(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}c.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},c.prototype.removeModifier=function(a){var b=this._chain.indexOf(a);0>b||this._chain.splice(b,1)},c.prototype.modify=function(a){for(var b=this._chain,c=a,d=0;d<b.length;d++)c=b[d].modify(c);return c},b.exports=c},{}],47:[function(a,b){function c(a){this._transformState=new g(e.identity),this._opacityState=new f(1),this._originState=new f([0,0]),this._alignState=new f([0,0]),this._sizeState=new f([0,0]),this._proportionsState=new f([0,0]),this._modifier=new d({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,a&&(a.transform&&this.setTransform(a.transform),void 0!==a.opacity&&this.setOpacity(a.opacity),a.origin&&this.setOrigin(a.origin),a.align&&this.setAlign(a.align),a.size&&this.setSize(a.size),a.proportions&&this.setProportions(a.proportions))}var d=a("../core/Modifier"),e=a("../core/Transform"),f=a("../transitions/Transitionable"),g=a("../transitions/TransitionableTransform");c.prototype.setTransform=function(a,b,c){return this._transformState.set(a,b,c),this},c.prototype.setOpacity=function(a,b,c){return this._opacityState.set(a,b,c),this},c.prototype.setOrigin=function(a,b,c){return null===a?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(a,b,c),this)},c.prototype.setAlign=function(a,b,c){return null===a?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(a,b,c),this)},c.prototype.setSize=function(a,b,c){return null===a?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(a,b,c),this)},c.prototype.setProportions=function(a,b,c){return null===a?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(a,b,c),this)},c.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},c.prototype.getTransform=function(){return this._transformState.get()},c.prototype.getFinalTransform=function(){return this._transformState.getFinal()},c.prototype.getOpacity=function(){return this._opacityState.get()},c.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},c.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},c.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},c.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},c.prototype.modify=function(a){return this._modifier.modify(a)},b.exports=c},{"../core/Modifier":9,"../core/Transform":15,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90}],48:[function(a,b){b.exports={Draggable:a("./Draggable"),Fader:a("./Fader"),ModifierChain:a("./ModifierChain"),StateModifier:a("./StateModifier")}},{"./Draggable":44,"./Fader":45,"./ModifierChain":46,"./StateModifier":47}],49:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=v(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function d(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function e(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},d.call(this,a).push(this._currAgentId),this._currAgentId++}function f(a){return this._agentData[a]}function g(a){var b=f.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function h(){for(var a=this._forces.length-1;a>-1;a--)g.call(this,a)}function i(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function j(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)i.call(this,c,a);b++}}function k(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function l(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function m(a,b){a.integrateOrientation(b)}function n(a,b){a.integratePosition(b),a.emit(w.update,a)}function o(a){h.call(this,a),this.forEach(k,a),this.forEachBody(l,a),j.call(this,a),this.forEachBody(m,a),this.forEach(n,a)}function p(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function q(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var r=a("../core/EventHandler"),s=17,t=1e3/120,u=17,v=Date.now,w={start:"start",update:"update",end:"end"};c.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},c.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},c.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},c.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],f=0;f<a.length;f++)d[f]=e.call(this,a[f],b,c);return d}return e.call(this,a,b,c)},c.prototype.attachTo=function(a,b){f.call(this,a).targets.push(b)},c.prototype.detach=function(a){var b=this.getAgent(a),c=d.call(this,b),e=c.indexOf(a);c.splice(e,1),delete this._agentData[a]},c.prototype.detachFrom=function(a,b){var c=f.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},c.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},c.prototype.getAgent=function(a){return f.call(this,a).agent},c.prototype.getParticles=function(){return this._particles},c.prototype.getBodies=function(){return this._bodies},c.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},c.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},c.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},c.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},c.prototype.getAgentEnergy=function(a){var b=f.call(this,a);return b.agent.getEnergy(b.targets,b.source)},c.prototype.getEnergy=function(){return p.call(this)+q.call(this)},c.prototype.step=function(){if(!this.isSleeping()){var a=v(),b=a-this._prevTime;this._prevTime=a,t>b||(b>u&&(b=u),o.call(this,s),this.emit(w.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},c.prototype.isSleeping=function(){return this._isSleeping},c.prototype.isActive=function(){return!this._isSleeping},c.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(w.end,this),this._isSleeping=!0)},c.prototype.wake=function(){this._isSleeping&&(this._prevTime=v(),this.emit(w.start,this),this._isSleeping=!1)},c.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},c.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new r),this._eventHandler.on(a,b)},b.exports=c},{"../core/EventHandler":7}],50:[function(a,b){function c(a){d.call(this,a),a=a||{},this.orientation=new g,this.angularVelocity=new f,this.angularMomentum=new f,this.torque=new f,a.orientation&&this.orientation.set(a.orientation),a.angularVelocity&&this.angularVelocity.set(a.angularVelocity),a.angularMomentum&&this.angularMomentum.set(a.angularMomentum),a.torque&&this.torque.set(a.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new f}var d=a("./Particle"),e=a("../../core/Transform"),f=a("../../math/Vector"),g=a("../../math/Quaternion"),h=a("../../math/Matrix"),i=a("../integrators/SymplecticEuler");c.DEFAULT_OPTIONS=d.DEFAULT_OPTIONS,c.DEFAULT_OPTIONS.orientation=[0,0,0,1],c.DEFAULT_OPTIONS.angularVelocity=[0,0,0],c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.isBody=!0,c.prototype.setMass=function(){d.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){this.inertia=new h,this.inverseInertia=new h},c.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},c.prototype.toWorldCoordinates=function(a){return this.pWorld.set(this.orientation.rotateVector(a))},c.prototype.getEnergy=function(){return d.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},c.prototype.reset=function(a,b,c,e){d.prototype.reset.call(this,a,b),this.angularVelocity.clear(),this.setOrientation(c||[1,0,0,0]),this.setAngularMomentum(e||[0,0,0])},c.prototype.setOrientation=function(a){this.orientation.set(a)},c.prototype.setAngularVelocity=function(a){this.wake(),this.angularVelocity.set(a)},c.prototype.setAngularMomentum=function(a){this.wake(),this.angularMomentum.set(a)},c.prototype.applyForce=function(a,b){d.prototype.applyForce.call(this,a),void 0!==b&&this.applyTorque(b.cross(a))},c.prototype.applyTorque=function(a){this.wake(),this.torque.set(this.torque.add(a))},c.prototype.getTransform=function(){return e.thenMove(this.orientation.getTransform(),e.getTranslate(d.prototype.getTransform.call(this)))},c.prototype._integrate=function(a){d.prototype._integrate.call(this,a),this.integrateAngularMomentum(a),this.updateAngularVelocity(a),this.integrateOrientation(a)},c.prototype.integrateAngularMomentum=function(a){i.integrateAngularMomentum(this,a)},c.prototype.integrateOrientation=function(a){i.integrateOrientation(this,a)},b.exports=c},{"../../core/Transform":15,"../../math/Matrix":38,"../../math/Quaternion":39,"../../math/Vector":42,"../integrators/SymplecticEuler":73,"./Particle":52}],51:[function(a,b){function c(a){a=a||{},this.setRadius(a.radius||0),d.call(this,a)}var d=a("./Body"),e=a("../../math/Matrix");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setRadius=function(a){this.radius=a,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.radius;this.inertia=new e([[.25*a*b*b,0,0],[0,.25*a*b*b,0],[0,0,.5*a*b*b]]),this.inverseInertia=new e([[4/(a*b*b),0,0],[0,4/(a*b*b),0],[0,0,2/(a*b*b)]])},b.exports=c},{"../../math/Matrix":38,"./Body":50}],52:[function(a,b){function c(a){a=a||{};var b=c.DEFAULT_OPTIONS;this.position=new e,this.velocity=new e,this.force=new e,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=f.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function d(){this._eventOutput=new g,this._eventOutput.bindThis(this),g.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/Transform"),g=a("../../core/EventHandler"),h=a("../integrators/SymplecticEuler");c.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var i={start:"start",update:"update",end:"end"},j=Date.now;c.prototype.isBody=!1,c.prototype.isActive=function(){return!this._isSleeping},c.prototype.sleep=function(){this._isSleeping||(this.emit(i.end,this),this._isSleeping=!0)},c.prototype.wake=function(){this._isSleeping&&(this.emit(i.start,this),this._isSleeping=!1,this._prevTime=j(),this._engine&&this._engine.wake())},c.prototype.setPosition=function(a){this.position.set(a)},c.prototype.setPosition1D=function(a){this.position.x=a},c.prototype.getPosition=function(){return this._engine.step(),this.position.get()},c.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},c.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},c.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},c.prototype.getVelocity=function(){return this.velocity.get()},c.prototype.setForce=function(a){this.force.set(a),this.wake()},c.prototype.getVelocity1D=function(){return this.velocity.x},c.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},c.prototype.getMass=function(){return this.mass},c.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},c.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},c.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},c.prototype.integrateVelocity=function(a){h.integrateVelocity(this,a)},c.prototype.integratePosition=function(a){h.integratePosition(this,a)},c.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},c.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},c.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},c.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},c.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},c.prototype.on=function(){return d.call(this),this.on.apply(this,arguments)},c.prototype.removeListener=function(){return d.call(this),this.removeListener.apply(this,arguments)},c.prototype.pipe=function(){return d.call(this),this.pipe.apply(this,arguments)},c.prototype.unpipe=function(){return d.call(this),this.unpipe.apply(this,arguments)},b.exports=c},{"../../core/EventHandler":7,"../../core/Transform":15,"../../math/Vector":42,"../integrators/SymplecticEuler":73}],53:[function(a,b){function c(a){a=a||{},this.size=a.size||[0,0],d.call(this,a)}var d=a("./Body"),e=a("../../math/Matrix");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setSize=function(a){this.size=a,this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.size[0],c=this.size[1];this.inertia=new e([[a*c*c/12,0,0],[0,a*b*b/12,0],[0,0,a*(b*b+c*c)/12]]),this.inverseInertia=new e([[12/(a*c*c),0,0],[0,12/(a*b*b),0],[0,0,12/(a*(b*b+c*c))]])},b.exports=c},{"../../math/Matrix":38,"./Body":50}],54:[function(a,b){b.exports={Body:a("./Body"),Circle:a("./Circle"),Particle:a("./Particle"),Rectangle:a("./Rectangle")}},{"./Body":50,"./Circle":51,"./Particle":52,"./Rectangle":53}],55:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.normal=new e,this.pDiff=new e,this.vDiff=new e,this.impulse1=new e,this.impulse2=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){if(void 0!==b)for(var d=b.velocity,e=b.position,f=b.inverseMass,g=b.radius,h=this.options,i=h.drift,j=-h.slop,k=h.restitution,l=this.normal,m=this.pDiff,n=this.vDiff,o=this.impulse1,p=this.impulse2,q=0;q<a.length;q++){var r=a[q];if(r!==b){var s=r.velocity,t=r.position,u=r.inverseMass,v=r.radius;m.set(t.sub(e)),n.set(s.sub(d));var w=m.norm(),x=w-(g+v),y=1/(f+u),z=0;if(0>x){if(l.set(m.normalize()),this._eventOutput){var A={target:r,source:b,overlap:x,normal:l};this._eventOutput.emit("preCollision",A),this._eventOutput.emit("collision",A)}var B=j>=x?((1+k)*l.dot(n)+i/c*(x-j))/(z+c/y):(1+k)*l.dot(n)/(z+c/y);l.mult(c*B).put(o),o.mult(-1).put(p),b.applyImpulse(o),r.applyImpulse(p),this._eventOutput&&this._eventOutput.emit("postCollision",A)}}}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],56:[function(a,b){function c(){this.options=this.options||{},this._eventOutput=new d,d.setOutputHandler(this,this._eventOutput)}var d=a("../../core/EventHandler");c.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},c.prototype.applyConstraint=function(){},c.prototype.getEnergy=function(){return 0},b.exports=c},{"../../core/EventHandler":7}],57:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new e,this.impulse=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c;var f=1e-7,g=Math.PI;c.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(a,b,c){return c},period:0,dampingRatio:0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.impulse,h=this.J,i=d.equation,j=d.plane,k=d.dampingRatio,l=d.period,m=0;m<a.length;m++){var n,o,p=a[m],q=p.velocity,r=p.position,s=p.mass;if(0===l)n=0,o=1;else{var t=4*s*g*k/l,u=4*s*g*g/(l*l);n=1/(t+c*u),o=c*u/(t+c*u)}var v=r.x,w=r.y,x=r.z,y=i(v,w,x),z=(i(v+f,r,r)-y)/f,A=(i(v,w+f,r)-y)/f,B=(i(v,w,r+f)-y)/f,C=j(v,w,x),D=(j(v+f,w,x)-C)/f,E=(j(v,w+f,x)-C)/f,F=(j(v,w,x+f)-C)/f;h.setXYZ(z+D,A+E,B+F);var G=o/c*(y+C),H=-(h.dot(q)+G)/(n+c*h.normSquared()/s);
e.set(h.mult(c*H)),p.applyImpulse(e)}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],58:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.impulse=new e,this.normal=new e,this.diffP=new e,this.diffV=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var f=Math.PI;c.prototype.setOptions=function(a){a.anchor&&(a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof e&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),void 0!==a.minLength&&(this.options.minLength=a.minLength)},c.prototype.setAnchor=function(a){this.options.anchor||(this.options.anchor=new e),this.options.anchor.set(a)},c.prototype.applyConstraint=function(a,b,c){var d,e,g=this.normal,h=this.diffP,i=this.diffV,j=this.impulse,k=this.options,l=k.dampingRatio,m=k.period,n=k.minLength;if(b){var o=b.velocity;d=b.position,e=b.inverseMass}else d=this.options.anchor,e=0;for(var p=this.options.length,q=0;q<a.length;q++){var r=a[q],s=r.velocity,t=r.position,u=r.inverseMass;h.set(t.sub(d)),g.set(h.normalize());var v=h.norm()-p;if(Math.abs(v)<n)return;i.set(b?s.sub(o):s);var w,x,y=1/(u+e);if(0===m)w=0,x=1;else{var z=4*y*f*l/m,A=4*y*f*f/(m*m);w=1/(z+c*A),x=c*A/(z+c*A)}var B=x/c*v,C=-(g.dot(i)+B)/(w+c/y);j.set(g.mult(c*C)),r.applyImpulse(j),b&&b.applyImpulse(j.mult(-1))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],59:[function(a,b){function c(a){d.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.pDiff=new e,this.vDiff=new e,this.impulse1=new e,this.impulse2=new e}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var f=Math.PI;c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof e&&(this.options.anchor=a.anchor),a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),d.prototype.setOptions.call(this,a)},c.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=c.anchor||b.position,g=Math.pow(2*f/c.period,2),h=0,i=0;i<a.length;i++){var j=a[i],k=e.sub(j.position).norm()-d;h+=.5*g*k*k}return h},c.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.pDiff,g=this.vDiff,h=this.impulse1,i=this.impulse2,j=d.length,k=d.anchor||b.position,l=d.period,m=d.dampingRatio,n=0;n<a.length;n++){var o=a[n],p=o.position,q=o.velocity,r=o.mass,s=o.inverseMass;e.set(p.sub(k));var t,u=e.norm()-j;if(b){var v=b.inverseMass,w=b.velocity;g.set(q.sub(w)),t=1/(s+v)}else g.set(q),t=r;var x,y;if(0===this.options.period)x=0,y=1;else{var z=4*t*f*f/(l*l),A=4*t*f*m/l;y=c*z/(A+c*z),x=1/(A+c*z)}var B=y/c*u;e.normalize(-B).sub(g).mult(c/(x+c/t)).put(h),o.applyImpulse(h),b&&(h.mult(-1).put(i),b.applyImpulse(i))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],60:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new e,this.impulse=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var f=1e-7,g=Math.PI;c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){for(var d=this.impulse,e=this.J,h=this.options,i=h.equation,j=h.dampingRatio,k=h.period,l=0;l<a.length;l++){var m,n,o=a[l],p=o.velocity,q=o.position,r=o.mass;if(0===k)m=0,n=1;else{var s=4*r*g*j/k,t=4*r*g*g/(k*k);m=1/(s+c*t),n=c*t/(s+c*t)}var u=q.x,v=q.y,w=q.z,x=i(u,v,w),y=(i(u+f,q,q)-x)/f,z=(i(u,v+f,q)-x)/f,A=(i(u,v,q+f)-x)/f;e.setXYZ(y,z,A);var B=n/c*x,C=-(e.dot(p)+B)/(m+c*e.normSquared()/r);d.set(e.mult(c*C)),o.applyImpulse(d)}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],61:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.diff=new i,this.impulse=new i,h.call(this)}function d(a,b){return b.dot(a)}function e(a){var b=this.options.normal,c=this.options.distance;return a.dot(b)+c}function f(a,b,d){var e=a.position,f=a.velocity,g=a.mass,h=this.options.normal,i=this.options.onContact,j=this.options.restitution,k=this.impulse,l=this.options.drift,m=-this.options.slop,n=0;if(this._eventOutput){var o={particle:a,wall:this,overlap:b,normal:h};this._eventOutput.emit("preCollision",o),this._eventOutput.emit("collision",o)}switch(i){case c.ON_CONTACT.REFLECT:var p=m>b?-((1+j)*h.dot(f)+l/d*(b-m))/(g*d+n):-((1+j)*h.dot(f))/(g*d+n);k.set(h.mult(d*p)),a.applyImpulse(k),a.setPosition(e.add(h.mult(-b)))}this._eventOutput&&this._eventOutput.emit("postCollision",o)}function g(a,b){var d=this.options.onContact,e=a.position,f=this.options.normal;d===c.ON_CONTACT.REFLECT&&a.setPosition(e.add(f.mult(-b)))}var h=a("./Constraint"),i=a("../../math/Vector");c.prototype=Object.create(h.prototype),c.prototype.constructor=c,c.ON_CONTACT={REFLECT:0,SILENT:1},c.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:c.ON_CONTACT.REFLECT},c.prototype.setOptions=function(a){void 0!==a.normal&&(a.normal instanceof i&&(this.options.normal=a.normal.clone()),a.normal instanceof Array&&(this.options.normal=new i(a.normal))),void 0!==a.restitution&&(this.options.restitution=a.restitution),void 0!==a.drift&&(this.options.drift=a.drift),void 0!==a.slop&&(this.options.slop=a.slop),void 0!==a.distance&&(this.options.distance=a.distance),void 0!==a.onContact&&(this.options.onContact=a.onContact)},c.prototype.applyConstraint=function(a,b,c){for(var h=this.options.normal,i=0;i<a.length;i++){var j=a[i],k=j.position,l=j.velocity,m=j.radius||0,n=e.call(this,k.add(h.mult(-m))),o=d.call(this,h,l);0>=n&&(0>o?f.call(this,j,n,c):g.call(this,j,n,c))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],62:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this,a.sides||this.options.sides),g.call(this)}function d(a,b,d){var e,f=c.SIDES;switch(parseInt(a)){case f.LEFT:e=b[0]*d[0];break;case f.TOP:e=b[1]*d[1];break;case f.FRONT:e=b[2]*d[2];break;case f.RIGHT:e=b[0]*(1-d[0]);break;case f.BOTTOM:e=b[1]*(1-d[1]);break;case f.BACK:e=b[2]*(1-d[2])}return e}function e(a){this.components={};for(var b=this.components,c=0;c<a.length;c++){var e=a[c];b[c]=new h({normal:j[e].clone(),distance:d(e,this.options.size,this.options.origin)})}}function f(a){this.forEach(function(b){b.setOptions(a)});for(var b in a)this.options[b]=a[b]}var g=a("./Constraint"),h=a("./Wall"),i=a("../../math/Vector");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.ON_CONTACT=h.ON_CONTACT,c.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},c.DEFAULT_OPTIONS={sides:c.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:c.ON_CONTACT.REFLECT};var j={0:new i(1,0,0),1:new i(-1,0,0),2:new i(0,1,0),3:new i(0,-1,0),4:new i(0,0,1),5:new i(0,0,-1)};c.prototype.setOptions=function(a){var b=!1;void 0!==a.restitution&&f.call(this,{restitution:a.restitution}),void 0!==a.drift&&f.call(this,{drift:a.drift}),void 0!==a.slop&&f.call(this,{slop:a.slop}),void 0!==a.onContact&&f.call(this,{onContact:a.onContact}),void 0!==a.size&&(b=!0),void 0!==a.sides&&(this.options.sides=a.sides),void 0!==a.origin&&(b=!0),b&&this.setSize(a.size,a.origin)},c.prototype.setSize=function(a,b){b=b||this.options.origin,b.length<3&&(b[2]=.5),this.forEach(function(c,e){var f=d(e,a,b);c.setOptions({distance:f})}),this.options.size=a,this.options.origin=b},c.prototype.applyConstraint=function(a,b,c){this.forEach(function(d){d.applyConstraint(a,b,c)})},c.prototype.forEach=function(a){var b=this.options.sides;for(var c in this.sides)a(b[c],c)},c.prototype.rotateZ=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateZ(a).put(c)})},c.prototype.rotateX=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateX(a).put(c)})},c.prototype.rotateY=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateY(a).put(c)})},c.prototype.reset=function(){var a=this.options.sides;for(var b in a){var c=this.components[b];c.options.normal.set(j[b])}},b.exports=c},{"../../math/Vector":42,"./Constraint":56,"./Wall":61}],63:[function(a,b){b.exports={Collision:a("./Collision"),Constraint:a("./Constraint"),Curve:a("./Curve"),Distance:a("./Distance"),Snap:a("./Snap"),Surface:a("./Surface"),Wall:a("./Wall"),Walls:a("./Walls")}},{"./Collision":55,"./Constraint":56,"./Curve":57,"./Distance":58,"./Snap":59,"./Surface":60,"./Wall":61,"./Walls":62}],64:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),d.call(this)}var d=a("./Force");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},c.DEFAULT_OPTIONS={strength:.01,forceFunction:c.FORCE_FUNCTIONS.LINEAR},c.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},b.exports=c},{"./Force":65}],65:[function(a,b){function c(a){this.force=new d(a),this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput)}var d=a("../../math/Vector"),e=a("../../core/EventHandler");c.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},c.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},c.prototype.getEnergy=function(){return 0},b.exports=c},{"../../core/EventHandler":7,"../../math/Vector":42}],66:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new e,d.call(this)}var d=a("./Force"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DECAY_FUNCTIONS={LINEAR:function(a,b){return Math.max(1-1/b*a,0)},MORSE:function(a,b){var c=0===b?100:b,d=a+c*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(d/c-1),2),0)},INVERSE:function(a,b){return 1/(1-b+a)},GRAVITY:function(a,b){return 1/(1-b+a*a)}},c.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:c.DECAY_FUNCTIONS.GRAVITY},c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor)),delete a.anchor);for(var b in a)this.options[b]=a[b]},c.prototype.applyForce=function(a,b){var c=this.options,d=this.force,e=this.disp,f=c.strength,g=c.anchor||b.position,h=c.cap,i=c.cutoff,j=c.range[0],k=c.range[1],l=c.decayFunction;if(0!==f)for(var m,n,o,p,q=a.length;q--;)m=a[q],m!==b&&(n=m.mass,o=m.position,e.set(o.sub(g)),p=e.norm(),k>p&&p>j&&(d.set(e.normalize(f*n*l(p,i)).cap(h)),m.applyForce(d)))},b.exports=c},{"../../math/Vector":42,"./Force":65}],67:[function(a,b){function c(a){d.call(this,a)}var d=a("./Drag");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=d.DEFAULT_OPTIONS,c.FORCE_FUNCTIONS=d.FORCE_FUNCTIONS,c.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},c.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.angularVelocity).mult(-100*d).put(f),c.applyTorque(f)},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},b.exports=c},{"./Drag":64}],68:[function(a,b){function c(a){h.call(this,a)}function d(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function e(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function f(){d.call(this),e.call(this)}var g=a("./Force"),h=a("./Spring"),i=a("../../math/Quaternion");c.prototype=Object.create(h.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=h.DEFAULT_OPTIONS,c.FORCE_FUNCTIONS=h.FORCE_FUNCTIONS;var j=Math.PI;c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),f.call(this),g.prototype.setOptions.call(this,a)},c.prototype.applyForce=function(a){var b,c,d,e,f=this.force,g=this.options,h=this.disp,i=g.stiffness,j=g.damping,k=g.length,l=g.anchor,m=g.forceFunction,n=g.maxLength;for(b=0;b<a.length;b++){if(c=a[b],h.set(l.sub(c.orientation)),d=h.norm()-k,0===d)return;e=c.mass,i*=e,j*=e,f.set(h.normalize(i*m(d,n))),j&&f.add(c.angularVelocity.mult(-j)).put(f),c.applyTorque(f)}},c.prototype.getEnergy=function(a){for(var b=this.options,c=b.length,d=b.anchor,e=b.stiffness,f=0,g=0;g<a.length;g++){var h=a[g],i=d.sub(h.orientation).norm()-c;f+=.5*e*i*i}return f},b.exports=c},{"../../math/Quaternion":39,"./Force":65,"./Spring":69}],69:[function(a,b){function c(a){g.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new h(0,0,0),f.call(this)}function d(){var a=this.options;a.stiffness=Math.pow(2*i/a.period,2)}function e(){var a=this.options;a.damping=4*i*a.dampingRatio/a.period}function f(){d.call(this),e.call(this)}var g=a("./Force"),h=a("../../math/Vector");c.prototype=Object.create(g.prototype),c.prototype.constructor=c;var i=Math.PI,j=150;c.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},c.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:c.FORCE_FUNCTIONS.HOOK},c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof h&&(this.options.anchor=a.anchor.position),a.anchor instanceof h&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new h(a.anchor))),void 0!==a.period&&(a.period<j&&(a.period=j,console.warn("The period of a SpringTransition is capped at "+j+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),f.call(this),g.prototype.setOptions.call(this,a)},c.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},c.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},b.exports=c},{"../../math/Vector":42,"./Force":65}],70:[function(a,b){function c(a){e.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.evaluation=new f}function d(a){var b=c.FIELDS;switch(a){case b.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new f(this.options.direction)):this.options.direction=new f(0,1,0);break;case b.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new f(this.options.position)):this.options.position=new f(0,0,0)}}var e=a("./Force"),f=a("../../math/Vector");c.prototype=Object.create(e.prototype),c.prototype.constructor=c,c.FIELDS={CONSTANT:function(a,b){b.direction.put(this.evaluation)},LINEAR:function(a){a.put(this.evaluation)},RADIAL:function(a){a.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(a,b){b.position.sub(a).put(this.evaluation)}},c.DEFAULT_OPTIONS={strength:.01,field:c.FIELDS.CONSTANT},c.prototype.setOptions=function(a){void 0!==a.strength&&(this.options.strength=a.strength),void 0!==a.direction&&(this.options.direction=a.direction),void 0!==a.field&&(this.options.field=a.field,d.call(this,this.options.field))},c.prototype.applyForce=function(a){var b,c,d=this.force,e=this.options.strength,f=this.options.field;for(b=0;b<a.length;b++)c=a[b],f.call(this,c.position,this.options),this.evaluation.mult(c.mass*e).put(d),c.applyForce(d)},c.prototype.getEnergy=function(a){var b,d,e=this.options.field,f=c.FIELDS,g=0;switch(e){case f.CONSTANT:g=a.length*this.options.direction.norm();break;case f.RADIAL:for(b=0;b<a.length;b++)d=a[b],g+=d.position.norm();break;case f.POINT_ATTRACTOR:for(b=0;b<a.length;b++)d=a[b],g+=d.position.sub(this.options.position).norm()}return g*=this.options.strength},b.exports=c},{"../../math/Vector":42,"./Force":65}],71:[function(a,b){b.exports={Drag:a("./Drag"),Force:a("./Force"),Repulsion:a("./Repulsion"),RotationalDrag:a("./RotationalDrag"),RotationalSpring:a("./RotationalSpring"),Spring:a("./Spring"),VectorField:a("./VectorField")}},{"./Drag":64,"./Force":65,"./Repulsion":66,"./RotationalDrag":67,"./RotationalSpring":68,"./Spring":69,"./VectorField":70}],72:[function(a,b){b.exports={PhysicsEngine:a("./PhysicsEngine"),bodies:a("./bodies"),constraints:a("./constraints"),forces:a("./forces"),integrators:a("./integrators")}},{"./PhysicsEngine":49,"./bodies":54,"./constraints":63,"./forces":71,"./integrators":74}],73:[function(a,b){var c={};c.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},c.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},c.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},c.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},b.exports=c},{}],74:[function(a,b){b.exports={SymplecticEuler:a("./SymplecticEuler")}},{"./SymplecticEuler":73}],75:[function(a,b){function c(a){a&&a.canvasSize&&(this._canvasSize=a.canvasSize),d.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="canvas",c.prototype.elementClass="famous-surface",c.prototype.setContent=function(){},c.prototype.deploy=function(a){this._canvasSize&&(a.width=this._canvasSize[0],a.height=this._canvasSize[1]),"2d"===this._contextId&&(a.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},c.prototype.recall=function(a){this.getSize();this._backBuffer.width=a.width,this._backBuffer.height=a.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(a,0,0),a.width=0,a.height=0)},c.prototype.getContext=function(a){return this._contextId=a,this._currentTarget?this._currentTarget.getContext(a):this._backBuffer.getContext(a)},c.prototype.setSize=function(a,b){d.prototype.setSize.apply(this,arguments),b&&(this._canvasSize=[b[0],b[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},b.exports=c},{"../core/Surface":14}],76:[function(a,b){function c(a){d.call(this,a),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new e(this._container),this.setContent(this._container)}var d=a("../core/Surface"),e=a("../core/Context");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="div",c.prototype.elementClass="famous-surface",c.prototype.add=function(){return this.context.add.apply(this.context,arguments)},c.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),d.prototype.render.apply(this,arguments)},c.prototype.deploy=function(){return this._shouldRecalculateSize=!0,d.prototype.deploy.apply(this,arguments)},c.prototype.commit=function(){var a=this._size?[this._size[0],this._size[1]]:null,b=d.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||a&&(this._size[0]!==a[0]||this._size[1]!==a[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),b},b.exports=c},{"../core/Context":1,"../core/Surface":14}],77:[function(a,b){function c(a){a&&(this._method=a.method||""),d.apply(this,arguments)}var d=a("./ContainerSurface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="form",c.prototype.deploy=function(a){return this._method&&(a.method=this._method),d.prototype.deploy.apply(this,arguments)},b.exports=c},{"./ContainerSurface":76}],78:[function(a,b){function c(){this._imageUrl=void 0,d.apply(this,arguments)}var d=a("../core/Surface"),e=[],f=[],g=[],h=!0;c.enableCache=function(){h=!0},c.disableCache=function(){h=!1},c.clearCache=function(){e=[],f=[],g=[]},c.getCache=function(){return{urlCache:e,countCache:f,nodeCache:f}},c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="img",c.prototype.elementClass="famous-surface",c.prototype.setContent=function(a){var b=e.indexOf(this._imageUrl);-1!==b&&(1===f[b]?(e.splice(b,1),f.splice(b,1),g.splice(b,1)):f[b]--),b=e.indexOf(a),-1===b?(e.push(a),f.push(1)):f[b]++,this._imageUrl=a,this._contentDirty=!0},c.prototype.deploy=function(a){var b=e.indexOf(this._imageUrl);if(void 0===g[b]&&h){var c=new Image;c.src=this._imageUrl||"",g[b]=c}a.src=this._imageUrl||""},c.prototype.recall=function(a){a.src=""},b.exports=c},{"../core/Surface":14}],79:[function(a,b){function c(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._type=a.type||"text",this._name=a.name||"",d.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(a){a.target!==this._currentTarget&&this.blur()}.bind(this))}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="input",c.prototype.elementClass="famous-surface",c.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},c.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},c.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},c.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},c.prototype.setType=function(a){return this._type=a,this._contentDirty=!0,this},c.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},c.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},c.prototype.getName=function(){return this._name},c.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),a.value=this._value,a.type=this._type,a.name=this._name},b.exports=c},{"../core/Surface":14}],80:[function(a,b){function c(a){d.apply(this,arguments),this._type="submit",a&&a.onClick&&this.setOnClick(a.onClick)}var d=a("./InputSurface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setOnClick=function(a){this.onClick=a},c.prototype.deploy=function(a){this.onclick&&(a.onClick=this.onClick),d.prototype.deploy.apply(this,arguments)},b.exports=c},{"./InputSurface":79}],81:[function(a,b){function c(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._name=a.name||"",this._wrap=a.wrap||"",this._cols=a.cols||"",this._rows=a.rows||"",d.apply(this,arguments),this.on("click",this.focus.bind(this))}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="textarea",c.prototype.elementClass="famous-surface",c.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},c.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},c.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},c.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},c.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},c.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},c.prototype.getName=function(){return this._name},c.prototype.setWrap=function(a){return this._wrap=a,this._contentDirty=!0,this},c.prototype.setColumns=function(a){return this._cols=a,this._contentDirty=!0,this},c.prototype.setRows=function(a){return this._rows=a,this._contentDirty=!0,this},c.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),""!==this._value&&(a.value=this._value),""!==this._name&&(a.name=this._name),""!==this._wrap&&(a.wrap=this._wrap),""!==this._cols&&(a.cols=this._cols),""!==this._rows&&(a.rows=this._rows)},b.exports=c},{"../core/Surface":14}],82:[function(a,b){function c(a){d.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a)}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={autoplay:!1},c.prototype.elementType="video",c.prototype.elementClass="famous-surface",c.prototype.setOptions=function(a){a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.autoplay&&(this.options.autoplay=a.autoplay),a.src&&(this._videoUrl=a.src,this._contentDirty=!0)},c.prototype.setContent=function(a){this._videoUrl=a,this._contentDirty=!0},c.prototype.deploy=function(a){a.src=this._videoUrl,a.autoplay=this.options.autoplay},c.prototype.recall=function(a){a.src=""},b.exports=c},{"../core/Surface":14}],83:[function(a,b){b.exports={CanvasSurface:a("./CanvasSurface"),ContainerSurface:a("./ContainerSurface"),FormContainerSurface:a("./FormContainerSurface"),ImageSurface:a("./ImageSurface"),InputSurface:a("./InputSurface"),SubmitInputSurface:a("./SubmitInputSurface"),TextareaSurface:a("./TextareaSurface"),VideoSurface:a("./VideoSurface")}},{"./CanvasSurface":75,"./ContainerSurface":76,"./FormContainerSurface":77,"./ImageSurface":78,"./InputSurface":79,"./SubmitInputSurface":80,"./TextareaSurface":81,"./VideoSurface":82}],84:[function(a,b){function c(a){this._map=a||null,this._cachedOutput=null,this._cachedInput=Number.NaN}c.create=function(a){var b=new c(a);return b.get.bind(b)},c.prototype.get=function(a){return a!==this._cachedInput&&(this._cachedInput=a,this._cachedOutput=this._map(a)),this._cachedOutput},b.exports=c},{}],85:[function(a,b){var c={inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inQuart:function(a){return a*a*a*a},outQuart:function(a){return-(--a*a*a*a-1)},inOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return--a*a*a*a*a+1},inOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inCirc:function(a){return-(Math.sqrt(1-a*a)-1)},outCirc:function(a){return Math.sqrt(1- --a*a)},inOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)},inBack:function(a,b){return void 0===b&&(b=1.70158),a*a*((b+1)*a-b)},outBack:function(a,b){return void 0===b&&(b=1.70158),--a*a*((b+1)*a+b)+1},inOutBack:function(a,b){return void 0===b&&(b=1.70158),(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},inBounce:function(a){return 1-c.outBounce(1-a)},outBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},inOutBounce:function(a){return.5>a?.5*c.inBounce(2*a):.5*c.outBounce(2*a-1)+.5}};b.exports=c},{}],86:[function(a,b){function c(a){this.method=a,this._instances=[],this.state=[]}var d=a("../utilities/Utility");c.SUPPORTS_MULTIPLE=!0,c.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},c.prototype.set=function(a,b,c){for(var e=d.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,e)},c.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},b.exports=c},{"../utilities/Utility":96}],87:[function(a,b){function c(a){a=a||0,this.endState=new s(a),this.initState=new s,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.particle=new q,this.spring=new r({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function f(a){this.endState.set(a),e.call(this)}function g(){this.PE.wake()}function h(){this.PE.sleep()}function i(a){this.particle.position.set(a)}function j(a){this.particle.velocity.set(a)}function k(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function m(a){this._callback=a}function n(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),j.call(this,a.velocity)}function o(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;
this._callback=void 0,a()}}else d.call(this)<this._absRestTolerance&&(i.call(this,this.endState),j.call(this,[0,0,0]),h.call(this))}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/constraints/Snap"),s=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),i.call(this,a),f.call(this,a),b&&j.call(this,b),m.call(this,void 0)},c.prototype.getVelocity=function(){return l.call(this)},c.prototype.setVelocity=function(a){this.call(this,j(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return o.call(this),k.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,g.call(this),n.call(this,b),f.call(this,a),void m.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/constraints/Snap":59}],88:[function(a,b){function c(a){a=a||0,this.endState=new s(a),this.initState=new s,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.spring=new r({anchor:this.endState}),this.particle=new q,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(a){this.particle.setPosition(a)}function f(a){this.particle.setVelocity(a)}function g(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function h(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function i(a){this._callback=a}function j(){this.PE.wake()}function k(){this.PE.sleep()}function l(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else d.call(this)<this._absRestTolerance&&(e.call(this,this.endState),f.call(this,[0,0,0]),k.call(this))}function m(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),a.period<150&&(a.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),f.call(this,a.velocity)}function n(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function o(a){this.endState.set(a),n.call(this)}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Spring"),s=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),e.call(this,a),o.call(this,a),b&&f.call(this,b),i.call(this,void 0)},c.prototype.getVelocity=function(){return h.call(this)},c.prototype.setVelocity=function(a){this.call(this,f(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return l.call(this),g.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,j.call(this),m.call(this,b),o.call(this,a),void i.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/forces/Spring":69}],89:[function(a,b){function c(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function d(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],h=this.currentAction[1];h instanceof Object&&h.method?(b=h.method,"string"==typeof b&&(b=g[b])):b=f,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new e(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(h.velocity=this.velocity),this._engineInstance.set(c,h,d.bind(this))}var e=a("./MultipleTransition"),f=a("./TweenTransition"),g={};c.register=function(a){var b=!0;for(var d in a)c.registerMethod(d,a[d])||(b=!1);return b},c.registerMethod=function(a,b){return a in g?!1:(g[a]=b,!0)},c.unregisterMethod=function(a){return a in g?(delete g[a],!0):!1},c.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var e=[a,b];return this.actionQueue.push(e),this.callbackQueue.push(c),this.currentAction||d.call(this),this},c.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},c.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},c.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},c.prototype.isActive=function(){return!!this.currentAction},c.prototype.halt=function(){return this.set(this.get())},b.exports=c},{"./MultipleTransition":86,"./TweenTransition":91}],90:[function(a,b){function c(a){this._final=g.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new f(this._finalTranslate),this.rotate=new f(this._finalRotate),this.skew=new f(this._finalSkew),this.scale=new f(this._finalScale),a&&this.set(a)}function d(){return g.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function e(){return g.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var f=a("./Transitionable"),g=a("../core/Transform"),h=a("../utilities/Utility");c.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=e.call(this),this.translate.set(a,b,c),this},c.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=e.call(this),this.scale.set(a,b,c),this},c.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=e.call(this),this.rotate.set(a,b,c),this},c.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=e.call(this),this.skew.set(a,b,c),this},c.prototype.set=function(a,b,c){var d=g.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?h.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},c.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},c.prototype.get=function(){return this.isActive()?d.call(this):this._final},c.prototype.getFinal=function(){return this._final},c.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},c.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},b.exports=c},{"../core/Transform":15,"../utilities/Utility":96,"./Transitionable":89}],91:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function d(a,b,c){return(1-c)*a+c*b}function e(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function f(a,b){var d={curve:b.curve};return b.duration&&(d.duration=b.duration),b.speed&&(d.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(d.duration=a.duration),a.curve&&(d.curve=a.curve),a.speed&&(d.speed=a.speed)),"string"==typeof d.curve&&(d.curve=c.getCurve(d.curve)),d}function g(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function h(a,b,c){var e;if(a instanceof Array){e=[];for(var f=0;f<a.length;f++)e[f]="number"==typeof a[f]?d(a[f],b[f],c):a[f]}else e=d(a,b,c);return e}c.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},c.SUPPORTS_MULTIPLE=!0,c.DEFAULT_OPTIONS={curve:c.Curves.linear,duration:500,speed:0};var i={};c.registerCurve=function(a,b){return i[a]?!1:(i[a]=b,!0)},c.unregisterCurve=function(a){return i[a]?(delete i[a],!0):!1},c.getCurve=function(a){var b=i[a];if(void 0!==b)return b;throw new Error("curve not registered")},c.getCurves=function(){return i},c.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},c.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=e(this.get()),b=f(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var g=0;for(var h in d)g+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(g)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=e(a),this._startVelocity=e(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},c.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=e(a),this.velocity=e(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},c.prototype.getVelocity=function(){return this.velocity},c.prototype.get=function(a){return this.update(a),this.state},c.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=g(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=h(this._startValue,this._endValue,this._curve(c)),this.velocity=g(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},c.prototype.isActive=function(){return this._active},c.prototype.halt=function(){this.reset(this.get())},c.registerCurve("linear",c.Curves.linear),c.registerCurve("easeIn",c.Curves.easeIn),c.registerCurve("easeOut",c.Curves.easeOut),c.registerCurve("easeInOut",c.Curves.easeInOut),c.registerCurve("easeOutBounce",c.Curves.easeOutBounce),c.registerCurve("spring",c.Curves.spring),c.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},b.exports=c},{}],92:[function(a,b){function c(a){a=a||0,this.endState=new t(a),this.initState=new t,this.spring=new r({anchor:this.endState}),this.wall=new s,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.particle=new q,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function f(){this.PE.wake()}function g(){this.PE.sleep()}function h(a){this.endState.set(a);var b=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===b?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),e.call(this)}function i(a){this.particle.position.set(a)}function j(a){this.particle.velocity.set(a)}function k(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function m(a){this._callback=a}function n(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else{var b=d.call(this);b<this._absRestTolerance&&(g.call(this),i.call(this,this.endState),j.call(this,[0,0,0]))}}function o(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),void 0===a.restitution&&(a.restitution=b.restitution),void 0===a.drift&&(a.drift=s.DEFAULT_OPTIONS.drift),void 0===a.slop&&(a.slop=s.DEFAULT_OPTIONS.slop),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),this.wall.setOptions({restitution:a.restitution,drift:a.drift,slop:a.slop}),j.call(this,a.velocity)}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Spring"),s=a("../physics/constraints/Wall"),t=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),i.call(this,a),b&&j.call(this,b),h.call(this,a),m.call(this,void 0)},c.prototype.getVelocity=function(){return l.call(this)},c.prototype.setVelocity=function(a){this.call(this,j(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return n.call(this),k.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,f.call(this),o.call(this,b),h.call(this,a),void m.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/constraints/Wall":61,"../physics/forces/Spring":69}],93:[function(a,b){b.exports={CachedMap:a("./CachedMap"),Easing:a("./Easing"),MultipleTransition:a("./MultipleTransition"),SnapTransition:a("./SnapTransition"),SpringTransition:a("./SpringTransition"),Transitionable:a("./Transitionable"),TransitionableTransform:a("./TransitionableTransform"),TweenTransition:a("./TweenTransition"),WallTransition:a("./WallTransition")}},{"./CachedMap":84,"./Easing":85,"./MultipleTransition":86,"./SnapTransition":87,"./SpringTransition":88,"./Transitionable":89,"./TransitionableTransform":90,"./TweenTransition":91,"./WallTransition":92}],94:[function(a,b){var c={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};b.exports=c},{}],95:[function(a,b){function c(a){return j.on(k,a),a}function d(a,b){var d=l(),e=function(){var c=l();c-d>=b&&(a.apply(this,arguments),j.removeListener(k,e))};return c(e)}function e(a,b){var d=l(),e=function(){var c=l();c-d>=b&&(a.apply(this,arguments),d=l())};return c(e)}function f(a,b){if(void 0===b)return void 0;var d=function(){b--,0>=b&&(a.apply(this,arguments),h(d))};return c(d)}function g(a,b){b=b||1;var d=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=d)};return c(e)}function h(a){j.removeListener(k,a)}function i(a,b){var c,e,f,g,i;return function(){e=this,i=arguments,f=l();var j=function(){var h=l-f;b>h?c=d(j,b-h):(c=null,g=a.apply(e,i))};return h(c),c=d(j,b),g}}var j=a("../core/Engine"),k="prerender",l=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};b.exports={setTimeout:d,setInterval:e,debounce:i,after:f,every:g,clear:h}},{"../core/Engine":4}],96:[function(a,b){var c={};c.Direction={X:0,Y:1,Z:2},c.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},c.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},c.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},c.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var d in a)if("object"==typeof a[d]&&null!==a[d])if(a[d]instanceof Array){b[d]=new Array(a[d].length);for(var e=0;e<a[d].length;e++)b[d][e]=c.clone(a[d][e])}else b[d]=c.clone(a[d]);else b[d]=a[d]}else b=a;return b},b.exports=c},{}],97:[function(a,b){b.exports={KeyCodes:a("./KeyCodes"),Timer:a("./Timer"),Utility:a("./Utility")}},{"./KeyCodes":94,"./Timer":95,"./Utility":96}],98:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this._id=d.register(this)}var d=a("../core/Entity"),e=(a("../core/Transform"),a("../core/EventHandler")),f=a("../core/OptionsManager");c.DEFAULT_OPTIONS={},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},c.prototype.render=function(){return this._id},c.prototype.commit=function(){},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15}],99:[function(a,b){function c(){j.apply(this,arguments),this.state=new h(0),this._isOpen=!1,this.setOutputFunction(function(a,b,c){var e=d.call(this),g=this.options.direction===i.Direction.X?f.translate(e*b,0,.001*(e-1)*b):f.translate(0,e*b,.001*(e-1)*b),h=a.render();if(this.options.stackRotation){var j=this.options.stackRotation*c*(1-e);h={transform:f.rotateZ(j),origin:[.5,.5],target:h}}return{transform:g,size:a.getSize(),target:h}})}function d(a){return a?this._isOpen?1:0:this.state.get()}function e(a,b,c){this.state.halt(),this.state.set(a,b,c)}var f=a("../core/Transform"),g=a("../core/OptionsManager"),h=a("../transitions/Transitionable"),i=a("../utilities/Utility"),j=a("./SequentialLayout");c.prototype=Object.create(j.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=g.patch(j.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),c.prototype.getSize=function(){var a=j.prototype.getSize.apply(this,arguments),b=this._items?this._items.get().getSize():[0,0];b||(b=[0,0]);var c=d.call(this),e=1-c;return[b[0]*e+a[0]*c,b[1]*e+a[1]*c]},c.prototype.isOpen=function(){return this._isOpen},c.prototype.open=function(a){this._isOpen=!0,e.call(this,1,this.options.transition,a)},c.prototype.close=function(a){this._isOpen=!1,e.call(this,0,this.options.transition,a)},c.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},b.exports=c},{"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":89,"../utilities/Utility":96,"./SequentialLayout":111}],100:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._position=new l(0),this._direction=d(this.options.side),this._orientation=e(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new i,this.content=new i,this._eventInput=new m,this._eventOutput=new m,m.setInputHandler(this,this._eventInput),m.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",g.bind(this)),this._eventInput.on("end",h.bind(this))}function d(a){var b=c.SIDES;return a===b.LEFT||a===b.RIGHT?n:o}function e(a){var b=c.SIDES;return a===b.LEFT||a===b.TOP?1:-1}function f(a){var b,c=this.options;if(c.drawerLength)b=c.drawerLength;else{var d=a.getSize();b=d?d[this._direction]:c.drawerLength}return this._orientation*b}function g(a){var b,c,d=this.getPosition()+a.delta;this._cachedLength=f.call(this,this.drawer),1===this._orientation?(b=0,c=this._cachedLength):(b=this._cachedLength,c=0),d>c?d=c:b>d&&(d=b),this.setPosition(d)}function h(a){var b=a.velocity,c=this._orientation*this.getPosition(),d=this.options,e=this._orientation*this._cachedLength,f=d.positionThreshold||e/2,g=d.velocityThreshold;if(d.transition instanceof Object&&(d.transition.velocity=a.velocity),0===c)return void(this._isOpen=!1);if(c===e)return void(this._isOpen=!0);var h=Math.abs(b)>g||!this._isOpen&&c>f||this._isOpen&&f>c;h?this.toggle():this.reset()}var i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager"),l=a("../transitions/Transitionable"),m=a("../core/EventHandler"),n=0,o=1;c.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},c.DEFAULT_OPTIONS={side:c.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},c.prototype.setOptions=function(a){this._optionsManager.setOptions(a),void 0!==a.side&&(this._direction=d(a.side),this._orientation=e(a.side))},c.prototype.open=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this._cachedLength=f.call(this,this.drawer),this.setPosition(this._cachedLength,a,b),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},c.prototype.close=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this.setPosition(0,a,b),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},c.prototype.setPosition=function(a,b,c){this._position.isActive()&&this._position.halt(),this._position.set(a,b,c)},c.prototype.getPosition=function(){return this._position.get()},c.prototype.setProgress=function(a,b,c){return this._position.set(a*this._cachedLength,b,c)},c.prototype.getProgress=function(){return this._position.get()/this._cachedLength},c.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},c.prototype.reset=function(a){this._isOpen?this.open(a):this.close(a)},c.prototype.isOpen=function(){return this._isOpen},c.prototype.render=function(){var a=this.getPosition();(!this._isOpen&&0>a&&1===this._orientation||a>0&&-1===this._orientation)&&(a=0,this.setPosition(a));var b=this._direction===n?j.translate(a,0,0):j.translate(0,a,0);return[{transform:j.behind,target:this.drawer.render()},{transform:b,target:this.content.render()}]},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89}],101:[function(a,b){function c(a){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new i(a),this._controller.inTransformFrom(e.create(d.bind(this,1e-4))),this._controller.outTransformFrom(e.create(d.bind(this,-1e-4))),this._eventInput=new g,g.setInputHandler(this,this._eventInput),this._entityId=f.register(this),a&&this.setOptions(a)}function d(a,b){return h.translate(this._size[0]*(1-b),0,a*(1-b))}var e=a("../transitions/CachedMap"),f=a("../core/Entity"),g=a("../core/EventHandler"),h=a("../core/Transform"),i=a("./RenderController");c.prototype.show=function(a){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=a,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},c.prototype.setOptions=function(a){this._controller.setOptions(a)},c.prototype.render=function(){return this._entityId},c.prototype.commit=function(a){return this._size[0]=a.size[0],this._size[1]=a.size[1],{transform:a.transform,opacity:a.opacity,origin:a.origin,size:a.size,target:this._controller.render()}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Transform":15,"../transitions/CachedMap":84,"./RenderController":107}],102:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new h(this.options),a&&this.setOptions(a),this.id=f.register(this),this._ratios=new j(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new i,i.setOutputHandler(this,this._eventOutput)}function d(a,b,d){var e,f,h,i,j=0,k=b,l=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<a.length;i++)f=a[i],h=this._nodes[i],"number"!=typeof f?k-=h.getSize()[d]||0:l+=f;for(i=0;i<a.length;i++)h=this._nodes[i],f=a[i],b="number"==typeof f?k*f/l:h.getSize()[d],e=d===c.DIRECTION_X?g.translate(j,0,0):g.translate(0,j,0),this._cachedTransforms.push(e),this._cachedLengths.push(b),j+=b}function e(a,b){for(var c=0;c<a.length;c++)if("number"!=typeof a[c]&&this._nodes[c].getSize()[b]!==this._cachedLengths[c])return!0;return!1}var f=a("../core/Entity"),g=a("../core/Transform"),h=a("../core/OptionsManager"),i=a("../core/EventHandler"),j=a("../transitions/Transitionable");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DEFAULT_OPTIONS={direction:c.DIRECTION_X,transition:!1,ratios:[]},c.prototype.render=function(){return this.id},c.prototype.setOptions=function(a){this.optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(a){if(this._nodes=a,0===this._ratios.get().length){for(var b=[],c=0;c<this._nodes.length;c++)b.push(1);this.setRatios(b)}},c.prototype.setRatios=function(a,b,c){void 0===b&&(b=this.options.transition);var d=this._ratios;0===d.get().length&&(b=void 0),d.isActive()&&d.halt(),d.set(a,b,c),this._ratiosDirty=!0},c.prototype.getSize=function(){return this._size},c.prototype.commit=function(a){var b,c=a.size,f=a.transform,h=a.origin,i=a.opacity,j=this._ratios.get(),k=this.options.direction,l=c[k];(l!==this._size[k]||this._ratiosDirty||this._ratios.isActive()||k!==this._cachedDirection||e.call(this,j,k))&&(d.call(this,j,l,k),l!==this._size[k]&&(this._size[0]=c[0],this._size[1]=c[1]),k!==this._cachedDirection&&(this._cachedDirection=k),this._ratiosDirty&&(this._ratiosDirty=!1));for(var m=[],n=0;n<j.length;n++)b=[void 0,void 0],l=this._cachedLengths[n],b[k]=l,m.push({transform:this._cachedTransforms[n],size:b,target:this._nodes[n].render()});return c&&0!==h[0]&&0!==h[1]&&(f=g.moveThen([-c[0]*h[0],-c[1]*h[1],0],f)),{transform:f,size:c,opacity:i,target:m}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":89}],103:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this.angle=new e(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var d=a("../core/Transform"),e=a("../transitions/Transitionable"),f=(a("../core/RenderNode"),a("../core/OptionsManager"));c.DIRECTION_X=0,c.DIRECTION_Y=1;var g=1;c.DEFAULT_OPTIONS={transition:!0,direction:c.DIRECTION_X},c.prototype.flip=function(a,b){var c=this.flipped?0:Math.PI;this.setAngle(c,a,b),this.flipped=!this.flipped},c.prototype.setAngle=function(a,b,c){void 0===b&&(b=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(a,b,c)},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.setFront=function(a){this.frontNode=a},c.prototype.setBack=function(a){this.backNode=a},c.prototype.render=function(){var a,b,e=this.angle.get();this.options.direction===c.DIRECTION_X?(a=d.rotateY(e),b=d.rotateY(e+Math.PI)):(a=d.rotateX(e),b=d.rotateX(e+Math.PI));var f=[];return this.frontNode&&f.push({transform:a,target:this.frontNode.render()}),this.backNode&&f.push({transform:d.moveThen([0,0,g],b),target:this.backNode.render()}),f},b.exports=c},{"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89}],104:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new l(this.options),a&&this.setOptions(a),this.id=g.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new j,j.setOutputHandler(this,this._eventOutput)}function d(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var g,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){g=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?e.call(this,k,[i,h],[g,j,0],1):f.call(this,k,[i,h],[g,j,0],1),k++,g+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)f.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function e(a,b,c,d){var e={transform:new n(h.translate.apply(null,c)),opacity:new m(d),size:new m(b)},f=new k({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function f(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var g=a("../core/Entity"),h=(a("../core/RenderNode"),a("../core/Transform")),i=a("../core/ViewSequence"),j=a("../core/EventHandler"),k=a("../core/Modifier"),l=a("../core/OptionsManager"),m=a("../transitions/Transitionable"),n=a("../transitions/TransitionableTransform");c.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},c.prototype.render=function(){return this.id},c.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new i(a)),this.sequence=a},c.prototype.getSize=function(){return this._contextSizeCache},c.prototype.commit=function(a){var b=a.transform,c=a.opacity,e=a.origin,f=a.size,g=this.options.dimensions[0],i=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||i!==this._dimensionsCache[1])&&d.call(this,f,g,i);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:e,target:m.render()})),j=j.getNext(),l++}return f&&(b=h.moveThen([-f[0]*e[0],-f[1]*e[1],0],b)),{transform:b,opacity:c,size:f,target:k}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../core/ViewSequence":17,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90}],105:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._entityId=g.register(this),this.header=new h,this.footer=new h,this.content=new h}function d(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function e(a){return this.options.direction===c.DIRECTION_X?i.translate(a,0,0):i.translate(0,a,0)}function f(a,b){return this.options.direction===c.DIRECTION_X?[a,b[1]]:[b[0],a]}var g=a("../core/Entity"),h=a("../core/RenderNode"),i=a("../core/Transform"),j=a("../core/OptionsManager");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DEFAULT_OPTIONS={direction:c.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},c.prototype.render=function(){return this._entityId
},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.commit=function(a){var b=a.transform,c=a.origin,g=a.size,h=a.opacity,j=void 0!==this.options.headerSize?this.options.headerSize:d.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:d.call(this,this.footer,this.options.defaultFooterSize),l=g[this.options.direction]-j-k;g&&(b=i.moveThen([-g[0]*c[0],-g[1]*c[1],0],b));var m=[{size:f.call(this,j,g),target:this.header.render()},{transform:e.call(this,j),size:f.call(this,l,g),target:this.content.render()},{transform:e.call(this,j+l),size:f.call(this,k,g),target:this.footer.render()}];return{transform:b,opacity:h,size:g,target:m}},b.exports=c},{"../core/Entity":5,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15}],106:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var d=a("../core/Transform"),e=a("../core/Modifier"),f=a("../core/RenderNode"),g=a("../utilities/Utility"),h=a("../core/OptionsManager"),i=a("../transitions/Transitionable"),j=a("../transitions/TransitionableTransform");c.DEFAULT_OPTIONS={inTransform:d.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:d.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:d.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,a,b,c));this.hide()}this._showing=!0;var d={transform:new j(this.options.inTransform),origin:new i(this.options.inOrigin),align:new i(this.options.inAlign),opacity:new i(this.options.inOpacity)},h=new e({transform:d.transform,opacity:d.opacity,origin:d.origin,align:d.align}),k=new f;k.add(h).add(a),this.nodes.push(k),this.states.push(d),this.transforms.push(h);var l=c?g.after(3,c):void 0;b||(b=this.options.inTransition),d.transform.set(this.options.showTransform,b,l),d.opacity.set(this.options.showOpacity,b,l),d.origin.set(this.options.showOrigin,b,l),d.align.set(this.options.showAlign,b,l)},c.prototype.hide=function(a,b){if(this._showing){this._showing=!1,a instanceof Function&&(b=a,a=void 0);var c=this.nodes[this.nodes.length-1],d=this.transforms[this.transforms.length-1],e=this.states[this.states.length-1],f=g.after(3,function(){this.nodes.splice(this.nodes.indexOf(c),1),this.states.splice(this.states.indexOf(e),1),this.transforms.splice(this.transforms.indexOf(d),1),b&&b.call(this)}.bind(this));a||(a=this.options.outTransition),e.transform.set(this.options.outTransform,a,f),e.opacity.set(this.options.outOpacity,a,f),e.origin.set(this.options.outOrigin,a,f),e.align.set(this.options.outAlign,a,f)}},c.prototype.render=function(){for(var a=[],b=0;b<this.nodes.length;b++)a.push(this.nodes[b].render());return a},b.exports=c},{"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90,"../utilities/Utility":96}],107:[function(a,b){function c(){i.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=c.DefaultMap.transform,this.inOpacityMap=c.DefaultMap.opacity,this.inOriginMap=c.DefaultMap.origin,this.inAlignMap=c.DefaultMap.align,this.outTransformMap=c.DefaultMap.transform,this.outOpacityMap=c.DefaultMap.opacity,this.outOriginMap=c.DefaultMap.origin,this.outAlignMap=c.DefaultMap.align,this._output=[]}function d(a,b){return a(b.get())}var e=a("../core/Modifier"),f=a("../core/RenderNode"),g=a("../core/Transform"),h=a("../transitions/Transitionable"),i=a("../core/View");c.prototype=Object.create(i.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},c.DefaultMap={transform:function(){return g.identity},opacity:function(a){return a},origin:null,align:null},c.prototype.inTransformFrom=function(a){if(a instanceof Function)this.inTransformMap=a;else{if(!a||!a.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=a.get.bind(a)}return this},c.prototype.inOpacityFrom=function(a){if(a instanceof Function)this.inOpacityMap=a;else{if(!a||!a.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=a.get.bind(a)}return this},c.prototype.inOriginFrom=function(a){if(a instanceof Function)this.inOriginMap=a;else{if(!a||!a.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=a.get.bind(a)}return this},c.prototype.inAlignFrom=function(a){if(a instanceof Function)this.inAlignMap=a;else{if(!a||!a.get)throw new Error("inAlignFrom takes only function or getter object");this.inAlignMap=a.get.bind(a)}return this},c.prototype.outTransformFrom=function(a){if(a instanceof Function)this.outTransformMap=a;else{if(!a||!a.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=a.get.bind(a)}return this},c.prototype.outOpacityFrom=function(a){if(a instanceof Function)this.outOpacityMap=a;else{if(!a||!a.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=a.get.bind(a)}return this},c.prototype.outOriginFrom=function(a){if(a instanceof Function)this.outOriginMap=a;else{if(!a||!a.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=a.get.bind(a)}return this},c.prototype.outAlignFrom=function(a){if(a instanceof Function)this.outAlignMap=a;else{if(!a||!a.get)throw new Error("outAlignFrom takes only function or getter object");this.outAlignMap=a.get.bind(a)}return this},c.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=a:(this._nextRenderable=a,this.hide(function(){this._nextRenderable===a&&this.show(this._nextRenderable,c),this._nextRenderable=null})));this.hide()}var g=null,i=this._renderables.indexOf(a);if(i>=0){this._showing=i,g=this._states[i],g.halt();var j=this._outgoingRenderables.indexOf(a);j>=0&&this._outgoingRenderables.splice(j,1)}else{g=new h(0);var k=new e({transform:this.inTransformMap?d.bind(this,this.inTransformMap,g):null,opacity:this.inOpacityMap?d.bind(this,this.inOpacityMap,g):null,origin:this.inOriginMap?d.bind(this,this.inOriginMap,g):null,align:this.inAlignMap?d.bind(this,this.inAlignMap,g):null}),l=new f;l.add(k).add(a),this._showing=this._nodes.length,this._nodes.push(l),this._modifiers.push(k),this._states.push(g),this._renderables.push(a)}b||(b=this.options.inTransition),g.set(1,b,c)},c.prototype.hide=function(a,b){if(!(this._showing<0)){var c=this._showing;this._showing=-1,a instanceof Function&&(b=a,a=void 0);var e=this._nodes[c],f=this._modifiers[c],g=this._states[c],h=this._renderables[c];f.transformFrom(this.outTransformMap?d.bind(this,this.outTransformMap,g):null),f.opacityFrom(this.outOpacityMap?d.bind(this,this.outOpacityMap,g):null),f.originFrom(this.outOriginMap?d.bind(this,this.outOriginMap,g):null),f.alignFrom(this.outAlignMap?d.bind(this,this.outAlignMap,g):null),this._outgoingRenderables.indexOf(h)<0&&this._outgoingRenderables.push(h),a||(a=this.options.outTransition),g.halt(),g.set(0,a,function(a,c,d,e){if(this._outgoingRenderables.indexOf(e)>=0){var f=this._nodes.indexOf(a);this._nodes.splice(f,1),this._modifiers.splice(f,1),this._states.splice(f,1),this._renderables.splice(f,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(e),1),this._showing>=f&&this._showing--}b&&b.call(this)}.bind(this,e,f,g,h))}},c.prototype.render=function(){var a=this._output;a.length>this._nodes.length&&a.splice(this._nodes.length);for(var b=0;b<this._nodes.length;b++)a[b]=this._nodes[b].render();return a},b.exports=c},{"../core/Modifier":9,"../core/RenderNode":11,"../core/Transform":15,"../core/View":16,"../transitions/Transitionable":89}],108:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this.container=new d(this.options.container),this.scrollview=new f(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new e,e.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var d=a("../surfaces/ContainerSurface"),e=a("../core/EventHandler"),f=a("./Scrollview"),g=(a("../utilities/Utility"),a("../core/OptionsManager"));c.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},c.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},c.prototype.render=function(){return this.container.render()},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../surfaces/ContainerSurface":76,"../utilities/Utility":96,"./Scrollview":110}],109:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new i,this.group.add({render:g.bind(this)}),this._entityId=h.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput)}function d(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function e(a,b,c){var e=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),d.call(this,e)}function f(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?d.call(this,this.getCumulativeSize()):d.call(this,this._contextSize)}function g(){for(var a=null,b=this._position,c=[],g=-this._positionOffset,h=f.call(this),i=this._node;i&&g-b<h+this.options.margin;)g+=e.call(this,i,g,c),i=i.getNext?i.getNext():null;var j=this._node,k=d.call(this,j.getSize());if(h>g){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=d.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=d.call(this,j.getSize()))}for(!i&&h-o>g-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:g-h})):!this._node.getPrevious()&&-o>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,g=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,g-=d.call(this,a));i&&g-b>-(h+this.options.margin);)e.call(this,i,g,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,g-=d.call(this,a));return c}var h=a("../core/Entity"),i=a("../core/Group"),j=a("../core/OptionsManager"),k=a("../core/Transform"),l=a("../utilities/Utility"),m=a("../core/ViewSequence"),n=a("../core/EventHandler");c.DEFAULT_OPTIONS={direction:l.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var o=0;c.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},c.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},c.prototype.onEdge=function(){return this._onEdge},c.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===l.Direction.X?k.translate(a,0):k.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return k.inverse(a(-b))}},c.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},c.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new m({array:a})),this._node=a,this._positionOffset=0},c.prototype.getSize=function(a){return a?this._contextSize:this._size},c.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},c.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===l.Direction.X?(this._size[0]=f.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=f.call(this)));var g=this._masterOutputFunction(-this._position);return{transform:k.multiply(b,g),size:e,opacity:c,origin:d,target:this.group.render()}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Group":8,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":96}],110:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),this._scroller=new w(this.options),this.sync=new y(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==x.Direction.Y}),this._physicsEngine=new p,this._particle=new q,this._physicsEngine.addBody(this._particle),this.spring=new s({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new r({forceFunction:r.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new r({forceFunction:r.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=B.NONE,this._onEdge=C.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new t,this._eventOutput=new t,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),t.setInputHandler(this,this._eventInput),t.setOutputHandler(this,this._eventOutput),g.call(this),a&&this.setOptions(a)}function d(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),i.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function e(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==C.NONE&&a.slip&&(0>b&&this._onEdge===C.TOP||b>0&&this._onEdge===C.BOTTOM?this._earlyEnd||(f.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&d.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var e=this.options.speedLimit;-e>b?b=-e:b>e&&(b=e),this.setVelocity(b);var g=16*e;c>g?c=g:-g>c&&(c=-g)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===B.NONE&&n.call(this)}}function f(a){if(this._touchCount=a.count||0,!this._touchCount){i.call(this),this._onEdge!==C.NONE&&m.call(this,this._edgeSpringPosition,B.EDGE),h.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function g(){this._eventInput.bindThis(this),this._eventInput.on("start",d),this._eventInput.on("update",e),this._eventInput.on("end",f),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,k.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===B.NONE&&n.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==B.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function h(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function i(){this._springState=B.NONE,this._physicsEngine.detachAll()}function j(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function k(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===B.EDGE||m.call(this,this._edgeSpringPosition,B.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(i.call(this),h.call(this))}function l(){if(!this._touchCount&&this._springState!==B.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=j.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():m.call(this,0,B.PAGE)}}}function m(a,b){var c;b===B.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===B.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(i.call(this),this._springState=b,h.call(this)),this._springState=b}function n(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=j.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=j.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=j.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&o.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function o(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===B.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===B.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Drag"),s=a("../physics/forces/Spring"),t=a("../core/EventHandler"),u=a("../core/OptionsManager"),v=a("../core/ViewSequence"),w=a("../views/Scroller"),x=a("../utilities/Utility"),y=a("../inputs/GenericSync"),z=a("../inputs/ScrollSync"),A=a("../inputs/TouchSync");y.register({scroll:z,touch:A});var B={NONE:0,EDGE:1,PAGE:2},C={TOP:-1,NONE:0,BOTTOM:1};c.DEFAULT_OPTIONS={direction:x.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},c.prototype.getCurrentIndex=function(){return this._node.index},c.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===C.TOP)return null;if(this.getPosition()>1&&this._springState===B.NONE)return m.call(this,0,B.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=j.call(this,a);this._scroller.sequenceFrom(a),this._node=a,o.call(this,b),m.call(this,0,B.PAGE)}return a},c.prototype.goToNextPage=function(){if(!this._node||this._onEdge===C.BOTTOM)return null;var a=this._node.getNext();if(a){var b=j.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,o.call(this,-b),m.call(this,0,B.PAGE)}return a},c.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},c.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},c.prototype.getPosition=function(){return this._particle.getPosition1D()},c.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},c.prototype.getOffset=c.prototype.getPosition,c.prototype.setPosition=function(a){this._particle.setPosition1D(a)},c.prototype.setOffset=c.prototype.setPosition,c.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},c.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},c.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=x.Direction.X:"y"===a.direction&&(a.direction=x.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===x.Direction.X?y.DIRECTION_X:y.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},c.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new v({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},c.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},c.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&l.call(this),this._scroller.render()},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/ViewSequence":17,"../inputs/GenericSync":27,"../inputs/ScrollSync":32,"../inputs/TouchSync":34,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/forces/Drag":64,"../physics/forces/Spring":69,"../utilities/Utility":96,"../views/Scroller":109}],111:[function(a,b){function c(a){this._items=null,this._size=null,this._outputFunction=c.DEFAULT_OUTPUT_FUNCTION,this.options=h.clone(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this.optionsManager=new d(this.options),this.id=e.register(this),this.cachedSize=[void 0,void 0],a&&this.setOptions(a)}var d=a("../core/OptionsManager"),e=a("../core/Entity"),f=a("../core/Transform"),g=a("../core/ViewSequence"),h=a("../utilities/Utility");c.DEFAULT_OPTIONS={direction:h.Direction.Y,itemSpacing:0},c.DEFAULT_OUTPUT_FUNCTION=function(a,b){var c=this.options.direction===h.Direction.X?f.translate(b,0):f.translate(0,b);return{size:this.cachedSize,transform:c,target:a.render()}},c.prototype.getSize=function(){return this._size||this.render(),this._size},c.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new g(a)),this._items=a,this},c.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},c.prototype.setOutputFunction=function(a){return this._outputFunction=a,this},c.prototype.render=function(){return this.id},c.prototype.commit=function(a){var b=0,c=1^this.options.direction,d=this._items,e=null,f=[],g={},h=[],i=0;for(this._size=[0,0],this.cachedSize=a.size;d&&(e=d.get());)e.getSize&&(f=e.getSize()),g=this._outputFunction.call(this,e,b,i++),h.push(g),f&&(f[this.options.direction]&&(b+=f[this.options.direction]),f[c]>this._size[c]&&(this._size[c]=f[c]),0===f[c]&&(this._size[c]=void 0)),d=d.getNext(),this.options.itemSpacing&&d&&(b+=this.options.itemSpacing);return this._size[this.options.direction]=b,{transform:a.transform,origin:a.origin,size:this.getSize(),target:h}},b.exports=c},{"../core/Entity":5,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":96}],112:[function(a,b){b.exports={ContextualView:a("./ContextualView"),Deck:a("./Deck"),DrawerLayout:a("./DrawerLayout"),EdgeSwapper:a("./EdgeSwapper"),FlexibleLayout:a("./FlexibleLayout"),Flipper:a("./Flipper"),GridLayout:a("./GridLayout"),HeaderFooterLayout:a("./HeaderFooterLayout"),Lightbox:a("./Lightbox"),RenderController:a("./RenderController"),ScrollContainer:a("./ScrollContainer"),Scroller:a("./Scroller"),Scrollview:a("./Scrollview"),SequentialLayout:a("./SequentialLayout")}},{"./ContextualView":98,"./Deck":99,"./DrawerLayout":100,"./EdgeSwapper":101,"./FlexibleLayout":102,"./Flipper":103,"./GridLayout":104,"./HeaderFooterLayout":105,"./Lightbox":106,"./RenderController":107,"./ScrollContainer":108,"./Scroller":109,"./Scrollview":110,"./SequentialLayout":111}],113:[function(a,b){function c(){g.apply(this,arguments),this.title=new e({classes:this.options.classes,content:this.options.content}),this.back=new e({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new e({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new d({id:"master",size:this.options.size,target:[{transform:f.inFront,origin:[0,.5],align:[0,.5],target:this.back},{origin:[.5,.5],align:[.5,.5],target:this.title},{transform:f.inFront,origin:[1,.5],align:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(a){var b=a.id,c=a.value;"size"===b?(this.layout.id.master.setSize(c),this.title.setSize(c),this.back.setSize([c[1],c[1]]),this.more.setSize([c[1],c[1]])):"backClasses"===b?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===b?this.back.setContent(this.options.backContent):"classes"===b?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===b?this.setContent(this.options.content):"moreClasses"===b?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===b&&this.more.setContent(this.options.content)}.bind(this))}var d=a("../core/Scene"),e=a("../core/Surface"),f=a("../core/Transform"),g=a("../core/View");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},c.prototype.setContent=function(a){return this.title.setContent(a)},b.exports=c},{"../core/Scene":12,"../core/Surface":14,"../core/Transform":15,"../core/View":16}],114:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new j(this.options),a&&this.setOptions(a),this.indicator=new f({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new e({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new h,this.eventInput=new h,h.setInputHandler(this,this.eventInput),h.setOutputHandler(this,this.eventOutput);var b=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new m(["mouse","touch"],{scale:b,direction:m.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(a){this.set(a.position)}.bind(this)),this._drawPos=0,d.call(this)}function d(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var e=a("../core/Surface"),f=a("../surfaces/CanvasSurface"),g=a("../core/Transform"),h=a("../core/EventHandler"),i=a("../math/Utilities"),j=a("../core/OptionsManager"),k=a("../inputs/MouseSync"),l=a("../inputs/TouchSync"),m=a("../inputs/GenericSync");m.register({mouse:k,touch:l}),c.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},c.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},c.prototype.get=function(){return this.options.value},c.prototype.set=function(a){a!==this.options.value&&(this.options.value=i.clamp(a,this.options.range),d.call(this),this.eventOutput.emit("change",{value:a}))},c.prototype.getSize=function(){return this.options.size},c.prototype.render=function(){var a=this.options.range,b=Math.floor((this.get()-a[0])/(a[1]-a[0])*this.options.indicatorSize[0]);if(b<this._drawPos)this.indicator.getContext("2d").clearRect(b,0,this._drawPos-b+1,this.options.indicatorSize[1]);else if(b>this._drawPos){var c=this.indicator.getContext("2d");c.fillStyle=this.options.fillColor,c.fillRect(this._drawPos-1,0,b-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=b,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:g.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Surface":14,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":34,"../math/Utilities":41,"../surfaces/CanvasSurface":75}],115:[function(a,b){function c(){g.apply(this,arguments),this.layout=new h,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",d.bind(this))}function d(a){var b=a.id,c=a.value;if("direction"===b)this.layout.setOptions({dimensions:e.call(this.buttons.length,this.options.direction)});else if("buttons"===b)for(var d in this.buttons)this.buttons[d].setOptions(c);else if("sections"===b)for(var f in this.options.sections)this.defineSection(f,this.options.sections[f])}function e(a,b){return b===f.Direction.X?[a,1]:[1,a]}var f=a("../utilities/Utility"),g=a("../core/View"),h=a("../views/GridLayout"),i=a("./ToggleButton");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={sections:[],widget:i,size:[void 0,50],direction:f.Direction.X,buttons:{toggleMode:i.ON}},c.prototype.defineSection=function(a,b){var c,d=this._buttonIds[a];if(void 0===d){d=this.buttons.length,this._buttonIds[a]=d;var f=this.options.widget;c=new f,this.buttons[d]=c,this.layout.setOptions({dimensions:e(this.buttons.length,this.options.direction)})}else c=this.buttons[d],c.unbind("select",this._buttonCallbacks[a]);this.options.buttons&&c.setOptions(this.options.buttons),c.setOptions(b),this._buttonCallbacks[a]=this.select.bind(this,a),c.on("select",this._buttonCallbacks[a])},c.prototype.select=function(a){var b=this._buttonIds[a];this.buttons[b]&&this.buttons[b].isSelected()?this._eventOutput.emit("select",{id:a}):this.buttons[b]&&this.buttons[b].select();
for(var c=0;c<this.buttons.length;c++)c!==b&&this.buttons[c].deselect()},b.exports=c},{"../core/View":16,"../utilities/Utility":96,"../views/GridLayout":104,"./ToggleButton":116}],116:[function(a,b){function c(a){this.options={content:["",""],offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:c.TOGGLE,crossfade:!0},this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput),this.offSurface=new d,this.offSurface.on("click",function(){this.options.toggleMode!==c.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new d,this.onSurface.on("click",function(){this.options.toggleMode!==c.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new f({overlap:this.options.crossfade}),this.deselect(),a&&this.setOptions(a)}var d=a("../core/Surface"),e=a("../core/EventHandler"),f=a("../views/RenderController");c.OFF=0,c.ON=1,c.TOGGLE=2,c.prototype.select=function(a){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),a||this._eventOutput.emit("select")},c.prototype.deselect=function(a){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),a||this._eventOutput.emit("deselect")},c.prototype.isSelected=function(){return this.selected},c.prototype.setOptions=function(a){void 0!==a.content&&(a.content instanceof Array||(a.content=[a.content,a.content]),this.options.content=a.content,this.offSurface.setContent(this.options.content[0]),this.onSurface.setContent(this.options.content[1])),a.offClasses&&(this.options.offClasses=a.offClasses,this.offSurface.setClasses(this.options.offClasses)),a.onClasses&&(this.options.onClasses=a.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==a.size&&(this.options.size=a.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==a.toggleMode&&(this.options.toggleMode=a.toggleMode),void 0!==a.outTransition&&(this.options.outTransition=a.outTransition),void 0!==a.inTransition&&(this.options.inTransition=a.inTransition),void 0!==a.crossfade&&(this.options.crossfade=a.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},c.prototype.getSize=function(){return this.options.size},c.prototype.render=function(){return this.arbiter.render()},b.exports=c},{"../core/EventHandler":7,"../core/Surface":14,"../views/RenderController":107}],117:[function(a,b){b.exports={NavigationBar:a("./NavigationBar"),Slider:a("./Slider"),TabBar:a("./TabBar"),ToggleButton:a("./ToggleButton")}},{"./NavigationBar":113,"./Slider":114,"./TabBar":115,"./ToggleButton":116}]},{},[23])(23)}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.famous=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){return[a.clientWidth,a.clientHeight]}function d(a){this.container=a,this._allocator=new g(a),this._node=new e,this._eventOutput=new f,this._size=c(this.container),this._perspectiveState=new i(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:h.identity,opacity:1,origin:j,align:j,size:this._size},this._eventOutput.on("resize",function(){this.setSize(c(this.container))}.bind(this))}var e=a("./RenderNode"),f=a("./EventHandler"),g=a("./ElementAllocator"),h=a("./Transform"),i=a("../transitions/Transitionable"),j=[0,0],k=!("perspective"in document.documentElement.style),l=k?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};d.prototype.getAllocator=function(){return this._allocator},d.prototype.add=function(a){return this._node.add(a)},d.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},d.prototype.getSize=function(){return this._size},d.prototype.setSize=function(a){a||(a=c(this.container)),this._size[0]=a[0],this._size[1]=a[1]},d.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(l(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},d.prototype.getPerspective=function(){return this._perspectiveState.get()},d.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},d.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},d.prototype.on=function(a,b){return this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},b.exports=d},{"../transitions/Transitionable":89,"./ElementAllocator":2,"./EventHandler":7,"./RenderNode":11,"./Transform":15}],2:[function(a,b){function c(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}c.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},c.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},c.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},c.prototype.getNodeCount=function(){return this.nodeCount},b.exports=c},{}],3:[function(a,b){function c(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new j,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=i.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function d(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function e(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function f(a){a[12]=Math.round(a[12]*m)/m,a[13]=Math.round(a[13]*m)/m;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function g(a){return 100*a[0]+"% "+100*a[1]+"%"}function h(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var i=a("./Entity"),j=a("./EventHandler"),k=a("./Transform"),l=!("transform"in document.documentElement.style),m=window.devicePixelRatio||1;c.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},c.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},c.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},c.prototype.pipe=function(a){return this._eventOutput.pipe(a)},c.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.prototype.render=function(){return this.id};var n;n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=f(b)}:l?function(a,b){a.style.webkitTransform=f(b)}:function(a,b){a.style.transform=f(b)};var o=l?function(a,b){a.style.webkitTransformOrigin=g(b)}:function(a,b){a.style.transformOrigin=g(b)},p=l?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};c.prototype.commit=function(a){var b=this._element;if(b){var c=a.transform,d=a.opacity,e=a.origin;if(a.size,!c&&this._matrix)return this._matrix=null,this._opacity=0,void p(b);if(h(this._origin,e)&&(this._originDirty=!0),k.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,o(b,this._origin),this._originDirty=!1),c||(c=k.identity),this._matrix=c;var f=this._size?k.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;n(b,f),this._transformDirty=!1}}},c.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},c.prototype.attach=function(a){this._element=a,d.call(this,a)},c.prototype.detach=function(){var a=this._element;return a&&(e.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},b.exports=c},{"./Entity":5,"./EventHandler":7,"./Transform":15}],4:[function(a,b){function c(){x.runLoop?(n.step(),window.requestAnimationFrame(c)):u=!1}function d(){for(var a=0;a<o.length;a++)o[a].emit("resize");w.emit("resize")}function e(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),f()}function f(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void n.nextTick(f)}function g(a,b){return document.body?void document.body.addEventListener(a,b):void n.nextTick(addEventListener.bind(this,a,b))}function h(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void n.nextTick(h.bind(this,a,b))}var i,j,k=a("./Context"),l=a("./EventHandler"),m=a("./OptionsManager"),n={},o=[],p=[],q=0,r=0,s=[],t=Date.now(),u=!0,v={},w=new l,x={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},y=new m(x),z=10;n.step=function(){q++,r=q;var a=Date.now();if(!(j&&j>a-t)){var b=0;i=a-t,t=a,w.emit("prerender");for(var c=p.length;c--;)p.shift()(q);for(;s.length&&Date.now()-a<z;)s.shift().call(this);for(b=0;b<o.length;b++)o[b].update();w.emit("postrender")}},window.requestAnimationFrame(c),window.addEventListener("resize",d,!1),d();var A=!1;n.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(n):w.pipe(a)},n.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(n):w.unpipe(a)},n.on=function(a,b){return a in v||(v[a]=w.emit.bind(w,a),g(a,v[a])),w.on(a,b)},n.emit=function(a,b){return w.emit(a,b)},n.removeListener=function(a,b){return w.removeListener(a,b)},n.getFPS=function(){return 1e3/i},n.setFPSCap=function(a){j=Math.floor(1e3/a)},n.getOptions=function(a){return y.getOptions(a)},n.setOptions=function(){return y.setOptions.apply(y,arguments)},n.createContext=function(a){!A&&x.appMode&&n.nextTick(e);var b=!1;a||(a=document.createElement(x.containerType),a.classList.add(x.containerClass),b=!0);var c=new k(a);return n.registerContext(c),b&&h(c,a),c},n.registerContext=function(a){return o.push(a),a},n.getContexts=function(){return o},n.deregisterContext=function(a){var b=o.indexOf(a);b>=0&&o.splice(b,1)},n.nextTick=function(a){p.push(a)},n.defer=function(a){s.push(a)},y.on("change",function(a){"fpsCap"===a.id?n.setFPSCap(a.value):"runLoop"===a.id&&!u&&a.value&&(u=!0,window.requestAnimationFrame(c))}),b.exports=n},{"./Context":1,"./EventHandler":7,"./OptionsManager":10}],5:[function(a,b){function c(a){return g[a]}function d(a,b){g[a]=b}function e(a){var b=g.length;return d(b,a),b}function f(a){d(a,null)}var g=[];b.exports={register:e,unregister:f,get:c,set:d}},{}],6:[function(a,b){function c(){this.listeners={},this._owner=this}c.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},c.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},c.prototype.addListener=c.prototype.on,c.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},c.prototype.bindThis=function(a){this._owner=a},b.exports=c},{}],7:[function(a,b){function c(){d.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var d=a("./EventEmitter");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},c.setOutputHandler=function(a,b){b instanceof c&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},c.prototype.emit=function(a,b){d.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},c.prototype.trigger=c.prototype.emit,c.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},c.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},c.prototype.on=function(a){if(d.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},c.prototype.addListener=c.prototype.on,c.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},c.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},b.exports=c},{"./EventEmitter":6}],8:[function(a,b){function c(a){f.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new d(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var d=a("./Context"),e=a("./Transform"),f=a("./Surface");c.SIZE_ZERO=[0,0],c.prototype=Object.create(f.prototype),c.prototype.elementType="div",c.prototype.elementClass="famous-group",c.prototype.add=function(){return this.context.add.apply(this.context,arguments)},c.prototype.render=function(){return f.prototype.render.call(this)},c.prototype.deploy=function(a){this.context.migrate(a)},c.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},c.prototype.commit=function(a){var b=a.transform,d=a.origin,g=a.opacity,h=a.size,i=f.prototype.commit.call(this,{allocator:a.allocator,transform:e.thenMove(b,[-d[0]*h[0],-d[1]*h[1],0]),opacity:g,origin:d,size:c.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:e.translate(-d[0]*h[0],-d[1]*h[1],0),origin:d,size:h}),i},b.exports=c},{"./Context":1,"./Surface":14,"./Transform":15}],9:[function(a,b){function c(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:e.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function d(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var e=a("./Transform"),f=a("../transitions/Transitionable"),g=a("../transitions/TransitionableTransform");c.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},c.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},c.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},c.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},c.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},c.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},c.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new g(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},c.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new f(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},c.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new f(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},c.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new f(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},c.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new f(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},c.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new f(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},c.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},c.prototype.getTransform=function(){return this._transformGetter()},c.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},c.prototype.getOpacity=function(){return this._opacityGetter()},c.prototype.getOrigin=function(){return this._originGetter()},c.prototype.getAlign=function(){return this._alignGetter()},c.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},c.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},c.prototype.modify=function(a){return d.call(this),this._output.target=a,this._output},b.exports=c},{"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90,"./Transform":15}],10:[function(a,b){function c(a){this._value=a,this.eventOutput=null}function d(){this.eventOutput=new e,this.eventOutput.bindThis(this),e.setOutputHandler(this,this.eventOutput)}var e=a("./EventHandler");c.patch=function(a){for(var b=new c(a),d=1;d<arguments.length;d++)b.patch(arguments[d]);return a},c.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},c.prototype.setOptions=c.prototype.patch,c.prototype.key=function(a){var b=new c(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},c.prototype.get=function(a){return a?this._value[a]:this._value},c.prototype.getOptions=c.prototype.get,c.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},c.prototype.on=function(){return d.call(this),this.on.apply(this,arguments)},c.prototype.removeListener=function(){return d.call(this),this.removeListener.apply(this,arguments)},c.prototype.pipe=function(){return d.call(this),this.pipe.apply(this,arguments)},c.prototype.unpipe=function(){return d.call(this),this.unpipe.apply(this,arguments)},b.exports=c},{"./EventHandler":7}],11:[function(a,b){function c(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function d(a,b,c){for(var g=f.parse(a,b),h=Object.keys(g),i=0;i<h.length;i++){var j=h[i],k=e.get(j),l=g[j];l.allocator=b.allocator;var m=k.commit(l);m?d(m,b,c):c[j]=l}}var e=a("./Entity"),f=a("./SpecParser");c.prototype.add=function(a){var b=a instanceof c?a:new c(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},c.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},c.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof c?a:this},c.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},c.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var f=b[c];if(void 0===this._resultCache[f]){var g=e.get(f);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},d(this.render(),a,this._resultCache)},c.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},b.exports=c},{"./Entity":5,"./SpecParser":13}],12:[function(a,b){function c(a){this.id=null,this._objects=null,this.node=new j,this._definition=null,a&&this.load(a)}function d(a){for(var b in k)if(b in a){var c=a[b];return c instanceof Array||(c=[c]),k[b].apply(this,c)}}function e(a){var b=a.transform,c=a.opacity,e=a.origin,f=a.align,g=a.size,j=h.identity;if(b instanceof Array)if(16===b.length&&"number"==typeof b[0])j=b;else for(var k=0;k<b.length;k++)j=h.multiply(j,d(b[k]));else b instanceof Function?j=b:b instanceof Object&&(j=d(b));var l=new i({transform:j,opacity:c,origin:e,align:f,size:g});return l}function f(a){for(var b=new j,c=0;c<a.length;c++){var d=g.call(this,a[c]);d&&b.add(d)}return b}function g(a){var b,c;if(a instanceof Array)b=f.call(this,a);else if(c=this._objects.length,a.render&&a.render instanceof Function)b=a;else if(a.target){var d=g.call(this,a.target),h=e.call(this,a);b=new j(h),b.add(d),a.id&&(this.id[a.id]=h)}else a.id&&(b=new j,this.id[a.id]=b);return this._objects[c]=b,b}var h=a("./Transform"),i=a("./Modifier"),j=a("./RenderNode"),k={translate:h.translate,rotate:h.rotate,rotateX:h.rotateX,rotateY:h.rotateY,rotateZ:h.rotateZ,rotateAxis:h.rotateAxis,scale:h.scale,skew:h.skew,matrix3d:function(){return arguments}};c.prototype.create=function(){return new c(this._definition)},c.prototype.load=function(a){this._definition=a,this.id={},this._objects=[],this.node.set(g.call(this,a))},c.prototype.add=function(){return this.node.add.apply(this.node,arguments)},c.prototype.render=function(){return this.node.render.apply(this.node,arguments)},b.exports=c},{"./Modifier":9,"./RenderNode":11,"./Transform":15}],13:[function(a,b){function c(){this.result={}}function d(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var e=a("./Transform");c._instance=new c,c.parse=function(a,b){return c._instance.parse(a,b)},c.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,e.identity),this.result},c.prototype.reset=function(){this.result={}};var f=[0,0];c.prototype._parseSpec=function(a,b,c){var g,h,i,j,k,l,m;if("number"==typeof a){if(g=a,i=b.transform,l=b.align||f,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=e.thenMove(i,d(n,c))}this.result[g]={transform:i,opacity:b.opacity,origin:b.origin||f,align:b.align||f,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=e.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=e.thenMove(i,d([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=e.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},b.exports=c},{"./Transform":15}],14:[function(a,b){function c(a){j.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function d(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function e(a){for(var b in this.properties)a.style[b]=this.properties[b]}function f(a){for(var b in this.properties)a.style[b]=""}function g(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function h(a){for(var b in this.attributes)a.removeAttribute(b)}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./ElementOutput");c.prototype=Object.create(j.prototype),c.prototype.constructor=c,c.prototype.elementType="div",c.prototype.elementClass="famous-surface",c.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[b]=a[b]}this._attributesDirty=!0},c.prototype.getAttributes=function(){return this.attributes},c.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},c.prototype.getProperties=function(){return this.properties},c.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},c.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},c.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},c.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},c.prototype.getClassList=function(){return this.classList},c.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},c.prototype.getContent=function(){return this.content},c.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},c.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},c.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){d.call(this,b);for(var f=this.getClassList(),h=0;h<f.length;h++)b.classList.add(f[h]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(e.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(g.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var k=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=k[0]),void 0===c[1]&&(c[1]=k[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}i(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),j.prototype.commit.call(this,a)
},c.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",f.call(this,c),h.call(this,c);var e=this.getClassList();for(d.call(this,c),b=0;b<e.length;b++)c.classList.remove(e[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},c.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},c.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},c.prototype.getSize=function(){return this._size?this._size:this.size},c.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},b.exports=c},{"./ElementOutput":3}],15:[function(a,b){function c(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function d(a){return Math.sqrt(c(a))}function e(a){return 0>a?-1:1}var f={};f.precision=1e-6,f.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},f.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},f.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},f.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return f.thenMove(b,[c,d,e])},f.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},f.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},f.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},f.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},f.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},f.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},f.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},f.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},f.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return f.thenMove(b,[c,d,e])},f.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},f.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},f.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},f.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},f.getTranslate=function(a){return[a[12],a[13],a[14]]},f.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},f.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},f.interpret=function(a){var b=[a[0],a[1],a[2]],g=e(b[0]),h=d(b),i=[b[0]+g*h,b[1],b[2]],j=2/c(i);if(j>=1/0)return{translate:f.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=f.multiply(k,a),m=[l[5],l[6]],n=e(m[0]),o=d(m),p=[m[0]+n*o,m[1]],q=2/c(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=f.multiply(r,k),t=f.multiply(s,a),u=f.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=f.multiply(t,u),s=f.multiply(u,s);var v={};return v.translate=f.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},f.average=function(a,b,c){c=void 0===c?.5:c;for(var d=f.interpret(a),e=f.interpret(b),g={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)g.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],g.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],g.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],g.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return f.build(g)},f.build=function(a){var b=f.scale(a.scale[0],a.scale[1],a.scale[2]),c=f.skew(a.skew[0],a.skew[1],a.skew[2]),d=f.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return f.thenMove(f.multiply(f.multiply(d,c),b),a.translate)},f.equals=function(a,b){return!f.notEquals(a,b)},f.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},f.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},f.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],f.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],b.exports=f},{}],16:[function(a,b){function c(a){this._node=new f,this._eventInput=new d,this._eventOutput=new d,d.setInputHandler(this,this._eventInput),d.setOutputHandler(this,this._eventOutput),this.options=g.clone(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a)}var d=a("./EventHandler"),e=a("./OptionsManager"),f=a("./RenderNode"),g=a("../utilities/Utility");c.DEFAULT_OPTIONS={},c.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},c.prototype.setOptions=function(a){this._optionsManager.patch(a)},c.prototype.add=function(){return this._node.add.apply(this._node,arguments)},c.prototype._add=c.prototype.add,c.prototype.render=function(){return this._node.render()},c.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},b.exports=c},{"../utilities/Utility":96,"./EventHandler":7,"./OptionsManager":10,"./RenderNode":11}],17:[function(a,b){function c(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}c.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},c.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},c.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},c.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},c.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},c.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},c.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},c.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},c.prototype.indexOf=function(a){return this._.array.indexOf(a)},c.prototype.getIndex=function(){return this.index},c.prototype.toString=function(){return""+this.index},c.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},c.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},c.prototype.get=function(){return this._.getValue(this.index)},c.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},c.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},b.exports=c},{}],18:[function(a,b){b.exports={Context:a("./Context"),ElementAllocator:a("./ElementAllocator"),ElementOutput:a("./ElementOutput"),Engine:a("./Engine"),Entity:a("./Entity"),EventEmitter:a("./EventEmitter"),EventHandler:a("./EventHandler"),Group:a("./Group"),Modifier:a("./Modifier"),OptionsManager:a("./OptionsManager"),RenderNode:a("./RenderNode"),Scene:a("./Scene"),SpecParser:a("./SpecParser"),Surface:a("./Surface"),Transform:a("./Transform"),View:a("./View"),ViewSequence:a("./ViewSequence")}},{"./Context":1,"./ElementAllocator":2,"./ElementOutput":3,"./Engine":4,"./Entity":5,"./EventEmitter":6,"./EventHandler":7,"./Group":8,"./Modifier":9,"./OptionsManager":10,"./RenderNode":11,"./Scene":12,"./SpecParser":13,"./Surface":14,"./Transform":15,"./View":16,"./ViewSequence":17}],19:[function(a,b){function c(a){this.dispatchers={},this.currMode=void 0,this.setMode(a)}var d=a("../core/EventHandler");c.prototype.setMode=function(a){if(a!==this.currMode){var b=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=a,this.dispatchers[a]&&this.dispatchers[a].emit("pipe"),this.emit("change",{from:b,to:a})}},c.prototype.forMode=function(a){return this.dispatchers[a]||(this.dispatchers[a]=new d),this.dispatchers[a]},c.prototype.emit=function(a,b){if(void 0===this.currMode)return!1;b||(b={});var c=this.dispatchers[this.currMode];return c?c.trigger(a,b):void 0},b.exports=c},{"../core/EventHandler":7}],20:[function(a,b){function c(a){d.call(this),this._condition=a}var d=a("../core/EventHandler");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.emit=function(a,b){return this._condition(a,b)?d.prototype.emit.apply(this,arguments):void 0},c.prototype.trigger=c.prototype.emit,b.exports=c},{"../core/EventHandler":7}],21:[function(a,b){function c(a){d.call(this),this._mappingFunction=a}var d=a("../core/EventHandler");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.subscribe=null,c.prototype.unsubscribe=null,c.prototype.emit=function(a,b){var c=this._mappingFunction.apply(this,arguments);c&&c.emit instanceof Function&&c.emit(a,b)},c.prototype.trigger=c.prototype.emit,b.exports=c},{"../core/EventHandler":7}],22:[function(a,b){b.exports={EventArbiter:a("./EventArbiter"),EventFilter:a("./EventFilter"),EventMapper:a("./EventMapper")}},{"./EventArbiter":19,"./EventFilter":20,"./EventMapper":21}],23:[function(a,b){b.exports={core:a("./core"),events:a("./events"),inputs:a("./inputs"),math:a("./math"),modifiers:a("./modifiers"),physics:a("./physics"),surfaces:a("./surfaces"),transitions:a("./transitions"),utilities:a("./utilities"),views:a("./views"),widgets:a("./widgets")}},{"./core":18,"./events":22,"./inputs":37,"./math":43,"./modifiers":48,"./physics":72,"./surfaces":83,"./transitions":93,"./utilities":97,"./views":112,"./widgets":117}],24:[function(a,b){function c(a,b){void 0===b&&(b="update"),this._state=a&&a.get&&a.set?a:new f(a||0),this._eventInput=new e,e.setInputHandler(this,this._eventInput),this._eventInput.on(b,d.bind(this))}function d(a){var b=a.delta,c=this.get();if(b.constructor===c.constructor){var d=b instanceof Array?[c[0]+b[0],c[1]+b[1]]:c+b;this.set(d)}}var e=a("../core/EventHandler"),f=a("../transitions/Transitionable");c.prototype.get=function(){return this._state.get()},c.prototype.set=function(a){this._state.set(a)},b.exports=c},{"../core/EventHandler":7,"../transitions/Transitionable":89}],25:[function(){function a(a){window.addEventListener(a,function(a){return a.stopPropagation(),!1},!0)}var b="ontouchstart"in window;b&&(a("mousedown"),a("mousemove"),a("mouseup"),a("mouseleave"))},{}],26:[function(){!function(){if(window.CustomEvent){var a=300,b=500,c={},d={},e=Date.now;window.addEventListener("touchstart",function(a){for(var b=e(),d=0;d<a.changedTouches.length;d++){var f=a.changedTouches[d];c[f.identifier]=b}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b];delete c[d.identifier]}}),window.addEventListener("touchend",function(b){for(var f=e(),g=0;g<b.changedTouches.length;g++){var h=b.changedTouches[g],i=c[h.identifier];if(i&&a>f-i){var j=new window.CustomEvent("click",{bubbles:!0,detail:h});d[f]=b,b.target.dispatchEvent(j)}delete c[h.identifier]}}),window.addEventListener("click",function(a){var c=e();for(var f in d){var g=d[f];b>c-f?a instanceof window.MouseEvent&&a.target===g.target&&a.stopPropagation():delete d[f]}},!0)}}()},{}],27:[function(a,b){function c(a,b){this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function d(a,b){f[a]&&(this._syncs[a]=new f[a](b),this.pipeSync(a))}var e=a("../core/EventHandler");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DIRECTION_Z=2;var f={};c.register=function(a){for(var b in a)if(f[b]){if(f[b]!==a[b])throw new Error("Conflicting sync classes for key: "+b)}else f[b]=a[b]},c.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},c.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},c.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},c.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)d.call(this,a[b]);else if(a instanceof Object)for(var c in a)d.call(this,c,a[c])},b.exports=c},{"../core/EventHandler":7}],28:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._eventInput=new i,this._eventOutput=new i,i.setInputHandler(this,this._eventInput),i.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",d.bind(this)),this._eventInput.on("mousemove",e.bind(this)),this._eventInput.on("mouseup",f.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",g.bind(this)):this._eventInput.on("mouseleave",f.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function d(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function e(a){if(0!==this._positionHistory.length){var b=h.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function f(a){if(this._down){var b=h.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function g(){if(this._down&&this._move&&!this._documentActive){var a=e.bind(this),b=function(c){f.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function h(a){var b,d,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],m=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(m)>Math.abs(n)?n=0:m=0),this.options.direction===c.DIRECTION_X?(d=m,this._position+=d):this.options.direction===c.DIRECTION_Y?(d=n,this._position+=d):(d=[m,n],this._position[0]+=m,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=m,this._displacement[1]+=n),e.delta=d,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=k.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,l);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var i=a("../core/EventHandler"),j=a("../core/OptionsManager"),k=a("./SyncUtils");c.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},c.DIRECTION_X=0,c.DIRECTION_Y=1;var l=8;c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"./SyncUtils":33}],29:[function(a,b){function c(a){d.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),this._displacement=0,this._previousDistance=0}var d=a("./TwoFingerSync"),e=a("../core/OptionsManager");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._previousDistance=d.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:d.calculateCenter(this.posA,this.posB)})},c.prototype._moveUpdate=function(a){var b=d.calculateDistance(this.posA,this.posB),c=d.calculateCenter(this.posA,this.posB),e=this.options.scale,f=e*(b-this._previousDistance),g=f/a;this._previousDistance=b,this._displacement+=f,this._eventOutput.emit("update",{delta:f,velocity:g,distance:b,displacement:this._displacement,center:c,touches:[this.touchAId,this.touchBId]})},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],30:[function(a,b){function c(a){d.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),this._angle=0,this._previousAngle=0}var d=a("./TwoFingerSync"),e=a("../core/OptionsManager");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._angle=0,this._previousAngle=d.calculateAngle(this.posA,this.posB);var b=d.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:a.touches.length,angle:this._angle,center:b,touches:[this.touchAId,this.touchBId]})},c.prototype._moveUpdate=function(a){var b=this.options.scale,c=d.calculateAngle(this.posA,this.posB),e=d.calculateCenter(this.posA,this.posB),f=b*(c-this._previousAngle),g=f/a;this._angle+=f,this._eventOutput.emit("update",{delta:f,velocity:g,angle:this._angle,center:e,touches:[this.touchAId,this.touchBId]}),this._previousAngle=c},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],31:[function(a,b){function c(a){e.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",d.bind(this))}function d(){this.touchAId=void 0,this.touchBId=void 0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");c.prototype=Object.create(e.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={scale:1},c.prototype._startUpdate=function(a){this._scaleFactor=1,this._startDist=e.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:e.calculateCenter(this.posA,this.posB)})},c.prototype._moveUpdate=function(a){var b=this.options.scale,c=e.calculateDistance(this.posA,this.posB),d=e.calculateCenter(this.posA,this.posB),f=(c-this._startDist)/this._startDist,g=Math.max(1+b*f,0),h=(g-this._scaleFactor)/a;this._eventOutput.emit("update",{delta:f,scale:g,velocity:h,distance:c,center:d,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=g},c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/OptionsManager":10,"./TwoFingerSync":36}],32:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",e.bind(this)),this._eventInput.on("wheel",e.bind(this)),this._inProgress=!1,this._loopBound=!1}function d(){if(this._inProgress&&j()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function e(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(g.on("prerender",d.bind(this)),this._loopBound=!0));var b=j(),e=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,h=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,h*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(h)?h=0:f=0);var k,l,m=Math.max(b-e,i),n=f/m,o=h/m,p=this.options.scale;this.options.direction===c.DIRECTION_X?(l=p*f,k=p*n,this._position+=l):this.options.direction===c.DIRECTION_Y?(l=p*h,k=p*o,this._position+=l):(l=[p*f,p*h],k=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=k,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=k}var f=a("../core/EventHandler"),g=a("../core/Engine"),h=a("../core/OptionsManager");c.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},c.DIRECTION_X=0,c.DIRECTION_Y=1;var i=8,j=Date.now;c.prototype.getOptions=function(){return this.options},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},b.exports=c},{"../core/Engine":4,"../core/EventHandler":7,"../core/OptionsManager":10}],33:[function(a,b){b.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}},{}],34:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._eventOutput=new i,this._touchTracker=new h({touchLimit:this.options.touchLimit}),i.setOutputHandler(this,this._eventOutput),i.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",d.bind(this)),this._touchTracker.on("trackmove",e.bind(this)),this._touchTracker.on("trackend",g.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function d(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function e(a){f.call(this,a)}function f(a){var b=a.history,d=b[b.length-1],e=k.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=d.timestamp,h=d.x-e.x,i=d.y-e.y,j=d.x-f,m=d.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(m)?m=0:j=0);var n,o,p=Math.max(g-f,l),q=j/p,r=m/p,s=this.options.scale;this.options.direction===c.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===c.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function g(a){f.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var h=a("./TouchTracker"),i=a("../core/EventHandler"),j=a("../core/OptionsManager"),k=a("./SyncUtils");c.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},c.DIRECTION_X=0,c.DIRECTION_Y=1;var l=8;c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.getOptions=function(){return this.options},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"./SyncUtils":33,"./TouchTracker":35}],35:[function(a,b){function c(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:j(),count:b.touches.length,history:c}}function d(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=c(d,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[d.identifier]||this.track(e)}}}function e(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=this.touchHistory[d.identifier];if(e){var f=c(d,a,e);this.touchHistory[d.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function f(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b],e=this.touchHistory[d.identifier];if(e){var f=c(d,a,e);this.touchHistory[d.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[d.identifier]}}this.isTouched=!1}}function g(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function h(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new i,this.eventOutput=new i,i.setInputHandler(this,this.eventInput),i.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",d.bind(this)),this.eventInput.on("touchmove",e.bind(this)),this.eventInput.on("touchend",f.bind(this)),this.eventInput.on("touchcancel",f.bind(this)),this.eventInput.on("unpipe",g.bind(this)),this.isTouched=!1
}var i=a("../core/EventHandler"),j=Date.now;h.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},b.exports=h},{"../core/EventHandler":7}],36:[function(a,b){function c(){this._eventInput=new d,this._eventOutput=new d,d.setInputHandler(this,this._eventInput),d.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var d=a("../core/EventHandler");c.calculateAngle=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.atan2(d,c)},c.calculateDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},c.calculateCenter=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};var e=Date.now;c.prototype.handleStart=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];this.touchAEnabled?this.touchBEnabled||(this.touchBId=c.identifier,this.touchBEnabled=!0,this.posB=[c.pageX,c.pageY],this.timestampB=e(),this._startUpdate(a)):(this.touchAId=c.identifier,this.touchAEnabled=!0,this.posA=[c.pageX,c.pageY],this.timestampA=e())}},c.prototype.handleMove=function(a){if(this.touchAEnabled&&this.touchBEnabled){for(var b,c=this.timestampA,d=this.timestampB,f=0;f<a.changedTouches.length;f++){var g=a.changedTouches[f];g.identifier===this.touchAId?(this.posA=[g.pageX,g.pageY],this.timestampA=e(),b=this.timestampA-c):g.identifier===this.touchBId&&(this.posB=[g.pageX,g.pageY],this.timestampB=e(),b=this.timestampB-d)}b&&this._moveUpdate(b)}},c.prototype.handleEnd=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];(c.identifier===this.touchAId||c.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},b.exports=c},{"../core/EventHandler":7}],37:[function(a,b){b.exports={Accumulator:a("./Accumulator"),DesktopEmulationMode:a("./DesktopEmulationMode"),FastClick:a("./FastClick"),GenericSync:a("./GenericSync"),MouseSync:a("./MouseSync"),PinchSync:a("./PinchSync"),RotateSync:a("./RotateSync"),ScaleSync:a("./ScaleSync"),ScrollSync:a("./ScrollSync"),SyncUtils:a("./SyncUtils"),TouchSync:a("./TouchSync"),TouchTracker:a("./TouchTracker"),TwoFingerSync:a("./TwoFingerSync")}},{"./Accumulator":24,"./DesktopEmulationMode":25,"./FastClick":26,"./GenericSync":27,"./MouseSync":28,"./PinchSync":29,"./RotateSync":30,"./ScaleSync":31,"./ScrollSync":32,"./SyncUtils":33,"./TouchSync":34,"./TouchTracker":35,"./TwoFingerSync":36}],38:[function(a,b){function c(a){return this.values=a||[[1,0,0],[0,1,0],[0,0,1]],this}var d=a("./Vector"),e=new c,f=new d;c.prototype.get=function(){return this.values},c.prototype.set=function(a){this.values=a},c.prototype.vectorMultiply=function(a){var b=this.get(),c=a.x,d=a.y,e=a.z,g=b[0],h=b[1],i=b[2],j=g[0],k=g[1],l=g[2],m=h[0],n=h[1],o=h[2],p=i[0],q=i[1],r=i[2];return f.setXYZ(j*c+k*d+l*e,m*c+n*d+o*e,p*c+q*d+r*e)},c.prototype.multiply=function(a){for(var b=this.get(),c=[[]],d=0;3>d;d++){c[d]=[];for(var f=0;3>f;f++){for(var g=0,h=0;3>h;h++)g+=b[d][h]*a[h][f];c[d][f]=g}}return e.set(c)},c.prototype.transpose=function(){for(var a=[],b=this.get(),c=0;3>c;c++)for(var d=0;3>d;d++)a[c][d]=b[d][c];return e.set(a)},c.prototype.clone=function(){for(var a=this.get(),b=[],d=0;3>d;d++)b[d]=a[d].slice();return new c(b)},b.exports=c},{"./Vector":42}],39:[function(a,b){function c(a,b,c,d){return 1===arguments.length?this.set(a):(this.w=void 0!==a?a:1,this.x=void 0!==b?b:0,this.y=void 0!==c?c:0,this.z=void 0!==d?d:0),this}var d=a("./Matrix"),e=new c(1,0,0,0);c.prototype.add=function(a){return e.setWXYZ(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)},c.prototype.sub=function(a){return e.setWXYZ(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)},c.prototype.scalarDivide=function(a){return this.scalarMultiply(1/a)},c.prototype.scalarMultiply=function(a){return e.setWXYZ(this.w*a,this.x*a,this.y*a,this.z*a)},c.prototype.multiply=function(a){var b=this.x,c=this.y,d=this.z,f=this.w,g=a.x,h=a.y,i=a.z,j=a.w||0;return e.setWXYZ(f*j-b*g-c*h-d*i,b*j+g*f+h*d-c*i,c*j+h*f+b*i-g*d,d*j+i*f+g*c-b*h)};var f=new c(1,0,0,0);c.prototype.rotateVector=function(a){return f.set(this.conj()),e.set(this.multiply(a).multiply(f))},c.prototype.inverse=function(){return e.set(this.conj().scalarDivide(this.normSquared()))},c.prototype.negate=function(){return this.scalarMultiply(-1)},c.prototype.conj=function(){return e.setWXYZ(this.w,-this.x,-this.y,-this.z)},c.prototype.normalize=function(a){return a=void 0===a?1:a,this.scalarDivide(a*this.norm())},c.prototype.makeFromAngleAndAxis=function(a,b){var c=b.normalize(),d=.5*a,e=-Math.sin(d);return this.x=e*c.x,this.y=e*c.y,this.z=e*c.z,this.w=Math.cos(d),this},c.prototype.setWXYZ=function(a,b,c,d){return e.clear(),this.w=a,this.x=b,this.y=c,this.z=d,this},c.prototype.set=function(a){return a instanceof Array?(this.w=0,this.x=a[0],this.y=a[1],this.z=a[2]):(this.w=a.w,this.x=a.x,this.y=a.y,this.z=a.z),this!==e&&e.clear(),this},c.prototype.put=function(a){a.set(e)},c.prototype.clone=function(){return new c(this)},c.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},c.prototype.isEqual=function(a){return a.w===this.w&&a.x===this.x&&a.y===this.y&&a.z===this.z},c.prototype.dot=function(a){return this.w*a.w+this.x*a.x+this.y*a.y+this.z*a.z},c.prototype.normSquared=function(){return this.dot(this)},c.prototype.norm=function(){return Math.sqrt(this.normSquared())},c.prototype.isZero=function(){return!(this.x||this.y||this.z)},c.prototype.getTransform=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return[1-2*c*c-2*d*d,2*b*c-2*d*e,2*b*d+2*c*e,0,2*b*c+2*d*e,1-2*b*b-2*d*d,2*c*d-2*b*e,0,2*b*d-2*c*e,2*c*d+2*b*e,1-2*b*b-2*c*c,0,0,0,0,1]};var g=new d;c.prototype.getMatrix=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return g.set([[1-2*c*c-2*d*d,2*b*c+2*d*e,2*b*d-2*c*e],[2*b*c-2*d*e,1-2*b*b-2*d*d,2*c*d+2*b*e],[2*b*d+2*c*e,2*c*d-2*b*e,1-2*b*b-2*c*c]])};var h=1e-5;c.prototype.slerp=function(a,b){var c,d,f,g,i;return d=this.dot(a),1-d>h?(c=Math.acos(d),f=Math.sin(c),g=Math.sin((1-b)*c)/f,i=Math.sin(b*c)/f):(g=1-b,i=b),e.set(this.scalarMultiply(g/i).add(a).multiply(i))},b.exports=c},{"./Matrix":38}],40:[function(a,b){function c(a,b){return a+e()*(b-a)}function d(a,b){return a+e()*(b-a+1)>>0}var e=Math.random,f={};f.integer=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var e=[],f=0;c>f;f++)e.push(d(a,b));return e}return d(a,b)},f.range=function(a,b,d){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==d){for(var e=[],f=0;d>f;f++)e.push(c(a,b));return e}return c(a,b)},f.sign=function(a){return a=void 0!==a?a:.5,e()<a?1:-1},f.bool=function(a){return a=void 0!==a?a:.5,e()<a},b.exports=f},{}],41:[function(a,b){var c={};c.clamp=function(a,b){return Math.max(Math.min(a,b[1]),b[0])},c.length=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)},b.exports=c},{}],42:[function(a,b){function c(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function d(a,b,c){return this.x=a,this.y=b,this.z=c,this}function e(a){return d.call(this,a[0],a[1],a[2]||0)}function f(a){return d.call(this,a.x,a.y,a.z)}function g(a){return d.call(this,a,0,0)}var h=new c(0,0,0);c.prototype.add=function(a){return d.call(h,this.x+a.x,this.y+a.y,this.z+a.z)},c.prototype.sub=function(a){return d.call(h,this.x-a.x,this.y-a.y,this.z-a.z)},c.prototype.mult=function(a){return d.call(h,a*this.x,a*this.y,a*this.z)},c.prototype.div=function(a){return this.mult(1/a)},c.prototype.cross=function(a){var b=this.x,c=this.y,e=this.z,f=a.x,g=a.y,i=a.z;return d.call(h,e*g-c*i,b*i-e*f,c*f-b*g)},c.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},c.prototype.rotateX=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,b,c*f-e*g,c*g+e*f)},c.prototype.rotateY=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,e*g+b*f,c,e*f-b*g)},c.prototype.rotateZ=function(a){var b=this.x,c=this.y,e=this.z,f=Math.cos(a),g=Math.sin(a);return d.call(h,b*f-c*g,b*g+c*f,e)},c.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},c.prototype.normSquared=function(){return this.dot(this)},c.prototype.norm=function(){return Math.sqrt(this.normSquared())},c.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?f.call(h,this.mult(a/b)):d.call(h,a,0,0)},c.prototype.clone=function(){return new c(this)},c.prototype.isZero=function(){return!(this.x||this.y||this.z)},c.prototype.set=function(a){return a instanceof Array?e.call(this,a):"number"==typeof a?g.call(this,a):f.call(this,a)},c.prototype.setXYZ=function(){return d.apply(this,arguments)},c.prototype.set1D=function(a){return g.call(this,a)},c.prototype.put=function(a){this===h?f.call(a,h):f.call(a,this)},c.prototype.clear=function(){return d.call(this,0,0,0)},c.prototype.cap=function i(i){if(1/0===i)return f.call(h,this);var a=this.norm();return a>i?f.call(h,this.mult(i/a)):f.call(h,this)},c.prototype.project=function(a){return a.mult(this.dot(a))},c.prototype.reflectAcross=function(a){return a.normalize().put(a),f(h,this.sub(this.project(a).mult(2)))},c.prototype.get=function(){return[this.x,this.y,this.z]},c.prototype.get1D=function(){return this.x},b.exports=c},{}],43:[function(a,b){b.exports={Matrix:a("./Matrix"),Quaternion:a("./Quaternion"),Random:a("./Random"),Utilities:a("./Utilities"),Vector:a("./Vector")}},{"./Matrix":38,"./Quaternion":39,"./Random":40,"./Utilities":41,"./Vector":42}],44:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._positionState=new j([0,0]),this._differential=[0,0],this._active=!0,this.sync=new m(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new k,k.setInputHandler(this,this.sync),k.setOutputHandler(this,this.eventOutput),h.call(this)}function d(a){var b=this.options,c=b.projection,d=b.snapX,e=b.snapY,f=c&p.x?a[0]:0,g=c&p.y?a[1]:0;return d>0&&(f-=f%d),e>0&&(g-=g%e),[f,g]}function e(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function f(a){if(this._active){var b=this.options;this._differential=a.position;var c=d.call(this,this._differential);this._differential[0]-=c[0],this._differential[1]-=c[1];var e=this.getPosition();if(e[0]+=c[0],e[1]+=c[1],b.xRange){var f=[b.xRange[0]+.5*b.snapX,b.xRange[1]-.5*b.snapX];e[0]=q(e[0],f)}if(b.yRange){var g=[b.yRange[0]+.5*b.snapY,b.yRange[1]-.5*b.snapY];e[1]=q(e[1],g)}this.eventOutput.emit("update",{position:e})}}function g(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function h(){this.sync.on("start",e.bind(this)),this.sync.on("update",f.bind(this)),this.sync.on("end",g.bind(this))}var i=a("../core/Transform"),j=a("../transitions/Transitionable"),k=a("../core/EventHandler"),l=a("../math/Utilities"),m=a("../inputs/GenericSync"),n=a("../inputs/MouseSync"),o=a("../inputs/TouchSync");m.register({mouse:n,touch:o});var p={x:1,y:2};c.DIRECTION_X=p.x,c.DIRECTION_Y=p.y;var q=l.clamp;c.DEFAULT_OPTIONS={projection:p.x|p.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},c.prototype.setOptions=function(a){var b=this.options;if(void 0!==a.projection){var c=a.projection;this.options.projection=0,["x","y"].forEach(function(a){-1!==c.indexOf(a)&&(b.projection|=p[a])})}void 0!==a.scale&&(b.scale=a.scale,this.sync.setOptions({scale:a.scale})),void 0!==a.xRange&&(b.xRange=a.xRange),void 0!==a.yRange&&(b.yRange=a.yRange),void 0!==a.snapX&&(b.snapX=a.snapX),void 0!==a.snapY&&(b.snapY=a.snapY)},c.prototype.getPosition=function(){return this._positionState.get()},c.prototype.setRelativePosition=function(a,b,c){var d=this.getPosition(),e=[d[0]+a[0],d[1]+a[1]];this.setPosition(e,b,c)},c.prototype.setPosition=function(a,b,c){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(a,b,c)},c.prototype.activate=function(){this._active=!0},c.prototype.deactivate=function(){this._active=!1},c.prototype.toggle=function(){this._active=!this._active},c.prototype.modify=function(a){var b=this.getPosition();return{transform:i.translate(b[0],b[1]),target:a}},b.exports=c},{"../core/EventHandler":7,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":34,"../math/Utilities":41,"../transitions/Transitionable":89}],45:[function(a,b){function c(a,b){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new e(this.options),a&&this.setOptions(a),b||(b=0),this.transitionHelper=new d(b)}var d=a("../transitions/Transitionable"),e=a("../core/OptionsManager");c.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.show=function(a,b){a=a||this.options.transition,this.set(1,a,b)},c.prototype.hide=function(a,b){a=a||this.options.transition,this.set(0,a,b)},c.prototype.set=function(a,b,c){this.halt(),this.transitionHelper.set(a,b,c)},c.prototype.halt=function(){this.transitionHelper.halt()},c.prototype.isVisible=function(){return this.transitionHelper.get()>0},c.prototype.modify=function(a){var b=this.transitionHelper.get();return this.options.cull&&!b?void 0:{opacity:b,target:a}},b.exports=c},{"../core/OptionsManager":10,"../transitions/Transitionable":89}],46:[function(a,b){function c(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}c.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},c.prototype.removeModifier=function(a){var b=this._chain.indexOf(a);0>b||this._chain.splice(b,1)},c.prototype.modify=function(a){for(var b=this._chain,c=a,d=0;d<b.length;d++)c=b[d].modify(c);return c},b.exports=c},{}],47:[function(a,b){function c(a){this._transformState=new g(e.identity),this._opacityState=new f(1),this._originState=new f([0,0]),this._alignState=new f([0,0]),this._sizeState=new f([0,0]),this._proportionsState=new f([0,0]),this._modifier=new d({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,a&&(a.transform&&this.setTransform(a.transform),void 0!==a.opacity&&this.setOpacity(a.opacity),a.origin&&this.setOrigin(a.origin),a.align&&this.setAlign(a.align),a.size&&this.setSize(a.size),a.proportions&&this.setProportions(a.proportions))}var d=a("../core/Modifier"),e=a("../core/Transform"),f=a("../transitions/Transitionable"),g=a("../transitions/TransitionableTransform");c.prototype.setTransform=function(a,b,c){return this._transformState.set(a,b,c),this},c.prototype.setOpacity=function(a,b,c){return this._opacityState.set(a,b,c),this},c.prototype.setOrigin=function(a,b,c){return null===a?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(a,b,c),this)},c.prototype.setAlign=function(a,b,c){return null===a?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(a,b,c),this)},c.prototype.setSize=function(a,b,c){return null===a?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(a,b,c),this)},c.prototype.setProportions=function(a,b,c){return null===a?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(a,b,c),this)},c.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},c.prototype.getTransform=function(){return this._transformState.get()},c.prototype.getFinalTransform=function(){return this._transformState.getFinal()},c.prototype.getOpacity=function(){return this._opacityState.get()},c.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},c.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},c.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},c.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},c.prototype.modify=function(a){return this._modifier.modify(a)},b.exports=c},{"../core/Modifier":9,"../core/Transform":15,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90}],48:[function(a,b){b.exports={Draggable:a("./Draggable"),Fader:a("./Fader"),ModifierChain:a("./ModifierChain"),StateModifier:a("./StateModifier")}},{"./Draggable":44,"./Fader":45,"./ModifierChain":46,"./StateModifier":47}],49:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=v(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function d(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function e(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},d.call(this,a).push(this._currAgentId),this._currAgentId++}function f(a){return this._agentData[a]}function g(a){var b=f.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function h(){for(var a=this._forces.length-1;a>-1;a--)g.call(this,a)}function i(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function j(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)i.call(this,c,a);b++}}function k(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function l(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function m(a,b){a.integrateOrientation(b)}function n(a,b){a.integratePosition(b),a.emit(w.update,a)}function o(a){h.call(this,a),this.forEach(k,a),this.forEachBody(l,a),j.call(this,a),this.forEachBody(m,a),this.forEach(n,a)}function p(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function q(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var r=a("../core/EventHandler"),s=17,t=1e3/120,u=17,v=Date.now,w={start:"start",update:"update",end:"end"};c.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},c.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},c.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},c.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],f=0;f<a.length;f++)d[f]=e.call(this,a[f],b,c);return d}return e.call(this,a,b,c)},c.prototype.attachTo=function(a,b){f.call(this,a).targets.push(b)},c.prototype.detach=function(a){var b=this.getAgent(a),c=d.call(this,b),e=c.indexOf(a);c.splice(e,1),delete this._agentData[a]},c.prototype.detachFrom=function(a,b){var c=f.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},c.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},c.prototype.getAgent=function(a){return f.call(this,a).agent},c.prototype.getParticles=function(){return this._particles},c.prototype.getBodies=function(){return this._bodies},c.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},c.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},c.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},c.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},c.prototype.getAgentEnergy=function(a){var b=f.call(this,a);return b.agent.getEnergy(b.targets,b.source)},c.prototype.getEnergy=function(){return p.call(this)+q.call(this)},c.prototype.step=function(){if(!this.isSleeping()){var a=v(),b=a-this._prevTime;this._prevTime=a,t>b||(b>u&&(b=u),o.call(this,s),this.emit(w.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},c.prototype.isSleeping=function(){return this._isSleeping},c.prototype.isActive=function(){return!this._isSleeping},c.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(w.end,this),this._isSleeping=!0)},c.prototype.wake=function(){this._isSleeping&&(this._prevTime=v(),this.emit(w.start,this),this._isSleeping=!1)},c.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},c.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new r),this._eventHandler.on(a,b)},b.exports=c},{"../core/EventHandler":7}],50:[function(a,b){function c(a){d.call(this,a),a=a||{},this.orientation=new g,this.angularVelocity=new f,this.angularMomentum=new f,this.torque=new f,a.orientation&&this.orientation.set(a.orientation),a.angularVelocity&&this.angularVelocity.set(a.angularVelocity),a.angularMomentum&&this.angularMomentum.set(a.angularMomentum),a.torque&&this.torque.set(a.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new f}var d=a("./Particle"),e=a("../../core/Transform"),f=a("../../math/Vector"),g=a("../../math/Quaternion"),h=a("../../math/Matrix"),i=a("../integrators/SymplecticEuler");c.DEFAULT_OPTIONS=d.DEFAULT_OPTIONS,c.DEFAULT_OPTIONS.orientation=[0,0,0,1],c.DEFAULT_OPTIONS.angularVelocity=[0,0,0],c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.isBody=!0,c.prototype.setMass=function(){d.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){this.inertia=new h,this.inverseInertia=new h},c.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},c.prototype.toWorldCoordinates=function(a){return this.pWorld.set(this.orientation.rotateVector(a))},c.prototype.getEnergy=function(){return d.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},c.prototype.reset=function(a,b,c,e){d.prototype.reset.call(this,a,b),this.angularVelocity.clear(),this.setOrientation(c||[1,0,0,0]),this.setAngularMomentum(e||[0,0,0])},c.prototype.setOrientation=function(a){this.orientation.set(a)},c.prototype.setAngularVelocity=function(a){this.wake(),this.angularVelocity.set(a)},c.prototype.setAngularMomentum=function(a){this.wake(),this.angularMomentum.set(a)},c.prototype.applyForce=function(a,b){d.prototype.applyForce.call(this,a),void 0!==b&&this.applyTorque(b.cross(a))},c.prototype.applyTorque=function(a){this.wake(),this.torque.set(this.torque.add(a))},c.prototype.getTransform=function(){return e.thenMove(this.orientation.getTransform(),e.getTranslate(d.prototype.getTransform.call(this)))},c.prototype._integrate=function(a){d.prototype._integrate.call(this,a),this.integrateAngularMomentum(a),this.updateAngularVelocity(a),this.integrateOrientation(a)},c.prototype.integrateAngularMomentum=function(a){i.integrateAngularMomentum(this,a)},c.prototype.integrateOrientation=function(a){i.integrateOrientation(this,a)},b.exports=c},{"../../core/Transform":15,"../../math/Matrix":38,"../../math/Quaternion":39,"../../math/Vector":42,"../integrators/SymplecticEuler":73,"./Particle":52}],51:[function(a,b){function c(a){a=a||{},this.setRadius(a.radius||0),d.call(this,a)}var d=a("./Body"),e=a("../../math/Matrix");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setRadius=function(a){this.radius=a,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.radius;this.inertia=new e([[.25*a*b*b,0,0],[0,.25*a*b*b,0],[0,0,.5*a*b*b]]),this.inverseInertia=new e([[4/(a*b*b),0,0],[0,4/(a*b*b),0],[0,0,2/(a*b*b)]])},b.exports=c},{"../../math/Matrix":38,"./Body":50}],52:[function(a,b){function c(a){a=a||{};var b=c.DEFAULT_OPTIONS;this.position=new e,this.velocity=new e,this.force=new e,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=f.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function d(){this._eventOutput=new g,this._eventOutput.bindThis(this),g.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/Transform"),g=a("../../core/EventHandler"),h=a("../integrators/SymplecticEuler");c.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var i={start:"start",update:"update",end:"end"},j=Date.now;c.prototype.isBody=!1,c.prototype.isActive=function(){return!this._isSleeping},c.prototype.sleep=function(){this._isSleeping||(this.emit(i.end,this),this._isSleeping=!0)},c.prototype.wake=function(){this._isSleeping&&(this.emit(i.start,this),this._isSleeping=!1,this._prevTime=j(),this._engine&&this._engine.wake())},c.prototype.setPosition=function(a){this.position.set(a)},c.prototype.setPosition1D=function(a){this.position.x=a},c.prototype.getPosition=function(){return this._engine.step(),this.position.get()},c.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},c.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},c.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},c.prototype.getVelocity=function(){return this.velocity.get()},c.prototype.setForce=function(a){this.force.set(a),this.wake()},c.prototype.getVelocity1D=function(){return this.velocity.x},c.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},c.prototype.getMass=function(){return this.mass},c.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},c.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},c.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},c.prototype.integrateVelocity=function(a){h.integrateVelocity(this,a)},c.prototype.integratePosition=function(a){h.integratePosition(this,a)},c.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},c.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},c.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},c.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},c.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},c.prototype.on=function(){return d.call(this),this.on.apply(this,arguments)},c.prototype.removeListener=function(){return d.call(this),this.removeListener.apply(this,arguments)},c.prototype.pipe=function(){return d.call(this),this.pipe.apply(this,arguments)},c.prototype.unpipe=function(){return d.call(this),this.unpipe.apply(this,arguments)},b.exports=c},{"../../core/EventHandler":7,"../../core/Transform":15,"../../math/Vector":42,"../integrators/SymplecticEuler":73}],53:[function(a,b){function c(a){a=a||{},this.size=a.size||[0,0],d.call(this,a)}var d=a("./Body"),e=a("../../math/Matrix");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setSize=function(a){this.size=a,this.setMomentsOfInertia()},c.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.size[0],c=this.size[1];this.inertia=new e([[a*c*c/12,0,0],[0,a*b*b/12,0],[0,0,a*(b*b+c*c)/12]]),this.inverseInertia=new e([[12/(a*c*c),0,0],[0,12/(a*b*b),0],[0,0,12/(a*(b*b+c*c))]])},b.exports=c},{"../../math/Matrix":38,"./Body":50}],54:[function(a,b){b.exports={Body:a("./Body"),Circle:a("./Circle"),Particle:a("./Particle"),Rectangle:a("./Rectangle")}},{"./Body":50,"./Circle":51,"./Particle":52,"./Rectangle":53}],55:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.normal=new e,this.pDiff=new e,this.vDiff=new e,this.impulse1=new e,this.impulse2=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){if(void 0!==b)for(var d=b.velocity,e=b.position,f=b.inverseMass,g=b.radius,h=this.options,i=h.drift,j=-h.slop,k=h.restitution,l=this.normal,m=this.pDiff,n=this.vDiff,o=this.impulse1,p=this.impulse2,q=0;q<a.length;q++){var r=a[q];if(r!==b){var s=r.velocity,t=r.position,u=r.inverseMass,v=r.radius;m.set(t.sub(e)),n.set(s.sub(d));var w=m.norm(),x=w-(g+v),y=1/(f+u),z=0;if(0>x){if(l.set(m.normalize()),this._eventOutput){var A={target:r,source:b,overlap:x,normal:l};this._eventOutput.emit("preCollision",A),this._eventOutput.emit("collision",A)}var B=j>=x?((1+k)*l.dot(n)+i/c*(x-j))/(z+c/y):(1+k)*l.dot(n)/(z+c/y);l.mult(c*B).put(o),o.mult(-1).put(p),b.applyImpulse(o),r.applyImpulse(p),this._eventOutput&&this._eventOutput.emit("postCollision",A)}}}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],56:[function(a,b){function c(){this.options=this.options||{},this._eventOutput=new d,d.setOutputHandler(this,this._eventOutput)}var d=a("../../core/EventHandler");c.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},c.prototype.applyConstraint=function(){},c.prototype.getEnergy=function(){return 0},b.exports=c},{"../../core/EventHandler":7}],57:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new e,this.impulse=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c;var f=1e-7,g=Math.PI;c.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(a,b,c){return c},period:0,dampingRatio:0},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.impulse,h=this.J,i=d.equation,j=d.plane,k=d.dampingRatio,l=d.period,m=0;m<a.length;m++){var n,o,p=a[m],q=p.velocity,r=p.position,s=p.mass;if(0===l)n=0,o=1;else{var t=4*s*g*k/l,u=4*s*g*g/(l*l);n=1/(t+c*u),o=c*u/(t+c*u)}var v=r.x,w=r.y,x=r.z,y=i(v,w,x),z=(i(v+f,r,r)-y)/f,A=(i(v,w+f,r)-y)/f,B=(i(v,w,r+f)-y)/f,C=j(v,w,x),D=(j(v+f,w,x)-C)/f,E=(j(v,w+f,x)-C)/f,F=(j(v,w,x+f)-C)/f;h.setXYZ(z+D,A+E,B+F);var G=o/c*(y+C),H=-(h.dot(q)+G)/(n+c*h.normSquared()/s);
e.set(h.mult(c*H)),p.applyImpulse(e)}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],58:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.impulse=new e,this.normal=new e,this.diffP=new e,this.diffV=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var f=Math.PI;c.prototype.setOptions=function(a){a.anchor&&(a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof e&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),void 0!==a.minLength&&(this.options.minLength=a.minLength)},c.prototype.setAnchor=function(a){this.options.anchor||(this.options.anchor=new e),this.options.anchor.set(a)},c.prototype.applyConstraint=function(a,b,c){var d,e,g=this.normal,h=this.diffP,i=this.diffV,j=this.impulse,k=this.options,l=k.dampingRatio,m=k.period,n=k.minLength;if(b){var o=b.velocity;d=b.position,e=b.inverseMass}else d=this.options.anchor,e=0;for(var p=this.options.length,q=0;q<a.length;q++){var r=a[q],s=r.velocity,t=r.position,u=r.inverseMass;h.set(t.sub(d)),g.set(h.normalize());var v=h.norm()-p;if(Math.abs(v)<n)return;i.set(b?s.sub(o):s);var w,x,y=1/(u+e);if(0===m)w=0,x=1;else{var z=4*y*f*l/m,A=4*y*f*f/(m*m);w=1/(z+c*A),x=c*A/(z+c*A)}var B=x/c*v,C=-(g.dot(i)+B)/(w+c/y);j.set(g.mult(c*C)),r.applyImpulse(j),b&&b.applyImpulse(j.mult(-1))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],59:[function(a,b){function c(a){d.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.pDiff=new e,this.vDiff=new e,this.impulse1=new e,this.impulse2=new e}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var f=Math.PI;c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof e&&(this.options.anchor=a.anchor),a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),d.prototype.setOptions.call(this,a)},c.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=c.anchor||b.position,g=Math.pow(2*f/c.period,2),h=0,i=0;i<a.length;i++){var j=a[i],k=e.sub(j.position).norm()-d;h+=.5*g*k*k}return h},c.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.pDiff,g=this.vDiff,h=this.impulse1,i=this.impulse2,j=d.length,k=d.anchor||b.position,l=d.period,m=d.dampingRatio,n=0;n<a.length;n++){var o=a[n],p=o.position,q=o.velocity,r=o.mass,s=o.inverseMass;e.set(p.sub(k));var t,u=e.norm()-j;if(b){var v=b.inverseMass,w=b.velocity;g.set(q.sub(w)),t=1/(s+v)}else g.set(q),t=r;var x,y;if(0===this.options.period)x=0,y=1;else{var z=4*t*f*f/(l*l),A=4*t*f*m/l;y=c*z/(A+c*z),x=1/(A+c*z)}var B=y/c*u;e.normalize(-B).sub(g).mult(c/(x+c/t)).put(h),o.applyImpulse(h),b&&(h.mult(-1).put(i),b.applyImpulse(i))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],60:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new e,this.impulse=new e,d.call(this)}var d=a("./Constraint"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var f=1e-7,g=Math.PI;c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.prototype.applyConstraint=function(a,b,c){for(var d=this.impulse,e=this.J,h=this.options,i=h.equation,j=h.dampingRatio,k=h.period,l=0;l<a.length;l++){var m,n,o=a[l],p=o.velocity,q=o.position,r=o.mass;if(0===k)m=0,n=1;else{var s=4*r*g*j/k,t=4*r*g*g/(k*k);m=1/(s+c*t),n=c*t/(s+c*t)}var u=q.x,v=q.y,w=q.z,x=i(u,v,w),y=(i(u+f,q,q)-x)/f,z=(i(u,v+f,q)-x)/f,A=(i(u,v,q+f)-x)/f;e.setXYZ(y,z,A);var B=n/c*x,C=-(e.dot(p)+B)/(m+c*e.normSquared()/r);d.set(e.mult(c*C)),o.applyImpulse(d)}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],61:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.diff=new i,this.impulse=new i,h.call(this)}function d(a,b){return b.dot(a)}function e(a){var b=this.options.normal,c=this.options.distance;return a.dot(b)+c}function f(a,b,d){var e=a.position,f=a.velocity,g=a.mass,h=this.options.normal,i=this.options.onContact,j=this.options.restitution,k=this.impulse,l=this.options.drift,m=-this.options.slop,n=0;if(this._eventOutput){var o={particle:a,wall:this,overlap:b,normal:h};this._eventOutput.emit("preCollision",o),this._eventOutput.emit("collision",o)}switch(i){case c.ON_CONTACT.REFLECT:var p=m>b?-((1+j)*h.dot(f)+l/d*(b-m))/(g*d+n):-((1+j)*h.dot(f))/(g*d+n);k.set(h.mult(d*p)),a.applyImpulse(k),a.setPosition(e.add(h.mult(-b)))}this._eventOutput&&this._eventOutput.emit("postCollision",o)}function g(a,b){var d=this.options.onContact,e=a.position,f=this.options.normal;d===c.ON_CONTACT.REFLECT&&a.setPosition(e.add(f.mult(-b)))}var h=a("./Constraint"),i=a("../../math/Vector");c.prototype=Object.create(h.prototype),c.prototype.constructor=c,c.ON_CONTACT={REFLECT:0,SILENT:1},c.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:c.ON_CONTACT.REFLECT},c.prototype.setOptions=function(a){void 0!==a.normal&&(a.normal instanceof i&&(this.options.normal=a.normal.clone()),a.normal instanceof Array&&(this.options.normal=new i(a.normal))),void 0!==a.restitution&&(this.options.restitution=a.restitution),void 0!==a.drift&&(this.options.drift=a.drift),void 0!==a.slop&&(this.options.slop=a.slop),void 0!==a.distance&&(this.options.distance=a.distance),void 0!==a.onContact&&(this.options.onContact=a.onContact)},c.prototype.applyConstraint=function(a,b,c){for(var h=this.options.normal,i=0;i<a.length;i++){var j=a[i],k=j.position,l=j.velocity,m=j.radius||0,n=e.call(this,k.add(h.mult(-m))),o=d.call(this,h,l);0>=n&&(0>o?f.call(this,j,n,c):g.call(this,j,n,c))}},b.exports=c},{"../../math/Vector":42,"./Constraint":56}],62:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this,a.sides||this.options.sides),g.call(this)}function d(a,b,d){var e,f=c.SIDES;switch(parseInt(a)){case f.LEFT:e=b[0]*d[0];break;case f.TOP:e=b[1]*d[1];break;case f.FRONT:e=b[2]*d[2];break;case f.RIGHT:e=b[0]*(1-d[0]);break;case f.BOTTOM:e=b[1]*(1-d[1]);break;case f.BACK:e=b[2]*(1-d[2])}return e}function e(a){this.components={};for(var b=this.components,c=0;c<a.length;c++){var e=a[c];b[c]=new h({normal:j[e].clone(),distance:d(e,this.options.size,this.options.origin)})}}function f(a){this.forEach(function(b){b.setOptions(a)});for(var b in a)this.options[b]=a[b]}var g=a("./Constraint"),h=a("./Wall"),i=a("../../math/Vector");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.ON_CONTACT=h.ON_CONTACT,c.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},c.DEFAULT_OPTIONS={sides:c.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:c.ON_CONTACT.REFLECT};var j={0:new i(1,0,0),1:new i(-1,0,0),2:new i(0,1,0),3:new i(0,-1,0),4:new i(0,0,1),5:new i(0,0,-1)};c.prototype.setOptions=function(a){var b=!1;void 0!==a.restitution&&f.call(this,{restitution:a.restitution}),void 0!==a.drift&&f.call(this,{drift:a.drift}),void 0!==a.slop&&f.call(this,{slop:a.slop}),void 0!==a.onContact&&f.call(this,{onContact:a.onContact}),void 0!==a.size&&(b=!0),void 0!==a.sides&&(this.options.sides=a.sides),void 0!==a.origin&&(b=!0),b&&this.setSize(a.size,a.origin)},c.prototype.setSize=function(a,b){b=b||this.options.origin,b.length<3&&(b[2]=.5),this.forEach(function(c,e){var f=d(e,a,b);c.setOptions({distance:f})}),this.options.size=a,this.options.origin=b},c.prototype.applyConstraint=function(a,b,c){this.forEach(function(d){d.applyConstraint(a,b,c)})},c.prototype.forEach=function(a){var b=this.options.sides;for(var c in this.sides)a(b[c],c)},c.prototype.rotateZ=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateZ(a).put(c)})},c.prototype.rotateX=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateX(a).put(c)})},c.prototype.rotateY=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateY(a).put(c)})},c.prototype.reset=function(){var a=this.options.sides;for(var b in a){var c=this.components[b];c.options.normal.set(j[b])}},b.exports=c},{"../../math/Vector":42,"./Constraint":56,"./Wall":61}],63:[function(a,b){b.exports={Collision:a("./Collision"),Constraint:a("./Constraint"),Curve:a("./Curve"),Distance:a("./Distance"),Snap:a("./Snap"),Surface:a("./Surface"),Wall:a("./Wall"),Walls:a("./Walls")}},{"./Collision":55,"./Constraint":56,"./Curve":57,"./Distance":58,"./Snap":59,"./Surface":60,"./Wall":61,"./Walls":62}],64:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),d.call(this)}var d=a("./Force");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},c.DEFAULT_OPTIONS={strength:.01,forceFunction:c.FORCE_FUNCTIONS.LINEAR},c.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},b.exports=c},{"./Force":65}],65:[function(a,b){function c(a){this.force=new d(a),this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput)}var d=a("../../math/Vector"),e=a("../../core/EventHandler");c.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},c.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},c.prototype.getEnergy=function(){return 0},b.exports=c},{"../../core/EventHandler":7,"../../math/Vector":42}],66:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new e,d.call(this)}var d=a("./Force"),e=a("../../math/Vector");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DECAY_FUNCTIONS={LINEAR:function(a,b){return Math.max(1-1/b*a,0)},MORSE:function(a,b){var c=0===b?100:b,d=a+c*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(d/c-1),2),0)},INVERSE:function(a,b){return 1/(1-b+a)},GRAVITY:function(a,b){return 1/(1-b+a*a)}},c.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:c.DECAY_FUNCTIONS.GRAVITY},c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof e&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new e(a.anchor)),delete a.anchor);for(var b in a)this.options[b]=a[b]},c.prototype.applyForce=function(a,b){var c=this.options,d=this.force,e=this.disp,f=c.strength,g=c.anchor||b.position,h=c.cap,i=c.cutoff,j=c.range[0],k=c.range[1],l=c.decayFunction;if(0!==f)for(var m,n,o,p,q=a.length;q--;)m=a[q],m!==b&&(n=m.mass,o=m.position,e.set(o.sub(g)),p=e.norm(),k>p&&p>j&&(d.set(e.normalize(f*n*l(p,i)).cap(h)),m.applyForce(d)))},b.exports=c},{"../../math/Vector":42,"./Force":65}],67:[function(a,b){function c(a){d.call(this,a)}var d=a("./Drag");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=d.DEFAULT_OPTIONS,c.FORCE_FUNCTIONS=d.FORCE_FUNCTIONS,c.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},c.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.angularVelocity).mult(-100*d).put(f),c.applyTorque(f)},c.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},b.exports=c},{"./Drag":64}],68:[function(a,b){function c(a){h.call(this,a)}function d(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function e(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function f(){d.call(this),e.call(this)}var g=a("./Force"),h=a("./Spring"),i=a("../../math/Quaternion");c.prototype=Object.create(h.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=h.DEFAULT_OPTIONS,c.FORCE_FUNCTIONS=h.FORCE_FUNCTIONS;var j=Math.PI;c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),f.call(this),g.prototype.setOptions.call(this,a)},c.prototype.applyForce=function(a){var b,c,d,e,f=this.force,g=this.options,h=this.disp,i=g.stiffness,j=g.damping,k=g.length,l=g.anchor,m=g.forceFunction,n=g.maxLength;for(b=0;b<a.length;b++){if(c=a[b],h.set(l.sub(c.orientation)),d=h.norm()-k,0===d)return;e=c.mass,i*=e,j*=e,f.set(h.normalize(i*m(d,n))),j&&f.add(c.angularVelocity.mult(-j)).put(f),c.applyTorque(f)}},c.prototype.getEnergy=function(a){for(var b=this.options,c=b.length,d=b.anchor,e=b.stiffness,f=0,g=0;g<a.length;g++){var h=a[g],i=d.sub(h.orientation).norm()-c;f+=.5*e*i*i}return f},b.exports=c},{"../../math/Quaternion":39,"./Force":65,"./Spring":69}],69:[function(a,b){function c(a){g.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new h(0,0,0),f.call(this)}function d(){var a=this.options;a.stiffness=Math.pow(2*i/a.period,2)}function e(){var a=this.options;a.damping=4*i*a.dampingRatio/a.period}function f(){d.call(this),e.call(this)}var g=a("./Force"),h=a("../../math/Vector");c.prototype=Object.create(g.prototype),c.prototype.constructor=c;var i=Math.PI,j=150;c.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},c.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:c.FORCE_FUNCTIONS.HOOK},c.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof h&&(this.options.anchor=a.anchor.position),a.anchor instanceof h&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new h(a.anchor))),void 0!==a.period&&(a.period<j&&(a.period=j,console.warn("The period of a SpringTransition is capped at "+j+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),f.call(this),g.prototype.setOptions.call(this,a)},c.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},c.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},b.exports=c},{"../../math/Vector":42,"./Force":65}],70:[function(a,b){function c(a){e.call(this),this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this.evaluation=new f}function d(a){var b=c.FIELDS;switch(a){case b.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new f(this.options.direction)):this.options.direction=new f(0,1,0);break;case b.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new f(this.options.position)):this.options.position=new f(0,0,0)}}var e=a("./Force"),f=a("../../math/Vector");c.prototype=Object.create(e.prototype),c.prototype.constructor=c,c.FIELDS={CONSTANT:function(a,b){b.direction.put(this.evaluation)},LINEAR:function(a){a.put(this.evaluation)},RADIAL:function(a){a.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(a,b){b.position.sub(a).put(this.evaluation)}},c.DEFAULT_OPTIONS={strength:.01,field:c.FIELDS.CONSTANT},c.prototype.setOptions=function(a){void 0!==a.strength&&(this.options.strength=a.strength),void 0!==a.direction&&(this.options.direction=a.direction),void 0!==a.field&&(this.options.field=a.field,d.call(this,this.options.field))},c.prototype.applyForce=function(a){var b,c,d=this.force,e=this.options.strength,f=this.options.field;for(b=0;b<a.length;b++)c=a[b],f.call(this,c.position,this.options),this.evaluation.mult(c.mass*e).put(d),c.applyForce(d)},c.prototype.getEnergy=function(a){var b,d,e=this.options.field,f=c.FIELDS,g=0;switch(e){case f.CONSTANT:g=a.length*this.options.direction.norm();break;case f.RADIAL:for(b=0;b<a.length;b++)d=a[b],g+=d.position.norm();break;case f.POINT_ATTRACTOR:for(b=0;b<a.length;b++)d=a[b],g+=d.position.sub(this.options.position).norm()}return g*=this.options.strength},b.exports=c},{"../../math/Vector":42,"./Force":65}],71:[function(a,b){b.exports={Drag:a("./Drag"),Force:a("./Force"),Repulsion:a("./Repulsion"),RotationalDrag:a("./RotationalDrag"),RotationalSpring:a("./RotationalSpring"),Spring:a("./Spring"),VectorField:a("./VectorField")}},{"./Drag":64,"./Force":65,"./Repulsion":66,"./RotationalDrag":67,"./RotationalSpring":68,"./Spring":69,"./VectorField":70}],72:[function(a,b){b.exports={PhysicsEngine:a("./PhysicsEngine"),bodies:a("./bodies"),constraints:a("./constraints"),forces:a("./forces"),integrators:a("./integrators")}},{"./PhysicsEngine":49,"./bodies":54,"./constraints":63,"./forces":71,"./integrators":74}],73:[function(a,b){var c={};c.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},c.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},c.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},c.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},b.exports=c},{}],74:[function(a,b){b.exports={SymplecticEuler:a("./SymplecticEuler")}},{"./SymplecticEuler":73}],75:[function(a,b){function c(a){a&&a.canvasSize&&(this._canvasSize=a.canvasSize),d.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="canvas",c.prototype.elementClass="famous-surface",c.prototype.setContent=function(){},c.prototype.deploy=function(a){this._canvasSize&&(a.width=this._canvasSize[0],a.height=this._canvasSize[1]),"2d"===this._contextId&&(a.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},c.prototype.recall=function(a){this.getSize(),this._backBuffer.width=a.width,this._backBuffer.height=a.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(a,0,0),a.width=0,a.height=0)},c.prototype.getContext=function(a){return this._contextId=a,this._currentTarget?this._currentTarget.getContext(a):this._backBuffer.getContext(a)},c.prototype.setSize=function(a,b){d.prototype.setSize.apply(this,arguments),b&&(this._canvasSize=[b[0],b[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},b.exports=c},{"../core/Surface":14}],76:[function(a,b){function c(a){d.call(this,a),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new e(this._container),this.setContent(this._container)}var d=a("../core/Surface"),e=a("../core/Context");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="div",c.prototype.elementClass="famous-surface",c.prototype.add=function(){return this.context.add.apply(this.context,arguments)},c.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),d.prototype.render.apply(this,arguments)},c.prototype.deploy=function(){return this._shouldRecalculateSize=!0,d.prototype.deploy.apply(this,arguments)},c.prototype.commit=function(){var a=this._size?[this._size[0],this._size[1]]:null,b=d.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||a&&(this._size[0]!==a[0]||this._size[1]!==a[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),b},b.exports=c},{"../core/Context":1,"../core/Surface":14}],77:[function(a,b){function c(a){a&&(this._method=a.method||""),d.apply(this,arguments)}var d=a("./ContainerSurface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="form",c.prototype.deploy=function(a){return this._method&&(a.method=this._method),d.prototype.deploy.apply(this,arguments)},b.exports=c},{"./ContainerSurface":76}],78:[function(a,b){function c(){this._imageUrl=void 0,d.apply(this,arguments)}var d=a("../core/Surface"),e=[],f=[],g=[],h=!0;c.enableCache=function(){h=!0},c.disableCache=function(){h=!1},c.clearCache=function(){e=[],f=[],g=[]},c.getCache=function(){return{urlCache:e,countCache:f,nodeCache:f}},c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="img",c.prototype.elementClass="famous-surface",c.prototype.setContent=function(a){var b=e.indexOf(this._imageUrl);-1!==b&&(1===f[b]?(e.splice(b,1),f.splice(b,1),g.splice(b,1)):f[b]--),b=e.indexOf(a),-1===b?(e.push(a),f.push(1)):f[b]++,this._imageUrl=a,this._contentDirty=!0},c.prototype.deploy=function(a){var b=e.indexOf(this._imageUrl);if(void 0===g[b]&&h){var c=new Image;c.src=this._imageUrl||"",g[b]=c}a.src=this._imageUrl||""},c.prototype.recall=function(a){a.src=""},b.exports=c},{"../core/Surface":14}],79:[function(a,b){function c(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._type=a.type||"text",this._name=a.name||"",d.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(a){a.target!==this._currentTarget&&this.blur()}.bind(this))}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="input",c.prototype.elementClass="famous-surface",c.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},c.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},c.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},c.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},c.prototype.setType=function(a){return this._type=a,this._contentDirty=!0,this},c.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},c.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},c.prototype.getName=function(){return this._name},c.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),a.value=this._value,a.type=this._type,a.name=this._name},b.exports=c},{"../core/Surface":14}],80:[function(a,b){function c(a){d.apply(this,arguments),this._type="submit",a&&a.onClick&&this.setOnClick(a.onClick)}var d=a("./InputSurface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.setOnClick=function(a){this.onClick=a},c.prototype.deploy=function(a){this.onclick&&(a.onClick=this.onClick),d.prototype.deploy.apply(this,arguments)},b.exports=c},{"./InputSurface":79}],81:[function(a,b){function c(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._name=a.name||"",this._wrap=a.wrap||"",this._cols=a.cols||"",this._rows=a.rows||"",d.apply(this,arguments),this.on("click",this.focus.bind(this))}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.elementType="textarea",c.prototype.elementClass="famous-surface",c.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},c.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},c.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},c.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},c.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},c.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},c.prototype.getName=function(){return this._name},c.prototype.setWrap=function(a){return this._wrap=a,this._contentDirty=!0,this},c.prototype.setColumns=function(a){return this._cols=a,this._contentDirty=!0,this},c.prototype.setRows=function(a){return this._rows=a,this._contentDirty=!0,this},c.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),""!==this._value&&(a.value=this._value),""!==this._name&&(a.name=this._name),""!==this._wrap&&(a.wrap=this._wrap),""!==this._cols&&(a.cols=this._cols),""!==this._rows&&(a.rows=this._rows)},b.exports=c},{"../core/Surface":14}],82:[function(a,b){function c(a){d.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a)}var d=a("../core/Surface");c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={autoplay:!1},c.prototype.elementType="video",c.prototype.elementClass="famous-surface",c.prototype.setOptions=function(a){a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.autoplay&&(this.options.autoplay=a.autoplay),a.src&&(this._videoUrl=a.src,this._contentDirty=!0)},c.prototype.setContent=function(a){this._videoUrl=a,this._contentDirty=!0},c.prototype.deploy=function(a){a.src=this._videoUrl,a.autoplay=this.options.autoplay},c.prototype.recall=function(a){a.src=""},b.exports=c},{"../core/Surface":14}],83:[function(a,b){b.exports={CanvasSurface:a("./CanvasSurface"),ContainerSurface:a("./ContainerSurface"),FormContainerSurface:a("./FormContainerSurface"),ImageSurface:a("./ImageSurface"),InputSurface:a("./InputSurface"),SubmitInputSurface:a("./SubmitInputSurface"),TextareaSurface:a("./TextareaSurface"),VideoSurface:a("./VideoSurface")}},{"./CanvasSurface":75,"./ContainerSurface":76,"./FormContainerSurface":77,"./ImageSurface":78,"./InputSurface":79,"./SubmitInputSurface":80,"./TextareaSurface":81,"./VideoSurface":82}],84:[function(a,b){function c(a){this._map=a||null,this._cachedOutput=null,this._cachedInput=Number.NaN}c.create=function(a){var b=new c(a);return b.get.bind(b)},c.prototype.get=function(a){return a!==this._cachedInput&&(this._cachedInput=a,this._cachedOutput=this._map(a)),this._cachedOutput},b.exports=c},{}],85:[function(a,b){var c={inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inQuart:function(a){return a*a*a*a},outQuart:function(a){return-(--a*a*a*a-1)},inOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return--a*a*a*a*a+1},inOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inCirc:function(a){return-(Math.sqrt(1-a*a)-1)},outCirc:function(a){return Math.sqrt(1- --a*a)},inOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)},inBack:function(a,b){return void 0===b&&(b=1.70158),a*a*((b+1)*a-b)},outBack:function(a,b){return void 0===b&&(b=1.70158),--a*a*((b+1)*a+b)+1},inOutBack:function(a,b){return void 0===b&&(b=1.70158),(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},inBounce:function(a){return 1-c.outBounce(1-a)},outBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},inOutBounce:function(a){return.5>a?.5*c.inBounce(2*a):.5*c.outBounce(2*a-1)+.5}};b.exports=c},{}],86:[function(a,b){function c(a){this.method=a,this._instances=[],this.state=[]}var d=a("../utilities/Utility");c.SUPPORTS_MULTIPLE=!0,c.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},c.prototype.set=function(a,b,c){for(var e=d.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,e)},c.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},b.exports=c},{"../utilities/Utility":96}],87:[function(a,b){function c(a){a=a||0,this.endState=new s(a),this.initState=new s,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.particle=new q,this.spring=new r({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function f(a){this.endState.set(a),e.call(this)}function g(){this.PE.wake()}function h(){this.PE.sleep()}function i(a){this.particle.position.set(a)}function j(a){this.particle.velocity.set(a)}function k(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function m(a){this._callback=a}function n(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),j.call(this,a.velocity)}function o(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;
this._callback=void 0,a()}}else d.call(this)<this._absRestTolerance&&(i.call(this,this.endState),j.call(this,[0,0,0]),h.call(this))}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/constraints/Snap"),s=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),i.call(this,a),f.call(this,a),b&&j.call(this,b),m.call(this,void 0)},c.prototype.getVelocity=function(){return l.call(this)},c.prototype.setVelocity=function(a){this.call(this,j(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return o.call(this),k.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,g.call(this),n.call(this,b),f.call(this,a),void m.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/constraints/Snap":59}],88:[function(a,b){function c(a){a=a||0,this.endState=new s(a),this.initState=new s,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.spring=new r({anchor:this.endState}),this.particle=new q,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(a){this.particle.setPosition(a)}function f(a){this.particle.setVelocity(a)}function g(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function h(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function i(a){this._callback=a}function j(){this.PE.wake()}function k(){this.PE.sleep()}function l(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else d.call(this)<this._absRestTolerance&&(e.call(this,this.endState),f.call(this,[0,0,0]),k.call(this))}function m(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),a.period<150&&(a.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),f.call(this,a.velocity)}function n(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function o(a){this.endState.set(a),n.call(this)}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Spring"),s=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),e.call(this,a),o.call(this,a),b&&f.call(this,b),i.call(this,void 0)},c.prototype.getVelocity=function(){return h.call(this)},c.prototype.setVelocity=function(a){this.call(this,f(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return l.call(this),g.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,j.call(this),m.call(this,b),o.call(this,a),void i.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/forces/Spring":69}],89:[function(a,b){function c(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function d(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],h=this.currentAction[1];h instanceof Object&&h.method?(b=h.method,"string"==typeof b&&(b=g[b])):b=f,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new e(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(h.velocity=this.velocity),this._engineInstance.set(c,h,d.bind(this))}var e=a("./MultipleTransition"),f=a("./TweenTransition"),g={};c.register=function(a){var b=!0;for(var d in a)c.registerMethod(d,a[d])||(b=!1);return b},c.registerMethod=function(a,b){return a in g?!1:(g[a]=b,!0)},c.unregisterMethod=function(a){return a in g?(delete g[a],!0):!1},c.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var e=[a,b];return this.actionQueue.push(e),this.callbackQueue.push(c),this.currentAction||d.call(this),this},c.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},c.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},c.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},c.prototype.isActive=function(){return!!this.currentAction},c.prototype.halt=function(){return this.set(this.get())},b.exports=c},{"./MultipleTransition":86,"./TweenTransition":91}],90:[function(a,b){function c(a){this._final=g.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new f(this._finalTranslate),this.rotate=new f(this._finalRotate),this.skew=new f(this._finalSkew),this.scale=new f(this._finalScale),a&&this.set(a)}function d(){return g.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function e(){return g.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var f=a("./Transitionable"),g=a("../core/Transform"),h=a("../utilities/Utility");c.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=e.call(this),this.translate.set(a,b,c),this},c.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=e.call(this),this.scale.set(a,b,c),this},c.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=e.call(this),this.rotate.set(a,b,c),this},c.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=e.call(this),this.skew.set(a,b,c),this},c.prototype.set=function(a,b,c){var d=g.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?h.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},c.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},c.prototype.get=function(){return this.isActive()?d.call(this):this._final},c.prototype.getFinal=function(){return this._final},c.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},c.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},b.exports=c},{"../core/Transform":15,"../utilities/Utility":96,"./Transitionable":89}],91:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function d(a,b,c){return(1-c)*a+c*b}function e(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function f(a,b){var d={curve:b.curve};return b.duration&&(d.duration=b.duration),b.speed&&(d.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(d.duration=a.duration),a.curve&&(d.curve=a.curve),a.speed&&(d.speed=a.speed)),"string"==typeof d.curve&&(d.curve=c.getCurve(d.curve)),d}function g(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function h(a,b,c){var e;if(a instanceof Array){e=[];for(var f=0;f<a.length;f++)e[f]="number"==typeof a[f]?d(a[f],b[f],c):a[f]}else e=d(a,b,c);return e}c.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},c.SUPPORTS_MULTIPLE=!0,c.DEFAULT_OPTIONS={curve:c.Curves.linear,duration:500,speed:0};var i={};c.registerCurve=function(a,b){return i[a]?!1:(i[a]=b,!0)},c.unregisterCurve=function(a){return i[a]?(delete i[a],!0):!1},c.getCurve=function(a){var b=i[a];if(void 0!==b)return b;throw new Error("curve not registered")},c.getCurves=function(){return i},c.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},c.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=e(this.get()),b=f(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var g=0;for(var h in d)g+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(g)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=e(a),this._startVelocity=e(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},c.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=e(a),this.velocity=e(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},c.prototype.getVelocity=function(){return this.velocity},c.prototype.get=function(a){return this.update(a),this.state},c.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=g(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=h(this._startValue,this._endValue,this._curve(c)),this.velocity=g(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},c.prototype.isActive=function(){return this._active},c.prototype.halt=function(){this.reset(this.get())},c.registerCurve("linear",c.Curves.linear),c.registerCurve("easeIn",c.Curves.easeIn),c.registerCurve("easeOut",c.Curves.easeOut),c.registerCurve("easeInOut",c.Curves.easeInOut),c.registerCurve("easeOutBounce",c.Curves.easeOutBounce),c.registerCurve("spring",c.Curves.spring),c.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},b.exports=c},{}],92:[function(a,b){function c(a){a=a||0,this.endState=new t(a),this.initState=new t,this.spring=new r({anchor:this.endState}),this.wall=new s,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new p,this.particle=new q,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function d(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function e(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function f(){this.PE.wake()}function g(){this.PE.sleep()}function h(a){this.endState.set(a);var b=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===b?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),e.call(this)}function i(a){this.particle.position.set(a)}function j(a){this.particle.velocity.set(a)}function k(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function l(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function m(a){this._callback=a}function n(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else{var b=d.call(this);b<this._absRestTolerance&&(g.call(this),i.call(this,this.endState),j.call(this,[0,0,0]))}}function o(a){var b=c.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),void 0===a.restitution&&(a.restitution=b.restitution),void 0===a.drift&&(a.drift=s.DEFAULT_OPTIONS.drift),void 0===a.slop&&(a.slop=s.DEFAULT_OPTIONS.slop),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),this.wall.setOptions({restitution:a.restitution,drift:a.drift,slop:a.slop}),j.call(this,a.velocity)}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Spring"),s=a("../physics/constraints/Wall"),t=a("../math/Vector");c.SUPPORTS_MULTIPLE=3,c.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},c.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),i.call(this,a),b&&j.call(this,b),h.call(this,a),m.call(this,void 0)},c.prototype.getVelocity=function(){return l.call(this)},c.prototype.setVelocity=function(a){this.call(this,j(a))},c.prototype.isActive=function(){return!this.PE.isSleeping()},c.prototype.halt=function(){this.set(this.get())},c.prototype.get=function(){return n.call(this),k.call(this)},c.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,f.call(this),o.call(this,b),h.call(this,a),void m.call(this,c)):(this.reset(a),void(c&&c()))},b.exports=c},{"../math/Vector":42,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/constraints/Wall":61,"../physics/forces/Spring":69}],93:[function(a,b){b.exports={CachedMap:a("./CachedMap"),Easing:a("./Easing"),MultipleTransition:a("./MultipleTransition"),SnapTransition:a("./SnapTransition"),SpringTransition:a("./SpringTransition"),Transitionable:a("./Transitionable"),TransitionableTransform:a("./TransitionableTransform"),TweenTransition:a("./TweenTransition"),WallTransition:a("./WallTransition")}},{"./CachedMap":84,"./Easing":85,"./MultipleTransition":86,"./SnapTransition":87,"./SpringTransition":88,"./Transitionable":89,"./TransitionableTransform":90,"./TweenTransition":91,"./WallTransition":92}],94:[function(a,b){var c={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};b.exports=c},{}],95:[function(a,b){function c(a){return j.on(k,a),a}function d(a,b){var d=l(),e=function(){var c=l();c-d>=b&&(a.apply(this,arguments),j.removeListener(k,e))};return c(e)}function e(a,b){var d=l(),e=function(){var c=l();c-d>=b&&(a.apply(this,arguments),d=l())};return c(e)}function f(a,b){if(void 0===b)return void 0;var d=function(){b--,0>=b&&(a.apply(this,arguments),h(d))};return c(d)}function g(a,b){b=b||1;var d=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=d)};return c(e)}function h(a){j.removeListener(k,a)}function i(a,b){var c,e,f,g,i;return function(){e=this,i=arguments,f=l();var j=function(){var h=l-f;b>h?c=d(j,b-h):(c=null,g=a.apply(e,i))};return h(c),c=d(j,b),g}}var j=a("../core/Engine"),k="prerender",l=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};b.exports={setTimeout:d,setInterval:e,debounce:i,after:f,every:g,clear:h}},{"../core/Engine":4}],96:[function(a,b){var c={};c.Direction={X:0,Y:1,Z:2},c.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},c.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},c.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},c.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var d in a)if("object"==typeof a[d]&&null!==a[d])if(a[d]instanceof Array){b[d]=new Array(a[d].length);for(var e=0;e<a[d].length;e++)b[d][e]=c.clone(a[d][e])}else b[d]=c.clone(a[d]);else b[d]=a[d]}else b=a;return b},b.exports=c},{}],97:[function(a,b){b.exports={KeyCodes:a("./KeyCodes"),Timer:a("./Timer"),Utility:a("./Utility")}},{"./KeyCodes":94,"./Timer":95,"./Utility":96}],98:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this._id=d.register(this)}var d=a("../core/Entity"),e=(a("../core/Transform"),a("../core/EventHandler")),f=a("../core/OptionsManager");c.DEFAULT_OPTIONS={},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},c.prototype.render=function(){return this._id},c.prototype.commit=function(){},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15}],99:[function(a,b){function c(){j.apply(this,arguments),this.state=new h(0),this._isOpen=!1,this.setOutputFunction(function(a,b,c){var e=d.call(this),g=this.options.direction===i.Direction.X?f.translate(e*b,0,.001*(e-1)*b):f.translate(0,e*b,.001*(e-1)*b),h=a.render();if(this.options.stackRotation){var j=this.options.stackRotation*c*(1-e);h={transform:f.rotateZ(j),origin:[.5,.5],target:h}}return{transform:g,size:a.getSize(),target:h}})}function d(a){return a?this._isOpen?1:0:this.state.get()}function e(a,b,c){this.state.halt(),this.state.set(a,b,c)}var f=a("../core/Transform"),g=a("../core/OptionsManager"),h=a("../transitions/Transitionable"),i=a("../utilities/Utility"),j=a("./SequentialLayout");c.prototype=Object.create(j.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS=g.patch(j.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),c.prototype.getSize=function(){var a=j.prototype.getSize.apply(this,arguments),b=this._items?this._items.get().getSize():[0,0];b||(b=[0,0]);var c=d.call(this),e=1-c;return[b[0]*e+a[0]*c,b[1]*e+a[1]*c]},c.prototype.isOpen=function(){return this._isOpen},c.prototype.open=function(a){this._isOpen=!0,e.call(this,1,this.options.transition,a)},c.prototype.close=function(a){this._isOpen=!1,e.call(this,0,this.options.transition,a)},c.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},b.exports=c},{"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":89,"../utilities/Utility":96,"./SequentialLayout":111}],100:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._position=new l(0),this._direction=d(this.options.side),this._orientation=e(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new i,this.content=new i,this._eventInput=new m,this._eventOutput=new m,m.setInputHandler(this,this._eventInput),m.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",g.bind(this)),this._eventInput.on("end",h.bind(this))}function d(a){var b=c.SIDES;return a===b.LEFT||a===b.RIGHT?n:o}function e(a){var b=c.SIDES;return a===b.LEFT||a===b.TOP?1:-1}function f(a){var b,c=this.options;if(c.drawerLength)b=c.drawerLength;else{var d=a.getSize();b=d?d[this._direction]:c.drawerLength}return this._orientation*b}function g(a){var b,c,d=this.getPosition()+a.delta;this._cachedLength=f.call(this,this.drawer),1===this._orientation?(b=0,c=this._cachedLength):(b=this._cachedLength,c=0),d>c?d=c:b>d&&(d=b),this.setPosition(d)}function h(a){var b=a.velocity,c=this._orientation*this.getPosition(),d=this.options,e=this._orientation*this._cachedLength,f=d.positionThreshold||e/2,g=d.velocityThreshold;if(d.transition instanceof Object&&(d.transition.velocity=a.velocity),0===c)return void(this._isOpen=!1);if(c===e)return void(this._isOpen=!0);var h=Math.abs(b)>g||!this._isOpen&&c>f||this._isOpen&&f>c;h?this.toggle():this.reset()}var i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager"),l=a("../transitions/Transitionable"),m=a("../core/EventHandler"),n=0,o=1;c.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},c.DEFAULT_OPTIONS={side:c.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},c.prototype.setOptions=function(a){this._optionsManager.setOptions(a),void 0!==a.side&&(this._direction=d(a.side),this._orientation=e(a.side))},c.prototype.open=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this._cachedLength=f.call(this,this.drawer),this.setPosition(this._cachedLength,a,b),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},c.prototype.close=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this.setPosition(0,a,b),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},c.prototype.setPosition=function(a,b,c){this._position.isActive()&&this._position.halt(),this._position.set(a,b,c)},c.prototype.getPosition=function(){return this._position.get()},c.prototype.setProgress=function(a,b,c){return this._position.set(a*this._cachedLength,b,c)},c.prototype.getProgress=function(){return this._position.get()/this._cachedLength},c.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},c.prototype.reset=function(a){this._isOpen?this.open(a):this.close(a)},c.prototype.isOpen=function(){return this._isOpen},c.prototype.render=function(){var a=this.getPosition();(!this._isOpen&&0>a&&1===this._orientation||a>0&&-1===this._orientation)&&(a=0,this.setPosition(a));var b=this._direction===n?j.translate(a,0,0):j.translate(0,a,0);return[{transform:j.behind,target:this.drawer.render()},{transform:b,target:this.content.render()}]},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89}],101:[function(a,b){function c(a){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new i(a),this._controller.inTransformFrom(e.create(d.bind(this,1e-4))),this._controller.outTransformFrom(e.create(d.bind(this,-1e-4))),this._eventInput=new g,g.setInputHandler(this,this._eventInput),this._entityId=f.register(this),a&&this.setOptions(a)}function d(a,b){return h.translate(this._size[0]*(1-b),0,a*(1-b))}var e=a("../transitions/CachedMap"),f=a("../core/Entity"),g=a("../core/EventHandler"),h=a("../core/Transform"),i=a("./RenderController");c.prototype.show=function(a){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=a,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},c.prototype.setOptions=function(a){this._controller.setOptions(a)},c.prototype.render=function(){return this._entityId},c.prototype.commit=function(a){return this._size[0]=a.size[0],this._size[1]=a.size[1],{transform:a.transform,opacity:a.opacity,origin:a.origin,size:a.size,target:this._controller.render()}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Transform":15,"../transitions/CachedMap":84,"./RenderController":107}],102:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new h(this.options),a&&this.setOptions(a),this.id=f.register(this),this._ratios=new j(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new i,i.setOutputHandler(this,this._eventOutput)}function d(a,b,d){var e,f,h,i,j=0,k=b,l=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<a.length;i++)f=a[i],h=this._nodes[i],"number"!=typeof f?k-=h.getSize()[d]||0:l+=f;for(i=0;i<a.length;i++)h=this._nodes[i],f=a[i],b="number"==typeof f?k*f/l:h.getSize()[d],e=d===c.DIRECTION_X?g.translate(j,0,0):g.translate(0,j,0),this._cachedTransforms.push(e),this._cachedLengths.push(b),j+=b}function e(a,b){for(var c=0;c<a.length;c++)if("number"!=typeof a[c]&&this._nodes[c].getSize()[b]!==this._cachedLengths[c])return!0;return!1}var f=a("../core/Entity"),g=a("../core/Transform"),h=a("../core/OptionsManager"),i=a("../core/EventHandler"),j=a("../transitions/Transitionable");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DEFAULT_OPTIONS={direction:c.DIRECTION_X,transition:!1,ratios:[]},c.prototype.render=function(){return this.id},c.prototype.setOptions=function(a){this.optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(a){if(this._nodes=a,0===this._ratios.get().length){for(var b=[],c=0;c<this._nodes.length;c++)b.push(1);this.setRatios(b)}},c.prototype.setRatios=function(a,b,c){void 0===b&&(b=this.options.transition);var d=this._ratios;0===d.get().length&&(b=void 0),d.isActive()&&d.halt(),d.set(a,b,c),this._ratiosDirty=!0},c.prototype.getSize=function(){return this._size},c.prototype.commit=function(a){var b,c=a.size,f=a.transform,h=a.origin,i=a.opacity,j=this._ratios.get(),k=this.options.direction,l=c[k];(l!==this._size[k]||this._ratiosDirty||this._ratios.isActive()||k!==this._cachedDirection||e.call(this,j,k))&&(d.call(this,j,l,k),l!==this._size[k]&&(this._size[0]=c[0],this._size[1]=c[1]),k!==this._cachedDirection&&(this._cachedDirection=k),this._ratiosDirty&&(this._ratiosDirty=!1));for(var m=[],n=0;n<j.length;n++)b=[void 0,void 0],l=this._cachedLengths[n],b[k]=l,m.push({transform:this._cachedTransforms[n],size:b,target:this._nodes[n].render()});return c&&0!==h[0]&&0!==h[1]&&(f=g.moveThen([-c[0]*h[0],-c[1]*h[1],0],f)),{transform:f,size:c,opacity:i,target:m}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Transform":15,"../transitions/Transitionable":89}],103:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this.angle=new e(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var d=a("../core/Transform"),e=a("../transitions/Transitionable"),f=(a("../core/RenderNode"),a("../core/OptionsManager"));c.DIRECTION_X=0,c.DIRECTION_Y=1;var g=1;c.DEFAULT_OPTIONS={transition:!0,direction:c.DIRECTION_X},c.prototype.flip=function(a,b){var c=this.flipped?0:Math.PI;this.setAngle(c,a,b),this.flipped=!this.flipped},c.prototype.setAngle=function(a,b,c){void 0===b&&(b=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(a,b,c)},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.setFront=function(a){this.frontNode=a},c.prototype.setBack=function(a){this.backNode=a},c.prototype.render=function(){var a,b,e=this.angle.get();this.options.direction===c.DIRECTION_X?(a=d.rotateY(e),b=d.rotateY(e+Math.PI)):(a=d.rotateX(e),b=d.rotateX(e+Math.PI));var f=[];return this.frontNode&&f.push({transform:a,target:this.frontNode.render()}),this.backNode&&f.push({transform:d.moveThen([0,0,g],b),target:this.backNode.render()}),f},b.exports=c},{"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89}],104:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new l(this.options),a&&this.setOptions(a),this.id=g.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new j,j.setOutputHandler(this,this._eventOutput)}function d(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var g,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){g=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?e.call(this,k,[i,h],[g,j,0],1):f.call(this,k,[i,h],[g,j,0],1),k++,g+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)f.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function e(a,b,c,d){var e={transform:new n(h.translate.apply(null,c)),opacity:new m(d),size:new m(b)},f=new k({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function f(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var g=a("../core/Entity"),h=(a("../core/RenderNode"),a("../core/Transform")),i=a("../core/ViewSequence"),j=a("../core/EventHandler"),k=a("../core/Modifier"),l=a("../core/OptionsManager"),m=a("../transitions/Transitionable"),n=a("../transitions/TransitionableTransform");c.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},c.prototype.render=function(){return this.id},c.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new i(a)),this.sequence=a},c.prototype.getSize=function(){return this._contextSizeCache},c.prototype.commit=function(a){var b=a.transform,c=a.opacity,e=a.origin,f=a.size,g=this.options.dimensions[0],i=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||i!==this._dimensionsCache[1])&&d.call(this,f,g,i);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:e,target:m.render()})),j=j.getNext(),l++}return f&&(b=h.moveThen([-f[0]*e[0],-f[1]*e[1],0],b)),{transform:b,opacity:c,size:f,target:k}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../core/ViewSequence":17,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90}],105:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this.setOptions(a),this._entityId=g.register(this),this.header=new h,this.footer=new h,this.content=new h}function d(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function e(a){return this.options.direction===c.DIRECTION_X?i.translate(a,0,0):i.translate(0,a,0)}function f(a,b){return this.options.direction===c.DIRECTION_X?[a,b[1]]:[b[0],a]}var g=a("../core/Entity"),h=a("../core/RenderNode"),i=a("../core/Transform"),j=a("../core/OptionsManager");c.DIRECTION_X=0,c.DIRECTION_Y=1,c.DEFAULT_OPTIONS={direction:c.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},c.prototype.render=function(){return this._entityId
},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.commit=function(a){var b=a.transform,c=a.origin,g=a.size,h=a.opacity,j=void 0!==this.options.headerSize?this.options.headerSize:d.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:d.call(this,this.footer,this.options.defaultFooterSize),l=g[this.options.direction]-j-k;g&&(b=i.moveThen([-g[0]*c[0],-g[1]*c[1],0],b));var m=[{size:f.call(this,j,g),target:this.header.render()},{transform:e.call(this,j),size:f.call(this,l,g),target:this.content.render()},{transform:e.call(this,j+l),size:f.call(this,k,g),target:this.footer.render()}];return{transform:b,opacity:h,size:g,target:m}},b.exports=c},{"../core/Entity":5,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15}],106:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var d=a("../core/Transform"),e=a("../core/Modifier"),f=a("../core/RenderNode"),g=a("../utilities/Utility"),h=a("../core/OptionsManager"),i=a("../transitions/Transitionable"),j=a("../transitions/TransitionableTransform");c.DEFAULT_OPTIONS={inTransform:d.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:d.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:d.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,a,b,c));this.hide()}this._showing=!0;var d={transform:new j(this.options.inTransform),origin:new i(this.options.inOrigin),align:new i(this.options.inAlign),opacity:new i(this.options.inOpacity)},h=new e({transform:d.transform,opacity:d.opacity,origin:d.origin,align:d.align}),k=new f;k.add(h).add(a),this.nodes.push(k),this.states.push(d),this.transforms.push(h);var l=c?g.after(3,c):void 0;b||(b=this.options.inTransition),d.transform.set(this.options.showTransform,b,l),d.opacity.set(this.options.showOpacity,b,l),d.origin.set(this.options.showOrigin,b,l),d.align.set(this.options.showAlign,b,l)},c.prototype.hide=function(a,b){if(this._showing){this._showing=!1,a instanceof Function&&(b=a,a=void 0);var c=this.nodes[this.nodes.length-1],d=this.transforms[this.transforms.length-1],e=this.states[this.states.length-1],f=g.after(3,function(){this.nodes.splice(this.nodes.indexOf(c),1),this.states.splice(this.states.indexOf(e),1),this.transforms.splice(this.transforms.indexOf(d),1),b&&b.call(this)}.bind(this));a||(a=this.options.outTransition),e.transform.set(this.options.outTransform,a,f),e.opacity.set(this.options.outOpacity,a,f),e.origin.set(this.options.outOrigin,a,f),e.align.set(this.options.outAlign,a,f)}},c.prototype.render=function(){for(var a=[],b=0;b<this.nodes.length;b++)a.push(this.nodes[b].render());return a},b.exports=c},{"../core/Modifier":9,"../core/OptionsManager":10,"../core/RenderNode":11,"../core/Transform":15,"../transitions/Transitionable":89,"../transitions/TransitionableTransform":90,"../utilities/Utility":96}],107:[function(a,b){function c(){i.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=c.DefaultMap.transform,this.inOpacityMap=c.DefaultMap.opacity,this.inOriginMap=c.DefaultMap.origin,this.inAlignMap=c.DefaultMap.align,this.outTransformMap=c.DefaultMap.transform,this.outOpacityMap=c.DefaultMap.opacity,this.outOriginMap=c.DefaultMap.origin,this.outAlignMap=c.DefaultMap.align,this._output=[]}function d(a,b){return a(b.get())}var e=a("../core/Modifier"),f=a("../core/RenderNode"),g=a("../core/Transform"),h=a("../transitions/Transitionable"),i=a("../core/View");c.prototype=Object.create(i.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},c.DefaultMap={transform:function(){return g.identity},opacity:function(a){return a},origin:null,align:null},c.prototype.inTransformFrom=function(a){if(a instanceof Function)this.inTransformMap=a;else{if(!a||!a.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=a.get.bind(a)}return this},c.prototype.inOpacityFrom=function(a){if(a instanceof Function)this.inOpacityMap=a;else{if(!a||!a.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=a.get.bind(a)}return this},c.prototype.inOriginFrom=function(a){if(a instanceof Function)this.inOriginMap=a;else{if(!a||!a.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=a.get.bind(a)}return this},c.prototype.inAlignFrom=function(a){if(a instanceof Function)this.inAlignMap=a;else{if(!a||!a.get)throw new Error("inAlignFrom takes only function or getter object");this.inAlignMap=a.get.bind(a)}return this},c.prototype.outTransformFrom=function(a){if(a instanceof Function)this.outTransformMap=a;else{if(!a||!a.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=a.get.bind(a)}return this},c.prototype.outOpacityFrom=function(a){if(a instanceof Function)this.outOpacityMap=a;else{if(!a||!a.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=a.get.bind(a)}return this},c.prototype.outOriginFrom=function(a){if(a instanceof Function)this.outOriginMap=a;else{if(!a||!a.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=a.get.bind(a)}return this},c.prototype.outAlignFrom=function(a){if(a instanceof Function)this.outAlignMap=a;else{if(!a||!a.get)throw new Error("outAlignFrom takes only function or getter object");this.outAlignMap=a.get.bind(a)}return this},c.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=a:(this._nextRenderable=a,this.hide(function(){this._nextRenderable===a&&this.show(this._nextRenderable,c),this._nextRenderable=null})));this.hide()}var g=null,i=this._renderables.indexOf(a);if(i>=0){this._showing=i,g=this._states[i],g.halt();var j=this._outgoingRenderables.indexOf(a);j>=0&&this._outgoingRenderables.splice(j,1)}else{g=new h(0);var k=new e({transform:this.inTransformMap?d.bind(this,this.inTransformMap,g):null,opacity:this.inOpacityMap?d.bind(this,this.inOpacityMap,g):null,origin:this.inOriginMap?d.bind(this,this.inOriginMap,g):null,align:this.inAlignMap?d.bind(this,this.inAlignMap,g):null}),l=new f;l.add(k).add(a),this._showing=this._nodes.length,this._nodes.push(l),this._modifiers.push(k),this._states.push(g),this._renderables.push(a)}b||(b=this.options.inTransition),g.set(1,b,c)},c.prototype.hide=function(a,b){if(!(this._showing<0)){var c=this._showing;this._showing=-1,a instanceof Function&&(b=a,a=void 0);var e=this._nodes[c],f=this._modifiers[c],g=this._states[c],h=this._renderables[c];f.transformFrom(this.outTransformMap?d.bind(this,this.outTransformMap,g):null),f.opacityFrom(this.outOpacityMap?d.bind(this,this.outOpacityMap,g):null),f.originFrom(this.outOriginMap?d.bind(this,this.outOriginMap,g):null),f.alignFrom(this.outAlignMap?d.bind(this,this.outAlignMap,g):null),this._outgoingRenderables.indexOf(h)<0&&this._outgoingRenderables.push(h),a||(a=this.options.outTransition),g.halt(),g.set(0,a,function(a,c,d,e){if(this._outgoingRenderables.indexOf(e)>=0){var f=this._nodes.indexOf(a);this._nodes.splice(f,1),this._modifiers.splice(f,1),this._states.splice(f,1),this._renderables.splice(f,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(e),1),this._showing>=f&&this._showing--}b&&b.call(this)}.bind(this,e,f,g,h))}},c.prototype.render=function(){var a=this._output;a.length>this._nodes.length&&a.splice(this._nodes.length);for(var b=0;b<this._nodes.length;b++)a[b]=this._nodes[b].render();return a},b.exports=c},{"../core/Modifier":9,"../core/RenderNode":11,"../core/Transform":15,"../core/View":16,"../transitions/Transitionable":89}],108:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this.container=new d(this.options.container),this.scrollview=new f(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new e,e.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var d=a("../surfaces/ContainerSurface"),e=a("../core/EventHandler"),f=a("./Scrollview"),g=(a("../utilities/Utility"),a("../core/OptionsManager"));c.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},c.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},c.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},c.prototype.render=function(){return this.container.render()},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../surfaces/ContainerSurface":76,"../utilities/Utility":96,"./Scrollview":110}],109:[function(a,b){function c(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new j(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new i,this.group.add({render:g.bind(this)}),this._entityId=h.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput)}function d(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function e(a,b,c){var e=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),d.call(this,e)}function f(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?d.call(this,this.getCumulativeSize()):d.call(this,this._contextSize)}function g(){for(var a=null,b=this._position,c=[],g=-this._positionOffset,h=f.call(this),i=this._node;i&&g-b<h+this.options.margin;)g+=e.call(this,i,g,c),i=i.getNext?i.getNext():null;var j=this._node,k=d.call(this,j.getSize());if(h>g){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=d.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=d.call(this,j.getSize()))}for(!i&&h-o>g-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:g-h})):!this._node.getPrevious()&&-o>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,g=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,g-=d.call(this,a));i&&g-b>-(h+this.options.margin);)e.call(this,i,g,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,g-=d.call(this,a));return c}var h=a("../core/Entity"),i=a("../core/Group"),j=a("../core/OptionsManager"),k=a("../core/Transform"),l=a("../utilities/Utility"),m=a("../core/ViewSequence"),n=a("../core/EventHandler");c.DEFAULT_OPTIONS={direction:l.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var o=0;c.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},c.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},c.prototype.onEdge=function(){return this._onEdge},c.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===l.Direction.X?k.translate(a,0):k.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return k.inverse(a(-b))}},c.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},c.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new m({array:a})),this._node=a,this._positionOffset=0},c.prototype.getSize=function(a){return a?this._contextSize:this._size},c.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},c.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===l.Direction.X?(this._size[0]=f.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=f.call(this)));var g=this._masterOutputFunction(-this._position);return{transform:k.multiply(b,g),size:e,opacity:c,origin:d,target:this.group.render()}},b.exports=c},{"../core/Entity":5,"../core/EventHandler":7,"../core/Group":8,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":96}],110:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),this._scroller=new w(this.options),this.sync=new y(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==x.Direction.Y}),this._physicsEngine=new p,this._particle=new q,this._physicsEngine.addBody(this._particle),this.spring=new s({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new r({forceFunction:r.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new r({forceFunction:r.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=B.NONE,this._onEdge=C.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new t,this._eventOutput=new t,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),t.setInputHandler(this,this._eventInput),t.setOutputHandler(this,this._eventOutput),g.call(this),a&&this.setOptions(a)}function d(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),i.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function e(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==C.NONE&&a.slip&&(0>b&&this._onEdge===C.TOP||b>0&&this._onEdge===C.BOTTOM?this._earlyEnd||(f.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&d.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var e=this.options.speedLimit;-e>b?b=-e:b>e&&(b=e),this.setVelocity(b);var g=16*e;c>g?c=g:-g>c&&(c=-g)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===B.NONE&&n.call(this)}}function f(a){if(this._touchCount=a.count||0,!this._touchCount){i.call(this),this._onEdge!==C.NONE&&m.call(this,this._edgeSpringPosition,B.EDGE),h.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function g(){this._eventInput.bindThis(this),this._eventInput.on("start",d),this._eventInput.on("update",e),this._eventInput.on("end",f),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,k.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===B.NONE&&n.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==B.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function h(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function i(){this._springState=B.NONE,this._physicsEngine.detachAll()}function j(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function k(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===B.EDGE||m.call(this,this._edgeSpringPosition,B.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(i.call(this),h.call(this))}function l(){if(!this._touchCount&&this._springState!==B.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=j.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():m.call(this,0,B.PAGE)}}}function m(a,b){var c;b===B.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===B.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(i.call(this),this._springState=b,h.call(this)),this._springState=b}function n(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=j.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=j.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=j.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&o.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function o(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===B.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===B.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var p=a("../physics/PhysicsEngine"),q=a("../physics/bodies/Particle"),r=a("../physics/forces/Drag"),s=a("../physics/forces/Spring"),t=a("../core/EventHandler"),u=a("../core/OptionsManager"),v=a("../core/ViewSequence"),w=a("../views/Scroller"),x=a("../utilities/Utility"),y=a("../inputs/GenericSync"),z=a("../inputs/ScrollSync"),A=a("../inputs/TouchSync");y.register({scroll:z,touch:A});var B={NONE:0,EDGE:1,PAGE:2},C={TOP:-1,NONE:0,BOTTOM:1};c.DEFAULT_OPTIONS={direction:x.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},c.prototype.getCurrentIndex=function(){return this._node.index},c.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===C.TOP)return null;if(this.getPosition()>1&&this._springState===B.NONE)return m.call(this,0,B.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=j.call(this,a);this._scroller.sequenceFrom(a),this._node=a,o.call(this,b),m.call(this,0,B.PAGE)}return a},c.prototype.goToNextPage=function(){if(!this._node||this._onEdge===C.BOTTOM)return null;var a=this._node.getNext();if(a){var b=j.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,o.call(this,-b),m.call(this,0,B.PAGE)}return a},c.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},c.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},c.prototype.getPosition=function(){return this._particle.getPosition1D()},c.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},c.prototype.getOffset=c.prototype.getPosition,c.prototype.setPosition=function(a){this._particle.setPosition1D(a)},c.prototype.setOffset=c.prototype.setPosition,c.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},c.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},c.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=x.Direction.X:"y"===a.direction&&(a.direction=x.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===x.Direction.X?y.DIRECTION_X:y.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},c.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new v({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},c.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},c.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&l.call(this),this._scroller.render()},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/ViewSequence":17,"../inputs/GenericSync":27,"../inputs/ScrollSync":32,"../inputs/TouchSync":34,"../physics/PhysicsEngine":49,"../physics/bodies/Particle":52,"../physics/forces/Drag":64,"../physics/forces/Spring":69,"../utilities/Utility":96,"../views/Scroller":109}],111:[function(a,b){function c(a){this._items=null,this._size=null,this._outputFunction=c.DEFAULT_OUTPUT_FUNCTION,this.options=h.clone(this.constructor.DEFAULT_OPTIONS||c.DEFAULT_OPTIONS),this.optionsManager=new d(this.options),this.id=e.register(this),this.cachedSize=[void 0,void 0],a&&this.setOptions(a)}var d=a("../core/OptionsManager"),e=a("../core/Entity"),f=a("../core/Transform"),g=a("../core/ViewSequence"),h=a("../utilities/Utility");c.DEFAULT_OPTIONS={direction:h.Direction.Y,itemSpacing:0},c.DEFAULT_OUTPUT_FUNCTION=function(a,b){var c=this.options.direction===h.Direction.X?f.translate(b,0):f.translate(0,b);return{size:this.cachedSize,transform:c,target:a.render()}},c.prototype.getSize=function(){return this._size||this.render(),this._size},c.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new g(a)),this._items=a,this},c.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},c.prototype.setOutputFunction=function(a){return this._outputFunction=a,this},c.prototype.render=function(){return this.id},c.prototype.commit=function(a){var b=0,c=1^this.options.direction,d=this._items,e=null,f=[],g={},h=[],i=0;for(this._size=[0,0],this.cachedSize=a.size;d&&(e=d.get());)e.getSize&&(f=e.getSize()),g=this._outputFunction.call(this,e,b,i++),h.push(g),f&&(f[this.options.direction]&&(b+=f[this.options.direction]),f[c]>this._size[c]&&(this._size[c]=f[c]),0===f[c]&&(this._size[c]=void 0)),d=d.getNext(),this.options.itemSpacing&&d&&(b+=this.options.itemSpacing);return this._size[this.options.direction]=b,{transform:a.transform,origin:a.origin,size:this.getSize(),target:h}},b.exports=c},{"../core/Entity":5,"../core/OptionsManager":10,"../core/Transform":15,"../core/ViewSequence":17,"../utilities/Utility":96}],112:[function(a,b){b.exports={ContextualView:a("./ContextualView"),Deck:a("./Deck"),DrawerLayout:a("./DrawerLayout"),EdgeSwapper:a("./EdgeSwapper"),FlexibleLayout:a("./FlexibleLayout"),Flipper:a("./Flipper"),GridLayout:a("./GridLayout"),HeaderFooterLayout:a("./HeaderFooterLayout"),Lightbox:a("./Lightbox"),RenderController:a("./RenderController"),ScrollContainer:a("./ScrollContainer"),Scroller:a("./Scroller"),Scrollview:a("./Scrollview"),SequentialLayout:a("./SequentialLayout")}},{"./ContextualView":98,"./Deck":99,"./DrawerLayout":100,"./EdgeSwapper":101,"./FlexibleLayout":102,"./Flipper":103,"./GridLayout":104,"./HeaderFooterLayout":105,"./Lightbox":106,"./RenderController":107,"./ScrollContainer":108,"./Scroller":109,"./Scrollview":110,"./SequentialLayout":111}],113:[function(a,b){function c(){g.apply(this,arguments),this.title=new e({classes:this.options.classes,content:this.options.content}),this.back=new e({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new e({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new d({id:"master",size:this.options.size,target:[{transform:f.inFront,origin:[0,.5],align:[0,.5],target:this.back},{origin:[.5,.5],align:[.5,.5],target:this.title},{transform:f.inFront,origin:[1,.5],align:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(a){var b=a.id,c=a.value;"size"===b?(this.layout.id.master.setSize(c),this.title.setSize(c),this.back.setSize([c[1],c[1]]),this.more.setSize([c[1],c[1]])):"backClasses"===b?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===b?this.back.setContent(this.options.backContent):"classes"===b?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===b?this.setContent(this.options.content):"moreClasses"===b?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===b&&this.more.setContent(this.options.content)}.bind(this))}var d=a("../core/Scene"),e=a("../core/Surface"),f=a("../core/Transform"),g=a("../core/View");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},c.prototype.setContent=function(a){return this.title.setContent(a)},b.exports=c},{"../core/Scene":12,"../core/Surface":14,"../core/Transform":15,"../core/View":16}],114:[function(a,b){function c(a){this.options=Object.create(c.DEFAULT_OPTIONS),this.optionsManager=new j(this.options),a&&this.setOptions(a),this.indicator=new f({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new e({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new h,this.eventInput=new h,h.setInputHandler(this,this.eventInput),h.setOutputHandler(this,this.eventOutput);var b=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new m(["mouse","touch"],{scale:b,direction:m.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(a){this.set(a.position)}.bind(this)),this._drawPos=0,d.call(this)}function d(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var e=a("../core/Surface"),f=a("../surfaces/CanvasSurface"),g=a("../core/Transform"),h=a("../core/EventHandler"),i=a("../math/Utilities"),j=a("../core/OptionsManager"),k=a("../inputs/MouseSync"),l=a("../inputs/TouchSync"),m=a("../inputs/GenericSync");m.register({mouse:k,touch:l}),c.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},c.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},c.prototype.get=function(){return this.options.value},c.prototype.set=function(a){a!==this.options.value&&(this.options.value=i.clamp(a,this.options.range),d.call(this),this.eventOutput.emit("change",{value:a}))},c.prototype.getSize=function(){return this.options.size},c.prototype.render=function(){var a=this.options.range,b=Math.floor((this.get()-a[0])/(a[1]-a[0])*this.options.indicatorSize[0]);if(b<this._drawPos)this.indicator.getContext("2d").clearRect(b,0,this._drawPos-b+1,this.options.indicatorSize[1]);else if(b>this._drawPos){var c=this.indicator.getContext("2d");c.fillStyle=this.options.fillColor,c.fillRect(this._drawPos-1,0,b-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=b,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:g.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},b.exports=c},{"../core/EventHandler":7,"../core/OptionsManager":10,"../core/Surface":14,"../core/Transform":15,"../inputs/GenericSync":27,"../inputs/MouseSync":28,"../inputs/TouchSync":34,"../math/Utilities":41,"../surfaces/CanvasSurface":75}],115:[function(a,b){function c(){g.apply(this,arguments),this.layout=new h,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",d.bind(this))}function d(a){var b=a.id,c=a.value;if("direction"===b)this.layout.setOptions({dimensions:e.call(this.buttons.length,this.options.direction)});else if("buttons"===b)for(var d in this.buttons)this.buttons[d].setOptions(c);else if("sections"===b)for(var f in this.options.sections)this.defineSection(f,this.options.sections[f])}function e(a,b){return b===f.Direction.X?[a,1]:[1,a]}var f=a("../utilities/Utility"),g=a("../core/View"),h=a("../views/GridLayout"),i=a("./ToggleButton");c.prototype=Object.create(g.prototype),c.prototype.constructor=c,c.DEFAULT_OPTIONS={sections:[],widget:i,size:[void 0,50],direction:f.Direction.X,buttons:{toggleMode:i.ON}},c.prototype.defineSection=function(a,b){var c,d=this._buttonIds[a];if(void 0===d){d=this.buttons.length,this._buttonIds[a]=d;var f=this.options.widget;c=new f,this.buttons[d]=c,this.layout.setOptions({dimensions:e(this.buttons.length,this.options.direction)})}else c=this.buttons[d],c.unbind("select",this._buttonCallbacks[a]);this.options.buttons&&c.setOptions(this.options.buttons),c.setOptions(b),this._buttonCallbacks[a]=this.select.bind(this,a),c.on("select",this._buttonCallbacks[a])},c.prototype.select=function(a){var b=this._buttonIds[a];this.buttons[b]&&this.buttons[b].isSelected()?this._eventOutput.emit("select",{id:a}):this.buttons[b]&&this.buttons[b].select();
for(var c=0;c<this.buttons.length;c++)c!==b&&this.buttons[c].deselect()},b.exports=c},{"../core/View":16,"../utilities/Utility":96,"../views/GridLayout":104,"./ToggleButton":116}],116:[function(a,b){function c(a){this.options={content:["",""],offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:c.TOGGLE,crossfade:!0},this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput),this.offSurface=new d,this.offSurface.on("click",function(){this.options.toggleMode!==c.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new d,this.onSurface.on("click",function(){this.options.toggleMode!==c.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new f({overlap:this.options.crossfade}),this.deselect(),a&&this.setOptions(a)}var d=a("../core/Surface"),e=a("../core/EventHandler"),f=a("../views/RenderController");c.OFF=0,c.ON=1,c.TOGGLE=2,c.prototype.select=function(a){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),a||this._eventOutput.emit("select")},c.prototype.deselect=function(a){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),a||this._eventOutput.emit("deselect")},c.prototype.isSelected=function(){return this.selected},c.prototype.setOptions=function(a){void 0!==a.content&&(a.content instanceof Array||(a.content=[a.content,a.content]),this.options.content=a.content,this.offSurface.setContent(this.options.content[0]),this.onSurface.setContent(this.options.content[1])),a.offClasses&&(this.options.offClasses=a.offClasses,this.offSurface.setClasses(this.options.offClasses)),a.onClasses&&(this.options.onClasses=a.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==a.size&&(this.options.size=a.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==a.toggleMode&&(this.options.toggleMode=a.toggleMode),void 0!==a.outTransition&&(this.options.outTransition=a.outTransition),void 0!==a.inTransition&&(this.options.inTransition=a.inTransition),void 0!==a.crossfade&&(this.options.crossfade=a.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},c.prototype.getSize=function(){return this.options.size},c.prototype.render=function(){return this.arbiter.render()},b.exports=c},{"../core/EventHandler":7,"../core/Surface":14,"../views/RenderController":107}],117:[function(a,b){b.exports={NavigationBar:a("./NavigationBar"),Slider:a("./Slider"),TabBar:a("./TabBar"),ToggleButton:a("./ToggleButton")}},{"./NavigationBar":113,"./Slider":114,"./TabBar":115,"./ToggleButton":116}]},{},[23])(23)}),define("famous/core/Entity",["require","exports","module"],function(a,b,c){function d(a){return h[a]}function e(a,b){h[a]=b}function f(a){var b=h.length;return e(b,a),b}function g(a){e(a,null)}var h=[];c.exports={register:f,unregister:g,get:d,set:e}}),define("famous/core/Transform",["require","exports","module"],function(a,b,c){function d(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function e(a){return Math.sqrt(d(a))}function f(a){return 0>a?-1:1}var g={};g.precision=1e-6,g.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},g.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},g.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},g.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return g.thenMove(b,[c,d,e])},g.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},g.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},g.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},g.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},g.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},g.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},g.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},g.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},g.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return g.thenMove(b,[c,d,e])},g.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},g.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},g.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},g.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},g.getTranslate=function(a){return[a[12],a[13],a[14]]},g.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},g.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},g.interpret=function(a){var b=[a[0],a[1],a[2]],c=f(b[0]),h=e(b),i=[b[0]+c*h,b[1],b[2]],j=2/d(i);if(j>=1/0)return{translate:g.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=g.multiply(k,a),m=[l[5],l[6]],n=f(m[0]),o=e(m),p=[m[0]+n*o,m[1]],q=2/d(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=g.multiply(r,k),t=g.multiply(s,a),u=g.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=g.multiply(t,u),s=g.multiply(u,s);var v={};return v.translate=g.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},g.average=function(a,b,c){c=void 0===c?.5:c;for(var d=g.interpret(a),e=g.interpret(b),f={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)f.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],f.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],f.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],f.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return g.build(f)},g.build=function(a){var b=g.scale(a.scale[0],a.scale[1],a.scale[2]),c=g.skew(a.skew[0],a.skew[1],a.skew[2]),d=g.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return g.thenMove(g.multiply(g.multiply(d,c),b),a.translate)},g.equals=function(a,b){return!g.notEquals(a,b)},g.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},g.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},g.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],g.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],c.exports=g}),define("famous/core/SpecParser",["require","exports","module","./Transform"],function(a,b,c){function d(){this.result={}}function e(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var f=a("./Transform");d._instance=new d,d.parse=function(a,b){return d._instance.parse(a,b)},d.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,f.identity),this.result},d.prototype.reset=function(){this.result={}};var g=[0,0];d.prototype._parseSpec=function(a,b,c){var d,h,i,j,k,l,m;if("number"==typeof a){if(d=a,i=b.transform,l=b.align||g,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=f.thenMove(i,e(n,c))}this.result[d]={transform:i,opacity:b.opacity,origin:b.origin||g,align:b.align||g,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=f.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=f.thenMove(i,e([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=f.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},c.exports=d}),define("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(a,b,c){function d(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function e(a,b,c){for(var d=g.parse(a,b),h=Object.keys(d),i=0;i<h.length;i++){var j=h[i],k=f.get(j),l=d[j];l.allocator=b.allocator;var m=k.commit(l);m?e(m,b,c):c[j]=l}}var f=a("./Entity"),g=a("./SpecParser");d.prototype.add=function(a){var b=a instanceof d?a:new d(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},d.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},d.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof d?a:this},d.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},d.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var d=b[c];if(void 0===this._resultCache[d]){var g=f.get(d);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},e(this.render(),a,this._resultCache)},d.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},c.exports=d}),define("famous/core/EventEmitter",["require","exports","module"],function(a,b,c){function d(){this.listeners={},this._owner=this}d.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},d.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},d.prototype.bindThis=function(a){this._owner=a},c.exports=d}),define("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(a,b,c){function d(){e.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var e=a("./EventEmitter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},d.setOutputHandler=function(a,b){b instanceof d&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},d.prototype.emit=function(a,b){e.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},d.prototype.trigger=d.prototype.emit,d.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},d.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},d.prototype.on=function(a){if(e.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},d.prototype.addListener=d.prototype.on,d.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},d.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},c.exports=d}),define("famous/core/ElementAllocator",["require","exports","module"],function(a,b,c){function d(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}d.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},d.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},d.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},d.prototype.getNodeCount=function(){return this.nodeCount},c.exports=d}),define("famous/utilities/Utility",["require","exports","module"],function(a,b,c){var d={};d.Direction={X:0,Y:1,Z:2},d.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},d.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},d.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},d.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var c in a)if("object"==typeof a[c]&&null!==a[c])if(a[c]instanceof Array){b[c]=new Array(a[c].length);for(var e=0;e<a[c].length;e++)b[c][e]=d.clone(a[c][e])}else b[c]=d.clone(a[c]);else b[c]=a[c]}else b=a;return b},c.exports=d}),define("famous/transitions/MultipleTransition",["require","exports","module","../utilities/Utility"],function(a,b,c){function d(a){this.method=a,this._instances=[],this.state=[]}var e=a("../utilities/Utility");d.SUPPORTS_MULTIPLE=!0,d.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},d.prototype.set=function(a,b,c){for(var d=e.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,d)},d.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},c.exports=d}),define("famous/transitions/TweenTransition",["require","exports","module"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function e(a,b,c){return(1-c)*a+c*b}function f(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function g(a,b){var c={curve:b.curve};return b.duration&&(c.duration=b.duration),b.speed&&(c.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(c.duration=a.duration),a.curve&&(c.curve=a.curve),a.speed&&(c.speed=a.speed)),"string"==typeof c.curve&&(c.curve=d.getCurve(c.curve)),c}function h(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function i(a,b,c){var d;if(a instanceof Array){d=[];for(var f=0;f<a.length;f++)d[f]="number"==typeof a[f]?e(a[f],b[f],c):a[f]}else d=e(a,b,c);return d}d.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},d.SUPPORTS_MULTIPLE=!0,d.DEFAULT_OPTIONS={curve:d.Curves.linear,duration:500,speed:0};var j={};d.registerCurve=function(a,b){return j[a]?!1:(j[a]=b,!0)},d.unregisterCurve=function(a){return j[a]?(delete j[a],!0):!1},d.getCurve=function(a){var b=j[a];if(void 0!==b)return b;throw new Error("curve not registered")},d.getCurves=function(){return j},d.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=f(this.get()),b=g(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var e=0;for(var h in d)e+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(e)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=f(a),this._startVelocity=f(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},d.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=f(a),this.velocity=f(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},d.prototype.getVelocity=function(){return this.velocity},d.prototype.get=function(a){return this.update(a),this.state},d.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=h(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=i(this._startValue,this._endValue,this._curve(c)),this.velocity=h(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},d.prototype.isActive=function(){return this._active},d.prototype.halt=function(){this.reset(this.get())},d.registerCurve("linear",d.Curves.linear),d.registerCurve("easeIn",d.Curves.easeIn),d.registerCurve("easeOut",d.Curves.easeOut),d.registerCurve("easeInOut",d.Curves.easeInOut),d.registerCurve("easeOutBounce",d.Curves.easeOutBounce),d.registerCurve("spring",d.Curves.spring),d.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},c.exports=d}),define("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(a,b,c){function d(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function e(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],d=this.currentAction[1];d instanceof Object&&d.method?(b=d.method,"string"==typeof b&&(b=h[b])):b=g,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new f(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(d.velocity=this.velocity),this._engineInstance.set(c,d,e.bind(this))}var f=a("./MultipleTransition"),g=a("./TweenTransition"),h={};d.register=function(a){var b=!0;for(var c in a)d.registerMethod(c,a[c])||(b=!1);return b},d.registerMethod=function(a,b){return a in h?!1:(h[a]=b,!0)},d.unregisterMethod=function(a){return a in h?(delete h[a],!0):!1},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var d=[a,b];return this.actionQueue.push(d),this.callbackQueue.push(c),this.currentAction||e.call(this),this},d.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},d.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},d.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},d.prototype.isActive=function(){return!!this.currentAction},d.prototype.halt=function(){return this.set(this.get())},c.exports=d}),define("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","../transitions/Transitionable"],function(a,b,c){function d(a){return[a.clientWidth,a.clientHeight]}function e(a){this.container=a,this._allocator=new h(a),this._node=new f,this._eventOutput=new g,this._size=d(this.container),this._perspectiveState=new j(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:i.identity,opacity:1,origin:k,align:k,size:this._size},this._eventOutput.on("resize",function(){this.setSize(d(this.container))}.bind(this))}var f=a("./RenderNode"),g=a("./EventHandler"),h=a("./ElementAllocator"),i=a("./Transform"),j=a("../transitions/Transitionable"),k=[0,0],l=!("perspective"in document.documentElement.style),m=l?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};e.prototype.getAllocator=function(){return this._allocator},e.prototype.add=function(a){return this._node.add(a)},e.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},e.prototype.getSize=function(){return this._size},e.prototype.setSize=function(a){a||(a=d(this.container)),this._size[0]=a[0],this._size[1]=a[1]},e.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(m(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},e.prototype.getPerspective=function(){return this._perspectiveState.get()},e.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},e.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},e.prototype.on=function(a,b){return this._eventOutput.on(a,b)},e.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},e.prototype.pipe=function(a){return this._eventOutput.pipe(a)},e.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.exports=e}),define("famous/core/ElementOutput",["require","exports","module","./Entity","./EventHandler","./Transform"],function(a,b,c){function d(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new k,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=j.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function e(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function f(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function g(a){a[12]=Math.round(a[12]*n)/n,a[13]=Math.round(a[13]*n)/n;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function h(a){return 100*a[0]+"% "+100*a[1]+"%"}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./Entity"),k=a("./EventHandler"),l=a("./Transform"),m=!("transform"in document.documentElement.style),n=window.devicePixelRatio||1;d.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},d.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},d.prototype.render=function(){return this.id};var o;o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=g(b)}:m?function(a,b){a.style.webkitTransform=g(b)}:function(a,b){a.style.transform=g(b)};var p=m?function(a,b){a.style.webkitTransformOrigin=h(b)}:function(a,b){a.style.transformOrigin=h(b)},q=m?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};d.prototype.commit=function(a){var b=this._element;if(b){{var c=a.transform,d=a.opacity,e=a.origin;a.size}if(!c&&this._matrix)return this._matrix=null,this._opacity=0,void q(b);if(i(this._origin,e)&&(this._originDirty=!0),l.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,p(b,this._origin),this._originDirty=!1),c||(c=l.identity),this._matrix=c;var f=this._size?l.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;o(b,f),this._transformDirty=!1}}},d.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},d.prototype.attach=function(a){this._element=a,e.call(this,a)},d.prototype.detach=function(){var a=this._element;return a&&(f.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},c.exports=d}),define("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(a,b,c){function d(a){this._value=a,this.eventOutput=null}function e(){this.eventOutput=new f,this.eventOutput.bindThis(this),f.setOutputHandler(this,this.eventOutput)}var f=a("./EventHandler");d.patch=function(a){for(var b=new d(a),c=1;c<arguments.length;c++)b.patch(arguments[c]);return a},d.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},d.prototype.setOptions=d.prototype.patch,d.prototype.key=function(a){var b=new d(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},d.prototype.get=function(a){return a?this._value[a]:this._value},d.prototype.getOptions=d.prototype.get,d.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(a,b,c){function d(){y.runLoop?(o.step(),window.requestAnimationFrame(d)):v=!1}function e(){for(var a=0;a<p.length;a++)p[a].emit("resize");x.emit("resize")}function f(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),g()}function g(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void o.nextTick(g)}function h(a,b){return document.body?void document.body.addEventListener(a,b):void o.nextTick(addEventListener.bind(this,a,b))}function i(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void o.nextTick(i.bind(this,a,b))}var j,k,l=a("./Context"),m=a("./EventHandler"),n=a("./OptionsManager"),o={},p=[],q=[],r=0,s=0,t=[],u=Date.now(),v=!0,w={},x=new m,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},z=new n(y),A=10;
o.step=function(){r++,s=r;var a=Date.now();if(!(k&&k>a-u)){var b=0;j=a-u,u=a,x.emit("prerender");for(var c=q.length;c--;)q.shift()(r);for(;t.length&&Date.now()-a<A;)t.shift().call(this);for(b=0;b<p.length;b++)p[b].update();x.emit("postrender")}},window.requestAnimationFrame(d),window.addEventListener("resize",e,!1),e();var B=!1;o.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(o):x.pipe(a)},o.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(o):x.unpipe(a)},o.on=function(a,b){return a in w||(w[a]=x.emit.bind(x,a),h(a,w[a])),x.on(a,b)},o.emit=function(a,b){return x.emit(a,b)},o.removeListener=function(a,b){return x.removeListener(a,b)},o.getFPS=function(){return 1e3/j},o.setFPSCap=function(a){k=Math.floor(1e3/a)},o.getOptions=function(a){return z.getOptions(a)},o.setOptions=function(){return z.setOptions.apply(z,arguments)},o.createContext=function(a){!B&&y.appMode&&o.nextTick(f);var b=!1;a||(a=document.createElement(y.containerType),a.classList.add(y.containerClass),b=!0);var c=new l(a);return o.registerContext(c),b&&i(c,a),c},o.registerContext=function(a){return p.push(a),a},o.getContexts=function(){return p},o.deregisterContext=function(a){var b=p.indexOf(a);b>=0&&p.splice(b,1)},o.nextTick=function(a){q.push(a)},o.defer=function(a){t.push(a)},z.on("change",function(a){"fpsCap"===a.id?o.setFPSCap(a.value):"runLoop"===a.id&&!v&&a.value&&(v=!0,window.requestAnimationFrame(d))}),c.exports=o}),define("famous/core/Surface",["require","exports","module","./ElementOutput"],function(a,b,c){function d(a){k.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function e(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function f(a){for(var b in this.properties)a.style[b]=this.properties[b]}function g(a){for(var b in this.properties)a.style[b]=""}function h(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function i(a){for(var b in this.attributes)a.removeAttribute(b)}function j(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var k=a("./ElementOutput");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[b]=a[b]}this._attributesDirty=!0},d.prototype.getAttributes=function(){return this.attributes},d.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},d.prototype.getProperties=function(){return this.properties},d.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},d.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},d.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},d.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},d.prototype.getClassList=function(){return this.classList},d.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},d.prototype.getContent=function(){return this.content},d.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},d.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},d.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){e.call(this,b);for(var d=this.getClassList(),g=0;g<d.length;g++)b.classList.add(d[g]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(f.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(h.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var i=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=i[0]),void 0===c[1]&&(c[1]=i[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}j(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),k.prototype.commit.call(this,a)},d.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",g.call(this,c),i.call(this,c);var d=this.getClassList();for(e.call(this,c),b=0;b<d.length;b++)c.classList.remove(d[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},d.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},d.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},d.prototype.getSize=function(){return this._size?this._size:this.size},d.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},c.exports=d}),define("famous/core/Group",["require","exports","module","./Context","./Transform","./Surface"],function(a,b,c){function d(a){g.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new e(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var e=a("./Context"),f=a("./Transform"),g=a("./Surface");d.SIZE_ZERO=[0,0],d.prototype=Object.create(g.prototype),d.prototype.elementType="div",d.prototype.elementClass="famous-group",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return g.prototype.render.call(this)},d.prototype.deploy=function(a){this.context.migrate(a)},d.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,e=a.opacity,h=a.size,i=g.prototype.commit.call(this,{allocator:a.allocator,transform:f.thenMove(b,[-c[0]*h[0],-c[1]*h[1],0]),opacity:e,origin:c,size:d.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:f.translate(-c[0]*h[0],-c[1]*h[1],0),origin:c,size:h}),i},c.exports=d}),define("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","../core/Transform","../utilities/Utility"],function(a,b,c){function d(a){this._final=h.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new g(this._finalTranslate),this.rotate=new g(this._finalRotate),this.skew=new g(this._finalSkew),this.scale=new g(this._finalScale),a&&this.set(a)}function e(){return h.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function f(){return h.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var g=a("./Transitionable"),h=a("../core/Transform"),i=a("../utilities/Utility");d.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=f.call(this),this.translate.set(a,b,c),this},d.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=f.call(this),this.scale.set(a,b,c),this},d.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=f.call(this),this.rotate.set(a,b,c),this},d.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=f.call(this),this.skew.set(a,b,c),this},d.prototype.set=function(a,b,c){var d=h.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?i.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},d.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},d.prototype.get=function(){return this.isActive()?e.call(this):this._final},d.prototype.getFinal=function(){return this._final},d.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},d.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},c.exports=d}),define("famous/core/Modifier",["require","exports","module","./Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:f.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function e(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var f=a("./Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},d.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},d.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},d.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},d.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},d.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},d.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new h(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},d.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new g(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},d.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new g(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},d.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new g(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},d.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new g(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},d.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new g(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},d.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},d.prototype.getTransform=function(){return this._transformGetter()},d.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},d.prototype.getOpacity=function(){return this._opacityGetter()},d.prototype.getOrigin=function(){return this._originGetter()},d.prototype.getAlign=function(){return this._alignGetter()},d.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},d.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},d.prototype.modify=function(a){return e.call(this),this._output.target=a,this._output},c.exports=d}),define("famous/core/Scene",["require","exports","module","./Transform","./Modifier","./RenderNode"],function(a,b,c){function d(a){this.id=null,this._objects=null,this.node=new k,this._definition=null,a&&this.load(a)}function e(a){for(var b in l)if(b in a){var c=a[b];return c instanceof Array||(c=[c]),l[b].apply(this,c)}}function f(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.align,g=a.size,h=i.identity;if(b instanceof Array)if(16===b.length&&"number"==typeof b[0])h=b;else for(var k=0;k<b.length;k++)h=i.multiply(h,e(b[k]));else b instanceof Function?h=b:b instanceof Object&&(h=e(b));var l=new j({transform:h,opacity:c,origin:d,align:f,size:g});return l}function g(a){for(var b=new k,c=0;c<a.length;c++){var d=h.call(this,a[c]);d&&b.add(d)}return b}function h(a){var b,c;if(a instanceof Array)b=g.call(this,a);else if(c=this._objects.length,a.render&&a.render instanceof Function)b=a;else if(a.target){var d=h.call(this,a.target),e=f.call(this,a);b=new k(e),b.add(d),a.id&&(this.id[a.id]=e)}else a.id&&(b=new k,this.id[a.id]=b);return this._objects[c]=b,b}var i=a("./Transform"),j=a("./Modifier"),k=a("./RenderNode"),l={translate:i.translate,rotate:i.rotate,rotateX:i.rotateX,rotateY:i.rotateY,rotateZ:i.rotateZ,rotateAxis:i.rotateAxis,scale:i.scale,skew:i.skew,matrix3d:function(){return arguments}};d.prototype.create=function(){return new d(this._definition)},d.prototype.load=function(a){this._definition=a,this.id={},this._objects=[],this.node.set(h.call(this,a))},d.prototype.add=function(){return this.node.add.apply(this.node,arguments)},d.prototype.render=function(){return this.node.render.apply(this.node,arguments)},c.exports=d}),define("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode","../utilities/Utility"],function(a,b,c){function d(a){this._node=new g,this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.options=h.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a)}var e=a("./EventHandler"),f=a("./OptionsManager"),g=a("./RenderNode"),h=a("../utilities/Utility");d.DEFAULT_OPTIONS={},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.setOptions=function(a){this._optionsManager.patch(a)},d.prototype.add=function(){return this._node.add.apply(this._node,arguments)},d.prototype._add=d.prototype.add,d.prototype.render=function(){return this._node.render()},d.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},c.exports=d}),define("famous/core/ViewSequence",["require","exports","module"],function(a,b,c){function d(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}d.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},d.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},d.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},d.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},d.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},d.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},d.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},d.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},d.prototype.indexOf=function(a){return this._.array.indexOf(a)},d.prototype.getIndex=function(){return this.index},d.prototype.toString=function(){return""+this.index},d.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},d.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.get=function(){return this._.getValue(this.index)},d.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},d.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},c.exports=d}),define("famous/events/EventArbiter",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){this.dispatchers={},this.currMode=void 0,this.setMode(a)}var e=a("../core/EventHandler");d.prototype.setMode=function(a){if(a!==this.currMode){var b=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=a,this.dispatchers[a]&&this.dispatchers[a].emit("pipe"),this.emit("change",{from:b,to:a})}},d.prototype.forMode=function(a){return this.dispatchers[a]||(this.dispatchers[a]=new e),this.dispatchers[a]},d.prototype.emit=function(a,b){if(void 0===this.currMode)return!1;b||(b={});var c=this.dispatchers[this.currMode];return c?c.trigger(a,b):void 0},c.exports=d}),define("famous/events/EventFilter",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){e.call(this),this._condition=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.emit=function(a,b){return this._condition(a,b)?e.prototype.emit.apply(this,arguments):void 0},d.prototype.trigger=d.prototype.emit,c.exports=d}),define("famous/events/EventMapper",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){e.call(this),this._mappingFunction=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.subscribe=null,d.prototype.unsubscribe=null,d.prototype.emit=function(a,b){var c=this._mappingFunction.apply(this,arguments);c&&c.emit instanceof Function&&c.emit(a,b)},d.prototype.trigger=d.prototype.emit,c.exports=d}),define("famous/inputs/Accumulator",["require","exports","module","../core/EventHandler","../transitions/Transitionable"],function(a,b,c){function d(a,b){void 0===b&&(b="update"),this._state=a&&a.get&&a.set?a:new g(a||0),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.on(b,e.bind(this))}function e(a){var b=a.delta,c=this.get();if(b.constructor===c.constructor){var d=b instanceof Array?[c[0]+b[0],c[1]+b[1]]:c+b;this.set(d)}}var f=a("../core/EventHandler"),g=a("../transitions/Transitionable");d.prototype.get=function(){return this._state.get()},d.prototype.set=function(a){this._state.set(a)},c.exports=d}),define("famous/inputs/DesktopEmulationMode",["require","exports","module"],function(){function a(a){window.addEventListener(a,function(a){return a.stopPropagation(),!1},!0)}var b="ontouchstart"in window;b&&(a("mousedown"),a("mousemove"),a("mouseup"),a("mouseleave"))}),define("famous/inputs/FastClick",["require","exports","module"],function(){!function(){if(window.CustomEvent){var a=300,b=500,c={},d={},e=Date.now;window.addEventListener("touchstart",function(a){for(var b=e(),d=0;d<a.changedTouches.length;d++){var f=a.changedTouches[d];c[f.identifier]=b}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b];delete c[d.identifier]}}),window.addEventListener("touchend",function(b){for(var f=e(),g=0;g<b.changedTouches.length;g++){var h=b.changedTouches[g],i=c[h.identifier];if(i&&a>f-i){var j=new window.CustomEvent("click",{bubbles:!0,detail:h});d[f]=b,b.target.dispatchEvent(j)}delete c[h.identifier]}}),window.addEventListener("click",function(a){var c=e();for(var f in d){var g=d[f];b>c-f?a instanceof window.MouseEvent&&a.target===g.target&&a.stopPropagation():delete d[f]}},!0)}}()}),define("famous/inputs/GenericSync",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b){this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function e(a,b){g[a]&&(this._syncs[a]=new g[a](b),this.pipeSync(a))}var f=a("../core/EventHandler");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DIRECTION_Z=2;var g={};d.register=function(a){for(var b in a)if(g[b]){if(g[b]!==a[b])throw new Error("Conflicting sync classes for key: "+b)}else g[b]=a[b]},d.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},d.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},d.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},d.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)e.call(this,a[b]);else if(a instanceof Object)for(var c in a)e.call(this,c,a[c])},c.exports=d}),define("famous/inputs/SyncUtils",["require","exports","module"],function(a,b,c){c.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}}),define("famous/inputs/MouseSync",["require","exports","module","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventInput=new j,this._eventOutput=new j,j.setInputHandler(this,this._eventInput),j.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",e.bind(this)),this._eventInput.on("mousemove",f.bind(this)),this._eventInput.on("mouseup",g.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",h.bind(this)):this._eventInput.on("mouseleave",g.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function e(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function f(a){if(0!==this._positionHistory.length){var b=i.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function g(a){if(this._down){var b=i.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function h(){if(this._down&&this._move&&!this._documentActive){var a=f.bind(this),b=function(c){g.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function i(a){var b,c,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],k=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(k)>Math.abs(n)?n=0:k=0),this.options.direction===d.DIRECTION_X?(c=k,this._position+=c):this.options.direction===d.DIRECTION_Y?(c=n,this._position+=c):(c=[k,n],this._position[0]+=k,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=k,this._displacement[1]+=n),e.delta=c,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=l.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,m);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/TwoFingerSync",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(){this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))
}var e=a("../core/EventHandler");d.calculateAngle=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.atan2(d,c)},d.calculateDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},d.calculateCenter=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};var f=Date.now;d.prototype.handleStart=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];this.touchAEnabled?this.touchBEnabled||(this.touchBId=c.identifier,this.touchBEnabled=!0,this.posB=[c.pageX,c.pageY],this.timestampB=f(),this._startUpdate(a)):(this.touchAId=c.identifier,this.touchAEnabled=!0,this.posA=[c.pageX,c.pageY],this.timestampA=f())}},d.prototype.handleMove=function(a){if(this.touchAEnabled&&this.touchBEnabled){for(var b,c=this.timestampA,d=this.timestampB,e=0;e<a.changedTouches.length;e++){var g=a.changedTouches[e];g.identifier===this.touchAId?(this.posA=[g.pageX,g.pageY],this.timestampA=f(),b=this.timestampA-c):g.identifier===this.touchBId&&(this.posB=[g.pageX,g.pageY],this.timestampB=f(),b=this.timestampB-d)}b&&this._moveUpdate(b)}},d.prototype.handleEnd=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];(c.identifier===this.touchAId||c.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},c.exports=d}),define("famous/inputs/PinchSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._displacement=0,this._previousDistance=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._previousDistance=e.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:e.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=e.calculateDistance(this.posA,this.posB),c=e.calculateCenter(this.posA,this.posB),d=this.options.scale,f=d*(b-this._previousDistance),g=f/a;this._previousDistance=b,this._displacement+=f,this._eventOutput.emit("update",{delta:f,velocity:g,distance:b,displacement:this._displacement,center:c,touches:[this.touchAId,this.touchBId]})},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/RotateSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._angle=0,this._previousAngle=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._angle=0,this._previousAngle=e.calculateAngle(this.posA,this.posB);var b=e.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:a.touches.length,angle:this._angle,center:b,touches:[this.touchAId,this.touchBId]})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=e.calculateAngle(this.posA,this.posB),d=e.calculateCenter(this.posA,this.posB),f=b*(c-this._previousAngle),g=f/a;this._angle+=f,this._eventOutput.emit("update",{delta:f,velocity:g,angle:this._angle,center:d,touches:[this.touchAId,this.touchBId]}),this._previousAngle=c},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/ScaleSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",e.bind(this))}function e(){this.touchAId=void 0,this.touchBId=void 0}var f=a("./TwoFingerSync"),g=a("../core/OptionsManager");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._scaleFactor=1,this._startDist=f.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:f.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=f.calculateDistance(this.posA,this.posB),d=f.calculateCenter(this.posA,this.posB),e=(c-this._startDist)/this._startDist,g=Math.max(1+b*e,0),h=(g-this._scaleFactor)/a;this._eventOutput.emit("update",{delta:e,scale:g,velocity:h,distance:c,center:d,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=g},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/ScrollSync",["require","exports","module","../core/EventHandler","../core/Engine","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",f.bind(this)),this._eventInput.on("wheel",f.bind(this)),this._inProgress=!1,this._loopBound=!1}function e(){if(this._inProgress&&k()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function f(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(h.on("prerender",e.bind(this)),this._loopBound=!0));var b=k(),c=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,g=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,g*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(g)?g=0:f=0);var i,l,m=Math.max(b-c,j),n=f/m,o=g/m,p=this.options.scale;this.options.direction===d.DIRECTION_X?(l=p*f,i=p*n,this._position+=l):this.options.direction===d.DIRECTION_Y?(l=p*g,i=p*o,this._position+=l):(l=[p*f,p*g],i=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=i,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=i}var g=a("../core/EventHandler"),h=a("../core/Engine"),i=a("../core/OptionsManager");d.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var j=8,k=Date.now;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/TouchTracker",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:k(),count:b.touches.length,history:c}}function e(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=d(c,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[c.identifier]||this.track(e)}}}function f(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function g(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[c.identifier]}}this.isTouched=!1}}function h(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function i(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new j,this.eventOutput=new j,j.setInputHandler(this,this.eventInput),j.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",e.bind(this)),this.eventInput.on("touchmove",f.bind(this)),this.eventInput.on("touchend",g.bind(this)),this.eventInput.on("touchcancel",g.bind(this)),this.eventInput.on("unpipe",h.bind(this)),this.isTouched=!1}var j=a("../core/EventHandler"),k=Date.now;i.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},c.exports=i}),define("famous/inputs/TouchSync",["require","exports","module","./TouchTracker","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventOutput=new j,this._touchTracker=new i({touchLimit:this.options.touchLimit}),j.setOutputHandler(this,this._eventOutput),j.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",e.bind(this)),this._touchTracker.on("trackmove",f.bind(this)),this._touchTracker.on("trackend",h.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function e(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function f(a){g.call(this,a)}function g(a){var b=a.history,c=b[b.length-1],e=l.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=c.timestamp,h=c.x-e.x,i=c.y-e.y,j=c.x-f,k=c.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(k)?k=0:j=0);var n,o,p=Math.max(g-f,m),q=j/p,r=k/p,s=this.options.scale;this.options.direction===d.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===d.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function h(a){g.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var i=a("./TouchTracker"),j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(){return this.options},c.exports=d}),define("famous/math/Vector",["require","exports","module"],function(a,b,c){function d(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function e(a,b,c){return this.x=a,this.y=b,this.z=c,this}function f(a){return e.call(this,a[0],a[1],a[2]||0)}function g(a){return e.call(this,a.x,a.y,a.z)}function h(a){return e.call(this,a,0,0)}var i=new d(0,0,0);d.prototype.add=function(a){return e.call(i,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return e.call(i,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.mult=function(a){return e.call(i,a*this.x,a*this.y,a*this.z)},d.prototype.div=function(a){return this.mult(1/a)},d.prototype.cross=function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;return e.call(i,d*g-c*h,b*h-d*f,c*f-b*g)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.rotateX=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b,c*f-d*g,c*g+d*f)},d.prototype.rotateY=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,d*g+b*f,c,d*f-b*g)},d.prototype.rotateZ=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b*f-c*g,b*g+c*f,d)},d.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?g.call(i,this.mult(a/b)):e.call(i,a,0,0)},d.prototype.clone=function(){return new d(this)},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.set=function(a){return a instanceof Array?f.call(this,a):"number"==typeof a?h.call(this,a):g.call(this,a)},d.prototype.setXYZ=function(){return e.apply(this,arguments)},d.prototype.set1D=function(a){return h.call(this,a)},d.prototype.put=function(a){this===i?g.call(a,i):g.call(a,this)},d.prototype.clear=function(){return e.call(this,0,0,0)},d.prototype.cap=function j(j){if(1/0===j)return g.call(i,this);var a=this.norm();return a>j?g.call(i,this.mult(j/a)):g.call(i,this)},d.prototype.project=function(a){return a.mult(this.dot(a))},d.prototype.reflectAcross=function(a){return a.normalize().put(a),g(i,this.sub(this.project(a).mult(2)))},d.prototype.get=function(){return[this.x,this.y,this.z]},d.prototype.get1D=function(){return this.x},c.exports=d}),define("famous/math/Matrix",["require","exports","module","./Vector"],function(a,b,c){function d(a){return this.values=a||[[1,0,0],[0,1,0],[0,0,1]],this}var e=a("./Vector"),f=new d,g=new e;d.prototype.get=function(){return this.values},d.prototype.set=function(a){this.values=a},d.prototype.vectorMultiply=function(a){var b=this.get(),c=a.x,d=a.y,e=a.z,f=b[0],h=b[1],i=b[2],j=f[0],k=f[1],l=f[2],m=h[0],n=h[1],o=h[2],p=i[0],q=i[1],r=i[2];return g.setXYZ(j*c+k*d+l*e,m*c+n*d+o*e,p*c+q*d+r*e)},d.prototype.multiply=function(a){for(var b=this.get(),c=[[]],d=0;3>d;d++){c[d]=[];for(var e=0;3>e;e++){for(var g=0,h=0;3>h;h++)g+=b[d][h]*a[h][e];c[d][e]=g}}return f.set(c)},d.prototype.transpose=function(){for(var a=[],b=this.get(),c=0;3>c;c++)for(var d=0;3>d;d++)a[c][d]=b[d][c];return f.set(a)},d.prototype.clone=function(){for(var a=this.get(),b=[],c=0;3>c;c++)b[c]=a[c].slice();return new d(b)},c.exports=d}),define("famous/math/Quaternion",["require","exports","module","./Matrix"],function(a,b,c){function d(a,b,c,d){return 1===arguments.length?this.set(a):(this.w=void 0!==a?a:1,this.x=void 0!==b?b:0,this.y=void 0!==c?c:0,this.z=void 0!==d?d:0),this}var e=a("./Matrix"),f=new d(1,0,0,0);d.prototype.add=function(a){return f.setWXYZ(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return f.setWXYZ(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.scalarDivide=function(a){return this.scalarMultiply(1/a)},d.prototype.scalarMultiply=function(a){return f.setWXYZ(this.w*a,this.x*a,this.y*a,this.z*a)},d.prototype.multiply=function(a){var b=this.x,c=this.y,d=this.z,e=this.w,g=a.x,h=a.y,i=a.z,j=a.w||0;return f.setWXYZ(e*j-b*g-c*h-d*i,b*j+g*e+h*d-c*i,c*j+h*e+b*i-g*d,d*j+i*e+g*c-b*h)};var g=new d(1,0,0,0);d.prototype.rotateVector=function(a){return g.set(this.conj()),f.set(this.multiply(a).multiply(g))},d.prototype.inverse=function(){return f.set(this.conj().scalarDivide(this.normSquared()))},d.prototype.negate=function(){return this.scalarMultiply(-1)},d.prototype.conj=function(){return f.setWXYZ(this.w,-this.x,-this.y,-this.z)},d.prototype.normalize=function(a){return a=void 0===a?1:a,this.scalarDivide(a*this.norm())},d.prototype.makeFromAngleAndAxis=function(a,b){var c=b.normalize(),d=.5*a,e=-Math.sin(d);return this.x=e*c.x,this.y=e*c.y,this.z=e*c.z,this.w=Math.cos(d),this},d.prototype.setWXYZ=function(a,b,c,d){return f.clear(),this.w=a,this.x=b,this.y=c,this.z=d,this},d.prototype.set=function(a){return a instanceof Array?(this.w=0,this.x=a[0],this.y=a[1],this.z=a[2]):(this.w=a.w,this.x=a.x,this.y=a.y,this.z=a.z),this!==f&&f.clear(),this},d.prototype.put=function(a){a.set(f)},d.prototype.clone=function(){return new d(this)},d.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},d.prototype.isEqual=function(a){return a.w===this.w&&a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.dot=function(a){return this.w*a.w+this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.getTransform=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return[1-2*c*c-2*d*d,2*b*c-2*d*e,2*b*d+2*c*e,0,2*b*c+2*d*e,1-2*b*b-2*d*d,2*c*d-2*b*e,0,2*b*d-2*c*e,2*c*d+2*b*e,1-2*b*b-2*c*c,0,0,0,0,1]};var h=new e;d.prototype.getMatrix=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return h.set([[1-2*c*c-2*d*d,2*b*c+2*d*e,2*b*d-2*c*e],[2*b*c-2*d*e,1-2*b*b-2*d*d,2*c*d+2*b*e],[2*b*d+2*c*e,2*c*d-2*b*e,1-2*b*b-2*c*c]])};var i=1e-5;d.prototype.slerp=function(a,b){var c,d,e,g,h;return d=this.dot(a),1-d>i?(c=Math.acos(d),e=Math.sin(c),g=Math.sin((1-b)*c)/e,h=Math.sin(b*c)/e):(g=1-b,h=b),f.set(this.scalarMultiply(g/h).add(a).multiply(h))},c.exports=d}),define("famous/math/Random",["require","exports","module"],function(a,b,c){function d(a,b){return a+f()*(b-a)}function e(a,b){return a+f()*(b-a+1)>>0}var f=Math.random,g={};g.integer=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var d=[],f=0;c>f;f++)d.push(e(a,b));return d}return e(a,b)},g.range=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var e=[],f=0;c>f;f++)e.push(d(a,b));return e}return d(a,b)},g.sign=function(a){return a=void 0!==a?a:.5,f()<a?1:-1},g.bool=function(a){return a=void 0!==a?a:.5,f()<a},c.exports=g}),define("famous/math/Utilities",["require","exports","module"],function(a,b,c){var d={};d.clamp=function(a,b){return Math.max(Math.min(a,b[1]),b[0])},d.length=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)},c.exports=d}),define("famous/modifiers/Draggable",["require","exports","module","../core/Transform","../transitions/Transitionable","../core/EventHandler","../math/Utilities","../inputs/GenericSync","../inputs/MouseSync","../inputs/TouchSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._positionState=new k([0,0]),this._differential=[0,0],this._active=!0,this.sync=new n(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new l,l.setInputHandler(this,this.sync),l.setOutputHandler(this,this.eventOutput),i.call(this)}function e(a){var b=this.options,c=b.projection,d=b.snapX,e=b.snapY,f=c&q.x?a[0]:0,g=c&q.y?a[1]:0;return d>0&&(f-=f%d),e>0&&(g-=g%e),[f,g]}function f(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function g(a){if(this._active){var b=this.options;this._differential=a.position;var c=e.call(this,this._differential);this._differential[0]-=c[0],this._differential[1]-=c[1];var d=this.getPosition();if(d[0]+=c[0],d[1]+=c[1],b.xRange){var f=[b.xRange[0]+.5*b.snapX,b.xRange[1]-.5*b.snapX];d[0]=r(d[0],f)}if(b.yRange){var g=[b.yRange[0]+.5*b.snapY,b.yRange[1]-.5*b.snapY];d[1]=r(d[1],g)}this.eventOutput.emit("update",{position:d})}}function h(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function i(){this.sync.on("start",f.bind(this)),this.sync.on("update",g.bind(this)),this.sync.on("end",h.bind(this))}var j=a("../core/Transform"),k=a("../transitions/Transitionable"),l=a("../core/EventHandler"),m=a("../math/Utilities"),n=a("../inputs/GenericSync"),o=a("../inputs/MouseSync"),p=a("../inputs/TouchSync");n.register({mouse:o,touch:p});var q={x:1,y:2};d.DIRECTION_X=q.x,d.DIRECTION_Y=q.y;var r=m.clamp;d.DEFAULT_OPTIONS={projection:q.x|q.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},d.prototype.setOptions=function(a){var b=this.options;if(void 0!==a.projection){var c=a.projection;this.options.projection=0,["x","y"].forEach(function(a){-1!==c.indexOf(a)&&(b.projection|=q[a])})}void 0!==a.scale&&(b.scale=a.scale,this.sync.setOptions({scale:a.scale})),void 0!==a.xRange&&(b.xRange=a.xRange),void 0!==a.yRange&&(b.yRange=a.yRange),void 0!==a.snapX&&(b.snapX=a.snapX),void 0!==a.snapY&&(b.snapY=a.snapY)},d.prototype.getPosition=function(){return this._positionState.get()},d.prototype.setRelativePosition=function(a,b,c){var d=this.getPosition(),e=[d[0]+a[0],d[1]+a[1]];this.setPosition(e,b,c)},d.prototype.setPosition=function(a,b,c){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(a,b,c)},d.prototype.activate=function(){this._active=!0},d.prototype.deactivate=function(){this._active=!1},d.prototype.toggle=function(){this._active=!this._active},d.prototype.modify=function(a){var b=this.getPosition();return{transform:j.translate(b[0],b[1]),target:a}},c.exports=d}),define("famous/modifiers/Fader",["require","exports","module","../transitions/Transitionable","../core/OptionsManager"],function(a,b,c){function d(a,b){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),b||(b=0),this.transitionHelper=new e(b)}var e=a("../transitions/Transitionable"),f=a("../core/OptionsManager");d.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b){a=a||this.options.transition,this.set(1,a,b)},d.prototype.hide=function(a,b){a=a||this.options.transition,this.set(0,a,b)},d.prototype.set=function(a,b,c){this.halt(),this.transitionHelper.set(a,b,c)},d.prototype.halt=function(){this.transitionHelper.halt()},d.prototype.isVisible=function(){return this.transitionHelper.get()>0},d.prototype.modify=function(a){var b=this.transitionHelper.get();return this.options.cull&&!b?void 0:{opacity:b,target:a}},c.exports=d}),define("famous/modifiers/ModifierChain",["require","exports","module"],function(a,b,c){function d(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}d.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},d.prototype.removeModifier=function(a){var b=this._chain.indexOf(a);0>b||this._chain.splice(b,1)},d.prototype.modify=function(a){for(var b=this._chain,c=a,d=0;d<b.length;d++)c=b[d].modify(c);return c},c.exports=d}),define("famous/modifiers/StateModifier",["require","exports","module","../core/Modifier","../core/Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this._transformState=new h(f.identity),this._opacityState=new g(1),this._originState=new g([0,0]),this._alignState=new g([0,0]),this._sizeState=new g([0,0]),this._proportionsState=new g([0,0]),this._modifier=new e({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,a&&(a.transform&&this.setTransform(a.transform),void 0!==a.opacity&&this.setOpacity(a.opacity),a.origin&&this.setOrigin(a.origin),a.align&&this.setAlign(a.align),a.size&&this.setSize(a.size),a.proportions&&this.setProportions(a.proportions))}var e=a("../core/Modifier"),f=a("../core/Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.setTransform=function(a,b,c){return this._transformState.set(a,b,c),this},d.prototype.setOpacity=function(a,b,c){return this._opacityState.set(a,b,c),this},d.prototype.setOrigin=function(a,b,c){return null===a?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(a,b,c),this)},d.prototype.setAlign=function(a,b,c){return null===a?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(a,b,c),this)},d.prototype.setSize=function(a,b,c){return null===a?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(a,b,c),this)},d.prototype.setProportions=function(a,b,c){return null===a?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(a,b,c),this)},d.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},d.prototype.getTransform=function(){return this._transformState.get()},d.prototype.getFinalTransform=function(){return this._transformState.getFinal()},d.prototype.getOpacity=function(){return this._opacityState.get()},d.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},d.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},d.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},d.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},d.prototype.modify=function(a){return this._modifier.modify(a)},c.exports=d}),define("famous/physics/PhysicsEngine",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=w(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function e(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function f(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},e.call(this,a).push(this._currAgentId),this._currAgentId++}function g(a){return this._agentData[a]}function h(a){var b=g.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function i(){for(var a=this._forces.length-1;a>-1;a--)h.call(this,a)}function j(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function k(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)j.call(this,c,a);b++}}function l(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function m(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function n(a,b){a.integrateOrientation(b)}function o(a,b){a.integratePosition(b),a.emit(x.update,a)}function p(a){i.call(this,a),this.forEach(l,a),this.forEachBody(m,a),k.call(this,a),this.forEachBody(n,a),this.forEach(o,a)}function q(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function r(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var s=a("../core/EventHandler"),t=17,u=1e3/120,v=17,w=Date.now,x={start:"start",update:"update",end:"end"};d.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},d.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},d.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},d.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],e=0;e<a.length;e++)d[e]=f.call(this,a[e],b,c);return d}return f.call(this,a,b,c)},d.prototype.attachTo=function(a,b){g.call(this,a).targets.push(b)},d.prototype.detach=function(a){var b=this.getAgent(a),c=e.call(this,b),d=c.indexOf(a);c.splice(d,1),delete this._agentData[a]},d.prototype.detachFrom=function(a,b){var c=g.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},d.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},d.prototype.getAgent=function(a){return g.call(this,a).agent},d.prototype.getParticles=function(){return this._particles},d.prototype.getBodies=function(){return this._bodies},d.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},d.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},d.prototype.getAgentEnergy=function(a){var b=g.call(this,a);return b.agent.getEnergy(b.targets,b.source)},d.prototype.getEnergy=function(){return q.call(this)+r.call(this)},d.prototype.step=function(){if(!this.isSleeping()){var a=w(),b=a-this._prevTime;this._prevTime=a,u>b||(b>v&&(b=v),p.call(this,t),this.emit(x.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},d.prototype.isSleeping=function(){return this._isSleeping},d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(x.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this._prevTime=w(),this.emit(x.start,this),this._isSleeping=!1)},d.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},d.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new s),this._eventHandler.on(a,b)},c.exports=d}),define("famous/physics/integrators/SymplecticEuler",["require","exports","module"],function(a,b,c){var d={};d.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},d.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},d.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},d.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},c.exports=d}),define("famous/physics/bodies/Particle",["require","exports","module","../../math/Vector","../../core/Transform","../../core/EventHandler","../integrators/SymplecticEuler"],function(a,b,c){function d(a){a=a||{};var b=d.DEFAULT_OPTIONS;this.position=new f,this.velocity=new f,this.force=new f,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=g.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}
}function e(){this._eventOutput=new h,this._eventOutput.bindThis(this),h.setOutputHandler(this,this._eventOutput)}var f=a("../../math/Vector"),g=a("../../core/Transform"),h=a("../../core/EventHandler"),i=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var j={start:"start",update:"update",end:"end"},k=Date.now;d.prototype.isBody=!1,d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.emit(j.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this.emit(j.start,this),this._isSleeping=!1,this._prevTime=k(),this._engine&&this._engine.wake())},d.prototype.setPosition=function(a){this.position.set(a)},d.prototype.setPosition1D=function(a){this.position.x=a},d.prototype.getPosition=function(){return this._engine.step(),this.position.get()},d.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},d.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},d.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},d.prototype.getVelocity=function(){return this.velocity.get()},d.prototype.setForce=function(a){this.force.set(a),this.wake()},d.prototype.getVelocity1D=function(){return this.velocity.x},d.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},d.prototype.getMass=function(){return this.mass},d.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},d.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},d.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},d.prototype.integrateVelocity=function(a){i.integrateVelocity(this,a)},d.prototype.integratePosition=function(a){i.integratePosition(this,a)},d.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},d.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},d.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},d.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},d.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/physics/bodies/Body",["require","exports","module","./Particle","../../core/Transform","../../math/Vector","../../math/Quaternion","../../math/Matrix","../integrators/SymplecticEuler"],function(a,b,c){function d(a){e.call(this,a),a=a||{},this.orientation=new h,this.angularVelocity=new g,this.angularMomentum=new g,this.torque=new g,a.orientation&&this.orientation.set(a.orientation),a.angularVelocity&&this.angularVelocity.set(a.angularVelocity),a.angularMomentum&&this.angularMomentum.set(a.angularMomentum),a.torque&&this.torque.set(a.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new g}var e=a("./Particle"),f=a("../../core/Transform"),g=a("../../math/Vector"),h=a("../../math/Quaternion"),i=a("../../math/Matrix"),j=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.DEFAULT_OPTIONS.orientation=[0,0,0,1],d.DEFAULT_OPTIONS.angularVelocity=[0,0,0],d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isBody=!0,d.prototype.setMass=function(){e.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){this.inertia=new i,this.inverseInertia=new i},d.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},d.prototype.toWorldCoordinates=function(a){return this.pWorld.set(this.orientation.rotateVector(a))},d.prototype.getEnergy=function(){return e.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},d.prototype.reset=function(a,b,c,d){e.prototype.reset.call(this,a,b),this.angularVelocity.clear(),this.setOrientation(c||[1,0,0,0]),this.setAngularMomentum(d||[0,0,0])},d.prototype.setOrientation=function(a){this.orientation.set(a)},d.prototype.setAngularVelocity=function(a){this.wake(),this.angularVelocity.set(a)},d.prototype.setAngularMomentum=function(a){this.wake(),this.angularMomentum.set(a)},d.prototype.applyForce=function(a,b){e.prototype.applyForce.call(this,a),void 0!==b&&this.applyTorque(b.cross(a))},d.prototype.applyTorque=function(a){this.wake(),this.torque.set(this.torque.add(a))},d.prototype.getTransform=function(){return f.thenMove(this.orientation.getTransform(),f.getTranslate(e.prototype.getTransform.call(this)))},d.prototype._integrate=function(a){e.prototype._integrate.call(this,a),this.integrateAngularMomentum(a),this.updateAngularVelocity(a),this.integrateOrientation(a)},d.prototype.integrateAngularMomentum=function(a){j.integrateAngularMomentum(this,a)},d.prototype.integrateOrientation=function(a){j.integrateOrientation(this,a)},c.exports=d}),define("famous/physics/bodies/Circle",["require","exports","module","./Body","../../math/Matrix"],function(a,b,c){function d(a){a=a||{},this.setRadius(a.radius||0),e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setRadius=function(a){this.radius=a,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.radius;this.inertia=new f([[.25*a*b*b,0,0],[0,.25*a*b*b,0],[0,0,.5*a*b*b]]),this.inverseInertia=new f([[4/(a*b*b),0,0],[0,4/(a*b*b),0],[0,0,2/(a*b*b)]])},c.exports=d}),define("famous/physics/bodies/Rectangle",["require","exports","module","./Body","../../math/Matrix"],function(a,b,c){function d(a){a=a||{},this.size=a.size||[0,0],e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setSize=function(a){this.size=a,this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.size[0],c=this.size[1];this.inertia=new f([[a*c*c/12,0,0],[0,a*b*b/12,0],[0,0,a*(b*b+c*c)/12]]),this.inverseInertia=new f([[12/(a*c*c),0,0],[0,12/(a*b*b),0],[0,0,12/(a*(b*b+c*c))]])},c.exports=d}),define("famous/physics/constraints/Constraint",["require","exports","module","../../core/EventHandler"],function(a,b,c){function d(){this.options=this.options||{},this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput)}var e=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyConstraint=function(){},d.prototype.getEnergy=function(){return 0},c.exports=d}),define("famous/physics/constraints/Collision",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.normal=new f,this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){if(void 0!==b)for(var d=b.velocity,e=b.position,f=b.inverseMass,g=b.radius,h=this.options,i=h.drift,j=-h.slop,k=h.restitution,l=this.normal,m=this.pDiff,n=this.vDiff,o=this.impulse1,p=this.impulse2,q=0;q<a.length;q++){var r=a[q];if(r!==b){var s=r.velocity,t=r.position,u=r.inverseMass,v=r.radius;m.set(t.sub(e)),n.set(s.sub(d));var w=m.norm(),x=w-(g+v),y=1/(f+u),z=0;if(0>x){if(l.set(m.normalize()),this._eventOutput){var A={target:r,source:b,overlap:x,normal:l};this._eventOutput.emit("preCollision",A),this._eventOutput.emit("collision",A)}var B=j>=x?((1+k)*l.dot(n)+i/c*(x-j))/(z+c/y):(1+k)*l.dot(n)/(z+c/y);l.mult(c*B).put(o),o.mult(-1).put(p),b.applyImpulse(o),r.applyImpulse(p),this._eventOutput&&this._eventOutput.emit("postCollision",A)}}}},c.exports=d}),define("famous/physics/constraints/Curve",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d;var g=1e-7,h=Math.PI;d.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(a,b,c){return c},period:0,dampingRatio:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.impulse,f=this.J,i=d.equation,j=d.plane,k=d.dampingRatio,l=d.period,m=0;m<a.length;m++){var n,o,p=a[m],q=p.velocity,r=p.position,s=p.mass;if(0===l)n=0,o=1;else{var t=4*s*h*k/l,u=4*s*h*h/(l*l);n=1/(t+c*u),o=c*u/(t+c*u)}var v=r.x,w=r.y,x=r.z,y=i(v,w,x),z=(i(v+g,r,r)-y)/g,A=(i(v,w+g,r)-y)/g,B=(i(v,w,r+g)-y)/g,C=j(v,w,x),D=(j(v+g,w,x)-C)/g,E=(j(v,w+g,x)-C)/g,F=(j(v,w,x+g)-C)/g;f.setXYZ(z+D,A+E,B+F);var G=o/c*(y+C),H=-(f.dot(q)+G)/(n+c*f.normSquared()/s);e.set(f.mult(c*H)),p.applyImpulse(e)}},c.exports=d}),define("famous/physics/constraints/Distance",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.impulse=new f,this.normal=new f,this.diffP=new f,this.diffV=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var g=Math.PI;d.prototype.setOptions=function(a){a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),void 0!==a.minLength&&(this.options.minLength=a.minLength)},d.prototype.setAnchor=function(a){this.options.anchor||(this.options.anchor=new f),this.options.anchor.set(a)},d.prototype.applyConstraint=function(a,b,c){var d,e,f=this.normal,h=this.diffP,i=this.diffV,j=this.impulse,k=this.options,l=k.dampingRatio,m=k.period,n=k.minLength;if(b){var o=b.velocity;d=b.position,e=b.inverseMass}else d=this.options.anchor,e=0;for(var p=this.options.length,q=0;q<a.length;q++){var r=a[q],s=r.velocity,t=r.position,u=r.inverseMass;h.set(t.sub(d)),f.set(h.normalize());var v=h.norm()-p;if(Math.abs(v)<n)return;i.set(b?s.sub(o):s);var w,x,y=1/(u+e);if(0===m)w=0,x=1;else{var z=4*y*g*l/m,A=4*y*g*g/(m*m);w=1/(z+c*A),x=c*A/(z+c*A)}var B=x/c*v,C=-(f.dot(i)+B)/(w+c/y);j.set(f.mult(c*C)),r.applyImpulse(j),b&&b.applyImpulse(j.mult(-1))}},c.exports=d}),define("famous/physics/constraints/Snap",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var g=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),e.prototype.setOptions.call(this,a)},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=c.anchor||b.position,f=Math.pow(2*g/c.period,2),h=0,i=0;i<a.length;i++){var j=a[i],k=e.sub(j.position).norm()-d;h+=.5*f*k*k}return h},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.pDiff,f=this.vDiff,h=this.impulse1,i=this.impulse2,j=d.length,k=d.anchor||b.position,l=d.period,m=d.dampingRatio,n=0;n<a.length;n++){var o=a[n],p=o.position,q=o.velocity,r=o.mass,s=o.inverseMass;e.set(p.sub(k));var t,u=e.norm()-j;if(b){var v=b.inverseMass,w=b.velocity;f.set(q.sub(w)),t=1/(s+v)}else f.set(q),t=r;var x,y;if(0===this.options.period)x=0,y=1;else{var z=4*t*g*g/(l*l),A=4*t*g*m/l;y=c*z/(A+c*z),x=1/(A+c*z)}var B=y/c*u;e.normalize(-B).sub(f).mult(c/(x+c/t)).put(h),o.applyImpulse(h),b&&(h.mult(-1).put(i),b.applyImpulse(i))}},c.exports=d}),define("famous/physics/constraints/Surface",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var g=1e-7,h=Math.PI;d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.impulse,e=this.J,f=this.options,i=f.equation,j=f.dampingRatio,k=f.period,l=0;l<a.length;l++){var m,n,o=a[l],p=o.velocity,q=o.position,r=o.mass;if(0===k)m=0,n=1;else{var s=4*r*h*j/k,t=4*r*h*h/(k*k);m=1/(s+c*t),n=c*t/(s+c*t)}var u=q.x,v=q.y,w=q.z,x=i(u,v,w),y=(i(u+g,q,q)-x)/g,z=(i(u,v+g,q)-x)/g,A=(i(u,v,q+g)-x)/g;e.setXYZ(y,z,A);var B=n/c*x,C=-(e.dot(p)+B)/(m+c*e.normSquared()/r);d.set(e.mult(c*C)),o.applyImpulse(d)}},c.exports=d}),define("famous/physics/constraints/Wall",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.diff=new j,this.impulse=new j,i.call(this)}function e(a,b){return b.dot(a)}function f(a){var b=this.options.normal,c=this.options.distance;return a.dot(b)+c}function g(a,b,c){var e=a.position,f=a.velocity,g=a.mass,h=this.options.normal,i=this.options.onContact,j=this.options.restitution,k=this.impulse,l=this.options.drift,m=-this.options.slop,n=0;if(this._eventOutput){var o={particle:a,wall:this,overlap:b,normal:h};this._eventOutput.emit("preCollision",o),this._eventOutput.emit("collision",o)}switch(i){case d.ON_CONTACT.REFLECT:var p=m>b?-((1+j)*h.dot(f)+l/c*(b-m))/(g*c+n):-((1+j)*h.dot(f))/(g*c+n);k.set(h.mult(c*p)),a.applyImpulse(k),a.setPosition(e.add(h.mult(-b)))}this._eventOutput&&this._eventOutput.emit("postCollision",o)}function h(a,b){var c=this.options.onContact,e=a.position,f=this.options.normal;c===d.ON_CONTACT.REFLECT&&a.setPosition(e.add(f.mult(-b)))}var i=a("./Constraint"),j=a("../../math/Vector");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.ON_CONTACT={REFLECT:0,SILENT:1},d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:d.ON_CONTACT.REFLECT},d.prototype.setOptions=function(a){void 0!==a.normal&&(a.normal instanceof j&&(this.options.normal=a.normal.clone()),a.normal instanceof Array&&(this.options.normal=new j(a.normal))),void 0!==a.restitution&&(this.options.restitution=a.restitution),void 0!==a.drift&&(this.options.drift=a.drift),void 0!==a.slop&&(this.options.slop=a.slop),void 0!==a.distance&&(this.options.distance=a.distance),void 0!==a.onContact&&(this.options.onContact=a.onContact)},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options.normal,i=0;i<a.length;i++){var j=a[i],k=j.position,l=j.velocity,m=j.radius||0,n=f.call(this,k.add(d.mult(-m))),o=e.call(this,d,l);0>=n&&(0>o?g.call(this,j,n,c):h.call(this,j,n,c))}},c.exports=d}),define("famous/physics/constraints/Walls",["require","exports","module","./Constraint","./Wall","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),f.call(this,a.sides||this.options.sides),h.call(this)}function e(a,b,c){var e,f=d.SIDES;switch(parseInt(a)){case f.LEFT:e=b[0]*c[0];break;case f.TOP:e=b[1]*c[1];break;case f.FRONT:e=b[2]*c[2];break;case f.RIGHT:e=b[0]*(1-c[0]);break;case f.BOTTOM:e=b[1]*(1-c[1]);break;case f.BACK:e=b[2]*(1-c[2])}return e}function f(a){this.components={};for(var b=this.components,c=0;c<a.length;c++){var d=a[c];b[c]=new i({normal:k[d].clone(),distance:e(d,this.options.size,this.options.origin)})}}function g(a){this.forEach(function(b){b.setOptions(a)});for(var b in a)this.options[b]=a[b]}var h=a("./Constraint"),i=a("./Wall"),j=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.ON_CONTACT=i.ON_CONTACT,d.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},d.DEFAULT_OPTIONS={sides:d.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:d.ON_CONTACT.REFLECT};var k={0:new j(1,0,0),1:new j(-1,0,0),2:new j(0,1,0),3:new j(0,-1,0),4:new j(0,0,1),5:new j(0,0,-1)};d.prototype.setOptions=function(a){var b=!1;void 0!==a.restitution&&g.call(this,{restitution:a.restitution}),void 0!==a.drift&&g.call(this,{drift:a.drift}),void 0!==a.slop&&g.call(this,{slop:a.slop}),void 0!==a.onContact&&g.call(this,{onContact:a.onContact}),void 0!==a.size&&(b=!0),void 0!==a.sides&&(this.options.sides=a.sides),void 0!==a.origin&&(b=!0),b&&this.setSize(a.size,a.origin)},d.prototype.setSize=function(a,b){b=b||this.options.origin,b.length<3&&(b[2]=.5),this.forEach(function(c,d){var f=e(d,a,b);c.setOptions({distance:f})}),this.options.size=a,this.options.origin=b},d.prototype.applyConstraint=function(a,b,c){this.forEach(function(d){d.applyConstraint(a,b,c)})},d.prototype.forEach=function(a){var b=this.options.sides;for(var c in this.sides)a(b[c],c)},d.prototype.rotateZ=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateZ(a).put(c)})},d.prototype.rotateX=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateX(a).put(c)})},d.prototype.rotateY=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateY(a).put(c)})},d.prototype.reset=function(){var a=this.options.sides;for(var b in a){var c=this.components[b];c.options.normal.set(k[b])}},c.exports=d}),define("famous/physics/forces/Force",["require","exports","module","../../math/Vector","../../core/EventHandler"],function(a,b,c){function d(a){this.force=new e(a),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},d.prototype.getEnergy=function(){return 0},c.exports=d}),define("famous/physics/forces/Drag",["require","exports","module","./Force"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this)}var e=a("./Force");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.DEFAULT_OPTIONS={strength:.01,forceFunction:d.FORCE_FUNCTIONS.LINEAR},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define("famous/physics/forces/Repulsion",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new f,e.call(this)}var e=a("./Force"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DECAY_FUNCTIONS={LINEAR:function(a,b){return Math.max(1-1/b*a,0)},MORSE:function(a,b){var c=0===b?100:b,d=a+c*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(d/c-1),2),0)},INVERSE:function(a,b){return 1/(1-b+a)},GRAVITY:function(a,b){return 1/(1-b+a*a)}},d.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:d.DECAY_FUNCTIONS.GRAVITY},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor)),delete a.anchor);for(var b in a)this.options[b]=a[b]},d.prototype.applyForce=function(a,b){var c=this.options,d=this.force,e=this.disp,f=c.strength,g=c.anchor||b.position,h=c.cap,i=c.cutoff,j=c.range[0],k=c.range[1],l=c.decayFunction;if(0!==f)for(var m,n,o,p,q=a.length;q--;)m=a[q],m!==b&&(n=m.mass,o=m.position,e.set(o.sub(g)),p=e.norm(),k>p&&p>j&&(d.set(e.normalize(f*n*l(p,i)).cap(h)),m.applyForce(d)))},c.exports=d}),define("famous/physics/forces/RotationalDrag",["require","exports","module","./Drag"],function(a,b,c){function d(a){e.call(this,a)}var e=a("./Drag");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=e.FORCE_FUNCTIONS,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.angularVelocity).mult(-100*d).put(f),c.applyTorque(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define("famous/physics/forces/Spring",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){h.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new i(0,0,0),g.call(this)}function e(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function f(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var j=Math.PI,k=150;d.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:d.FORCE_FUNCTIONS.HOOK},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof i&&(this.options.anchor=a.anchor.position),a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(a.period<k&&(a.period=k,console.warn("The period of a SpringTransition is capped at "+k+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},c.exports=d}),define("famous/physics/forces/RotationalSpring",["require","exports","module","./Force","./Spring","../../math/Quaternion"],function(a,b,c){function d(a){i.call(this,a)}function e(){var a=this.options;a.stiffness=Math.pow(2*k/a.period,2)}function f(){var a=this.options;a.damping=4*k*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("./Spring"),j=a("../../math/Quaternion");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=i.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=i.FORCE_FUNCTIONS;var k=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof j&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new j(a.anchor))),void 0!==a.period&&(this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a){var b,c,d,e,f=this.force,g=this.options,h=this.disp,i=g.stiffness,j=g.damping,k=g.length,l=g.anchor,m=g.forceFunction,n=g.maxLength;for(b=0;b<a.length;b++){if(c=a[b],h.set(l.sub(c.orientation)),d=h.norm()-k,0===d)return;e=c.mass,i*=e,j*=e,f.set(h.normalize(i*m(d,n))),j&&f.add(c.angularVelocity.mult(-j)).put(f),c.applyTorque(f)}},d.prototype.getEnergy=function(a){for(var b=this.options,c=b.length,d=b.anchor,e=b.stiffness,f=0,g=0;g<a.length;g++){var h=a[g],i=d.sub(h.orientation).norm()-c;f+=.5*e*i*i}return f},c.exports=d}),define("famous/physics/forces/VectorField",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.evaluation=new g}function e(a){var b=d.FIELDS;switch(a){case b.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new g(this.options.direction)):this.options.direction=new g(0,1,0);break;case b.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new g(this.options.position)):this.options.position=new g(0,0,0)}}var f=a("./Force"),g=a("../../math/Vector");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.FIELDS={CONSTANT:function(a,b){b.direction.put(this.evaluation)},LINEAR:function(a){a.put(this.evaluation)},RADIAL:function(a){a.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(a,b){b.position.sub(a).put(this.evaluation)}},d.DEFAULT_OPTIONS={strength:.01,field:d.FIELDS.CONSTANT},d.prototype.setOptions=function(a){void 0!==a.strength&&(this.options.strength=a.strength),void 0!==a.direction&&(this.options.direction=a.direction),void 0!==a.field&&(this.options.field=a.field,e.call(this,this.options.field))},d.prototype.applyForce=function(a){var b,c,d=this.force,e=this.options.strength,f=this.options.field;for(b=0;b<a.length;b++)c=a[b],f.call(this,c.position,this.options),this.evaluation.mult(c.mass*e).put(d),c.applyForce(d)},d.prototype.getEnergy=function(a){var b,c,e=this.options.field,f=d.FIELDS,g=0;switch(e){case f.CONSTANT:g=a.length*this.options.direction.norm();break;case f.RADIAL:for(b=0;b<a.length;b++)c=a[b],g+=c.position.norm();break;case f.POINT_ATTRACTOR:for(b=0;b<a.length;b++)c=a[b],g+=c.position.sub(this.options.position).norm()}return g*=this.options.strength},c.exports=d}),define("famous/surfaces/CanvasSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){a&&a.canvasSize&&(this._canvasSize=a.canvasSize),e.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="canvas",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(){},d.prototype.deploy=function(a){this._canvasSize&&(a.width=this._canvasSize[0],a.height=this._canvasSize[1]),"2d"===this._contextId&&(a.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},d.prototype.recall=function(a){this.getSize();this._backBuffer.width=a.width,this._backBuffer.height=a.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(a,0,0),a.width=0,a.height=0)},d.prototype.getContext=function(a){return this._contextId=a,this._currentTarget?this._currentTarget.getContext(a):this._backBuffer.getContext(a)},d.prototype.setSize=function(a,b){e.prototype.setSize.apply(this,arguments),b&&(this._canvasSize=[b[0],b[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},c.exports=d}),define("famous/surfaces/ContainerSurface",["require","exports","module","../core/Surface","../core/Context"],function(a,b,c){function d(a){e.call(this,a),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new f(this._container),this.setContent(this._container)}var e=a("../core/Surface"),f=a("../core/Context");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),e.prototype.render.apply(this,arguments)},d.prototype.deploy=function(){return this._shouldRecalculateSize=!0,e.prototype.deploy.apply(this,arguments)},d.prototype.commit=function(){var a=this._size?[this._size[0],this._size[1]]:null,b=e.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||a&&(this._size[0]!==a[0]||this._size[1]!==a[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),b},c.exports=d}),define("famous/surfaces/FormContainerSurface",["require","exports","module","./ContainerSurface"],function(a,b,c){function d(a){a&&(this._method=a.method||""),e.apply(this,arguments)}var e=a("./ContainerSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="form",d.prototype.deploy=function(a){return this._method&&(a.method=this._method),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define("famous/surfaces/ImageSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(){this._imageUrl=void 0,e.apply(this,arguments)}var e=a("../core/Surface"),f=[],g=[],h=[],i=!0;d.enableCache=function(){i=!0},d.disableCache=function(){i=!1},d.clearCache=function(){f=[],g=[],h=[]},d.getCache=function(){return{urlCache:f,countCache:g,nodeCache:g}},d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="img",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(a){var b=f.indexOf(this._imageUrl);-1!==b&&(1===g[b]?(f.splice(b,1),g.splice(b,1),h.splice(b,1)):g[b]--),b=f.indexOf(a),-1===b?(f.push(a),g.push(1)):g[b]++,this._imageUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){var b=f.indexOf(this._imageUrl);if(void 0===h[b]&&i){var c=new Image;c.src=this._imageUrl||"",h[b]=c}a.src=this._imageUrl||""},d.prototype.recall=function(a){a.src=""},c.exports=d}),define("famous/surfaces/InputSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._type=a.type||"text",this._name=a.name||"",e.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(a){a.target!==this._currentTarget&&this.blur()
}.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="input",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.setType=function(a){return this._type=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),a.value=this._value,a.type=this._type,a.name=this._name},c.exports=d}),define("famous/surfaces/SubmitInputSurface",["require","exports","module","./InputSurface"],function(a,b,c){function d(a){e.apply(this,arguments),this._type="submit",a&&a.onClick&&this.setOnClick(a.onClick)}var e=a("./InputSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setOnClick=function(a){this.onClick=a},d.prototype.deploy=function(a){this.onclick&&(a.onClick=this.onClick),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define("famous/surfaces/TextareaSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._name=a.name||"",this._wrap=a.wrap||"",this._cols=a.cols||"",this._rows=a.rows||"",e.apply(this,arguments),this.on("click",this.focus.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="textarea",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.setWrap=function(a){return this._wrap=a,this._contentDirty=!0,this},d.prototype.setColumns=function(a){return this._cols=a,this._contentDirty=!0,this},d.prototype.setRows=function(a){return this._rows=a,this._contentDirty=!0,this},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),""!==this._value&&(a.value=this._value),""!==this._name&&(a.name=this._name),""!==this._wrap&&(a.wrap=this._wrap),""!==this._cols&&(a.cols=this._cols),""!==this._rows&&(a.rows=this._rows)},c.exports=d}),define("famous/surfaces/VideoSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){e.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a)}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={autoplay:!1},d.prototype.elementType="video",d.prototype.elementClass="famous-surface",d.prototype.setOptions=function(a){a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.autoplay&&(this.options.autoplay=a.autoplay),a.src&&(this._videoUrl=a.src,this._contentDirty=!0)},d.prototype.setContent=function(a){this._videoUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){a.src=this._videoUrl,a.autoplay=this.options.autoplay},d.prototype.recall=function(a){a.src=""},c.exports=d}),define("famous/transitions/CachedMap",["require","exports","module"],function(a,b,c){function d(a){this._map=a||null,this._cachedOutput=null,this._cachedInput=Number.NaN}d.create=function(a){var b=new d(a);return b.get.bind(b)},d.prototype.get=function(a){return a!==this._cachedInput&&(this._cachedInput=a,this._cachedOutput=this._map(a)),this._cachedOutput},c.exports=d}),define("famous/transitions/Easing",["require","exports","module"],function(a,b,c){var d={inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inQuart:function(a){return a*a*a*a},outQuart:function(a){return-(--a*a*a*a-1)},inOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return--a*a*a*a*a+1},inOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inCirc:function(a){return-(Math.sqrt(1-a*a)-1)},outCirc:function(a){return Math.sqrt(1- --a*a)},inOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)},inBack:function(a,b){return void 0===b&&(b=1.70158),a*a*((b+1)*a-b)},outBack:function(a,b){return void 0===b&&(b=1.70158),--a*a*((b+1)*a+b)+1},inOutBack:function(a,b){return void 0===b&&(b=1.70158),(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},inBounce:function(a){return 1-d.outBounce(1-a)},outBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},inOutBounce:function(a){return.5>a?.5*d.inBounce(2*a):.5*d.outBounce(2*a-1)+.5}};c.exports=d}),define("famous/transitions/SnapTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/constraints/Snap","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.spring=new s({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(a){this.endState.set(a),f.call(this)}function h(){this.PE.wake()}function i(){this.PE.sleep()}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),k.call(this,a.velocity)}function p(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(j.call(this,this.endState),k.call(this,[0,0,0]),i.call(this))}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/constraints/Snap"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),g.call(this,a),b&&k.call(this,b),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return p.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,h.call(this),o.call(this,b),g.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/transitions/SpringTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Spring","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.spring=new s({anchor:this.endState}),this.particle=new r,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(a){this.particle.setPosition(a)}function g(a){this.particle.setVelocity(a)}function h(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function i(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function j(a){this._callback=a}function k(){this.PE.wake()}function l(){this.PE.sleep()}function m(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(f.call(this,this.endState),g.call(this,[0,0,0]),l.call(this))}function n(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),a.period<150&&(a.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),g.call(this,a.velocity)}function o(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function p(a){this.endState.set(a),o.call(this)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),f.call(this,a),p.call(this,a),b&&g.call(this,b),j.call(this,void 0)},d.prototype.getVelocity=function(){return i.call(this)},d.prototype.setVelocity=function(a){this.call(this,g(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return m.call(this),h.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,k.call(this),n.call(this,b),p.call(this,a),void j.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/transitions/WallTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Spring","../physics/constraints/Wall","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new u(a),this.initState=new u,this.spring=new s({anchor:this.endState}),this.wall=new t,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(){this.PE.wake()}function h(){this.PE.sleep()}function i(a){this.endState.set(a);var b=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===b?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),f.call(this)}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else{var b=e.call(this);b<this._absRestTolerance&&(h.call(this),j.call(this,this.endState),k.call(this,[0,0,0]))}}function p(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),void 0===a.restitution&&(a.restitution=b.restitution),void 0===a.drift&&(a.drift=t.DEFAULT_OPTIONS.drift),void 0===a.slop&&(a.slop=t.DEFAULT_OPTIONS.slop),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),this.wall.setOptions({restitution:a.restitution,drift:a.drift,slop:a.slop}),k.call(this,a.velocity)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../physics/constraints/Wall"),u=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),b&&k.call(this,b),i.call(this,a),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return o.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,g.call(this),p.call(this,b),i.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/utilities/KeyCodes",["require","exports","module"],function(a,b,c){var d={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};c.exports=d}),define("famous/utilities/Timer",["require","exports","module","../core/Engine"],function(a,b,c){function d(a){return k.on(l,a),a}function e(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),k.removeListener(l,e))};return d(e)}function f(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),c=m())};return d(e)}function g(a,b){if(void 0===b)return void 0;var c=function(){b--,0>=b&&(a.apply(this,arguments),i(c))};return d(c)}function h(a,b){b=b||1;var c=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=c)};return d(e)}function i(a){k.removeListener(l,a)}function j(a,b){var c,d,f,g,h;return function(){d=this,h=arguments,f=m();var j=function(){var i=m-f;b>i?c=e(j,b-i):(c=null,g=a.apply(d,h))};return i(c),c=e(j,b),g}}var k=a("../core/Engine"),l="prerender",m=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};c.exports={setTimeout:e,setInterval:f,debounce:j,after:g,every:h,clear:i}}),define("famous/views/ContextualView",["require","exports","module","../core/Entity","../core/Transform","../core/EventHandler","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._id=e.register(this)}var e=a("../core/Entity"),f=(a("../core/Transform"),a("../core/EventHandler")),g=a("../core/OptionsManager");d.DEFAULT_OPTIONS={},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.render=function(){return this._id},d.prototype.commit=function(){},c.exports=d}),define("famous/views/SequentialLayout",["require","exports","module","../core/OptionsManager","../core/Entity","../core/Transform","../core/ViewSequence","../utilities/Utility"],function(a,b,c){function d(a){this._items=null,this._size=null,this._outputFunction=d.DEFAULT_OUTPUT_FUNCTION,this.options=i.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this.optionsManager=new e(this.options),this.id=f.register(this),this.cachedSize=[void 0,void 0],a&&this.setOptions(a)}var e=a("../core/OptionsManager"),f=a("../core/Entity"),g=a("../core/Transform"),h=a("../core/ViewSequence"),i=a("../utilities/Utility");d.DEFAULT_OPTIONS={direction:i.Direction.Y,itemSpacing:0},d.DEFAULT_OUTPUT_FUNCTION=function(a,b){var c=this.options.direction===i.Direction.X?g.translate(b,0):g.translate(0,b);return{size:this.cachedSize,transform:c,target:a.render()}},d.prototype.getSize=function(){return this._size||this.render(),this._size},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new h(a)),this._items=a,this},d.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},d.prototype.setOutputFunction=function(a){return this._outputFunction=a,this},d.prototype.render=function(){return this.id},d.prototype.commit=function(a){var b=0,c=1^this.options.direction,d=this._items,e=null,f=[],g={},h=[],i=0;for(this._size=[0,0],this.cachedSize=a.size;d&&(e=d.get());)e.getSize&&(f=e.getSize()),g=this._outputFunction.call(this,e,b,i++),h.push(g),f&&(f[this.options.direction]&&(b+=f[this.options.direction]),f[c]>this._size[c]&&(this._size[c]=f[c]),0===f[c]&&(this._size[c]=void 0)),d=d.getNext(),this.options.itemSpacing&&d&&(b+=this.options.itemSpacing);return this._size[this.options.direction]=b,{transform:a.transform,origin:a.origin,size:this.getSize(),target:h}},c.exports=d}),define("famous/views/Deck",["require","exports","module","../core/Transform","../core/OptionsManager","../transitions/Transitionable","../utilities/Utility","./SequentialLayout"],function(a,b,c){function d(){k.apply(this,arguments),this.state=new i(0),this._isOpen=!1,this.setOutputFunction(function(a,b,c){var d=e.call(this),f=this.options.direction===j.Direction.X?g.translate(d*b,0,.001*(d-1)*b):g.translate(0,d*b,.001*(d-1)*b),h=a.render();if(this.options.stackRotation){var i=this.options.stackRotation*c*(1-d);h={transform:g.rotateZ(i),origin:[.5,.5],target:h}}return{transform:f,size:a.getSize(),target:h}})}function e(a){return a?this._isOpen?1:0:this.state.get()}function f(a,b,c){this.state.halt(),this.state.set(a,b,c)}var g=a("../core/Transform"),h=a("../core/OptionsManager"),i=a("../transitions/Transitionable"),j=a("../utilities/Utility"),k=a("./SequentialLayout");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=h.patch(k.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),d.prototype.getSize=function(){var a=k.prototype.getSize.apply(this,arguments),b=this._items?this._items.get().getSize():[0,0];b||(b=[0,0]);var c=e.call(this),d=1-c;return[b[0]*d+a[0]*c,b[1]*d+a[1]*c]},d.prototype.isOpen=function(){return this._isOpen},d.prototype.open=function(a){this._isOpen=!0,f.call(this,1,this.options.transition,a)},d.prototype.close=function(a){this._isOpen=!1,f.call(this,0,this.options.transition,a)},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},c.exports=d}),define("famous/views/DrawerLayout",["require","exports","module","../core/RenderNode","../core/Transform","../core/OptionsManager","../transitions/Transitionable","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),a&&this.setOptions(a),this._position=new m(0),this._direction=e(this.options.side),this._orientation=f(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new j,this.content=new j,this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",h.bind(this)),this._eventInput.on("end",i.bind(this))}function e(a){var b=d.SIDES;return a===b.LEFT||a===b.RIGHT?o:p}function f(a){var b=d.SIDES;return a===b.LEFT||a===b.TOP?1:-1}function g(a){var b,c=this.options;if(c.drawerLength)b=c.drawerLength;else{var d=a.getSize();b=d?d[this._direction]:c.drawerLength}return this._orientation*b}function h(a){var b,c,d=this.getPosition()+a.delta;this._cachedLength=g.call(this,this.drawer),1===this._orientation?(b=0,c=this._cachedLength):(b=this._cachedLength,c=0),d>c?d=c:b>d&&(d=b),this.setPosition(d)}function i(a){var b=a.velocity,c=this._orientation*this.getPosition(),d=this.options,e=this._orientation*this._cachedLength,f=d.positionThreshold||e/2,g=d.velocityThreshold;if(d.transition instanceof Object&&(d.transition.velocity=a.velocity),0===c)return void(this._isOpen=!1);if(c===e)return void(this._isOpen=!0);var h=Math.abs(b)>g||!this._isOpen&&c>f||this._isOpen&&f>c;h?this.toggle():this.reset()}var j=a("../core/RenderNode"),k=a("../core/Transform"),l=a("../core/OptionsManager"),m=a("../transitions/Transitionable"),n=a("../core/EventHandler"),o=0,p=1;d.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},d.DEFAULT_OPTIONS={side:d.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},d.prototype.setOptions=function(a){this._optionsManager.setOptions(a),void 0!==a.side&&(this._direction=e(a.side),this._orientation=f(a.side))},d.prototype.open=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this._cachedLength=g.call(this,this.drawer),this.setPosition(this._cachedLength,a,b),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},d.prototype.close=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this.setPosition(0,a,b),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},d.prototype.setPosition=function(a,b,c){this._position.isActive()&&this._position.halt(),this._position.set(a,b,c)},d.prototype.getPosition=function(){return this._position.get()},d.prototype.setProgress=function(a,b,c){return this._position.set(a*this._cachedLength,b,c)},d.prototype.getProgress=function(){return this._position.get()/this._cachedLength},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},d.prototype.reset=function(a){this._isOpen?this.open(a):this.close(a)},d.prototype.isOpen=function(){return this._isOpen},d.prototype.render=function(){var a=this.getPosition();(!this._isOpen&&0>a&&1===this._orientation||a>0&&-1===this._orientation)&&(a=0,this.setPosition(a));var b=this._direction===o?k.translate(a,0,0):k.translate(0,a,0);return[{transform:k.behind,target:this.drawer.render()},{transform:b,target:this.content.render()}]},c.exports=d}),define("famous/views/RenderController",["require","exports","module","../core/Modifier","../core/RenderNode","../core/Transform","../transitions/Transitionable","../core/View"],function(a,b,c){function d(){j.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=d.DefaultMap.transform,this.inOpacityMap=d.DefaultMap.opacity,this.inOriginMap=d.DefaultMap.origin,this.inAlignMap=d.DefaultMap.align,this.outTransformMap=d.DefaultMap.transform,this.outOpacityMap=d.DefaultMap.opacity,this.outOriginMap=d.DefaultMap.origin,this.outAlignMap=d.DefaultMap.align,this._output=[]}function e(a,b){return a(b.get())}var f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../core/Transform"),i=a("../transitions/Transitionable"),j=a("../core/View");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},d.DefaultMap={transform:function(){return h.identity},opacity:function(a){return a},origin:null,align:null},d.prototype.inTransformFrom=function(a){if(a instanceof Function)this.inTransformMap=a;else{if(!a||!a.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=a.get.bind(a)}return this},d.prototype.inOpacityFrom=function(a){if(a instanceof Function)this.inOpacityMap=a;else{if(!a||!a.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=a.get.bind(a)}return this},d.prototype.inOriginFrom=function(a){if(a instanceof Function)this.inOriginMap=a;else{if(!a||!a.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=a.get.bind(a)}return this},d.prototype.inAlignFrom=function(a){if(a instanceof Function)this.inAlignMap=a;else{if(!a||!a.get)throw new Error("inAlignFrom takes only function or getter object");this.inAlignMap=a.get.bind(a)}return this},d.prototype.outTransformFrom=function(a){if(a instanceof Function)this.outTransformMap=a;else{if(!a||!a.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=a.get.bind(a)}return this},d.prototype.outOpacityFrom=function(a){if(a instanceof Function)this.outOpacityMap=a;else{if(!a||!a.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=a.get.bind(a)}return this},d.prototype.outOriginFrom=function(a){if(a instanceof Function)this.outOriginMap=a;else{if(!a||!a.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=a.get.bind(a)}return this},d.prototype.outAlignFrom=function(a){if(a instanceof Function)this.outAlignMap=a;else{if(!a||!a.get)throw new Error("outAlignFrom takes only function or getter object");this.outAlignMap=a.get.bind(a)}return this},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=a:(this._nextRenderable=a,this.hide(function(){this._nextRenderable===a&&this.show(this._nextRenderable,c),this._nextRenderable=null})));this.hide()}var d=null,h=this._renderables.indexOf(a);if(h>=0){this._showing=h,d=this._states[h],d.halt();var j=this._outgoingRenderables.indexOf(a);j>=0&&this._outgoingRenderables.splice(j,1)}else{d=new i(0);var k=new f({transform:this.inTransformMap?e.bind(this,this.inTransformMap,d):null,opacity:this.inOpacityMap?e.bind(this,this.inOpacityMap,d):null,origin:this.inOriginMap?e.bind(this,this.inOriginMap,d):null,align:this.inAlignMap?e.bind(this,this.inAlignMap,d):null}),l=new g;l.add(k).add(a),this._showing=this._nodes.length,this._nodes.push(l),this._modifiers.push(k),this._states.push(d),this._renderables.push(a)}b||(b=this.options.inTransition),d.set(1,b,c)},d.prototype.hide=function(a,b){if(!(this._showing<0)){var c=this._showing;this._showing=-1,a instanceof Function&&(b=a,a=void 0);var d=this._nodes[c],f=this._modifiers[c],g=this._states[c],h=this._renderables[c];f.transformFrom(this.outTransformMap?e.bind(this,this.outTransformMap,g):null),f.opacityFrom(this.outOpacityMap?e.bind(this,this.outOpacityMap,g):null),f.originFrom(this.outOriginMap?e.bind(this,this.outOriginMap,g):null),f.alignFrom(this.outAlignMap?e.bind(this,this.outAlignMap,g):null),this._outgoingRenderables.indexOf(h)<0&&this._outgoingRenderables.push(h),a||(a=this.options.outTransition),g.halt(),g.set(0,a,function(a,c,d,e){if(this._outgoingRenderables.indexOf(e)>=0){var f=this._nodes.indexOf(a);this._nodes.splice(f,1),this._modifiers.splice(f,1),this._states.splice(f,1),this._renderables.splice(f,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(e),1),this._showing>=f&&this._showing--}b&&b.call(this)}.bind(this,d,f,g,h))}},d.prototype.render=function(){var a=this._output;a.length>this._nodes.length&&a.splice(this._nodes.length);for(var b=0;b<this._nodes.length;b++)a[b]=this._nodes[b].render();return a},c.exports=d}),define("famous/views/EdgeSwapper",["require","exports","module","../transitions/CachedMap","../core/Entity","../core/EventHandler","../core/Transform","./RenderController"],function(a,b,c){function d(a){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new j(a),this._controller.inTransformFrom(f.create(e.bind(this,1e-4))),this._controller.outTransformFrom(f.create(e.bind(this,-1e-4))),this._eventInput=new h,h.setInputHandler(this,this._eventInput),this._entityId=g.register(this),a&&this.setOptions(a)}function e(a,b){return i.translate(this._size[0]*(1-b),0,a*(1-b))}var f=a("../transitions/CachedMap"),g=a("../core/Entity"),h=a("../core/EventHandler"),i=a("../core/Transform"),j=a("./RenderController");d.prototype.show=function(a){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=a,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},d.prototype.setOptions=function(a){this._controller.setOptions(a)},d.prototype.render=function(){return this._entityId},d.prototype.commit=function(a){return this._size[0]=a.size[0],this._size[1]=a.size[1],{transform:a.transform,opacity:a.opacity,origin:a.origin,size:a.size,target:this._controller.render()}},c.exports=d}),define("famous/views/FlexibleLayout",["require","exports","module","../core/Entity","../core/Transform","../core/OptionsManager","../core/EventHandler","../transitions/Transitionable"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new i(this.options),a&&this.setOptions(a),this.id=g.register(this),this._ratios=new k(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new j,j.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var e,f,g,i,j=0,k=b,l=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<a.length;i++)f=a[i],g=this._nodes[i],"number"!=typeof f?k-=g.getSize()[c]||0:l+=f;for(i=0;i<a.length;i++)g=this._nodes[i],f=a[i],b="number"==typeof f?k*f/l:g.getSize()[c],e=c===d.DIRECTION_X?h.translate(j,0,0):h.translate(0,j,0),this._cachedTransforms.push(e),this._cachedLengths.push(b),j+=b}function f(a,b){for(var c=0;c<a.length;c++)if("number"!=typeof a[c]&&this._nodes[c].getSize()[b]!==this._cachedLengths[c])return!0;return!1}var g=a("../core/Entity"),h=a("../core/Transform"),i=a("../core/OptionsManager"),j=a("../core/EventHandler"),k=a("../transitions/Transitionable");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_X,transition:!1,ratios:[]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){if(this._nodes=a,0===this._ratios.get().length){for(var b=[],c=0;c<this._nodes.length;c++)b.push(1);
this.setRatios(b)}},d.prototype.setRatios=function(a,b,c){void 0===b&&(b=this.options.transition);var d=this._ratios;0===d.get().length&&(b=void 0),d.isActive()&&d.halt(),d.set(a,b,c),this._ratiosDirty=!0},d.prototype.getSize=function(){return this._size},d.prototype.commit=function(a){var b,c=a.size,d=a.transform,g=a.origin,i=a.opacity,j=this._ratios.get(),k=this.options.direction,l=c[k];(l!==this._size[k]||this._ratiosDirty||this._ratios.isActive()||k!==this._cachedDirection||f.call(this,j,k))&&(e.call(this,j,l,k),l!==this._size[k]&&(this._size[0]=c[0],this._size[1]=c[1]),k!==this._cachedDirection&&(this._cachedDirection=k),this._ratiosDirty&&(this._ratiosDirty=!1));for(var m=[],n=0;n<j.length;n++)b=[void 0,void 0],l=this._cachedLengths[n],b[k]=l,m.push({transform:this._cachedTransforms[n],size:b,target:this._nodes[n].render()});return c&&0!==g[0]&&0!==g[1]&&(d=h.moveThen([-c[0]*g[0],-c[1]*g[1],0],d)),{transform:d,size:c,opacity:i,target:m}},c.exports=d}),define("famous/views/Flipper",["require","exports","module","../core/Transform","../transitions/Transitionable","../core/RenderNode","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this.angle=new f(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var e=a("../core/Transform"),f=a("../transitions/Transitionable"),g=(a("../core/RenderNode"),a("../core/OptionsManager"));d.DIRECTION_X=0,d.DIRECTION_Y=1;var h=1;d.DEFAULT_OPTIONS={transition:!0,direction:d.DIRECTION_X},d.prototype.flip=function(a,b){var c=this.flipped?0:Math.PI;this.setAngle(c,a,b),this.flipped=!this.flipped},d.prototype.setAngle=function(a,b,c){void 0===b&&(b=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(a,b,c)},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.setFront=function(a){this.frontNode=a},d.prototype.setBack=function(a){this.backNode=a},d.prototype.render=function(){var a,b,c=this.angle.get();this.options.direction===d.DIRECTION_X?(a=e.rotateY(c),b=e.rotateY(c+Math.PI)):(a=e.rotateX(c),b=e.rotateX(c+Math.PI));var f=[];return this.frontNode&&f.push({transform:a,target:this.frontNode.render()}),this.backNode&&f.push({transform:e.moveThen([0,0,h],b),target:this.backNode.render()}),f},c.exports=d}),define("famous/views/GridLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/ViewSequence","../core/EventHandler","../core/Modifier","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new m(this.options),a&&this.setOptions(a),this.id=h.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new k,k.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var e,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){e=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?f.call(this,k,[i,h],[e,j,0],1):g.call(this,k,[i,h],[e,j,0],1),k++,e+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)g.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function f(a,b,c,d){var e={transform:new o(i.translate.apply(null,c)),opacity:new n(d),size:new n(b)},f=new l({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function g(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var h=a("../core/Entity"),i=(a("../core/RenderNode"),a("../core/Transform")),j=a("../core/ViewSequence"),k=a("../core/EventHandler"),l=a("../core/Modifier"),m=a("../core/OptionsManager"),n=a("../transitions/Transitionable"),o=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new j(a)),this.sequence=a},d.prototype.getSize=function(){return this._contextSizeCache},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.size,g=this.options.dimensions[0],h=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||h!==this._dimensionsCache[1])&&e.call(this,f,g,h);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:d,target:m.render()})),j=j.getNext(),l++}return f&&(b=i.moveThen([-f[0]*d[0],-f[1]*d[1],0],b)),{transform:b,opacity:c,size:f,target:k}},c.exports=d}),define("famous/views/HeaderFooterLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._entityId=h.register(this),this.header=new i,this.footer=new i,this.content=new i}function e(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function f(a){return this.options.direction===d.DIRECTION_X?j.translate(a,0,0):j.translate(0,a,0)}function g(a,b){return this.options.direction===d.DIRECTION_X?[a,b[1]]:[b[0],a]}var h=a("../core/Entity"),i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},d.prototype.render=function(){return this._entityId},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,d=a.size,h=a.opacity,i=void 0!==this.options.headerSize?this.options.headerSize:e.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:e.call(this,this.footer,this.options.defaultFooterSize),l=d[this.options.direction]-i-k;d&&(b=j.moveThen([-d[0]*c[0],-d[1]*c[1],0],b));var m=[{size:g.call(this,i,d),target:this.header.render()},{transform:f.call(this,i),size:g.call(this,l,d),target:this.content.render()},{transform:f.call(this,i+l),size:g.call(this,k,d),target:this.footer.render()}];return{transform:b,opacity:h,size:d,target:m}},c.exports=d}),define("famous/views/Lightbox",["require","exports","module","../core/Transform","../core/Modifier","../core/RenderNode","../utilities/Utility","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var e=a("../core/Transform"),f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../utilities/Utility"),i=a("../core/OptionsManager"),j=a("../transitions/Transitionable"),k=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={inTransform:e.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:e.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:e.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,a,b,c));this.hide()}this._showing=!0;var d={transform:new k(this.options.inTransform),origin:new j(this.options.inOrigin),align:new j(this.options.inAlign),opacity:new j(this.options.inOpacity)},e=new f({transform:d.transform,opacity:d.opacity,origin:d.origin,align:d.align}),i=new g;i.add(e).add(a),this.nodes.push(i),this.states.push(d),this.transforms.push(e);var l=c?h.after(3,c):void 0;b||(b=this.options.inTransition),d.transform.set(this.options.showTransform,b,l),d.opacity.set(this.options.showOpacity,b,l),d.origin.set(this.options.showOrigin,b,l),d.align.set(this.options.showAlign,b,l)},d.prototype.hide=function(a,b){if(this._showing){this._showing=!1,a instanceof Function&&(b=a,a=void 0);var c=this.nodes[this.nodes.length-1],d=this.transforms[this.transforms.length-1],e=this.states[this.states.length-1],f=h.after(3,function(){this.nodes.splice(this.nodes.indexOf(c),1),this.states.splice(this.states.indexOf(e),1),this.transforms.splice(this.transforms.indexOf(d),1),b&&b.call(this)}.bind(this));a||(a=this.options.outTransition),e.transform.set(this.options.outTransform,a,f),e.opacity.set(this.options.outOpacity,a,f),e.origin.set(this.options.outOrigin,a,f),e.align.set(this.options.outAlign,a,f)}},d.prototype.render=function(){for(var a=[],b=0;b<this.nodes.length;b++)a.push(this.nodes[b].render());return a},c.exports=d}),define("famous/views/Scroller",["require","exports","module","../core/Entity","../core/Group","../core/OptionsManager","../core/Transform","../utilities/Utility","../core/ViewSequence","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new j,this.group.add({render:h.bind(this)}),this._entityId=i.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput)}function e(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function f(a,b,c){var d=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),e.call(this,d)}function g(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?e.call(this,this.getCumulativeSize()):e.call(this,this._contextSize)}function h(){for(var a=null,b=this._position,c=[],d=-this._positionOffset,h=g.call(this),i=this._node;i&&d-b<h+this.options.margin;)d+=f.call(this,i,d,c),i=i.getNext?i.getNext():null;var j=this._node,k=e.call(this,j.getSize());if(h>d){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=e.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=e.call(this,j.getSize()))}for(!i&&h-p>d-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:d-h})):!this._node.getPrevious()&&-p>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,d=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));i&&d-b>-(h+this.options.margin);)f.call(this,i,d,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));return c}var i=a("../core/Entity"),j=a("../core/Group"),k=a("../core/OptionsManager"),l=a("../core/Transform"),m=a("../utilities/Utility"),n=a("../core/ViewSequence"),o=a("../core/EventHandler");d.DEFAULT_OPTIONS={direction:m.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var p=0;d.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},d.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},d.prototype.onEdge=function(){return this._onEdge},d.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===m.Direction.X?l.translate(a,0):l.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return l.inverse(a(-b))}},d.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new n({array:a})),this._node=a,this._positionOffset=0},d.prototype.getSize=function(a){return a?this._contextSize:this._size},d.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===m.Direction.X?(this._size[0]=g.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=g.call(this)));var f=this._masterOutputFunction(-this._position);return{transform:l.multiply(b,f),size:e,opacity:c,origin:d,target:this.group.render()}},c.exports=d}),define("famous/views/Scrollview",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Drag","../physics/forces/Spring","../core/EventHandler","../core/OptionsManager","../core/ViewSequence","../views/Scroller","../utilities/Utility","../inputs/GenericSync","../inputs/ScrollSync","../inputs/TouchSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new v(this.options),this._scroller=new x(this.options),this.sync=new z(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==y.Direction.Y}),this._physicsEngine=new q,this._particle=new r,this._physicsEngine.addBody(this._particle),this.spring=new t({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new s({forceFunction:s.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new s({forceFunction:s.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=C.NONE,this._onEdge=D.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new u,this._eventOutput=new u,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),h.call(this),a&&this.setOptions(a)}function e(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),j.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function f(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==D.NONE&&a.slip&&(0>b&&this._onEdge===D.TOP||b>0&&this._onEdge===D.BOTTOM?this._earlyEnd||(g.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&e.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var d=this.options.speedLimit;-d>b?b=-d:b>d&&(b=d),this.setVelocity(b);var f=16*d;c>f?c=f:-f>c&&(c=-f)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===C.NONE&&o.call(this)}}function g(a){if(this._touchCount=a.count||0,!this._touchCount){j.call(this),this._onEdge!==D.NONE&&n.call(this,this._edgeSpringPosition,C.EDGE),i.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function h(){this._eventInput.bindThis(this),this._eventInput.on("start",e),this._eventInput.on("update",f),this._eventInput.on("end",g),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,l.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===C.NONE&&o.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==C.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function i(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function j(){this._springState=C.NONE,this._physicsEngine.detachAll()}function k(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function l(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===C.EDGE||n.call(this,this._edgeSpringPosition,C.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(j.call(this),i.call(this))}function m(){if(!this._touchCount&&this._springState!==C.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=k.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():n.call(this,0,C.PAGE)}}}function n(a,b){var c;b===C.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===C.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(j.call(this),this._springState=b,i.call(this)),this._springState=b}function o(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=k.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=k.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=k.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&p.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function p(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===C.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===C.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Drag"),t=a("../physics/forces/Spring"),u=a("../core/EventHandler"),v=a("../core/OptionsManager"),w=a("../core/ViewSequence"),x=a("../views/Scroller"),y=a("../utilities/Utility"),z=a("../inputs/GenericSync"),A=a("../inputs/ScrollSync"),B=a("../inputs/TouchSync");z.register({scroll:A,touch:B});var C={NONE:0,EDGE:1,PAGE:2},D={TOP:-1,NONE:0,BOTTOM:1};d.DEFAULT_OPTIONS={direction:y.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},d.prototype.getCurrentIndex=function(){return this._node.index},d.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===D.TOP)return null;if(this.getPosition()>1&&this._springState===C.NONE)return n.call(this,0,C.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=k.call(this,a);this._scroller.sequenceFrom(a),this._node=a,p.call(this,b),n.call(this,0,C.PAGE)}return a},d.prototype.goToNextPage=function(){if(!this._node||this._onEdge===D.BOTTOM)return null;var a=this._node.getNext();if(a){var b=k.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,p.call(this,-b),n.call(this,0,C.PAGE)}return a},d.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},d.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},d.prototype.getPosition=function(){return this._particle.getPosition1D()},d.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},d.prototype.getOffset=d.prototype.getPosition,d.prototype.setPosition=function(a){this._particle.setPosition1D(a)},d.prototype.setOffset=d.prototype.setPosition,d.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},d.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},d.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=y.Direction.X:"y"===a.direction&&(a.direction=y.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===y.Direction.X?z.DIRECTION_X:z.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new w({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},d.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},d.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&m.call(this),this._scroller.render()},c.exports=d}),define("famous/views/ScrollContainer",["require","exports","module","../surfaces/ContainerSurface","../core/EventHandler","./Scrollview","../utilities/Utility","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this.container=new e(this.options.container),this.scrollview=new g(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var e=a("../surfaces/ContainerSurface"),f=a("../core/EventHandler"),g=a("./Scrollview"),h=(a("../utilities/Utility"),a("../core/OptionsManager"));d.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},d.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},d.prototype.render=function(){return this.container.render()},c.exports=d}),define("famous/widgets/NavigationBar",["require","exports","module","../core/Scene","../core/Surface","../core/Transform","../core/View"],function(a,b,c){function d(){h.apply(this,arguments),this.title=new f({classes:this.options.classes,content:this.options.content}),this.back=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new e({id:"master",size:this.options.size,target:[{transform:g.inFront,origin:[0,.5],align:[0,.5],target:this.back},{origin:[.5,.5],align:[.5,.5],target:this.title},{transform:g.inFront,origin:[1,.5],align:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(a){var b=a.id,c=a.value;"size"===b?(this.layout.id.master.setSize(c),this.title.setSize(c),this.back.setSize([c[1],c[1]]),this.more.setSize([c[1],c[1]])):"backClasses"===b?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===b?this.back.setContent(this.options.backContent):"classes"===b?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===b?this.setContent(this.options.content):"moreClasses"===b?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===b&&this.more.setContent(this.options.content)}.bind(this))}var e=a("../core/Scene"),f=a("../core/Surface"),g=a("../core/Transform"),h=a("../core/View");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},d.prototype.setContent=function(a){return this.title.setContent(a)},c.exports=d}),define("famous/widgets/Slider",["require","exports","module","../core/Surface","../surfaces/CanvasSurface","../core/Transform","../core/EventHandler","../math/Utilities","../core/OptionsManager","../inputs/MouseSync","../inputs/TouchSync","../inputs/GenericSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new k(this.options),a&&this.setOptions(a),this.indicator=new g({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new f({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new i,this.eventInput=new i,i.setInputHandler(this,this.eventInput),i.setOutputHandler(this,this.eventOutput);var b=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new n(["mouse","touch"],{scale:b,direction:n.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(a){this.set(a.position)}.bind(this)),this._drawPos=0,e.call(this)}function e(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var f=a("../core/Surface"),g=a("../surfaces/CanvasSurface"),h=a("../core/Transform"),i=a("../core/EventHandler"),j=a("../math/Utilities"),k=a("../core/OptionsManager"),l=a("../inputs/MouseSync"),m=a("../inputs/TouchSync"),n=a("../inputs/GenericSync");n.register({mouse:l,touch:m}),d.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.get=function(){return this.options.value},d.prototype.set=function(a){a!==this.options.value&&(this.options.value=j.clamp(a,this.options.range),e.call(this),this.eventOutput.emit("change",{value:a}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){var a=this.options.range,b=Math.floor((this.get()-a[0])/(a[1]-a[0])*this.options.indicatorSize[0]);if(b<this._drawPos)this.indicator.getContext("2d").clearRect(b,0,this._drawPos-b+1,this.options.indicatorSize[1]);else if(b>this._drawPos){var c=this.indicator.getContext("2d");c.fillStyle=this.options.fillColor,c.fillRect(this._drawPos-1,0,b-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=b,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:h.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},c.exports=d}),define("famous/widgets/ToggleButton",["require","exports","module","../core/Surface","../core/EventHandler","../views/RenderController"],function(a,b,c){function d(a){this.options={content:["",""],offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:d.TOGGLE,crossfade:!0},this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.offSurface=new e,this.offSurface.on("click",function(){this.options.toggleMode!==d.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new e,this.onSurface.on("click",function(){this.options.toggleMode!==d.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new g({overlap:this.options.crossfade}),this.deselect(),a&&this.setOptions(a)}var e=a("../core/Surface"),f=a("../core/EventHandler"),g=a("../views/RenderController");d.OFF=0,d.ON=1,d.TOGGLE=2,d.prototype.select=function(a){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),a||this._eventOutput.emit("select")},d.prototype.deselect=function(a){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),a||this._eventOutput.emit("deselect")},d.prototype.isSelected=function(){return this.selected},d.prototype.setOptions=function(a){void 0!==a.content&&(a.content instanceof Array||(a.content=[a.content,a.content]),this.options.content=a.content,this.offSurface.setContent(this.options.content[0]),this.onSurface.setContent(this.options.content[1])),a.offClasses&&(this.options.offClasses=a.offClasses,this.offSurface.setClasses(this.options.offClasses)),a.onClasses&&(this.options.onClasses=a.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==a.size&&(this.options.size=a.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==a.toggleMode&&(this.options.toggleMode=a.toggleMode),void 0!==a.outTransition&&(this.options.outTransition=a.outTransition),void 0!==a.inTransition&&(this.options.inTransition=a.inTransition),void 0!==a.crossfade&&(this.options.crossfade=a.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){return this.arbiter.render()},c.exports=d}),define("famous/widgets/TabBar",["require","exports","module","../utilities/Utility","../core/View","../views/GridLayout","./ToggleButton"],function(a,b,c){function d(){h.apply(this,arguments),this.layout=new i,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",e.bind(this))}function e(a){var b=a.id,c=a.value;
if("direction"===b)this.layout.setOptions({dimensions:f.call(this.buttons.length,this.options.direction)});else if("buttons"===b)for(var d in this.buttons)this.buttons[d].setOptions(c);else if("sections"===b)for(var e in this.options.sections)this.defineSection(e,this.options.sections[e])}function f(a,b){return b===g.Direction.X?[a,1]:[1,a]}var g=a("../utilities/Utility"),h=a("../core/View"),i=a("../views/GridLayout"),j=a("./ToggleButton");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={sections:[],widget:j,size:[void 0,50],direction:g.Direction.X,buttons:{toggleMode:j.ON}},d.prototype.defineSection=function(a,b){var c,d=this._buttonIds[a];if(void 0===d){d=this.buttons.length,this._buttonIds[a]=d;var e=this.options.widget;c=new e,this.buttons[d]=c,this.layout.setOptions({dimensions:f(this.buttons.length,this.options.direction)})}else c=this.buttons[d],c.unbind("select",this._buttonCallbacks[a]);this.options.buttons&&c.setOptions(this.options.buttons),c.setOptions(b),this._buttonCallbacks[a]=this.select.bind(this,a),c.on("select",this._buttonCallbacks[a])},d.prototype.select=function(a){var b=this._buttonIds[a];this.buttons[b]&&this.buttons[b].isSelected()?this._eventOutput.emit("select",{id:a}):this.buttons[b]&&this.buttons[b].select();for(var c=0;c<this.buttons.length;c++)c!==b&&this.buttons[c].deselect()},c.exports=d}),define("famous/core/Entity",["require","exports","module"],function(a,b,c){function d(a){return h[a]}function e(a,b){h[a]=b}function f(a){var b=h.length;return e(b,a),b}function g(a){e(a,null)}var h=[];c.exports={register:f,unregister:g,get:d,set:e}}),define("famous/core/Transform",["require","exports","module"],function(a,b,c){function d(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function e(a){return Math.sqrt(d(a))}function f(a){return 0>a?-1:1}var g={};g.precision=1e-6,g.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},g.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]},g.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},g.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return g.thenMove(b,[c,d,e])},g.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},g.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},g.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},g.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},g.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},g.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},g.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},g.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},g.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return g.thenMove(b,[c,d,e])},g.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},g.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},g.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},g.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},g.getTranslate=function(a){return[a[12],a[13],a[14]]},g.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},g.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},g.interpret=function(a){var b=[a[0],a[1],a[2]],c=f(b[0]),h=e(b),i=[b[0]+c*h,b[1],b[2]],j=2/d(i);if(j>=1/0)return{translate:g.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=g.multiply(k,a),m=[l[5],l[6]],n=f(m[0]),o=e(m),p=[m[0]+n*o,m[1]],q=2/d(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=g.multiply(r,k),t=g.multiply(s,a),u=g.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=g.multiply(t,u),s=g.multiply(u,s);var v={};return v.translate=g.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},g.average=function(a,b,c){c=void 0===c?.5:c;for(var d=g.interpret(a),e=g.interpret(b),f={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)f.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],f.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],f.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],f.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return g.build(f)},g.build=function(a){var b=g.scale(a.scale[0],a.scale[1],a.scale[2]),c=g.skew(a.skew[0],a.skew[1],a.skew[2]),d=g.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return g.thenMove(g.multiply(g.multiply(d,c),b),a.translate)},g.equals=function(a,b){return!g.notEquals(a,b)},g.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},g.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},g.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],g.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],c.exports=g}),define("famous/core/SpecParser",["require","exports","module","./Transform"],function(a,b,c){function d(){this.result={}}function e(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var f=a("./Transform");d._instance=new d,d.parse=function(a,b){return d._instance.parse(a,b)},d.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,f.identity),this.result},d.prototype.reset=function(){this.result={}};var g=[0,0];d.prototype._parseSpec=function(a,b,c){var d,h,i,j,k,l,m;if("number"==typeof a){if(d=a,i=b.transform,l=b.align||g,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=f.thenMove(i,e(n,c))}this.result[d]={transform:i,opacity:b.opacity,origin:b.origin||g,align:b.align||g,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=f.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=f.thenMove(i,e([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=f.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},c.exports=d}),define("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(a,b,c){function d(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function e(a,b,c){for(var d=g.parse(a,b),h=Object.keys(d),i=0;i<h.length;i++){var j=h[i],k=f.get(j),l=d[j];l.allocator=b.allocator;var m=k.commit(l);m?e(m,b,c):c[j]=l}}var f=a("./Entity"),g=a("./SpecParser");d.prototype.add=function(a){var b=a instanceof d?a:new d(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},d.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},d.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof d?a:this},d.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},d.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var d=b[c];if(void 0===this._resultCache[d]){var g=f.get(d);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},e(this.render(),a,this._resultCache)},d.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},c.exports=d}),define("famous/core/EventEmitter",["require","exports","module"],function(a,b,c){function d(){this.listeners={},this._owner=this}d.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},d.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},d.prototype.bindThis=function(a){this._owner=a},c.exports=d}),define("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(a,b,c){function d(){e.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var e=a("./EventEmitter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},d.setOutputHandler=function(a,b){b instanceof d&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},d.prototype.emit=function(a,b){e.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},d.prototype.trigger=d.prototype.emit,d.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},d.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},d.prototype.on=function(a){if(e.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},d.prototype.addListener=d.prototype.on,d.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},d.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},c.exports=d}),define("famous/core/ElementAllocator",["require","exports","module"],function(a,b,c){function d(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}d.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},d.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},d.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},d.prototype.getNodeCount=function(){return this.nodeCount},c.exports=d}),define("famous/utilities/Utility",["require","exports","module"],function(a,b,c){var d={};d.Direction={X:0,Y:1,Z:2},d.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},d.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},d.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},d.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var c in a)if("object"==typeof a[c]&&null!==a[c])if(a[c]instanceof Array){b[c]=Array(a[c].length);for(var e=0;e<a[c].length;e++)b[c][e]=d.clone(a[c][e])}else b[c]=d.clone(a[c]);else b[c]=a[c]}else b=a;return b},c.exports=d}),define("famous/transitions/MultipleTransition",["require","exports","module","../utilities/Utility"],function(a,b,c){function d(a){this.method=a,this._instances=[],this.state=[]}var e=a("../utilities/Utility");d.SUPPORTS_MULTIPLE=!0,d.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},d.prototype.set=function(a,b,c){for(var d=e.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,d)},d.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},c.exports=d}),define("famous/transitions/TweenTransition",["require","exports","module"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function e(a,b,c){return(1-c)*a+c*b}function f(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function g(a,b){var c={curve:b.curve};return b.duration&&(c.duration=b.duration),b.speed&&(c.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(c.duration=a.duration),a.curve&&(c.curve=a.curve),a.speed&&(c.speed=a.speed)),"string"==typeof c.curve&&(c.curve=d.getCurve(c.curve)),c}function h(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function i(a,b,c){var d;if(a instanceof Array){d=[];for(var f=0;f<a.length;f++)d[f]="number"==typeof a[f]?e(a[f],b[f],c):a[f]}else d=e(a,b,c);return d}d.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},d.SUPPORTS_MULTIPLE=!0,d.DEFAULT_OPTIONS={curve:d.Curves.linear,duration:500,speed:0};var j={};d.registerCurve=function(a,b){return j[a]?!1:(j[a]=b,!0)},d.unregisterCurve=function(a){return j[a]?(delete j[a],!0):!1},d.getCurve=function(a){var b=j[a];if(void 0!==b)return b;throw Error("curve not registered")},d.getCurves=function(){return j},d.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=f(this.get()),b=g(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var e=0;for(var h in d)e+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(e)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=f(a),this._startVelocity=f(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},d.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=f(a),this.velocity=f(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},d.prototype.getVelocity=function(){return this.velocity},d.prototype.get=function(a){return this.update(a),this.state},d.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=h(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=i(this._startValue,this._endValue,this._curve(c)),this.velocity=h(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},d.prototype.isActive=function(){return this._active},d.prototype.halt=function(){this.reset(this.get())},d.registerCurve("linear",d.Curves.linear),d.registerCurve("easeIn",d.Curves.easeIn),d.registerCurve("easeOut",d.Curves.easeOut),d.registerCurve("easeInOut",d.Curves.easeInOut),d.registerCurve("easeOutBounce",d.Curves.easeOutBounce),d.registerCurve("spring",d.Curves.spring),d.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},c.exports=d}),define("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(a,b,c){function d(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function e(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],d=this.currentAction[1];d instanceof Object&&d.method?(b=d.method,"string"==typeof b&&(b=h[b])):b=g,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new f(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(d.velocity=this.velocity),this._engineInstance.set(c,d,e.bind(this))}var f=a("./MultipleTransition"),g=a("./TweenTransition"),h={};d.register=function(a){var b=!0;for(var c in a)d.registerMethod(c,a[c])||(b=!1);return b},d.registerMethod=function(a,b){return a in h?!1:(h[a]=b,!0)},d.unregisterMethod=function(a){return a in h?(delete h[a],!0):!1},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var d=[a,b];return this.actionQueue.push(d),this.callbackQueue.push(c),this.currentAction||e.call(this),this},d.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},d.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},d.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},d.prototype.isActive=function(){return!!this.currentAction},d.prototype.halt=function(){return this.set(this.get())},c.exports=d}),define("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","../transitions/Transitionable"],function(a,b,c){function d(a){return[a.clientWidth,a.clientHeight]}function e(a){this.container=a,this._allocator=new h(a),this._node=new f,this._eventOutput=new g,this._size=d(this.container),this._perspectiveState=new j(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:i.identity,opacity:1,origin:k,align:k,size:this._size},this._eventOutput.on("resize",function(){this.setSize(d(this.container))}.bind(this))}var f=a("./RenderNode"),g=a("./EventHandler"),h=a("./ElementAllocator"),i=a("./Transform"),j=a("../transitions/Transitionable"),k=[0,0],l=!("perspective"in document.documentElement.style),m=l?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};e.prototype.getAllocator=function(){return this._allocator},e.prototype.add=function(a){return this._node.add(a)},e.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},e.prototype.getSize=function(){return this._size},e.prototype.setSize=function(a){a||(a=d(this.container)),this._size[0]=a[0],this._size[1]=a[1]},e.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(m(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},e.prototype.getPerspective=function(){return this._perspectiveState.get()},e.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},e.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},e.prototype.on=function(a,b){return this._eventOutput.on(a,b)},e.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},e.prototype.pipe=function(a){return this._eventOutput.pipe(a)},e.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.exports=e}),define("famous/core/ElementOutput",["require","exports","module","./Entity","./EventHandler","./Transform"],function(a,b,c){function d(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new k,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=j.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function e(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function f(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function g(a){a[12]=Math.round(a[12]*n)/n,a[13]=Math.round(a[13]*n)/n;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function h(a){return 100*a[0]+"% "+100*a[1]+"%"}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./Entity"),k=a("./EventHandler"),l=a("./Transform"),m=!("transform"in document.documentElement.style),n=window.devicePixelRatio||1;d.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},d.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},d.prototype.render=function(){return this.id};var o;o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=g(b)}:m?function(a,b){a.style.webkitTransform=g(b)}:function(a,b){a.style.transform=g(b)};var p=m?function(a,b){a.style.webkitTransformOrigin=h(b)}:function(a,b){a.style.transformOrigin=h(b)},q=m?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};d.prototype.commit=function(a){var b=this._element;if(b){var c=a.transform,d=a.opacity,e=a.origin;if(a.size,!c&&this._matrix)return this._matrix=null,this._opacity=0,void q(b);if(i(this._origin,e)&&(this._originDirty=!0),l.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,p(b,this._origin),this._originDirty=!1),c||(c=l.identity),this._matrix=c;var f=this._size?l.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;o(b,f),this._transformDirty=!1}}},d.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},d.prototype.attach=function(a){this._element=a,e.call(this,a)},d.prototype.detach=function(){var a=this._element;return a&&(f.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},c.exports=d}),define("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(a,b,c){function d(a){this._value=a,this.eventOutput=null}function e(){this.eventOutput=new f,this.eventOutput.bindThis(this),f.setOutputHandler(this,this.eventOutput)}var f=a("./EventHandler");d.patch=function(a){for(var b=new d(a),c=1;c<arguments.length;c++)b.patch(arguments[c]);return a},d.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},d.prototype.setOptions=d.prototype.patch,d.prototype.key=function(a){var b=new d(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},d.prototype.get=function(a){return a?this._value[a]:this._value},d.prototype.getOptions=d.prototype.get,d.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(a,b,c){function d(){y.runLoop?(o.step(),window.requestAnimationFrame(d)):v=!1}function e(){for(var a=0;a<p.length;a++)p[a].emit("resize");x.emit("resize")}function f(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),g()}function g(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void o.nextTick(g)}function h(a,b){return document.body?void document.body.addEventListener(a,b):void o.nextTick(addEventListener.bind(this,a,b))}function i(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void o.nextTick(i.bind(this,a,b))}var j,k,l=a("./Context"),m=a("./EventHandler"),n=a("./OptionsManager"),o={},p=[],q=[],r=0,s=0,t=[],u=Date.now(),v=!0,w={},x=new m,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},z=new n(y),A=10;o.step=function(){r++,s=r;var a=Date.now();if(!(k&&k>a-u)){var b=0;j=a-u,u=a,x.emit("prerender");for(var c=q.length;c--;)q.shift()(r);for(;t.length&&Date.now()-a<A;)t.shift().call(this);for(b=0;b<p.length;b++)p[b].update();x.emit("postrender")}},window.requestAnimationFrame(d),window.addEventListener("resize",e,!1),e();var B=!1;o.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(o):x.pipe(a)},o.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(o):x.unpipe(a)},o.on=function(a,b){return a in w||(w[a]=x.emit.bind(x,a),h(a,w[a])),x.on(a,b)},o.emit=function(a,b){return x.emit(a,b)},o.removeListener=function(a,b){return x.removeListener(a,b)},o.getFPS=function(){return 1e3/j},o.setFPSCap=function(a){k=Math.floor(1e3/a)},o.getOptions=function(a){return z.getOptions(a)},o.setOptions=function(){return z.setOptions.apply(z,arguments)},o.createContext=function(a){!B&&y.appMode&&o.nextTick(f);var b=!1;a||(a=document.createElement(y.containerType),a.classList.add(y.containerClass),b=!0);var c=new l(a);return o.registerContext(c),b&&i(c,a),c},o.registerContext=function(a){return p.push(a),a},o.getContexts=function(){return p},o.deregisterContext=function(a){var b=p.indexOf(a);
b>=0&&p.splice(b,1)},o.nextTick=function(a){q.push(a)},o.defer=function(a){t.push(a)},z.on("change",function(a){"fpsCap"===a.id?o.setFPSCap(a.value):"runLoop"===a.id&&!v&&a.value&&(v=!0,window.requestAnimationFrame(d))}),c.exports=o}),define("famous/core/Surface",["require","exports","module","./ElementOutput"],function(a,b,c){function d(a){k.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function e(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function f(a){for(var b in this.properties)a.style[b]=this.properties[b]}function g(a){for(var b in this.properties)a.style[b]=""}function h(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function i(a){for(var b in this.attributes)a.removeAttribute(b)}function j(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var k=a("./ElementOutput");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[b]=a[b]}this._attributesDirty=!0},d.prototype.getAttributes=function(){return this.attributes},d.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},d.prototype.getProperties=function(){return this.properties},d.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},d.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},d.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},d.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},d.prototype.getClassList=function(){return this.classList},d.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},d.prototype.getContent=function(){return this.content},d.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},d.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},d.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){e.call(this,b);for(var d=this.getClassList(),g=0;g<d.length;g++)b.classList.add(d[g]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(f.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(h.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var i=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=i[0]),void 0===c[1]&&(c[1]=i[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}j(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),k.prototype.commit.call(this,a)},d.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",g.call(this,c),i.call(this,c);var d=this.getClassList();for(e.call(this,c),b=0;b<d.length;b++)c.classList.remove(d[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},d.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},d.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},d.prototype.getSize=function(){return this._size?this._size:this.size},d.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},c.exports=d}),define("famous/core/Group",["require","exports","module","./Context","./Transform","./Surface"],function(a,b,c){function d(a){g.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new e(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var e=a("./Context"),f=a("./Transform"),g=a("./Surface");d.SIZE_ZERO=[0,0],d.prototype=Object.create(g.prototype),d.prototype.elementType="div",d.prototype.elementClass="famous-group",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return g.prototype.render.call(this)},d.prototype.deploy=function(a){this.context.migrate(a)},d.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,e=a.opacity,h=a.size,i=g.prototype.commit.call(this,{allocator:a.allocator,transform:f.thenMove(b,[-c[0]*h[0],-c[1]*h[1],0]),opacity:e,origin:c,size:d.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:f.translate(-c[0]*h[0],-c[1]*h[1],0),origin:c,size:h}),i},c.exports=d}),define("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","../core/Transform","../utilities/Utility"],function(a,b,c){function d(a){this._final=h.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new g(this._finalTranslate),this.rotate=new g(this._finalRotate),this.skew=new g(this._finalSkew),this.scale=new g(this._finalScale),a&&this.set(a)}function e(){return h.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function f(){return h.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var g=a("./Transitionable"),h=a("../core/Transform"),i=a("../utilities/Utility");d.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=f.call(this),this.translate.set(a,b,c),this},d.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=f.call(this),this.scale.set(a,b,c),this},d.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=f.call(this),this.rotate.set(a,b,c),this},d.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=f.call(this),this.skew.set(a,b,c),this},d.prototype.set=function(a,b,c){var d=h.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?i.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},d.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},d.prototype.get=function(){return this.isActive()?e.call(this):this._final},d.prototype.getFinal=function(){return this._final},d.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},d.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},c.exports=d}),define("famous/core/Modifier",["require","exports","module","./Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:f.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function e(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var f=a("./Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},d.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},d.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},d.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},d.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},d.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},d.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new h(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},d.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new g(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},d.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new g(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},d.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new g(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},d.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new g(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},d.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new g(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},d.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},d.prototype.getTransform=function(){return this._transformGetter()},d.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},d.prototype.getOpacity=function(){return this._opacityGetter()},d.prototype.getOrigin=function(){return this._originGetter()},d.prototype.getAlign=function(){return this._alignGetter()},d.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},d.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},d.prototype.modify=function(a){return e.call(this),this._output.target=a,this._output},c.exports=d}),define("famous/core/Scene",["require","exports","module","./Transform","./Modifier","./RenderNode"],function(a,b,c){function d(a){this.id=null,this._objects=null,this.node=new k,this._definition=null,a&&this.load(a)}function e(a){for(var b in l)if(b in a){var c=a[b];return c instanceof Array||(c=[c]),l[b].apply(this,c)}}function f(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.align,g=a.size,h=i.identity;if(b instanceof Array)if(16===b.length&&"number"==typeof b[0])h=b;else for(var k=0;k<b.length;k++)h=i.multiply(h,e(b[k]));else b instanceof Function?h=b:b instanceof Object&&(h=e(b));var l=new j({transform:h,opacity:c,origin:d,align:f,size:g});return l}function g(a){for(var b=new k,c=0;c<a.length;c++){var d=h.call(this,a[c]);d&&b.add(d)}return b}function h(a){var b,c;if(a instanceof Array)b=g.call(this,a);else if(c=this._objects.length,a.render&&a.render instanceof Function)b=a;else if(a.target){var d=h.call(this,a.target),e=f.call(this,a);b=new k(e),b.add(d),a.id&&(this.id[a.id]=e)}else a.id&&(b=new k,this.id[a.id]=b);return this._objects[c]=b,b}var i=a("./Transform"),j=a("./Modifier"),k=a("./RenderNode"),l={translate:i.translate,rotate:i.rotate,rotateX:i.rotateX,rotateY:i.rotateY,rotateZ:i.rotateZ,rotateAxis:i.rotateAxis,scale:i.scale,skew:i.skew,matrix3d:function(){return arguments}};d.prototype.create=function(){return new d(this._definition)},d.prototype.load=function(a){this._definition=a,this.id={},this._objects=[],this.node.set(h.call(this,a))},d.prototype.add=function(){return this.node.add.apply(this.node,arguments)},d.prototype.render=function(){return this.node.render.apply(this.node,arguments)},c.exports=d}),define("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode","../utilities/Utility"],function(a,b,c){function d(a){this._node=new g,this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.options=h.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a)}var e=a("./EventHandler"),f=a("./OptionsManager"),g=a("./RenderNode"),h=a("../utilities/Utility");d.DEFAULT_OPTIONS={},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.setOptions=function(a){this._optionsManager.patch(a)},d.prototype.add=function(){return this._node.add.apply(this._node,arguments)},d.prototype._add=d.prototype.add,d.prototype.render=function(){return this._node.render()},d.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},c.exports=d}),define("famous/core/ViewSequence",["require","exports","module"],function(a,b,c){function d(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}d.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},d.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},d.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},d.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},d.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},d.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},d.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},d.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},d.prototype.indexOf=function(a){return this._.array.indexOf(a)},d.prototype.getIndex=function(){return this.index},d.prototype.toString=function(){return""+this.index},d.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},d.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.get=function(){return this._.getValue(this.index)},d.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},d.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},c.exports=d}),define("famous/events/EventArbiter",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){this.dispatchers={},this.currMode=void 0,this.setMode(a)}var e=a("../core/EventHandler");d.prototype.setMode=function(a){if(a!==this.currMode){var b=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=a,this.dispatchers[a]&&this.dispatchers[a].emit("pipe"),this.emit("change",{from:b,to:a})}},d.prototype.forMode=function(a){return this.dispatchers[a]||(this.dispatchers[a]=new e),this.dispatchers[a]},d.prototype.emit=function(a,b){if(void 0===this.currMode)return!1;b||(b={});var c=this.dispatchers[this.currMode];return c?c.trigger(a,b):void 0},c.exports=d}),define("famous/events/EventFilter",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){e.call(this),this._condition=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.emit=function(a,b){return this._condition(a,b)?e.prototype.emit.apply(this,arguments):void 0},d.prototype.trigger=d.prototype.emit,c.exports=d}),define("famous/events/EventMapper",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){e.call(this),this._mappingFunction=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.subscribe=null,d.prototype.unsubscribe=null,d.prototype.emit=function(a,b){var c=this._mappingFunction.apply(this,arguments);c&&c.emit instanceof Function&&c.emit(a,b)},d.prototype.trigger=d.prototype.emit,c.exports=d}),define("famous/inputs/Accumulator",["require","exports","module","../core/EventHandler","../transitions/Transitionable"],function(a,b,c){function d(a,b){void 0===b&&(b="update"),this._state=a&&a.get&&a.set?a:new g(a||0),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.on(b,e.bind(this))}function e(a){var b=a.delta,c=this.get();if(b.constructor===c.constructor){var d=b instanceof Array?[c[0]+b[0],c[1]+b[1]]:c+b;this.set(d)}}var f=a("../core/EventHandler"),g=a("../transitions/Transitionable");d.prototype.get=function(){return this._state.get()},d.prototype.set=function(a){this._state.set(a)},c.exports=d}),define("famous/inputs/DesktopEmulationMode",["require","exports","module"],function(){function a(a){window.addEventListener(a,function(a){return a.stopPropagation(),!1},!0)}var b="ontouchstart"in window;b&&(a("mousedown"),a("mousemove"),a("mouseup"),a("mouseleave"))}),define("famous/inputs/FastClick",["require","exports","module"],function(){!function(){if(window.CustomEvent){var a=300,b=500,c={},d={},e=Date.now;window.addEventListener("touchstart",function(a){for(var b=e(),d=0;d<a.changedTouches.length;d++){var f=a.changedTouches[d];c[f.identifier]=b}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b];delete c[d.identifier]}}),window.addEventListener("touchend",function(b){for(var f=e(),g=0;g<b.changedTouches.length;g++){var h=b.changedTouches[g],i=c[h.identifier];if(i&&a>f-i){var j=new window.CustomEvent("click",{bubbles:!0,detail:h});d[f]=b,b.target.dispatchEvent(j)}delete c[h.identifier]}}),window.addEventListener("click",function(a){var c=e();for(var f in d){var g=d[f];b>c-f?a instanceof window.MouseEvent&&a.target===g.target&&a.stopPropagation():delete d[f]}},!0)}}()}),define("famous/inputs/GenericSync",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b){this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function e(a,b){g[a]&&(this._syncs[a]=new g[a](b),this.pipeSync(a))}var f=a("../core/EventHandler");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DIRECTION_Z=2;var g={};d.register=function(a){for(var b in a)if(g[b]){if(g[b]!==a[b])throw Error("Conflicting sync classes for key: "+b)}else g[b]=a[b]},d.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},d.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},d.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},d.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)e.call(this,a[b]);else if(a instanceof Object)for(var c in a)e.call(this,c,a[c])},c.exports=d}),define("famous/inputs/SyncUtils",["require","exports","module"],function(a,b,c){c.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}}),define("famous/inputs/MouseSync",["require","exports","module","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventInput=new j,this._eventOutput=new j,j.setInputHandler(this,this._eventInput),j.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",e.bind(this)),this._eventInput.on("mousemove",f.bind(this)),this._eventInput.on("mouseup",g.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",h.bind(this)):this._eventInput.on("mouseleave",g.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function e(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function f(a){if(0!==this._positionHistory.length){var b=i.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function g(a){if(this._down){var b=i.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function h(){if(this._down&&this._move&&!this._documentActive){var a=f.bind(this),b=function(c){g.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function i(a){var b,c,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],k=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(k)>Math.abs(n)?n=0:k=0),this.options.direction===d.DIRECTION_X?(c=k,this._position+=c):this.options.direction===d.DIRECTION_Y?(c=n,this._position+=c):(c=[k,n],this._position[0]+=k,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=k,this._displacement[1]+=n),e.delta=c,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=l.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,m);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/TwoFingerSync",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(){this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var e=a("../core/EventHandler");d.calculateAngle=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.atan2(d,c)},d.calculateDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},d.calculateCenter=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};var f=Date.now;d.prototype.handleStart=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];this.touchAEnabled?this.touchBEnabled||(this.touchBId=c.identifier,this.touchBEnabled=!0,this.posB=[c.pageX,c.pageY],this.timestampB=f(),this._startUpdate(a)):(this.touchAId=c.identifier,this.touchAEnabled=!0,this.posA=[c.pageX,c.pageY],this.timestampA=f())}},d.prototype.handleMove=function(a){if(this.touchAEnabled&&this.touchBEnabled){for(var b,c=this.timestampA,d=this.timestampB,e=0;e<a.changedTouches.length;e++){var g=a.changedTouches[e];
g.identifier===this.touchAId?(this.posA=[g.pageX,g.pageY],this.timestampA=f(),b=this.timestampA-c):g.identifier===this.touchBId&&(this.posB=[g.pageX,g.pageY],this.timestampB=f(),b=this.timestampB-d)}b&&this._moveUpdate(b)}},d.prototype.handleEnd=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];(c.identifier===this.touchAId||c.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},c.exports=d}),define("famous/inputs/PinchSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._displacement=0,this._previousDistance=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._previousDistance=e.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:e.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=e.calculateDistance(this.posA,this.posB),c=e.calculateCenter(this.posA,this.posB),d=this.options.scale,f=d*(b-this._previousDistance),g=f/a;this._previousDistance=b,this._displacement+=f,this._eventOutput.emit("update",{delta:f,velocity:g,distance:b,displacement:this._displacement,center:c,touches:[this.touchAId,this.touchBId]})},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/RotateSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._angle=0,this._previousAngle=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._angle=0,this._previousAngle=e.calculateAngle(this.posA,this.posB);var b=e.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:a.touches.length,angle:this._angle,center:b,touches:[this.touchAId,this.touchBId]})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=e.calculateAngle(this.posA,this.posB),d=e.calculateCenter(this.posA,this.posB),f=b*(c-this._previousAngle),g=f/a;this._angle+=f,this._eventOutput.emit("update",{delta:f,velocity:g,angle:this._angle,center:d,touches:[this.touchAId,this.touchBId]}),this._previousAngle=c},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/ScaleSync",["require","exports","module","./TwoFingerSync","../core/OptionsManager"],function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",e.bind(this))}function e(){this.touchAId=void 0,this.touchBId=void 0}var f=a("./TwoFingerSync"),g=a("../core/OptionsManager");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._scaleFactor=1,this._startDist=f.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:f.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=f.calculateDistance(this.posA,this.posB),d=f.calculateCenter(this.posA,this.posB),e=(c-this._startDist)/this._startDist,g=Math.max(1+b*e,0),h=(g-this._scaleFactor)/a;this._eventOutput.emit("update",{delta:e,scale:g,velocity:h,distance:c,center:d,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=g},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/ScrollSync",["require","exports","module","../core/EventHandler","../core/Engine","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",f.bind(this)),this._eventInput.on("wheel",f.bind(this)),this._inProgress=!1,this._loopBound=!1}function e(){if(this._inProgress&&k()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function f(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(h.on("prerender",e.bind(this)),this._loopBound=!0));var b=k(),c=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,g=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,g*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(g)?g=0:f=0);var i,l,m=Math.max(b-c,j),n=f/m,o=g/m,p=this.options.scale;this.options.direction===d.DIRECTION_X?(l=p*f,i=p*n,this._position+=l):this.options.direction===d.DIRECTION_Y?(l=p*g,i=p*o,this._position+=l):(l=[p*f,p*g],i=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=i,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=i}var g=a("../core/EventHandler"),h=a("../core/Engine"),i=a("../core/OptionsManager");d.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var j=8,k=Date.now;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define("famous/inputs/TouchTracker",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:k(),count:b.touches.length,history:c}}function e(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=d(c,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[c.identifier]||this.track(e)}}}function f(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function g(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[c.identifier]}}this.isTouched=!1}}function h(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function i(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new j,this.eventOutput=new j,j.setInputHandler(this,this.eventInput),j.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",e.bind(this)),this.eventInput.on("touchmove",f.bind(this)),this.eventInput.on("touchend",g.bind(this)),this.eventInput.on("touchcancel",g.bind(this)),this.eventInput.on("unpipe",h.bind(this)),this.isTouched=!1}var j=a("../core/EventHandler"),k=Date.now;i.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},c.exports=i}),define("famous/inputs/TouchSync",["require","exports","module","./TouchTracker","../core/EventHandler","../core/OptionsManager","./SyncUtils"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventOutput=new j,this._touchTracker=new i({touchLimit:this.options.touchLimit}),j.setOutputHandler(this,this._eventOutput),j.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",e.bind(this)),this._touchTracker.on("trackmove",f.bind(this)),this._touchTracker.on("trackend",h.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function e(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function f(a){g.call(this,a)}function g(a){var b=a.history,c=b[b.length-1],e=l.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=c.timestamp,h=c.x-e.x,i=c.y-e.y,j=c.x-f,k=c.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(k)?k=0:j=0);var n,o,p=Math.max(g-f,m),q=j/p,r=k/p,s=this.options.scale;this.options.direction===d.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===d.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function h(a){g.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var i=a("./TouchTracker"),j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(){return this.options},c.exports=d}),define("famous/math/Vector",["require","exports","module"],function(a,b,c){function d(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function e(a,b,c){return this.x=a,this.y=b,this.z=c,this}function f(a){return e.call(this,a[0],a[1],a[2]||0)}function g(a){return e.call(this,a.x,a.y,a.z)}function h(a){return e.call(this,a,0,0)}var i=new d(0,0,0);d.prototype.add=function(a){return e.call(i,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return e.call(i,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.mult=function(a){return e.call(i,a*this.x,a*this.y,a*this.z)},d.prototype.div=function(a){return this.mult(1/a)},d.prototype.cross=function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;return e.call(i,d*g-c*h,b*h-d*f,c*f-b*g)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.rotateX=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b,c*f-d*g,c*g+d*f)},d.prototype.rotateY=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,d*g+b*f,c,d*f-b*g)},d.prototype.rotateZ=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b*f-c*g,b*g+c*f,d)},d.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?g.call(i,this.mult(a/b)):e.call(i,a,0,0)},d.prototype.clone=function(){return new d(this)},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.set=function(a){return a instanceof Array?f.call(this,a):"number"==typeof a?h.call(this,a):g.call(this,a)},d.prototype.setXYZ=function(){return e.apply(this,arguments)},d.prototype.set1D=function(a){return h.call(this,a)},d.prototype.put=function(a){this===i?g.call(a,i):g.call(a,this)},d.prototype.clear=function(){return e.call(this,0,0,0)},d.prototype.cap=function j(j){if(1/0===j)return g.call(i,this);var a=this.norm();return a>j?g.call(i,this.mult(j/a)):g.call(i,this)},d.prototype.project=function(a){return a.mult(this.dot(a))},d.prototype.reflectAcross=function(a){return a.normalize().put(a),g(i,this.sub(this.project(a).mult(2)))},d.prototype.get=function(){return[this.x,this.y,this.z]},d.prototype.get1D=function(){return this.x},c.exports=d}),define("famous/math/Matrix",["require","exports","module","./Vector"],function(a,b,c){function d(a){return this.values=a||[[1,0,0],[0,1,0],[0,0,1]],this}var e=a("./Vector"),f=new d,g=new e;d.prototype.get=function(){return this.values},d.prototype.set=function(a){this.values=a},d.prototype.vectorMultiply=function(a){var b=this.get(),c=a.x,d=a.y,e=a.z,f=b[0],h=b[1],i=b[2],j=f[0],k=f[1],l=f[2],m=h[0],n=h[1],o=h[2],p=i[0],q=i[1],r=i[2];return g.setXYZ(j*c+k*d+l*e,m*c+n*d+o*e,p*c+q*d+r*e)},d.prototype.multiply=function(a){for(var b=this.get(),c=[[]],d=0;3>d;d++){c[d]=[];for(var e=0;3>e;e++){for(var g=0,h=0;3>h;h++)g+=b[d][h]*a[h][e];c[d][e]=g}}return f.set(c)},d.prototype.transpose=function(){for(var a=[],b=this.get(),c=0;3>c;c++)for(var d=0;3>d;d++)a[c][d]=b[d][c];return f.set(a)},d.prototype.clone=function(){for(var a=this.get(),b=[],c=0;3>c;c++)b[c]=a[c].slice();return new d(b)},c.exports=d}),define("famous/math/Quaternion",["require","exports","module","./Matrix"],function(a,b,c){function d(a,b,c,d){return 1===arguments.length?this.set(a):(this.w=void 0!==a?a:1,this.x=void 0!==b?b:0,this.y=void 0!==c?c:0,this.z=void 0!==d?d:0),this}var e=a("./Matrix"),f=new d(1,0,0,0);d.prototype.add=function(a){return f.setWXYZ(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return f.setWXYZ(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.scalarDivide=function(a){return this.scalarMultiply(1/a)},d.prototype.scalarMultiply=function(a){return f.setWXYZ(this.w*a,this.x*a,this.y*a,this.z*a)},d.prototype.multiply=function(a){var b=this.x,c=this.y,d=this.z,e=this.w,g=a.x,h=a.y,i=a.z,j=a.w||0;return f.setWXYZ(e*j-b*g-c*h-d*i,b*j+g*e+h*d-c*i,c*j+h*e+b*i-g*d,d*j+i*e+g*c-b*h)};var g=new d(1,0,0,0);d.prototype.rotateVector=function(a){return g.set(this.conj()),f.set(this.multiply(a).multiply(g))},d.prototype.inverse=function(){return f.set(this.conj().scalarDivide(this.normSquared()))},d.prototype.negate=function(){return this.scalarMultiply(-1)},d.prototype.conj=function(){return f.setWXYZ(this.w,-this.x,-this.y,-this.z)},d.prototype.normalize=function(a){return a=void 0===a?1:a,this.scalarDivide(a*this.norm())},d.prototype.makeFromAngleAndAxis=function(a,b){var c=b.normalize(),d=.5*a,e=-Math.sin(d);return this.x=e*c.x,this.y=e*c.y,this.z=e*c.z,this.w=Math.cos(d),this},d.prototype.setWXYZ=function(a,b,c,d){return f.clear(),this.w=a,this.x=b,this.y=c,this.z=d,this},d.prototype.set=function(a){return a instanceof Array?(this.w=0,this.x=a[0],this.y=a[1],this.z=a[2]):(this.w=a.w,this.x=a.x,this.y=a.y,this.z=a.z),this!==f&&f.clear(),this},d.prototype.put=function(a){a.set(f)},d.prototype.clone=function(){return new d(this)},d.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},d.prototype.isEqual=function(a){return a.w===this.w&&a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.dot=function(a){return this.w*a.w+this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.getTransform=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return[1-2*c*c-2*d*d,2*b*c-2*d*e,2*b*d+2*c*e,0,2*b*c+2*d*e,1-2*b*b-2*d*d,2*c*d-2*b*e,0,2*b*d-2*c*e,2*c*d+2*b*e,1-2*b*b-2*c*c,0,0,0,0,1]};var h=new e;d.prototype.getMatrix=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return h.set([[1-2*c*c-2*d*d,2*b*c+2*d*e,2*b*d-2*c*e],[2*b*c-2*d*e,1-2*b*b-2*d*d,2*c*d+2*b*e],[2*b*d+2*c*e,2*c*d-2*b*e,1-2*b*b-2*c*c]])};var i=1e-5;d.prototype.slerp=function(a,b){var c,d,e,g,h;return d=this.dot(a),1-d>i?(c=Math.acos(d),e=Math.sin(c),g=Math.sin((1-b)*c)/e,h=Math.sin(b*c)/e):(g=1-b,h=b),f.set(this.scalarMultiply(g/h).add(a).multiply(h))},c.exports=d}),define("famous/math/Random",["require","exports","module"],function(a,b,c){function d(a,b){return a+f()*(b-a)}function e(a,b){return a+f()*(b-a+1)>>0}var f=Math.random,g={};g.integer=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var d=[],f=0;c>f;f++)d.push(e(a,b));return d}return e(a,b)},g.range=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var e=[],f=0;c>f;f++)e.push(d(a,b));return e}return d(a,b)},g.sign=function(a){return a=void 0!==a?a:.5,f()<a?1:-1},g.bool=function(a){return a=void 0!==a?a:.5,f()<a},c.exports=g}),define("famous/math/Utilities",["require","exports","module"],function(a,b,c){var d={};d.clamp=function(a,b){return Math.max(Math.min(a,b[1]),b[0])},d.length=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)},c.exports=d}),define("famous/modifiers/Draggable",["require","exports","module","../core/Transform","../transitions/Transitionable","../core/EventHandler","../math/Utilities","../inputs/GenericSync","../inputs/MouseSync","../inputs/TouchSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._positionState=new k([0,0]),this._differential=[0,0],this._active=!0,this.sync=new n(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new l,l.setInputHandler(this,this.sync),l.setOutputHandler(this,this.eventOutput),i.call(this)}function e(a){var b=this.options,c=b.projection,d=b.snapX,e=b.snapY,f=c&q.x?a[0]:0,g=c&q.y?a[1]:0;return d>0&&(f-=f%d),e>0&&(g-=g%e),[f,g]}function f(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function g(a){if(this._active){var b=this.options;this._differential=a.position;var c=e.call(this,this._differential);this._differential[0]-=c[0],this._differential[1]-=c[1];var d=this.getPosition();if(d[0]+=c[0],d[1]+=c[1],b.xRange){var f=[b.xRange[0]+.5*b.snapX,b.xRange[1]-.5*b.snapX];d[0]=r(d[0],f)}if(b.yRange){var g=[b.yRange[0]+.5*b.snapY,b.yRange[1]-.5*b.snapY];d[1]=r(d[1],g)}this.eventOutput.emit("update",{position:d})}}function h(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function i(){this.sync.on("start",f.bind(this)),this.sync.on("update",g.bind(this)),this.sync.on("end",h.bind(this))}var j=a("../core/Transform"),k=a("../transitions/Transitionable"),l=a("../core/EventHandler"),m=a("../math/Utilities"),n=a("../inputs/GenericSync"),o=a("../inputs/MouseSync"),p=a("../inputs/TouchSync");n.register({mouse:o,touch:p});var q={x:1,y:2};d.DIRECTION_X=q.x,d.DIRECTION_Y=q.y;var r=m.clamp;d.DEFAULT_OPTIONS={projection:q.x|q.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},d.prototype.setOptions=function(a){var b=this.options;if(void 0!==a.projection){var c=a.projection;this.options.projection=0,["x","y"].forEach(function(a){-1!==c.indexOf(a)&&(b.projection|=q[a])})}void 0!==a.scale&&(b.scale=a.scale,this.sync.setOptions({scale:a.scale})),void 0!==a.xRange&&(b.xRange=a.xRange),void 0!==a.yRange&&(b.yRange=a.yRange),void 0!==a.snapX&&(b.snapX=a.snapX),void 0!==a.snapY&&(b.snapY=a.snapY)},d.prototype.getPosition=function(){return this._positionState.get()},d.prototype.setRelativePosition=function(a,b,c){var d=this.getPosition(),e=[d[0]+a[0],d[1]+a[1]];this.setPosition(e,b,c)},d.prototype.setPosition=function(a,b,c){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(a,b,c)},d.prototype.activate=function(){this._active=!0},d.prototype.deactivate=function(){this._active=!1},d.prototype.toggle=function(){this._active=!this._active},d.prototype.modify=function(a){var b=this.getPosition();return{transform:j.translate(b[0],b[1]),target:a}},c.exports=d}),define("famous/modifiers/Fader",["require","exports","module","../transitions/Transitionable","../core/OptionsManager"],function(a,b,c){function d(a,b){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),b||(b=0),this.transitionHelper=new e(b)}var e=a("../transitions/Transitionable"),f=a("../core/OptionsManager");d.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b){a=a||this.options.transition,this.set(1,a,b)},d.prototype.hide=function(a,b){a=a||this.options.transition,this.set(0,a,b)},d.prototype.set=function(a,b,c){this.halt(),this.transitionHelper.set(a,b,c)},d.prototype.halt=function(){this.transitionHelper.halt()},d.prototype.isVisible=function(){return this.transitionHelper.get()>0},d.prototype.modify=function(a){var b=this.transitionHelper.get();return this.options.cull&&!b?void 0:{opacity:b,target:a}},c.exports=d}),define("famous/modifiers/ModifierChain",["require","exports","module"],function(a,b,c){function d(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}d.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},d.prototype.removeModifier=function(a){var b=this._chain.indexOf(a);0>b||this._chain.splice(b,1)},d.prototype.modify=function(a){for(var b=this._chain,c=a,d=0;d<b.length;d++)c=b[d].modify(c);return c},c.exports=d}),define("famous/modifiers/StateModifier",["require","exports","module","../core/Modifier","../core/Transform","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this._transformState=new h(f.identity),this._opacityState=new g(1),this._originState=new g([0,0]),this._alignState=new g([0,0]),this._sizeState=new g([0,0]),this._proportionsState=new g([0,0]),this._modifier=new e({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,a&&(a.transform&&this.setTransform(a.transform),void 0!==a.opacity&&this.setOpacity(a.opacity),a.origin&&this.setOrigin(a.origin),a.align&&this.setAlign(a.align),a.size&&this.setSize(a.size),a.proportions&&this.setProportions(a.proportions))}var e=a("../core/Modifier"),f=a("../core/Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.setTransform=function(a,b,c){return this._transformState.set(a,b,c),this},d.prototype.setOpacity=function(a,b,c){return this._opacityState.set(a,b,c),this},d.prototype.setOrigin=function(a,b,c){return null===a?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(a,b,c),this)},d.prototype.setAlign=function(a,b,c){return null===a?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(a,b,c),this)},d.prototype.setSize=function(a,b,c){return null===a?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(a,b,c),this)},d.prototype.setProportions=function(a,b,c){return null===a?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(a,b,c),this)},d.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},d.prototype.getTransform=function(){return this._transformState.get()},d.prototype.getFinalTransform=function(){return this._transformState.getFinal()},d.prototype.getOpacity=function(){return this._opacityState.get()},d.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},d.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},d.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},d.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},d.prototype.modify=function(a){return this._modifier.modify(a)},c.exports=d}),define("famous/physics/PhysicsEngine",["require","exports","module","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=w(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function e(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function f(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},e.call(this,a).push(this._currAgentId),this._currAgentId++}function g(a){return this._agentData[a]}function h(a){var b=g.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function i(){for(var a=this._forces.length-1;a>-1;a--)h.call(this,a)}function j(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function k(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)j.call(this,c,a);b++}}function l(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function m(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function n(a,b){a.integrateOrientation(b)}function o(a,b){a.integratePosition(b),a.emit(x.update,a)}function p(a){i.call(this,a),this.forEach(l,a),this.forEachBody(m,a),k.call(this,a),this.forEachBody(n,a),this.forEach(o,a)}function q(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function r(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var s=a("../core/EventHandler"),t=17,u=1e3/120,v=17,w=Date.now,x={start:"start",update:"update",end:"end"};d.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},d.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},d.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},d.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],e=0;e<a.length;e++)d[e]=f.call(this,a[e],b,c);return d}return f.call(this,a,b,c)},d.prototype.attachTo=function(a,b){g.call(this,a).targets.push(b)},d.prototype.detach=function(a){var b=this.getAgent(a),c=e.call(this,b),d=c.indexOf(a);c.splice(d,1),delete this._agentData[a]},d.prototype.detachFrom=function(a,b){var c=g.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},d.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},d.prototype.getAgent=function(a){return g.call(this,a).agent},d.prototype.getParticles=function(){return this._particles},d.prototype.getBodies=function(){return this._bodies},d.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},d.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},d.prototype.getAgentEnergy=function(a){var b=g.call(this,a);return b.agent.getEnergy(b.targets,b.source)},d.prototype.getEnergy=function(){return q.call(this)+r.call(this)},d.prototype.step=function(){if(!this.isSleeping()){var a=w(),b=a-this._prevTime;this._prevTime=a,u>b||(b>v&&(b=v),p.call(this,t),this.emit(x.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},d.prototype.isSleeping=function(){return this._isSleeping},d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(x.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this._prevTime=w(),this.emit(x.start,this),this._isSleeping=!1)},d.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},d.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new s),this._eventHandler.on(a,b)},c.exports=d}),define("famous/physics/integrators/SymplecticEuler",["require","exports","module"],function(a,b,c){var d={};d.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},d.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},d.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},d.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},c.exports=d}),define("famous/physics/bodies/Particle",["require","exports","module","../../math/Vector","../../core/Transform","../../core/EventHandler","../integrators/SymplecticEuler"],function(a,b,c){function d(a){a=a||{};var b=d.DEFAULT_OPTIONS;this.position=new f,this.velocity=new f,this.force=new f,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=g.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function e(){this._eventOutput=new h,this._eventOutput.bindThis(this),h.setOutputHandler(this,this._eventOutput)}var f=a("../../math/Vector"),g=a("../../core/Transform"),h=a("../../core/EventHandler"),i=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var j={start:"start",update:"update",end:"end"},k=Date.now;d.prototype.isBody=!1,d.prototype.isActive=function(){return!this._isSleeping
},d.prototype.sleep=function(){this._isSleeping||(this.emit(j.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this.emit(j.start,this),this._isSleeping=!1,this._prevTime=k(),this._engine&&this._engine.wake())},d.prototype.setPosition=function(a){this.position.set(a)},d.prototype.setPosition1D=function(a){this.position.x=a},d.prototype.getPosition=function(){return this._engine.step(),this.position.get()},d.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},d.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},d.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},d.prototype.getVelocity=function(){return this.velocity.get()},d.prototype.setForce=function(a){this.force.set(a),this.wake()},d.prototype.getVelocity1D=function(){return this.velocity.x},d.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},d.prototype.getMass=function(){return this.mass},d.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},d.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},d.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},d.prototype.integrateVelocity=function(a){i.integrateVelocity(this,a)},d.prototype.integratePosition=function(a){i.integratePosition(this,a)},d.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},d.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()},d.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},d.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},d.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define("famous/physics/bodies/Body",["require","exports","module","./Particle","../../core/Transform","../../math/Vector","../../math/Quaternion","../../math/Matrix","../integrators/SymplecticEuler"],function(a,b,c){function d(a){e.call(this,a),a=a||{},this.orientation=new h,this.angularVelocity=new g,this.angularMomentum=new g,this.torque=new g,a.orientation&&this.orientation.set(a.orientation),a.angularVelocity&&this.angularVelocity.set(a.angularVelocity),a.angularMomentum&&this.angularMomentum.set(a.angularMomentum),a.torque&&this.torque.set(a.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new g}var e=a("./Particle"),f=a("../../core/Transform"),g=a("../../math/Vector"),h=a("../../math/Quaternion"),i=a("../../math/Matrix"),j=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.DEFAULT_OPTIONS.orientation=[0,0,0,1],d.DEFAULT_OPTIONS.angularVelocity=[0,0,0],d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isBody=!0,d.prototype.setMass=function(){e.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){this.inertia=new i,this.inverseInertia=new i},d.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},d.prototype.toWorldCoordinates=function(a){return this.pWorld.set(this.orientation.rotateVector(a))},d.prototype.getEnergy=function(){return e.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},d.prototype.reset=function(a,b,c,d){e.prototype.reset.call(this,a,b),this.angularVelocity.clear(),this.setOrientation(c||[1,0,0,0]),this.setAngularMomentum(d||[0,0,0])},d.prototype.setOrientation=function(a){this.orientation.set(a)},d.prototype.setAngularVelocity=function(a){this.wake(),this.angularVelocity.set(a)},d.prototype.setAngularMomentum=function(a){this.wake(),this.angularMomentum.set(a)},d.prototype.applyForce=function(a,b){e.prototype.applyForce.call(this,a),void 0!==b&&this.applyTorque(b.cross(a))},d.prototype.applyTorque=function(a){this.wake(),this.torque.set(this.torque.add(a))},d.prototype.getTransform=function(){return f.thenMove(this.orientation.getTransform(),f.getTranslate(e.prototype.getTransform.call(this)))},d.prototype._integrate=function(a){e.prototype._integrate.call(this,a),this.integrateAngularMomentum(a),this.updateAngularVelocity(a),this.integrateOrientation(a)},d.prototype.integrateAngularMomentum=function(a){j.integrateAngularMomentum(this,a)},d.prototype.integrateOrientation=function(a){j.integrateOrientation(this,a)},c.exports=d}),define("famous/physics/bodies/Circle",["require","exports","module","./Body","../../math/Matrix"],function(a,b,c){function d(a){a=a||{},this.setRadius(a.radius||0),e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setRadius=function(a){this.radius=a,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.radius;this.inertia=new f([[.25*a*b*b,0,0],[0,.25*a*b*b,0],[0,0,.5*a*b*b]]),this.inverseInertia=new f([[4/(a*b*b),0,0],[0,4/(a*b*b),0],[0,0,2/(a*b*b)]])},c.exports=d}),define("famous/physics/bodies/Rectangle",["require","exports","module","./Body","../../math/Matrix"],function(a,b,c){function d(a){a=a||{},this.size=a.size||[0,0],e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setSize=function(a){this.size=a,this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.size[0],c=this.size[1];this.inertia=new f([[a*c*c/12,0,0],[0,a*b*b/12,0],[0,0,a*(b*b+c*c)/12]]),this.inverseInertia=new f([[12/(a*c*c),0,0],[0,12/(a*b*b),0],[0,0,12/(a*(b*b+c*c))]])},c.exports=d}),define("famous/physics/constraints/Constraint",["require","exports","module","../../core/EventHandler"],function(a,b,c){function d(){this.options=this.options||{},this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput)}var e=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyConstraint=function(){},d.prototype.getEnergy=function(){return 0},c.exports=d}),define("famous/physics/constraints/Collision",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.normal=new f,this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){if(void 0!==b)for(var d=b.velocity,e=b.position,f=b.inverseMass,g=b.radius,h=this.options,i=h.drift,j=-h.slop,k=h.restitution,l=this.normal,m=this.pDiff,n=this.vDiff,o=this.impulse1,p=this.impulse2,q=0;q<a.length;q++){var r=a[q];if(r!==b){var s=r.velocity,t=r.position,u=r.inverseMass,v=r.radius;m.set(t.sub(e)),n.set(s.sub(d));var w=m.norm(),x=w-(g+v),y=1/(f+u),z=0;if(0>x){if(l.set(m.normalize()),this._eventOutput){var A={target:r,source:b,overlap:x,normal:l};this._eventOutput.emit("preCollision",A),this._eventOutput.emit("collision",A)}var B=j>=x?((1+k)*l.dot(n)+i/c*(x-j))/(z+c/y):(1+k)*l.dot(n)/(z+c/y);l.mult(c*B).put(o),o.mult(-1).put(p),b.applyImpulse(o),r.applyImpulse(p),this._eventOutput&&this._eventOutput.emit("postCollision",A)}}}},c.exports=d}),define("famous/physics/constraints/Curve",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d;var g=1e-7,h=Math.PI;d.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(a,b,c){return c},period:0,dampingRatio:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.impulse,f=this.J,i=d.equation,j=d.plane,k=d.dampingRatio,l=d.period,m=0;m<a.length;m++){var n,o,p=a[m],q=p.velocity,r=p.position,s=p.mass;if(0===l)n=0,o=1;else{var t=4*s*h*k/l,u=4*s*h*h/(l*l);n=1/(t+c*u),o=c*u/(t+c*u)}var v=r.x,w=r.y,x=r.z,y=i(v,w,x),z=(i(v+g,r,r)-y)/g,A=(i(v,w+g,r)-y)/g,B=(i(v,w,r+g)-y)/g,C=j(v,w,x),D=(j(v+g,w,x)-C)/g,E=(j(v,w+g,x)-C)/g,F=(j(v,w,x+g)-C)/g;f.setXYZ(z+D,A+E,B+F);var G=o/c*(y+C),H=-(f.dot(q)+G)/(n+c*f.normSquared()/s);e.set(f.mult(c*H)),p.applyImpulse(e)}},c.exports=d}),define("famous/physics/constraints/Distance",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.impulse=new f,this.normal=new f,this.diffP=new f,this.diffV=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var g=Math.PI;d.prototype.setOptions=function(a){a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),void 0!==a.minLength&&(this.options.minLength=a.minLength)},d.prototype.setAnchor=function(a){this.options.anchor||(this.options.anchor=new f),this.options.anchor.set(a)},d.prototype.applyConstraint=function(a,b,c){var d,e,f=this.normal,h=this.diffP,i=this.diffV,j=this.impulse,k=this.options,l=k.dampingRatio,m=k.period,n=k.minLength;if(b){var o=b.velocity;d=b.position,e=b.inverseMass}else d=this.options.anchor,e=0;for(var p=this.options.length,q=0;q<a.length;q++){var r=a[q],s=r.velocity,t=r.position,u=r.inverseMass;h.set(t.sub(d)),f.set(h.normalize());var v=h.norm()-p;if(Math.abs(v)<n)return;i.set(b?s.sub(o):s);var w,x,y=1/(u+e);if(0===m)w=0,x=1;else{var z=4*y*g*l/m,A=4*y*g*g/(m*m);w=1/(z+c*A),x=c*A/(z+c*A)}var B=x/c*v,C=-(f.dot(i)+B)/(w+c/y);j.set(f.mult(c*C)),r.applyImpulse(j),b&&b.applyImpulse(j.mult(-1))}},c.exports=d}),define("famous/physics/constraints/Snap",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){e.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var g=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),e.prototype.setOptions.call(this,a)},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=c.anchor||b.position,f=Math.pow(2*g/c.period,2),h=0,i=0;i<a.length;i++){var j=a[i],k=e.sub(j.position).norm()-d;h+=.5*f*k*k}return h},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.pDiff,f=this.vDiff,h=this.impulse1,i=this.impulse2,j=d.length,k=d.anchor||b.position,l=d.period,m=d.dampingRatio,n=0;n<a.length;n++){var o=a[n],p=o.position,q=o.velocity,r=o.mass,s=o.inverseMass;e.set(p.sub(k));var t,u=e.norm()-j;if(b){var v=b.inverseMass,w=b.velocity;f.set(q.sub(w)),t=1/(s+v)}else f.set(q),t=r;var x,y;if(0===this.options.period)x=0,y=1;else{var z=4*t*g*g/(l*l),A=4*t*g*m/l;y=c*z/(A+c*z),x=1/(A+c*z)}var B=y/c*u;e.normalize(-B).sub(f).mult(c/(x+c/t)).put(h),o.applyImpulse(h),b&&(h.mult(-1).put(i),b.applyImpulse(i))}},c.exports=d}),define("famous/physics/constraints/Surface",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var g=1e-7,h=Math.PI;d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.impulse,e=this.J,f=this.options,i=f.equation,j=f.dampingRatio,k=f.period,l=0;l<a.length;l++){var m,n,o=a[l],p=o.velocity,q=o.position,r=o.mass;if(0===k)m=0,n=1;else{var s=4*r*h*j/k,t=4*r*h*h/(k*k);m=1/(s+c*t),n=c*t/(s+c*t)}var u=q.x,v=q.y,w=q.z,x=i(u,v,w),y=(i(u+g,q,q)-x)/g,z=(i(u,v+g,q)-x)/g,A=(i(u,v,q+g)-x)/g;e.setXYZ(y,z,A);var B=n/c*x,C=-(e.dot(p)+B)/(m+c*e.normSquared()/r);d.set(e.mult(c*C)),o.applyImpulse(d)}},c.exports=d}),define("famous/physics/constraints/Wall",["require","exports","module","./Constraint","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.diff=new j,this.impulse=new j,i.call(this)}function e(a,b){return b.dot(a)}function f(a){var b=this.options.normal,c=this.options.distance;return a.dot(b)+c}function g(a,b,c){var e=a.position,f=a.velocity,g=a.mass,h=this.options.normal,i=this.options.onContact,j=this.options.restitution,k=this.impulse,l=this.options.drift,m=-this.options.slop,n=0;if(this._eventOutput){var o={particle:a,wall:this,overlap:b,normal:h};this._eventOutput.emit("preCollision",o),this._eventOutput.emit("collision",o)}switch(i){case d.ON_CONTACT.REFLECT:var p=m>b?-((1+j)*h.dot(f)+l/c*(b-m))/(g*c+n):-((1+j)*h.dot(f))/(g*c+n);k.set(h.mult(c*p)),a.applyImpulse(k),a.setPosition(e.add(h.mult(-b)))}this._eventOutput&&this._eventOutput.emit("postCollision",o)}function h(a,b){var c=this.options.onContact,e=a.position,f=this.options.normal;c===d.ON_CONTACT.REFLECT&&a.setPosition(e.add(f.mult(-b)))}var i=a("./Constraint"),j=a("../../math/Vector");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.ON_CONTACT={REFLECT:0,SILENT:1},d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:d.ON_CONTACT.REFLECT},d.prototype.setOptions=function(a){void 0!==a.normal&&(a.normal instanceof j&&(this.options.normal=a.normal.clone()),a.normal instanceof Array&&(this.options.normal=new j(a.normal))),void 0!==a.restitution&&(this.options.restitution=a.restitution),void 0!==a.drift&&(this.options.drift=a.drift),void 0!==a.slop&&(this.options.slop=a.slop),void 0!==a.distance&&(this.options.distance=a.distance),void 0!==a.onContact&&(this.options.onContact=a.onContact)},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options.normal,i=0;i<a.length;i++){var j=a[i],k=j.position,l=j.velocity,m=j.radius||0,n=f.call(this,k.add(d.mult(-m))),o=e.call(this,d,l);0>=n&&(0>o?g.call(this,j,n,c):h.call(this,j,n,c))}},c.exports=d}),define("famous/physics/constraints/Walls",["require","exports","module","./Constraint","./Wall","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),f.call(this,a.sides||this.options.sides),h.call(this)}function e(a,b,c){var e,f=d.SIDES;switch(parseInt(a)){case f.LEFT:e=b[0]*c[0];break;case f.TOP:e=b[1]*c[1];break;case f.FRONT:e=b[2]*c[2];break;case f.RIGHT:e=b[0]*(1-c[0]);break;case f.BOTTOM:e=b[1]*(1-c[1]);break;case f.BACK:e=b[2]*(1-c[2])}return e}function f(a){this.components={};for(var b=this.components,c=0;c<a.length;c++){var d=a[c];b[c]=new i({normal:k[d].clone(),distance:e(d,this.options.size,this.options.origin)})}}function g(a){this.forEach(function(b){b.setOptions(a)});for(var b in a)this.options[b]=a[b]}var h=a("./Constraint"),i=a("./Wall"),j=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.ON_CONTACT=i.ON_CONTACT,d.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},d.DEFAULT_OPTIONS={sides:d.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:d.ON_CONTACT.REFLECT};var k={0:new j(1,0,0),1:new j(-1,0,0),2:new j(0,1,0),3:new j(0,-1,0),4:new j(0,0,1),5:new j(0,0,-1)};d.prototype.setOptions=function(a){var b=!1;void 0!==a.restitution&&g.call(this,{restitution:a.restitution}),void 0!==a.drift&&g.call(this,{drift:a.drift}),void 0!==a.slop&&g.call(this,{slop:a.slop}),void 0!==a.onContact&&g.call(this,{onContact:a.onContact}),void 0!==a.size&&(b=!0),void 0!==a.sides&&(this.options.sides=a.sides),void 0!==a.origin&&(b=!0),b&&this.setSize(a.size,a.origin)},d.prototype.setSize=function(a,b){b=b||this.options.origin,b.length<3&&(b[2]=.5),this.forEach(function(c,d){var f=e(d,a,b);c.setOptions({distance:f})}),this.options.size=a,this.options.origin=b},d.prototype.applyConstraint=function(a,b,c){this.forEach(function(d){d.applyConstraint(a,b,c)})},d.prototype.forEach=function(a){var b=this.options.sides;for(var c in this.sides)a(b[c],c)},d.prototype.rotateZ=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateZ(a).put(c)})},d.prototype.rotateX=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateX(a).put(c)})},d.prototype.rotateY=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateY(a).put(c)})},d.prototype.reset=function(){var a=this.options.sides;for(var b in a){var c=this.components[b];c.options.normal.set(k[b])}},c.exports=d}),define("famous/physics/forces/Force",["require","exports","module","../../math/Vector","../../core/EventHandler"],function(a,b,c){function d(a){this.force=new e(a),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},d.prototype.getEnergy=function(){return 0},c.exports=d}),define("famous/physics/forces/Drag",["require","exports","module","./Force"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this)}var e=a("./Force");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.DEFAULT_OPTIONS={strength:.01,forceFunction:d.FORCE_FUNCTIONS.LINEAR},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define("famous/physics/forces/Repulsion",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new f,e.call(this)}var e=a("./Force"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DECAY_FUNCTIONS={LINEAR:function(a,b){return Math.max(1-1/b*a,0)},MORSE:function(a,b){var c=0===b?100:b,d=a+c*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(d/c-1),2),0)},INVERSE:function(a,b){return 1/(1-b+a)},GRAVITY:function(a,b){return 1/(1-b+a*a)}},d.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:d.DECAY_FUNCTIONS.GRAVITY},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor)),delete a.anchor);for(var b in a)this.options[b]=a[b]},d.prototype.applyForce=function(a,b){var c=this.options,d=this.force,e=this.disp,f=c.strength,g=c.anchor||b.position,h=c.cap,i=c.cutoff,j=c.range[0],k=c.range[1],l=c.decayFunction;if(0!==f)for(var m,n,o,p,q=a.length;q--;)m=a[q],m!==b&&(n=m.mass,o=m.position,e.set(o.sub(g)),p=e.norm(),k>p&&p>j&&(d.set(e.normalize(f*n*l(p,i)).cap(h)),m.applyForce(d)))},c.exports=d}),define("famous/physics/forces/RotationalDrag",["require","exports","module","./Drag"],function(a,b,c){function d(a){e.call(this,a)}var e=a("./Drag");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=e.FORCE_FUNCTIONS,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.angularVelocity).mult(-100*d).put(f),c.applyTorque(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define("famous/physics/forces/Spring",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){h.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new i(0,0,0),g.call(this)}function e(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function f(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var j=Math.PI,k=150;d.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:d.FORCE_FUNCTIONS.HOOK},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof i&&(this.options.anchor=a.anchor.position),a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(a.period<k&&(a.period=k,console.warn("The period of a SpringTransition is capped at "+k+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},c.exports=d}),define("famous/physics/forces/RotationalSpring",["require","exports","module","./Force","./Spring","../../math/Quaternion"],function(a,b,c){function d(a){i.call(this,a)}function e(){var a=this.options;a.stiffness=Math.pow(2*k/a.period,2)}function f(){var a=this.options;a.damping=4*k*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("./Spring"),j=a("../../math/Quaternion");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=i.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=i.FORCE_FUNCTIONS;var k=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof j&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new j(a.anchor))),void 0!==a.period&&(this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a){var b,c,d,e,f=this.force,g=this.options,h=this.disp,i=g.stiffness,j=g.damping,k=g.length,l=g.anchor,m=g.forceFunction,n=g.maxLength;for(b=0;b<a.length;b++){if(c=a[b],h.set(l.sub(c.orientation)),d=h.norm()-k,0===d)return;e=c.mass,i*=e,j*=e,f.set(h.normalize(i*m(d,n))),j&&f.add(c.angularVelocity.mult(-j)).put(f),c.applyTorque(f)}},d.prototype.getEnergy=function(a){for(var b=this.options,c=b.length,d=b.anchor,e=b.stiffness,f=0,g=0;g<a.length;g++){var h=a[g],i=d.sub(h.orientation).norm()-c;f+=.5*e*i*i}return f},c.exports=d}),define("famous/physics/forces/VectorField",["require","exports","module","./Force","../../math/Vector"],function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.evaluation=new g}function e(a){var b=d.FIELDS;switch(a){case b.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new g(this.options.direction)):this.options.direction=new g(0,1,0);break;case b.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new g(this.options.position)):this.options.position=new g(0,0,0)}}var f=a("./Force"),g=a("../../math/Vector");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.FIELDS={CONSTANT:function(a,b){b.direction.put(this.evaluation)},LINEAR:function(a){a.put(this.evaluation)},RADIAL:function(a){a.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(a,b){b.position.sub(a).put(this.evaluation)}},d.DEFAULT_OPTIONS={strength:.01,field:d.FIELDS.CONSTANT},d.prototype.setOptions=function(a){void 0!==a.strength&&(this.options.strength=a.strength),void 0!==a.direction&&(this.options.direction=a.direction),void 0!==a.field&&(this.options.field=a.field,e.call(this,this.options.field))},d.prototype.applyForce=function(a){var b,c,d=this.force,e=this.options.strength,f=this.options.field;for(b=0;b<a.length;b++)c=a[b],f.call(this,c.position,this.options),this.evaluation.mult(c.mass*e).put(d),c.applyForce(d)},d.prototype.getEnergy=function(a){var b,c,e=this.options.field,f=d.FIELDS,g=0;switch(e){case f.CONSTANT:g=a.length*this.options.direction.norm();break;case f.RADIAL:for(b=0;b<a.length;b++)c=a[b],g+=c.position.norm();break;case f.POINT_ATTRACTOR:for(b=0;b<a.length;b++)c=a[b],g+=c.position.sub(this.options.position).norm()}return g*=this.options.strength},c.exports=d}),define("famous/surfaces/CanvasSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){a&&a.canvasSize&&(this._canvasSize=a.canvasSize),e.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="canvas",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(){},d.prototype.deploy=function(a){this._canvasSize&&(a.width=this._canvasSize[0],a.height=this._canvasSize[1]),"2d"===this._contextId&&(a.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},d.prototype.recall=function(a){this.getSize(),this._backBuffer.width=a.width,this._backBuffer.height=a.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(a,0,0),a.width=0,a.height=0)},d.prototype.getContext=function(a){return this._contextId=a,this._currentTarget?this._currentTarget.getContext(a):this._backBuffer.getContext(a)},d.prototype.setSize=function(a,b){e.prototype.setSize.apply(this,arguments),b&&(this._canvasSize=[b[0],b[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},c.exports=d}),define("famous/surfaces/ContainerSurface",["require","exports","module","../core/Surface","../core/Context"],function(a,b,c){function d(a){e.call(this,a),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new f(this._container),this.setContent(this._container)}var e=a("../core/Surface"),f=a("../core/Context");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),e.prototype.render.apply(this,arguments)},d.prototype.deploy=function(){return this._shouldRecalculateSize=!0,e.prototype.deploy.apply(this,arguments)},d.prototype.commit=function(){var a=this._size?[this._size[0],this._size[1]]:null,b=e.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||a&&(this._size[0]!==a[0]||this._size[1]!==a[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),b},c.exports=d}),define("famous/surfaces/FormContainerSurface",["require","exports","module","./ContainerSurface"],function(a,b,c){function d(a){a&&(this._method=a.method||""),e.apply(this,arguments)}var e=a("./ContainerSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="form",d.prototype.deploy=function(a){return this._method&&(a.method=this._method),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define("famous/surfaces/ImageSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(){this._imageUrl=void 0,e.apply(this,arguments)}var e=a("../core/Surface"),f=[],g=[],h=[],i=!0;d.enableCache=function(){i=!0},d.disableCache=function(){i=!1},d.clearCache=function(){f=[],g=[],h=[]},d.getCache=function(){return{urlCache:f,countCache:g,nodeCache:g}},d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="img",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(a){var b=f.indexOf(this._imageUrl);-1!==b&&(1===g[b]?(f.splice(b,1),g.splice(b,1),h.splice(b,1)):g[b]--),b=f.indexOf(a),-1===b?(f.push(a),g.push(1)):g[b]++,this._imageUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){var b=f.indexOf(this._imageUrl);if(void 0===h[b]&&i){var c=new Image;c.src=this._imageUrl||"",h[b]=c}a.src=this._imageUrl||""},d.prototype.recall=function(a){a.src=""},c.exports=d}),define("famous/surfaces/InputSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._type=a.type||"text",this._name=a.name||"",e.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(a){a.target!==this._currentTarget&&this.blur()}.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="input",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this
},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.setType=function(a){return this._type=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),a.value=this._value,a.type=this._type,a.name=this._name},c.exports=d}),define("famous/surfaces/SubmitInputSurface",["require","exports","module","./InputSurface"],function(a,b,c){function d(a){e.apply(this,arguments),this._type="submit",a&&a.onClick&&this.setOnClick(a.onClick)}var e=a("./InputSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setOnClick=function(a){this.onClick=a},d.prototype.deploy=function(a){this.onclick&&(a.onClick=this.onClick),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define("famous/surfaces/TextareaSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._name=a.name||"",this._wrap=a.wrap||"",this._cols=a.cols||"",this._rows=a.rows||"",e.apply(this,arguments),this.on("click",this.focus.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="textarea",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.setWrap=function(a){return this._wrap=a,this._contentDirty=!0,this},d.prototype.setColumns=function(a){return this._cols=a,this._contentDirty=!0,this},d.prototype.setRows=function(a){return this._rows=a,this._contentDirty=!0,this},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),""!==this._value&&(a.value=this._value),""!==this._name&&(a.name=this._name),""!==this._wrap&&(a.wrap=this._wrap),""!==this._cols&&(a.cols=this._cols),""!==this._rows&&(a.rows=this._rows)},c.exports=d}),define("famous/surfaces/VideoSurface",["require","exports","module","../core/Surface"],function(a,b,c){function d(a){e.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a)}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={autoplay:!1},d.prototype.elementType="video",d.prototype.elementClass="famous-surface",d.prototype.setOptions=function(a){a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.autoplay&&(this.options.autoplay=a.autoplay),a.src&&(this._videoUrl=a.src,this._contentDirty=!0)},d.prototype.setContent=function(a){this._videoUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){a.src=this._videoUrl,a.autoplay=this.options.autoplay},d.prototype.recall=function(a){a.src=""},c.exports=d}),define("famous/transitions/CachedMap",["require","exports","module"],function(a,b,c){function d(a){this._map=a||null,this._cachedOutput=null,this._cachedInput=Number.NaN}d.create=function(a){var b=new d(a);return b.get.bind(b)},d.prototype.get=function(a){return a!==this._cachedInput&&(this._cachedInput=a,this._cachedOutput=this._map(a)),this._cachedOutput},c.exports=d}),define("famous/transitions/Easing",["require","exports","module"],function(a,b,c){var d={inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inQuart:function(a){return a*a*a*a},outQuart:function(a){return-(--a*a*a*a-1)},inOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return--a*a*a*a*a+1},inOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inCirc:function(a){return-(Math.sqrt(1-a*a)-1)},outCirc:function(a){return Math.sqrt(1- --a*a)},inOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)},inBack:function(a,b){return void 0===b&&(b=1.70158),a*a*((b+1)*a-b)},outBack:function(a,b){return void 0===b&&(b=1.70158),--a*a*((b+1)*a+b)+1},inOutBack:function(a,b){return void 0===b&&(b=1.70158),(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},inBounce:function(a){return 1-d.outBounce(1-a)},outBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},inOutBounce:function(a){return.5>a?.5*d.inBounce(2*a):.5*d.outBounce(2*a-1)+.5}};c.exports=d}),define("famous/transitions/SnapTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/constraints/Snap","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.spring=new s({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(a){this.endState.set(a),f.call(this)}function h(){this.PE.wake()}function i(){this.PE.sleep()}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),k.call(this,a.velocity)}function p(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(j.call(this,this.endState),k.call(this,[0,0,0]),i.call(this))}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/constraints/Snap"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),g.call(this,a),b&&k.call(this,b),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return p.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,h.call(this),o.call(this,b),g.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/transitions/SpringTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Spring","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.spring=new s({anchor:this.endState}),this.particle=new r,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(a){this.particle.setPosition(a)}function g(a){this.particle.setVelocity(a)}function h(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function i(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function j(a){this._callback=a}function k(){this.PE.wake()}function l(){this.PE.sleep()}function m(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(f.call(this,this.endState),g.call(this,[0,0,0]),l.call(this))}function n(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),a.period<150&&(a.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),g.call(this,a.velocity)}function o(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function p(a){this.endState.set(a),o.call(this)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),f.call(this,a),p.call(this,a),b&&g.call(this,b),j.call(this,void 0)},d.prototype.getVelocity=function(){return i.call(this)},d.prototype.setVelocity=function(a){this.call(this,g(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return m.call(this),h.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,k.call(this),n.call(this,b),p.call(this,a),void j.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/transitions/WallTransition",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Spring","../physics/constraints/Wall","../math/Vector"],function(a,b,c){function d(a){a=a||0,this.endState=new u(a),this.initState=new u,this.spring=new s({anchor:this.endState}),this.wall=new t,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(){this.PE.wake()}function h(){this.PE.sleep()}function i(a){this.endState.set(a);var b=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===b?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),f.call(this)}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else{var b=e.call(this);b<this._absRestTolerance&&(h.call(this),j.call(this,this.endState),k.call(this,[0,0,0]))}}function p(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),void 0===a.restitution&&(a.restitution=b.restitution),void 0===a.drift&&(a.drift=t.DEFAULT_OPTIONS.drift),void 0===a.slop&&(a.slop=t.DEFAULT_OPTIONS.slop),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),this.wall.setOptions({restitution:a.restitution,drift:a.drift,slop:a.slop}),k.call(this,a.velocity)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../physics/constraints/Wall"),u=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),b&&k.call(this,b),i.call(this,a),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return o.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,g.call(this),p.call(this,b),i.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define("famous/utilities/KeyCodes",["require","exports","module"],function(a,b,c){var d={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};c.exports=d}),define("famous/utilities/Timer",["require","exports","module","../core/Engine"],function(a,b,c){function d(a){return k.on(l,a),a}function e(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),k.removeListener(l,e))};return d(e)}function f(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),c=m())};return d(e)}function g(a,b){if(void 0===b)return void 0;var c=function(){b--,0>=b&&(a.apply(this,arguments),i(c))};return d(c)}function h(a,b){b=b||1;var c=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=c)};return d(e)}function i(a){k.removeListener(l,a)}function j(a,b){var c,d,f,g,h;return function(){d=this,h=arguments,f=m();var j=function(){var i=m-f;b>i?c=e(j,b-i):(c=null,g=a.apply(d,h))};return i(c),c=e(j,b),g}}var k=a("../core/Engine"),l="prerender",m=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};c.exports={setTimeout:e,setInterval:f,debounce:j,after:g,every:h,clear:i}}),define("famous/views/ContextualView",["require","exports","module","../core/Entity","../core/Transform","../core/EventHandler","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._id=e.register(this)}var e=a("../core/Entity"),f=(a("../core/Transform"),a("../core/EventHandler")),g=a("../core/OptionsManager");d.DEFAULT_OPTIONS={},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.render=function(){return this._id},d.prototype.commit=function(){},c.exports=d}),define("famous/views/SequentialLayout",["require","exports","module","../core/OptionsManager","../core/Entity","../core/Transform","../core/ViewSequence","../utilities/Utility"],function(a,b,c){function d(a){this._items=null,this._size=null,this._outputFunction=d.DEFAULT_OUTPUT_FUNCTION,this.options=i.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this.optionsManager=new e(this.options),this.id=f.register(this),this.cachedSize=[void 0,void 0],a&&this.setOptions(a)}var e=a("../core/OptionsManager"),f=a("../core/Entity"),g=a("../core/Transform"),h=a("../core/ViewSequence"),i=a("../utilities/Utility");d.DEFAULT_OPTIONS={direction:i.Direction.Y,itemSpacing:0},d.DEFAULT_OUTPUT_FUNCTION=function(a,b){var c=this.options.direction===i.Direction.X?g.translate(b,0):g.translate(0,b);return{size:this.cachedSize,transform:c,target:a.render()}},d.prototype.getSize=function(){return this._size||this.render(),this._size},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new h(a)),this._items=a,this},d.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},d.prototype.setOutputFunction=function(a){return this._outputFunction=a,this},d.prototype.render=function(){return this.id},d.prototype.commit=function(a){var b=0,c=1^this.options.direction,d=this._items,e=null,f=[],g={},h=[],i=0;for(this._size=[0,0],this.cachedSize=a.size;d&&(e=d.get());)e.getSize&&(f=e.getSize()),g=this._outputFunction.call(this,e,b,i++),h.push(g),f&&(f[this.options.direction]&&(b+=f[this.options.direction]),f[c]>this._size[c]&&(this._size[c]=f[c]),0===f[c]&&(this._size[c]=void 0)),d=d.getNext(),this.options.itemSpacing&&d&&(b+=this.options.itemSpacing);return this._size[this.options.direction]=b,{transform:a.transform,origin:a.origin,size:this.getSize(),target:h}},c.exports=d}),define("famous/views/Deck",["require","exports","module","../core/Transform","../core/OptionsManager","../transitions/Transitionable","../utilities/Utility","./SequentialLayout"],function(a,b,c){function d(){k.apply(this,arguments),this.state=new i(0),this._isOpen=!1,this.setOutputFunction(function(a,b,c){var d=e.call(this),f=this.options.direction===j.Direction.X?g.translate(d*b,0,.001*(d-1)*b):g.translate(0,d*b,.001*(d-1)*b),h=a.render();if(this.options.stackRotation){var i=this.options.stackRotation*c*(1-d);h={transform:g.rotateZ(i),origin:[.5,.5],target:h}}return{transform:f,size:a.getSize(),target:h}})}function e(a){return a?this._isOpen?1:0:this.state.get()}function f(a,b,c){this.state.halt(),this.state.set(a,b,c)}var g=a("../core/Transform"),h=a("../core/OptionsManager"),i=a("../transitions/Transitionable"),j=a("../utilities/Utility"),k=a("./SequentialLayout");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=h.patch(k.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),d.prototype.getSize=function(){var a=k.prototype.getSize.apply(this,arguments),b=this._items?this._items.get().getSize():[0,0];b||(b=[0,0]);var c=e.call(this),d=1-c;return[b[0]*d+a[0]*c,b[1]*d+a[1]*c]},d.prototype.isOpen=function(){return this._isOpen},d.prototype.open=function(a){this._isOpen=!0,f.call(this,1,this.options.transition,a)},d.prototype.close=function(a){this._isOpen=!1,f.call(this,0,this.options.transition,a)},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},c.exports=d}),define("famous/views/DrawerLayout",["require","exports","module","../core/RenderNode","../core/Transform","../core/OptionsManager","../transitions/Transitionable","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),a&&this.setOptions(a),this._position=new m(0),this._direction=e(this.options.side),this._orientation=f(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new j,this.content=new j,this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",h.bind(this)),this._eventInput.on("end",i.bind(this))}function e(a){var b=d.SIDES;return a===b.LEFT||a===b.RIGHT?o:p}function f(a){var b=d.SIDES;return a===b.LEFT||a===b.TOP?1:-1}function g(a){var b,c=this.options;if(c.drawerLength)b=c.drawerLength;else{var d=a.getSize();b=d?d[this._direction]:c.drawerLength}return this._orientation*b}function h(a){var b,c,d=this.getPosition()+a.delta;this._cachedLength=g.call(this,this.drawer),1===this._orientation?(b=0,c=this._cachedLength):(b=this._cachedLength,c=0),d>c?d=c:b>d&&(d=b),this.setPosition(d)}function i(a){var b=a.velocity,c=this._orientation*this.getPosition(),d=this.options,e=this._orientation*this._cachedLength,f=d.positionThreshold||e/2,g=d.velocityThreshold;if(d.transition instanceof Object&&(d.transition.velocity=a.velocity),0===c)return void(this._isOpen=!1);if(c===e)return void(this._isOpen=!0);var h=Math.abs(b)>g||!this._isOpen&&c>f||this._isOpen&&f>c;h?this.toggle():this.reset()}var j=a("../core/RenderNode"),k=a("../core/Transform"),l=a("../core/OptionsManager"),m=a("../transitions/Transitionable"),n=a("../core/EventHandler"),o=0,p=1;d.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},d.DEFAULT_OPTIONS={side:d.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},d.prototype.setOptions=function(a){this._optionsManager.setOptions(a),void 0!==a.side&&(this._direction=e(a.side),this._orientation=f(a.side))},d.prototype.open=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this._cachedLength=g.call(this,this.drawer),this.setPosition(this._cachedLength,a,b),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},d.prototype.close=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this.setPosition(0,a,b),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},d.prototype.setPosition=function(a,b,c){this._position.isActive()&&this._position.halt(),this._position.set(a,b,c)},d.prototype.getPosition=function(){return this._position.get()},d.prototype.setProgress=function(a,b,c){return this._position.set(a*this._cachedLength,b,c)},d.prototype.getProgress=function(){return this._position.get()/this._cachedLength},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},d.prototype.reset=function(a){this._isOpen?this.open(a):this.close(a)},d.prototype.isOpen=function(){return this._isOpen},d.prototype.render=function(){var a=this.getPosition();(!this._isOpen&&0>a&&1===this._orientation||a>0&&-1===this._orientation)&&(a=0,this.setPosition(a));var b=this._direction===o?k.translate(a,0,0):k.translate(0,a,0);return[{transform:k.behind,target:this.drawer.render()},{transform:b,target:this.content.render()}]},c.exports=d}),define("famous/views/RenderController",["require","exports","module","../core/Modifier","../core/RenderNode","../core/Transform","../transitions/Transitionable","../core/View"],function(a,b,c){function d(){j.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=d.DefaultMap.transform,this.inOpacityMap=d.DefaultMap.opacity,this.inOriginMap=d.DefaultMap.origin,this.inAlignMap=d.DefaultMap.align,this.outTransformMap=d.DefaultMap.transform,this.outOpacityMap=d.DefaultMap.opacity,this.outOriginMap=d.DefaultMap.origin,this.outAlignMap=d.DefaultMap.align,this._output=[]}function e(a,b){return a(b.get())}var f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../core/Transform"),i=a("../transitions/Transitionable"),j=a("../core/View");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},d.DefaultMap={transform:function(){return h.identity},opacity:function(a){return a},origin:null,align:null},d.prototype.inTransformFrom=function(a){if(a instanceof Function)this.inTransformMap=a;else{if(!a||!a.get)throw Error("inTransformFrom takes only function or getter object");this.inTransformMap=a.get.bind(a)}return this},d.prototype.inOpacityFrom=function(a){if(a instanceof Function)this.inOpacityMap=a;else{if(!a||!a.get)throw Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=a.get.bind(a)}return this},d.prototype.inOriginFrom=function(a){if(a instanceof Function)this.inOriginMap=a;else{if(!a||!a.get)throw Error("inOriginFrom takes only function or getter object");this.inOriginMap=a.get.bind(a)}return this},d.prototype.inAlignFrom=function(a){if(a instanceof Function)this.inAlignMap=a;else{if(!a||!a.get)throw Error("inAlignFrom takes only function or getter object");this.inAlignMap=a.get.bind(a)}return this},d.prototype.outTransformFrom=function(a){if(a instanceof Function)this.outTransformMap=a;else{if(!a||!a.get)throw Error("outTransformFrom takes only function or getter object");this.outTransformMap=a.get.bind(a)}return this},d.prototype.outOpacityFrom=function(a){if(a instanceof Function)this.outOpacityMap=a;else{if(!a||!a.get)throw Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=a.get.bind(a)}return this},d.prototype.outOriginFrom=function(a){if(a instanceof Function)this.outOriginMap=a;else{if(!a||!a.get)throw Error("outOriginFrom takes only function or getter object");this.outOriginMap=a.get.bind(a)}return this},d.prototype.outAlignFrom=function(a){if(a instanceof Function)this.outAlignMap=a;else{if(!a||!a.get)throw Error("outAlignFrom takes only function or getter object");this.outAlignMap=a.get.bind(a)}return this},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=a:(this._nextRenderable=a,this.hide(function(){this._nextRenderable===a&&this.show(this._nextRenderable,c),this._nextRenderable=null})));this.hide()}var d=null,h=this._renderables.indexOf(a);if(h>=0){this._showing=h,d=this._states[h],d.halt();var j=this._outgoingRenderables.indexOf(a);j>=0&&this._outgoingRenderables.splice(j,1)}else{d=new i(0);var k=new f({transform:this.inTransformMap?e.bind(this,this.inTransformMap,d):null,opacity:this.inOpacityMap?e.bind(this,this.inOpacityMap,d):null,origin:this.inOriginMap?e.bind(this,this.inOriginMap,d):null,align:this.inAlignMap?e.bind(this,this.inAlignMap,d):null}),l=new g;l.add(k).add(a),this._showing=this._nodes.length,this._nodes.push(l),this._modifiers.push(k),this._states.push(d),this._renderables.push(a)}b||(b=this.options.inTransition),d.set(1,b,c)},d.prototype.hide=function(a,b){if(!(this._showing<0)){var c=this._showing;this._showing=-1,a instanceof Function&&(b=a,a=void 0);var d=this._nodes[c],f=this._modifiers[c],g=this._states[c],h=this._renderables[c];f.transformFrom(this.outTransformMap?e.bind(this,this.outTransformMap,g):null),f.opacityFrom(this.outOpacityMap?e.bind(this,this.outOpacityMap,g):null),f.originFrom(this.outOriginMap?e.bind(this,this.outOriginMap,g):null),f.alignFrom(this.outAlignMap?e.bind(this,this.outAlignMap,g):null),this._outgoingRenderables.indexOf(h)<0&&this._outgoingRenderables.push(h),a||(a=this.options.outTransition),g.halt(),g.set(0,a,function(a,c,d,e){if(this._outgoingRenderables.indexOf(e)>=0){var f=this._nodes.indexOf(a);this._nodes.splice(f,1),this._modifiers.splice(f,1),this._states.splice(f,1),this._renderables.splice(f,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(e),1),this._showing>=f&&this._showing--}b&&b.call(this)}.bind(this,d,f,g,h))}},d.prototype.render=function(){var a=this._output;a.length>this._nodes.length&&a.splice(this._nodes.length);for(var b=0;b<this._nodes.length;b++)a[b]=this._nodes[b].render();return a},c.exports=d}),define("famous/views/EdgeSwapper",["require","exports","module","../transitions/CachedMap","../core/Entity","../core/EventHandler","../core/Transform","./RenderController"],function(a,b,c){function d(a){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new j(a),this._controller.inTransformFrom(f.create(e.bind(this,1e-4))),this._controller.outTransformFrom(f.create(e.bind(this,-1e-4))),this._eventInput=new h,h.setInputHandler(this,this._eventInput),this._entityId=g.register(this),a&&this.setOptions(a)}function e(a,b){return i.translate(this._size[0]*(1-b),0,a*(1-b))}var f=a("../transitions/CachedMap"),g=a("../core/Entity"),h=a("../core/EventHandler"),i=a("../core/Transform"),j=a("./RenderController");d.prototype.show=function(a){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=a,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},d.prototype.setOptions=function(a){this._controller.setOptions(a)},d.prototype.render=function(){return this._entityId},d.prototype.commit=function(a){return this._size[0]=a.size[0],this._size[1]=a.size[1],{transform:a.transform,opacity:a.opacity,origin:a.origin,size:a.size,target:this._controller.render()}},c.exports=d}),define("famous/views/FlexibleLayout",["require","exports","module","../core/Entity","../core/Transform","../core/OptionsManager","../core/EventHandler","../transitions/Transitionable"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new i(this.options),a&&this.setOptions(a),this.id=g.register(this),this._ratios=new k(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new j,j.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var e,f,g,i,j=0,k=b,l=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<a.length;i++)f=a[i],g=this._nodes[i],"number"!=typeof f?k-=g.getSize()[c]||0:l+=f;for(i=0;i<a.length;i++)g=this._nodes[i],f=a[i],b="number"==typeof f?k*f/l:g.getSize()[c],e=c===d.DIRECTION_X?h.translate(j,0,0):h.translate(0,j,0),this._cachedTransforms.push(e),this._cachedLengths.push(b),j+=b}function f(a,b){for(var c=0;c<a.length;c++)if("number"!=typeof a[c]&&this._nodes[c].getSize()[b]!==this._cachedLengths[c])return!0;return!1}var g=a("../core/Entity"),h=a("../core/Transform"),i=a("../core/OptionsManager"),j=a("../core/EventHandler"),k=a("../transitions/Transitionable");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_X,transition:!1,ratios:[]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){if(this._nodes=a,0===this._ratios.get().length){for(var b=[],c=0;c<this._nodes.length;c++)b.push(1);this.setRatios(b)}},d.prototype.setRatios=function(a,b,c){void 0===b&&(b=this.options.transition);var d=this._ratios;0===d.get().length&&(b=void 0),d.isActive()&&d.halt(),d.set(a,b,c),this._ratiosDirty=!0
},d.prototype.getSize=function(){return this._size},d.prototype.commit=function(a){var b,c=a.size,d=a.transform,g=a.origin,i=a.opacity,j=this._ratios.get(),k=this.options.direction,l=c[k];(l!==this._size[k]||this._ratiosDirty||this._ratios.isActive()||k!==this._cachedDirection||f.call(this,j,k))&&(e.call(this,j,l,k),l!==this._size[k]&&(this._size[0]=c[0],this._size[1]=c[1]),k!==this._cachedDirection&&(this._cachedDirection=k),this._ratiosDirty&&(this._ratiosDirty=!1));for(var m=[],n=0;n<j.length;n++)b=[void 0,void 0],l=this._cachedLengths[n],b[k]=l,m.push({transform:this._cachedTransforms[n],size:b,target:this._nodes[n].render()});return c&&0!==g[0]&&0!==g[1]&&(d=h.moveThen([-c[0]*g[0],-c[1]*g[1],0],d)),{transform:d,size:c,opacity:i,target:m}},c.exports=d}),define("famous/views/Flipper",["require","exports","module","../core/Transform","../transitions/Transitionable","../core/RenderNode","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this.angle=new f(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var e=a("../core/Transform"),f=a("../transitions/Transitionable"),g=(a("../core/RenderNode"),a("../core/OptionsManager"));d.DIRECTION_X=0,d.DIRECTION_Y=1;var h=1;d.DEFAULT_OPTIONS={transition:!0,direction:d.DIRECTION_X},d.prototype.flip=function(a,b){var c=this.flipped?0:Math.PI;this.setAngle(c,a,b),this.flipped=!this.flipped},d.prototype.setAngle=function(a,b,c){void 0===b&&(b=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(a,b,c)},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.setFront=function(a){this.frontNode=a},d.prototype.setBack=function(a){this.backNode=a},d.prototype.render=function(){var a,b,c=this.angle.get();this.options.direction===d.DIRECTION_X?(a=e.rotateY(c),b=e.rotateY(c+Math.PI)):(a=e.rotateX(c),b=e.rotateX(c+Math.PI));var f=[];return this.frontNode&&f.push({transform:a,target:this.frontNode.render()}),this.backNode&&f.push({transform:e.moveThen([0,0,h],b),target:this.backNode.render()}),f},c.exports=d}),define("famous/views/GridLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/ViewSequence","../core/EventHandler","../core/Modifier","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new m(this.options),a&&this.setOptions(a),this.id=h.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new k,k.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var e,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){e=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?f.call(this,k,[i,h],[e,j,0],1):g.call(this,k,[i,h],[e,j,0],1),k++,e+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)g.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function f(a,b,c,d){var e={transform:new o(i.translate.apply(null,c)),opacity:new n(d),size:new n(b)},f=new l({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function g(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var h=a("../core/Entity"),i=(a("../core/RenderNode"),a("../core/Transform")),j=a("../core/ViewSequence"),k=a("../core/EventHandler"),l=a("../core/Modifier"),m=a("../core/OptionsManager"),n=a("../transitions/Transitionable"),o=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new j(a)),this.sequence=a},d.prototype.getSize=function(){return this._contextSizeCache},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.size,g=this.options.dimensions[0],h=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||h!==this._dimensionsCache[1])&&e.call(this,f,g,h);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:d,target:m.render()})),j=j.getNext(),l++}return f&&(b=i.moveThen([-f[0]*d[0],-f[1]*d[1],0],b)),{transform:b,opacity:c,size:f,target:k}},c.exports=d}),define("famous/views/HeaderFooterLayout",["require","exports","module","../core/Entity","../core/RenderNode","../core/Transform","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._entityId=h.register(this),this.header=new i,this.footer=new i,this.content=new i}function e(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function f(a){return this.options.direction===d.DIRECTION_X?j.translate(a,0,0):j.translate(0,a,0)}function g(a,b){return this.options.direction===d.DIRECTION_X?[a,b[1]]:[b[0],a]}var h=a("../core/Entity"),i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},d.prototype.render=function(){return this._entityId},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,d=a.size,h=a.opacity,i=void 0!==this.options.headerSize?this.options.headerSize:e.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:e.call(this,this.footer,this.options.defaultFooterSize),l=d[this.options.direction]-i-k;d&&(b=j.moveThen([-d[0]*c[0],-d[1]*c[1],0],b));var m=[{size:g.call(this,i,d),target:this.header.render()},{transform:f.call(this,i),size:g.call(this,l,d),target:this.content.render()},{transform:f.call(this,i+l),size:g.call(this,k,d),target:this.footer.render()}];return{transform:b,opacity:h,size:d,target:m}},c.exports=d}),define("famous/views/Lightbox",["require","exports","module","../core/Transform","../core/Modifier","../core/RenderNode","../utilities/Utility","../core/OptionsManager","../transitions/Transitionable","../transitions/TransitionableTransform"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var e=a("../core/Transform"),f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../utilities/Utility"),i=a("../core/OptionsManager"),j=a("../transitions/Transitionable"),k=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={inTransform:e.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:e.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:e.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,a,b,c));this.hide()}this._showing=!0;var d={transform:new k(this.options.inTransform),origin:new j(this.options.inOrigin),align:new j(this.options.inAlign),opacity:new j(this.options.inOpacity)},e=new f({transform:d.transform,opacity:d.opacity,origin:d.origin,align:d.align}),i=new g;i.add(e).add(a),this.nodes.push(i),this.states.push(d),this.transforms.push(e);var l=c?h.after(3,c):void 0;b||(b=this.options.inTransition),d.transform.set(this.options.showTransform,b,l),d.opacity.set(this.options.showOpacity,b,l),d.origin.set(this.options.showOrigin,b,l),d.align.set(this.options.showAlign,b,l)},d.prototype.hide=function(a,b){if(this._showing){this._showing=!1,a instanceof Function&&(b=a,a=void 0);var c=this.nodes[this.nodes.length-1],d=this.transforms[this.transforms.length-1],e=this.states[this.states.length-1],f=h.after(3,function(){this.nodes.splice(this.nodes.indexOf(c),1),this.states.splice(this.states.indexOf(e),1),this.transforms.splice(this.transforms.indexOf(d),1),b&&b.call(this)}.bind(this));a||(a=this.options.outTransition),e.transform.set(this.options.outTransform,a,f),e.opacity.set(this.options.outOpacity,a,f),e.origin.set(this.options.outOrigin,a,f),e.align.set(this.options.outAlign,a,f)}},d.prototype.render=function(){for(var a=[],b=0;b<this.nodes.length;b++)a.push(this.nodes[b].render());return a},c.exports=d}),define("famous/views/Scroller",["require","exports","module","../core/Entity","../core/Group","../core/OptionsManager","../core/Transform","../utilities/Utility","../core/ViewSequence","../core/EventHandler"],function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new j,this.group.add({render:h.bind(this)}),this._entityId=i.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput)}function e(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function f(a,b,c){var d=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),e.call(this,d)}function g(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?e.call(this,this.getCumulativeSize()):e.call(this,this._contextSize)}function h(){for(var a=null,b=this._position,c=[],d=-this._positionOffset,h=g.call(this),i=this._node;i&&d-b<h+this.options.margin;)d+=f.call(this,i,d,c),i=i.getNext?i.getNext():null;var j=this._node,k=e.call(this,j.getSize());if(h>d){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=e.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=e.call(this,j.getSize()))}for(!i&&h-p>d-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:d-h})):!this._node.getPrevious()&&-p>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,d=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));i&&d-b>-(h+this.options.margin);)f.call(this,i,d,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));return c}var i=a("../core/Entity"),j=a("../core/Group"),k=a("../core/OptionsManager"),l=a("../core/Transform"),m=a("../utilities/Utility"),n=a("../core/ViewSequence"),o=a("../core/EventHandler");d.DEFAULT_OPTIONS={direction:m.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var p=0;d.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},d.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},d.prototype.onEdge=function(){return this._onEdge},d.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===m.Direction.X?l.translate(a,0):l.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return l.inverse(a(-b))}},d.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new n({array:a})),this._node=a,this._positionOffset=0},d.prototype.getSize=function(a){return a?this._contextSize:this._size},d.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===m.Direction.X?(this._size[0]=g.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=g.call(this)));var f=this._masterOutputFunction(-this._position);return{transform:l.multiply(b,f),size:e,opacity:c,origin:d,target:this.group.render()}},c.exports=d}),define("famous/views/Scrollview",["require","exports","module","../physics/PhysicsEngine","../physics/bodies/Particle","../physics/forces/Drag","../physics/forces/Spring","../core/EventHandler","../core/OptionsManager","../core/ViewSequence","../views/Scroller","../utilities/Utility","../inputs/GenericSync","../inputs/ScrollSync","../inputs/TouchSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new v(this.options),this._scroller=new x(this.options),this.sync=new z(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==y.Direction.Y}),this._physicsEngine=new q,this._particle=new r,this._physicsEngine.addBody(this._particle),this.spring=new t({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new s({forceFunction:s.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new s({forceFunction:s.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=C.NONE,this._onEdge=D.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new u,this._eventOutput=new u,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),h.call(this),a&&this.setOptions(a)}function e(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),j.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function f(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==D.NONE&&a.slip&&(0>b&&this._onEdge===D.TOP||b>0&&this._onEdge===D.BOTTOM?this._earlyEnd||(g.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&e.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var d=this.options.speedLimit;-d>b?b=-d:b>d&&(b=d),this.setVelocity(b);var f=16*d;c>f?c=f:-f>c&&(c=-f)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===C.NONE&&o.call(this)}}function g(a){if(this._touchCount=a.count||0,!this._touchCount){j.call(this),this._onEdge!==D.NONE&&n.call(this,this._edgeSpringPosition,C.EDGE),i.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function h(){this._eventInput.bindThis(this),this._eventInput.on("start",e),this._eventInput.on("update",f),this._eventInput.on("end",g),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,l.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===C.NONE&&o.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==C.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function i(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function j(){this._springState=C.NONE,this._physicsEngine.detachAll()}function k(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function l(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===C.EDGE||n.call(this,this._edgeSpringPosition,C.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(j.call(this),i.call(this))}function m(){if(!this._touchCount&&this._springState!==C.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=k.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():n.call(this,0,C.PAGE)}}}function n(a,b){var c;b===C.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===C.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(j.call(this),this._springState=b,i.call(this)),this._springState=b}function o(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=k.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=k.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=k.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&p.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function p(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===C.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===C.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Drag"),t=a("../physics/forces/Spring"),u=a("../core/EventHandler"),v=a("../core/OptionsManager"),w=a("../core/ViewSequence"),x=a("../views/Scroller"),y=a("../utilities/Utility"),z=a("../inputs/GenericSync"),A=a("../inputs/ScrollSync"),B=a("../inputs/TouchSync");z.register({scroll:A,touch:B});var C={NONE:0,EDGE:1,PAGE:2},D={TOP:-1,NONE:0,BOTTOM:1};d.DEFAULT_OPTIONS={direction:y.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},d.prototype.getCurrentIndex=function(){return this._node.index},d.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===D.TOP)return null;if(this.getPosition()>1&&this._springState===C.NONE)return n.call(this,0,C.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=k.call(this,a);this._scroller.sequenceFrom(a),this._node=a,p.call(this,b),n.call(this,0,C.PAGE)}return a},d.prototype.goToNextPage=function(){if(!this._node||this._onEdge===D.BOTTOM)return null;var a=this._node.getNext();if(a){var b=k.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,p.call(this,-b),n.call(this,0,C.PAGE)}return a},d.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},d.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},d.prototype.getPosition=function(){return this._particle.getPosition1D()},d.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},d.prototype.getOffset=d.prototype.getPosition,d.prototype.setPosition=function(a){this._particle.setPosition1D(a)},d.prototype.setOffset=d.prototype.setPosition,d.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},d.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},d.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=y.Direction.X:"y"===a.direction&&(a.direction=y.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===y.Direction.X?z.DIRECTION_X:z.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new w({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},d.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},d.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&m.call(this),this._scroller.render()},c.exports=d}),define("famous/views/ScrollContainer",["require","exports","module","../surfaces/ContainerSurface","../core/EventHandler","./Scrollview","../utilities/Utility","../core/OptionsManager"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this.container=new e(this.options.container),this.scrollview=new g(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var e=a("../surfaces/ContainerSurface"),f=a("../core/EventHandler"),g=a("./Scrollview"),h=(a("../utilities/Utility"),a("../core/OptionsManager"));d.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},d.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},d.prototype.render=function(){return this.container.render()},c.exports=d}),define("famous/widgets/NavigationBar",["require","exports","module","../core/Scene","../core/Surface","../core/Transform","../core/View"],function(a,b,c){function d(){h.apply(this,arguments),this.title=new f({classes:this.options.classes,content:this.options.content}),this.back=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new e({id:"master",size:this.options.size,target:[{transform:g.inFront,origin:[0,.5],align:[0,.5],target:this.back},{origin:[.5,.5],align:[.5,.5],target:this.title},{transform:g.inFront,origin:[1,.5],align:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(a){var b=a.id,c=a.value;"size"===b?(this.layout.id.master.setSize(c),this.title.setSize(c),this.back.setSize([c[1],c[1]]),this.more.setSize([c[1],c[1]])):"backClasses"===b?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===b?this.back.setContent(this.options.backContent):"classes"===b?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===b?this.setContent(this.options.content):"moreClasses"===b?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===b&&this.more.setContent(this.options.content)}.bind(this))}var e=a("../core/Scene"),f=a("../core/Surface"),g=a("../core/Transform"),h=a("../core/View");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},d.prototype.setContent=function(a){return this.title.setContent(a)},c.exports=d}),define("famous/widgets/Slider",["require","exports","module","../core/Surface","../surfaces/CanvasSurface","../core/Transform","../core/EventHandler","../math/Utilities","../core/OptionsManager","../inputs/MouseSync","../inputs/TouchSync","../inputs/GenericSync"],function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new k(this.options),a&&this.setOptions(a),this.indicator=new g({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new f({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new i,this.eventInput=new i,i.setInputHandler(this,this.eventInput),i.setOutputHandler(this,this.eventOutput);var b=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new n(["mouse","touch"],{scale:b,direction:n.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(a){this.set(a.position)}.bind(this)),this._drawPos=0,e.call(this)}function e(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var f=a("../core/Surface"),g=a("../surfaces/CanvasSurface"),h=a("../core/Transform"),i=a("../core/EventHandler"),j=a("../math/Utilities"),k=a("../core/OptionsManager"),l=a("../inputs/MouseSync"),m=a("../inputs/TouchSync"),n=a("../inputs/GenericSync");n.register({mouse:l,touch:m}),d.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.get=function(){return this.options.value},d.prototype.set=function(a){a!==this.options.value&&(this.options.value=j.clamp(a,this.options.range),e.call(this),this.eventOutput.emit("change",{value:a}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){var a=this.options.range,b=Math.floor((this.get()-a[0])/(a[1]-a[0])*this.options.indicatorSize[0]);if(b<this._drawPos)this.indicator.getContext("2d").clearRect(b,0,this._drawPos-b+1,this.options.indicatorSize[1]);else if(b>this._drawPos){var c=this.indicator.getContext("2d");c.fillStyle=this.options.fillColor,c.fillRect(this._drawPos-1,0,b-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=b,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:h.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},c.exports=d}),define("famous/widgets/ToggleButton",["require","exports","module","../core/Surface","../core/EventHandler","../views/RenderController"],function(a,b,c){function d(a){this.options={content:["",""],offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:d.TOGGLE,crossfade:!0},this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.offSurface=new e,this.offSurface.on("click",function(){this.options.toggleMode!==d.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new e,this.onSurface.on("click",function(){this.options.toggleMode!==d.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new g({overlap:this.options.crossfade}),this.deselect(),a&&this.setOptions(a)}var e=a("../core/Surface"),f=a("../core/EventHandler"),g=a("../views/RenderController");d.OFF=0,d.ON=1,d.TOGGLE=2,d.prototype.select=function(a){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),a||this._eventOutput.emit("select")},d.prototype.deselect=function(a){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),a||this._eventOutput.emit("deselect")},d.prototype.isSelected=function(){return this.selected},d.prototype.setOptions=function(a){void 0!==a.content&&(a.content instanceof Array||(a.content=[a.content,a.content]),this.options.content=a.content,this.offSurface.setContent(this.options.content[0]),this.onSurface.setContent(this.options.content[1])),a.offClasses&&(this.options.offClasses=a.offClasses,this.offSurface.setClasses(this.options.offClasses)),a.onClasses&&(this.options.onClasses=a.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==a.size&&(this.options.size=a.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==a.toggleMode&&(this.options.toggleMode=a.toggleMode),void 0!==a.outTransition&&(this.options.outTransition=a.outTransition),void 0!==a.inTransition&&(this.options.inTransition=a.inTransition),void 0!==a.crossfade&&(this.options.crossfade=a.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){return this.arbiter.render()},c.exports=d}),define("famous/widgets/TabBar",["require","exports","module","../utilities/Utility","../core/View","../views/GridLayout","./ToggleButton"],function(a,b,c){function d(){h.apply(this,arguments),this.layout=new i,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",e.bind(this))}function e(a){var b=a.id,c=a.value;if("direction"===b)this.layout.setOptions({dimensions:f.call(this.buttons.length,this.options.direction)});else if("buttons"===b)for(var d in this.buttons)this.buttons[d].setOptions(c);
else if("sections"===b)for(var e in this.options.sections)this.defineSection(e,this.options.sections[e])}function f(a,b){return b===g.Direction.X?[a,1]:[1,a]}var g=a("../utilities/Utility"),h=a("../core/View"),i=a("../views/GridLayout"),j=a("./ToggleButton");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={sections:[],widget:j,size:[void 0,50],direction:g.Direction.X,buttons:{toggleMode:j.ON}},d.prototype.defineSection=function(a,b){var c,d=this._buttonIds[a];if(void 0===d){d=this.buttons.length,this._buttonIds[a]=d;var e=this.options.widget;c=new e,this.buttons[d]=c,this.layout.setOptions({dimensions:f(this.buttons.length,this.options.direction)})}else c=this.buttons[d],c.unbind("select",this._buttonCallbacks[a]);this.options.buttons&&c.setOptions(this.options.buttons),c.setOptions(b),this._buttonCallbacks[a]=this.select.bind(this,a),c.on("select",this._buttonCallbacks[a])},d.prototype.select=function(a){var b=this._buttonIds[a];this.buttons[b]&&this.buttons[b].isSelected()?this._eventOutput.emit("select",{id:a}):this.buttons[b]&&this.buttons[b].select();for(var c=0;c<this.buttons.length;c++)c!==b&&this.buttons[c].deselect()},c.exports=d}),define(function(a,b,c){function d(a){return[a.clientWidth,a.clientHeight]}function e(a){this.container=a,this._allocator=new h(a),this._node=new f,this._eventOutput=new g,this._size=d(this.container),this._perspectiveState=new j(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:i.identity,opacity:1,origin:k,align:k,size:this._size},this._eventOutput.on("resize",function(){this.setSize(d(this.container))}.bind(this))}var f=a("./RenderNode"),g=a("./EventHandler"),h=a("./ElementAllocator"),i=a("./Transform"),j=a("../transitions/Transitionable"),k=[0,0],l=!("perspective"in document.documentElement.style),m=l?function(a,b){a.style.webkitPerspective=b?b.toFixed()+"px":""}:function(a,b){a.style.perspective=b?b.toFixed()+"px":""};e.prototype.getAllocator=function(){return this._allocator},e.prototype.add=function(a){return this._node.add(a)},e.prototype.migrate=function(a){a!==this.container&&(this.container=a,this._allocator.migrate(a))},e.prototype.getSize=function(){return this._size},e.prototype.setSize=function(a){a||(a=d(this.container)),this._size[0]=a[0],this._size[1]=a[1]},e.prototype.update=function(a){a&&(a.transform&&(this._nodeContext.transform=a.transform),a.opacity&&(this._nodeContext.opacity=a.opacity),a.origin&&(this._nodeContext.origin=a.origin),a.align&&(this._nodeContext.align=a.align),a.size&&(this._nodeContext.size=a.size));var b=this._perspectiveState.get();b!==this._perspective&&(m(this.container,b),this._perspective=b),this._node.commit(this._nodeContext)},e.prototype.getPerspective=function(){return this._perspectiveState.get()},e.prototype.setPerspective=function(a,b,c){return this._perspectiveState.set(a,b,c)},e.prototype.emit=function(a,b){return this._eventOutput.emit(a,b)},e.prototype.on=function(a,b){return this._eventOutput.on(a,b)},e.prototype.removeListener=function(a,b){return this._eventOutput.removeListener(a,b)},e.prototype.pipe=function(a){return this._eventOutput.pipe(a)},e.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},c.exports=e}),define(function(a,b,c){function d(a){a||(a=document.createDocumentFragment()),this.container=a,this.detachedNodes={},this.nodeCount=0}d.prototype.migrate=function(a){var b=this.container;if(a!==b){if(b instanceof DocumentFragment)a.appendChild(b);else for(;b.hasChildNodes();)a.appendChild(b.firstChild);this.container=a}},d.prototype.allocate=function(a){a=a.toLowerCase(),a in this.detachedNodes||(this.detachedNodes[a]=[]);var b,c=this.detachedNodes[a];return c.length>0?b=c.pop():(b=document.createElement(a),this.container.appendChild(b)),this.nodeCount++,b},d.prototype.deallocate=function(a){var b=a.nodeName.toLowerCase(),c=this.detachedNodes[b];c.push(a),this.nodeCount--},d.prototype.getNodeCount=function(){return this.nodeCount},c.exports=d}),define(function(a,b,c){function d(a){this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this._eventOutput=new k,this._eventOutput.bindThis(this),this.eventForwarder=function(a){this._eventOutput.emit(a.type,a)}.bind(this),this.id=j.register(this),this._element=null,this._sizeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._invisible=!1,a&&this.attach(a)}function e(a){for(var b in this._eventOutput.listeners)a.addEventListener(b,this.eventForwarder)}function f(a){for(var b in this._eventOutput.listeners)a.removeEventListener(b,this.eventForwarder)}function g(a){a[12]=Math.round(a[12]*n)/n,a[13]=Math.round(a[13]*n)/n;for(var b="matrix3d(",c=0;15>c;c++)b+=a[c]<1e-6&&a[c]>-1e-6?"0,":a[c]+",";return b+=a[15]+")"}function h(a){return 100*a[0]+"% "+100*a[1]+"%"}function i(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var j=a("./Entity"),k=a("./EventHandler"),l=a("./Transform"),m=!("transform"in document.documentElement.style),n=window.devicePixelRatio||1;d.prototype.on=function(a,b){this._element&&this._element.addEventListener(a,this.eventForwarder),this._eventOutput.on(a,b)},d.prototype.removeListener=function(a,b){this._eventOutput.removeListener(a,b)},d.prototype.emit=function(a,b){b&&!b.origin&&(b.origin=this);var c=this._eventOutput.emit(a,b);return c&&b&&b.stopPropagation&&b.stopPropagation(),c},d.prototype.pipe=function(a){return this._eventOutput.pipe(a)},d.prototype.unpipe=function(a){return this._eventOutput.unpipe(a)},d.prototype.render=function(){return this.id};var o;o=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(a,b){a.style.zIndex=1e6*b[14]|0,a.style.transform=g(b)}:m?function(a,b){a.style.webkitTransform=g(b)}:function(a,b){a.style.transform=g(b)};var p=m?function(a,b){a.style.webkitTransformOrigin=h(b)}:function(a,b){a.style.transformOrigin=h(b)},q=m?function(a){a.style.webkitTransform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0}:function(a){a.style.transform="scale3d(0.0001,0.0001,0.0001)",a.style.opacity=0};d.prototype.commit=function(a){var b=this._element;if(b){{var c=a.transform,d=a.opacity,e=a.origin;a.size}if(!c&&this._matrix)return this._matrix=null,this._opacity=0,void q(b);if(i(this._origin,e)&&(this._originDirty=!0),l.notEquals(this._matrix,c)&&(this._transformDirty=!0),this._invisible&&(this._invisible=!1,this._element.style.display=""),this._opacity!==d&&(this._opacity=d,b.style.opacity=d>=1?"0.999999":d),this._transformDirty||this._originDirty||this._sizeDirty){this._sizeDirty&&(this._sizeDirty=!1),this._originDirty&&(e?(this._origin||(this._origin=[0,0]),this._origin[0]=e[0],this._origin[1]=e[1]):this._origin=null,p(b,this._origin),this._originDirty=!1),c||(c=l.identity),this._matrix=c;var f=this._size?l.thenMove(c,[-this._size[0]*e[0],-this._size[1]*e[1],0]):c;o(b,f),this._transformDirty=!1}}},d.prototype.cleanup=function(){this._element&&(this._invisible=!0,this._element.style.display="none")},d.prototype.attach=function(a){this._element=a,e.call(this,a)},d.prototype.detach=function(){var a=this._element;return a&&(f.call(this,a),this._invisible&&(this._invisible=!1,this._element.style.display="")),this._element=null,a},c.exports=d}),define(function(a,b,c){function d(){y.runLoop?(o.step(),window.requestAnimationFrame(d)):v=!1}function e(){for(var a=0;a<p.length;a++)p[a].emit("resize");x.emit("resize")}function f(){window.addEventListener("touchmove",function(a){a.preventDefault()},!0),g()}function g(){return document.body?(document.body.classList.add("famous-root"),void document.documentElement.classList.add("famous-root")):void o.nextTick(g)}function h(a,b){return document.body?void document.body.addEventListener(a,b):void o.nextTick(addEventListener.bind(this,a,b))}function i(a,b){return document.body?(document.body.appendChild(b),void a.emit("resize")):void o.nextTick(i.bind(this,a,b))}var j,k,l=a("./Context"),m=a("./EventHandler"),n=a("./OptionsManager"),o={},p=[],q=[],r=0,s=0,t=[],u=Date.now(),v=!0,w={},x=new m,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0,appMode:!0},z=new n(y),A=10;o.step=function(){r++,s=r;var a=Date.now();if(!(k&&k>a-u)){var b=0;j=a-u,u=a,x.emit("prerender");for(var c=q.length;c--;)q.shift()(r);for(;t.length&&Date.now()-a<A;)t.shift().call(this);for(b=0;b<p.length;b++)p[b].update();x.emit("postrender")}},window.requestAnimationFrame(d),window.addEventListener("resize",e,!1),e();var B=!1;o.pipe=function(a){return a.subscribe instanceof Function?a.subscribe(o):x.pipe(a)},o.unpipe=function(a){return a.unsubscribe instanceof Function?a.unsubscribe(o):x.unpipe(a)},o.on=function(a,b){return a in w||(w[a]=x.emit.bind(x,a),h(a,w[a])),x.on(a,b)},o.emit=function(a,b){return x.emit(a,b)},o.removeListener=function(a,b){return x.removeListener(a,b)},o.getFPS=function(){return 1e3/j},o.setFPSCap=function(a){k=Math.floor(1e3/a)},o.getOptions=function(a){return z.getOptions(a)},o.setOptions=function(){return z.setOptions.apply(z,arguments)},o.createContext=function(a){!B&&y.appMode&&o.nextTick(f);var b=!1;a||(a=document.createElement(y.containerType),a.classList.add(y.containerClass),b=!0);var c=new l(a);return o.registerContext(c),b&&i(c,a),c},o.registerContext=function(a){return p.push(a),a},o.getContexts=function(){return p},o.deregisterContext=function(a){var b=p.indexOf(a);b>=0&&p.splice(b,1)},o.nextTick=function(a){q.push(a)},o.defer=function(a){t.push(a)},z.on("change",function(a){"fpsCap"===a.id?o.setFPSCap(a.value):"runLoop"===a.id&&!v&&a.value&&(v=!0,window.requestAnimationFrame(d))}),c.exports=o}),define(function(a,b,c){function d(a){return h[a]}function e(a,b){h[a]=b}function f(a){var b=h.length;return e(b,a),b}function g(a){e(a,null)}var h=[];c.exports={register:f,unregister:g,get:d,set:e}}),define(function(a,b,c){function d(){this.listeners={},this._owner=this}d.prototype.emit=function(a,b){var c=this.listeners[a];if(c)for(var d=0;d<c.length;d++)c[d].call(this._owner,b);return this},d.prototype.on=function(a,b){a in this.listeners||(this.listeners[a]=[]);var c=this.listeners[a].indexOf(b);return 0>c&&this.listeners[a].push(b),this},d.prototype.addListener=d.prototype.on,d.prototype.removeListener=function(a,b){var c=this.listeners[a];if(void 0!==c){var d=c.indexOf(b);d>=0&&c.splice(d,1)}return this},d.prototype.bindThis=function(a){this._owner=a},c.exports=d}),define(function(a,b,c){function d(){e.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var e=a("./EventEmitter");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.setInputHandler=function(a,b){a.trigger=b.trigger.bind(b),b.subscribe&&b.unsubscribe&&(a.subscribe=b.subscribe.bind(b),a.unsubscribe=b.unsubscribe.bind(b))},d.setOutputHandler=function(a,b){b instanceof d&&b.bindThis(a),a.pipe=b.pipe.bind(b),a.unpipe=b.unpipe.bind(b),a.on=b.on.bind(b),a.addListener=a.on,a.removeListener=b.removeListener.bind(b)},d.prototype.emit=function(a,b){e.prototype.emit.apply(this,arguments);var c=0;for(c=0;c<this.downstream.length;c++)this.downstream[c].trigger&&this.downstream[c].trigger(a,b);for(c=0;c<this.downstreamFn.length;c++)this.downstreamFn[c](a,b);return this},d.prototype.trigger=d.prototype.emit,d.prototype.pipe=function(a){if(a.subscribe instanceof Function)return a.subscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return 0>c&&b.push(a),a instanceof Function?a("pipe",null):a.trigger&&a.trigger("pipe",null),a},d.prototype.unpipe=function(a){if(a.unsubscribe instanceof Function)return a.unsubscribe(this);var b=a instanceof Function?this.downstreamFn:this.downstream,c=b.indexOf(a);return c>=0?(b.splice(c,1),a instanceof Function?a("unpipe",null):a.trigger&&a.trigger("unpipe",null),a):!1},d.prototype.on=function(a){if(e.prototype.on.apply(this,arguments),!(a in this.upstreamListeners)){var b=this.trigger.bind(this,a);this.upstreamListeners[a]=b;for(var c=0;c<this.upstream.length;c++)this.upstream[c].on(a,b)}return this},d.prototype.addListener=d.prototype.on,d.prototype.subscribe=function(a){var b=this.upstream.indexOf(a);if(0>b){this.upstream.push(a);for(var c in this.upstreamListeners)a.on(c,this.upstreamListeners[c])}return this},d.prototype.unsubscribe=function(a){var b=this.upstream.indexOf(a);if(b>=0){this.upstream.splice(b,1);for(var c in this.upstreamListeners)a.removeListener(c,this.upstreamListeners[c])}return this},c.exports=d}),define(function(a,b,c){function d(a){g.call(this,a),this._shouldRecalculateSize=!1,this._container=document.createDocumentFragment(),this.context=new e(this._container),this.setContent(this._container),this._groupSize=[void 0,void 0]}var e=a("./Context"),f=a("./Transform"),g=a("./Surface");d.SIZE_ZERO=[0,0],d.prototype=Object.create(g.prototype),d.prototype.elementType="div",d.prototype.elementClass="famous-group",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return g.prototype.render.call(this)},d.prototype.deploy=function(a){this.context.migrate(a)},d.prototype.recall=function(){this._container=document.createDocumentFragment(),this.context.migrate(this._container)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,e=a.opacity,h=a.size,i=g.prototype.commit.call(this,{allocator:a.allocator,transform:f.thenMove(b,[-c[0]*h[0],-c[1]*h[1],0]),opacity:e,origin:c,size:d.SIZE_ZERO});return(h[0]!==this._groupSize[0]||h[1]!==this._groupSize[1])&&(this._groupSize[0]=h[0],this._groupSize[1]=h[1],this.context.setSize(h)),this.context.update({transform:f.translate(-c[0]*h[0],-c[1]*h[1],0),origin:c,size:h}),i},c.exports=d}),define(function(a,b,c){function d(a){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null,this._legacyStates={},this._output={transform:f.identity,opacity:1,origin:null,align:null,size:null,proportions:null,target:null},a&&(a.transform&&this.transformFrom(a.transform),void 0!==a.opacity&&this.opacityFrom(a.opacity),a.origin&&this.originFrom(a.origin),a.align&&this.alignFrom(a.align),a.size&&this.sizeFrom(a.size),a.proportions&&this.proportionsFrom(a.proportions))}function e(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._alignGetter&&(this._output.align=this._alignGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter()),this._proportionGetter&&(this._output.proportions=this._proportionGetter())}var f=a("./Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.transformFrom=function(a){return a instanceof Function?this._transformGetter=a:a instanceof Object&&a.get?this._transformGetter=a.get.bind(a):(this._transformGetter=null,this._output.transform=a),this},d.prototype.opacityFrom=function(a){return a instanceof Function?this._opacityGetter=a:a instanceof Object&&a.get?this._opacityGetter=a.get.bind(a):(this._opacityGetter=null,this._output.opacity=a),this},d.prototype.originFrom=function(a){return a instanceof Function?this._originGetter=a:a instanceof Object&&a.get?this._originGetter=a.get.bind(a):(this._originGetter=null,this._output.origin=a),this},d.prototype.alignFrom=function(a){return a instanceof Function?this._alignGetter=a:a instanceof Object&&a.get?this._alignGetter=a.get.bind(a):(this._alignGetter=null,this._output.align=a),this},d.prototype.sizeFrom=function(a){return a instanceof Function?this._sizeGetter=a:a instanceof Object&&a.get?this._sizeGetter=a.get.bind(a):(this._sizeGetter=null,this._output.size=a),this},d.prototype.proportionsFrom=function(a){return a instanceof Function?this._proportionGetter=a:a instanceof Object&&a.get?this._proportionGetter=a.get.bind(a):(this._proportionGetter=null,this._output.proportions=a),this},d.prototype.setTransform=function(a,b,c){return b||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new h(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(a,b,c),this):this.transformFrom(a)},d.prototype.setOpacity=function(a,b,c){return b||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new g(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(a,b,c)):this.opacityFrom(a)},d.prototype.setOrigin=function(a,b,c){return b||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new g(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(a,b,c),this):this.originFrom(a)},d.prototype.setAlign=function(a,b,c){return b||this._legacyStates.align?(this._legacyStates.align||(this._legacyStates.align=new g(this._output.align||[0,0])),this._alignGetter||this.alignFrom(this._legacyStates.align),this._legacyStates.align.set(a,b,c),this):this.alignFrom(a)},d.prototype.setSize=function(a,b,c){return a&&(b||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new g(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(a,b,c),this):this.sizeFrom(a)},d.prototype.setProportions=function(a,b,c){return a&&(b||this._legacyStates.proportions)?(this._legacyStates.proportions||(this._legacyStates.proportions=new g(this._output.proportions||[0,0])),this._proportionGetter||this.proportionsFrom(this._legacyStates.proportions),this._legacyStates.proportions.set(a,b,c),this):this.proportionsFrom(a)},d.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.align&&this._legacyStates.align.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._legacyStates.proportions&&this._legacyStates.proportions.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._alignGetter=null,this._sizeGetter=null,this._proportionGetter=null},d.prototype.getTransform=function(){return this._transformGetter()},d.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},d.prototype.getOpacity=function(){return this._opacityGetter()},d.prototype.getOrigin=function(){return this._originGetter()},d.prototype.getAlign=function(){return this._alignGetter()},d.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},d.prototype.getProportions=function(){return this._proportionGetter?this._proportionGetter():this._output.proportions},d.prototype.modify=function(a){return e.call(this),this._output.target=a,this._output},c.exports=d}),define(function(a,b,c){function d(a){this._value=a,this.eventOutput=null}function e(){this.eventOutput=new f,this.eventOutput.bindThis(this),f.setOutputHandler(this,this.eventOutput)}var f=a("./EventHandler");d.patch=function(a){for(var b=new d(a),c=1;c<arguments.length;c++)b.patch(arguments[c]);return a},d.prototype.patch=function(){for(var a=this._value,b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)d in a&&c[d]&&c[d].constructor===Object&&a[d]&&a[d].constructor===Object?(a.hasOwnProperty(d)||(a[d]=Object.create(a[d])),this.key(d).patch(c[d]),this.eventOutput&&this.eventOutput.emit("change",{id:d,value:this.key(d).value()})):this.set(d,c[d])}return this},d.prototype.setOptions=d.prototype.patch,d.prototype.key=function(a){var b=new d(this._value[a]);return(!(b._value instanceof Object)||b._value instanceof Array)&&(b._value={}),b},d.prototype.get=function(a){return a?this._value[a]:this._value},d.prototype.getOptions=d.prototype.get,d.prototype.set=function(a,b){var c=this.get(a);return this._value[a]=b,this.eventOutput&&b!==c&&this.eventOutput.emit("change",{id:a,value:b}),this},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define(function(a,b,c){function d(a){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,a&&this.set(a)}function e(a,b,c){for(var d=g.parse(a,b),h=Object.keys(d),i=0;i<h.length;i++){var j=h[i],k=f.get(j),l=d[j];l.allocator=b.allocator;var m=k.commit(l);m?e(m,b,c):c[j]=l}}var f=a("./Entity"),g=a("./SpecParser");d.prototype.add=function(a){var b=a instanceof d?a:new d(a);return this._child instanceof Array?this._child.push(b):this._child?(this._child=[this._child,b],this._hasMultipleChildren=!0,this._childResult=[]):this._child=b,b},d.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},d.prototype.set=function(a){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=a.render?!0:!1,this._isModifier=a.modify?!0:!1,this._object=a,this._child=null,a instanceof d?a:this},d.prototype.getSize=function(){var a=null,b=this.get();return b&&b.getSize&&(a=b.getSize()),!a&&this._child&&this._child.getSize&&(a=this._child.getSize()),a},d.prototype.commit=function(a){for(var b=Object.keys(this._prevResults),c=0;c<b.length;c++){var d=b[c];if(void 0===this._resultCache[d]){var g=f.get(d);g.cleanup&&g.cleanup(a.allocator)}}this._prevResults=this._resultCache,this._resultCache={},e(this.render(),a,this._resultCache)},d.prototype.render=function(){if(this._isRenderable)return this._object.render();var a=null;if(this._hasMultipleChildren){a=this._childResult;for(var b=this._child,c=0;c<b.length;c++)a[c]=b[c].render()}else this._child&&(a=this._child.render());return this._isModifier?this._object.modify(a):a},c.exports=d}),define(function(a,b,c){function d(a){this.id=null,this._objects=null,this.node=new k,this._definition=null,a&&this.load(a)}function e(a){for(var b in l)if(b in a){var c=a[b];return c instanceof Array||(c=[c]),l[b].apply(this,c)}}function f(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.align,g=a.size,h=i.identity;if(b instanceof Array)if(16===b.length&&"number"==typeof b[0])h=b;else for(var k=0;k<b.length;k++)h=i.multiply(h,e(b[k]));else b instanceof Function?h=b:b instanceof Object&&(h=e(b));var l=new j({transform:h,opacity:c,origin:d,align:f,size:g});return l}function g(a){for(var b=new k,c=0;c<a.length;c++){var d=h.call(this,a[c]);d&&b.add(d)}return b}function h(a){var b,c;if(a instanceof Array)b=g.call(this,a);else if(c=this._objects.length,a.render&&a.render instanceof Function)b=a;else if(a.target){var d=h.call(this,a.target),e=f.call(this,a);b=new k(e),b.add(d),a.id&&(this.id[a.id]=e)}else a.id&&(b=new k,this.id[a.id]=b);return this._objects[c]=b,b}var i=a("./Transform"),j=a("./Modifier"),k=a("./RenderNode"),l={translate:i.translate,rotate:i.rotate,rotateX:i.rotateX,rotateY:i.rotateY,rotateZ:i.rotateZ,rotateAxis:i.rotateAxis,scale:i.scale,skew:i.skew,matrix3d:function(){return arguments}};d.prototype.create=function(){return new d(this._definition)},d.prototype.load=function(a){this._definition=a,this.id={},this._objects=[],this.node.set(h.call(this,a))},d.prototype.add=function(){return this.node.add.apply(this.node,arguments)},d.prototype.render=function(){return this.node.render.apply(this.node,arguments)},c.exports=d}),define(function(a,b,c){function d(){this.result={}}function e(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8],a[0]*b[1]+a[1]*b[5]+a[2]*b[9],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]]}var f=a("./Transform");d._instance=new d,d.parse=function(a,b){return d._instance.parse(a,b)},d.prototype.parse=function(a,b){return this.reset(),this._parseSpec(a,b,f.identity),this.result},d.prototype.reset=function(){this.result={}};var g=[0,0];d.prototype._parseSpec=function(a,b,c){var d,h,i,j,k,l,m;if("number"==typeof a){if(d=a,i=b.transform,l=b.align||g,b.size&&l&&(l[0]||l[1])){var n=[l[0]*b.size[0],l[1]*b.size[1],0];i=f.thenMove(i,e(n,c))}this.result[d]={transform:i,opacity:b.opacity,origin:b.origin||g,align:b.align||g,size:b.size}}else{if(!a)return;if(a instanceof Array)for(var o=0;o<a.length;o++)this._parseSpec(a[o],b,c);else{h=a.target,i=b.transform,j=b.opacity,k=b.origin,l=b.align,m=b.size;var p=c;if(void 0!==a.opacity&&(j=b.opacity*a.opacity),a.transform&&(i=f.multiply(b.transform,a.transform)),a.origin&&(k=a.origin,p=b.transform),a.align&&(l=a.align),a.size||a.proportions){var q=m;m=[m[0],m[1]],a.size&&(void 0!==a.size[0]&&(m[0]=a.size[0]),void 0!==a.size[1]&&(m[1]=a.size[1])),a.proportions&&(void 0!==a.proportions[0]&&(m[0]=m[0]*a.proportions[0]),void 0!==a.proportions[1]&&(m[1]=m[1]*a.proportions[1])),q&&(l&&(l[0]||l[1])&&(i=f.thenMove(i,e([l[0]*q[0],l[1]*q[1],0],c))),k&&(k[0]||k[1])&&(i=f.moveThen([-k[0]*m[0],-k[1]*m[1],0],i))),p=b.transform,k=null,l=null}this._parseSpec(h,{transform:i,opacity:j,origin:k,align:l,size:m},p)}}},c.exports=d}),define(function(a,b,c){function d(a){k.call(this),this.options={},this.properties={},this.attributes={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._trueSizeCheck=!0,this._dirtyClasses=[],a&&this.setOptions(a),this._currentTarget=null}function e(a){for(var b=0;b<this._dirtyClasses.length;b++)a.classList.remove(this._dirtyClasses[b]);this._dirtyClasses=[]}function f(a){for(var b in this.properties)a.style[b]=this.properties[b]}function g(a){for(var b in this.properties)a.style[b]=""}function h(a){for(var b in this.attributes)a.setAttribute(b,this.attributes[b])}function i(a){for(var b in this.attributes)a.removeAttribute(b)}function j(a,b){return a&&b?a[0]!==b[0]||a[1]!==b[1]:a!==b}var k=a("./ElementOutput");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.setAttributes=function(a){for(var b in a){if("style"===b)throw new Error('Cannot set styles via "setAttributes" as it will break Famo.us.  Use "setProperties" instead.');this.attributes[b]=a[b]}this._attributesDirty=!0},d.prototype.getAttributes=function(){return this.attributes},d.prototype.setProperties=function(a){for(var b in a)this.properties[b]=a[b];return this._stylesDirty=!0,this},d.prototype.getProperties=function(){return this.properties},d.prototype.addClass=function(a){return this.classList.indexOf(a)<0&&(this.classList.push(a),this._classesDirty=!0),this},d.prototype.removeClass=function(a){var b=this.classList.indexOf(a);return b>=0&&(this._dirtyClasses.push(this.classList.splice(b,1)[0]),this._classesDirty=!0),this},d.prototype.toggleClass=function(a){var b=this.classList.indexOf(a);return b>=0?this.removeClass(a):this.addClass(a),this},d.prototype.setClasses=function(a){var b=0,c=[];for(b=0;b<this.classList.length;b++)a.indexOf(this.classList[b])<0&&c.push(this.classList[b]);for(b=0;b<c.length;b++)this.removeClass(c[b]);for(b=0;b<a.length;b++)this.addClass(a[b]);return this},d.prototype.getClassList=function(){return this.classList},d.prototype.setContent=function(a){return this.content!==a&&(this.content=a,this._contentDirty=!0),this},d.prototype.getContent=function(){return this.content},d.prototype.setOptions=function(a){return a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.attributes&&this.setAttributes(a.attributes),a.content&&this.setContent(a.content),this},d.prototype.setup=function(a){var b=a.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var c=0;c<this.elementClass.length;c++)b.classList.add(this.elementClass[c]);else b.classList.add(this.elementClass);b.style.display="",this.attach(b),this._opacity=null,this._currentTarget=b,this._stylesDirty=!0,this._classesDirty=!0,this._attributesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._originDirty=!0,this._transformDirty=!0},d.prototype.commit=function(a){this._currentTarget||this.setup(a.allocator);var b=this._currentTarget,c=a.size;if(this._classesDirty){e.call(this,b);for(var d=this.getClassList(),g=0;g<d.length;g++)b.classList.add(d[g]);this._classesDirty=!1,this._trueSizeCheck=!0}if(this._stylesDirty&&(f.call(this,b),this._stylesDirty=!1,this._trueSizeCheck=!0),this._attributesDirty&&(h.call(this,b),this._attributesDirty=!1,this._trueSizeCheck=!0),this.size){var i=a.size;if(c=[this.size[0],this.size[1]],void 0===c[0]&&(c[0]=i[0]),void 0===c[1]&&(c[1]=i[1]),c[0]===!0||c[1]===!0){if(c[0]===!0)if(this._trueSizeCheck||0===this._size[0]){var l=b.offsetWidth;this._size&&this._size[0]!==l&&(this._size[0]=l,this._sizeDirty=!0),c[0]=l}else this._size&&(c[0]=this._size[0]);if(c[1]===!0)if(this._trueSizeCheck||0===this._size[1]){var m=b.offsetHeight;this._size&&this._size[1]!==m&&(this._size[1]=m,this._sizeDirty=!0),c[1]=m}else this._size&&(c[1]=this._size[1]);this._trueSizeCheck=!1}}j(this._size,c)&&(this._size||(this._size=[0,0]),this._size[0]=c[0],this._size[1]=c[1],this._sizeDirty=!0),this._sizeDirty&&(this._size&&(b.style.width=this.size&&this.size[0]===!0?"":this._size[0]+"px",b.style.height=this.size&&this.size[1]===!0?"":this._size[1]+"px"),this._eventOutput.emit("resize")),this._contentDirty&&(this.deploy(b),this._eventOutput.emit("deploy"),this._contentDirty=!1,this._trueSizeCheck=!0),k.prototype.commit.call(this,a)},d.prototype.cleanup=function(a){var b=0,c=this._currentTarget;this._eventOutput.emit("recall"),this.recall(c),c.style.display="none",c.style.opacity="",c.style.width="",c.style.height="",g.call(this,c),i.call(this,c);var d=this.getClassList();for(e.call(this,c),b=0;b<d.length;b++)c.classList.remove(d[b]);if(this.elementClass)if(this.elementClass instanceof Array)for(b=0;b<this.elementClass.length;b++)c.classList.remove(this.elementClass[b]);else c.classList.remove(this.elementClass);this.detach(c),this._currentTarget=null,a.deallocate(c)},d.prototype.deploy=function(a){var b=this.getContent();if(b instanceof Node){for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(b)}else a.innerHTML=b},d.prototype.recall=function(a){for(var b=document.createDocumentFragment();a.hasChildNodes();)b.appendChild(a.firstChild);this.setContent(b)},d.prototype.getSize=function(){return this._size?this._size:this.size},d.prototype.setSize=function(a){return this.size=a?[a[0],a[1]]:null,this._sizeDirty=!0,this},c.exports=d}),define(function(a,b,c){function d(a){return 2===a.length?a[0]*a[0]+a[1]*a[1]:a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function e(a){return Math.sqrt(d(a))}function f(a){return 0>a?-1:1}var g={};g.precision=1e-6,g.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g.multiply4x4=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]},g.multiply=function(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2],a[1]*b[0]+a[5]*b[1]+a[9]*b[2],a[2]*b[0]+a[6]*b[1]+a[10]*b[2],0,a[0]*b[4]+a[4]*b[5]+a[8]*b[6],a[1]*b[4]+a[5]*b[5]+a[9]*b[6],a[2]*b[4]+a[6]*b[5]+a[10]*b[6],0,a[0]*b[8]+a[4]*b[9]+a[8]*b[10],a[1]*b[8]+a[5]*b[9]+a[9]*b[10],a[2]*b[8]+a[6]*b[9]+a[10]*b[10],0,a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14],1]
},g.thenMove=function(a,b){return b[2]||(b[2]=0),[a[0],a[1],a[2],0,a[4],a[5],a[6],0,a[8],a[9],a[10],0,a[12]+b[0],a[13]+b[1],a[14]+b[2],1]},g.moveThen=function(a,b){a[2]||(a[2]=0);var c=a[0]*b[0]+a[1]*b[4]+a[2]*b[8],d=a[0]*b[1]+a[1]*b[5]+a[2]*b[9],e=a[0]*b[2]+a[1]*b[6]+a[2]*b[10];return g.thenMove(b,[c,d,e])},g.translate=function(a,b,c){return void 0===c&&(c=0),[1,0,0,0,0,1,0,0,0,0,1,0,a,b,c,1]},g.thenScale=function(a,b){return[b[0]*a[0],b[1]*a[1],b[2]*a[2],0,b[0]*a[4],b[1]*a[5],b[2]*a[6],0,b[0]*a[8],b[1]*a[9],b[2]*a[10],0,b[0]*a[12],b[1]*a[13],b[2]*a[14],1]},g.scale=function(a,b,c){return void 0===c&&(c=1),void 0===b&&(b=a),[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]},g.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a);return[1,0,0,0,0,b,c,0,0,-c,b,0,0,0,0,1]},g.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,0,-c,0,0,1,0,0,c,0,b,0,0,0,0,1]},g.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a);return[b,c,0,0,-c,b,0,0,0,0,1,0,0,0,0,1]},g.rotate=function(a,b,c){var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b),h=Math.cos(c),i=Math.sin(c),j=[f*h,d*i+e*g*h,e*i-d*g*h,0,-f*i,d*h-e*g*i,e*h+d*g*i,0,g,-e*f,d*f,0,0,0,0,1];return j},g.rotateAxis=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=1-d,f=a[0]*a[0]*e,g=a[0]*a[1]*e,h=a[0]*a[2]*e,i=a[1]*a[1]*e,j=a[1]*a[2]*e,k=a[2]*a[2]*e,l=a[0]*c,m=a[1]*c,n=a[2]*c,o=[f+d,g+n,h-m,0,g-n,i+d,j+l,0,h+m,j-l,k+d,0,0,0,0,1];return o},g.aboutOrigin=function(a,b){var c=a[0]-(a[0]*b[0]+a[1]*b[4]+a[2]*b[8]),d=a[1]-(a[0]*b[1]+a[1]*b[5]+a[2]*b[9]),e=a[2]-(a[0]*b[2]+a[1]*b[6]+a[2]*b[10]);return g.thenMove(b,[c,d,e])},g.skew=function(a,b,c){return[1,Math.tan(b),0,0,Math.tan(c),1,0,0,0,Math.tan(a),1,0,0,0,0,1]},g.skewX=function(a){return[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1]},g.skewY=function(a){return[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},g.perspective=function(a){return[1,0,0,0,0,1,0,0,0,0,1,-1/a,0,0,0,1]},g.getTranslate=function(a){return[a[12],a[13],a[14]]},g.inverse=function(a){var b=a[5]*a[10]-a[6]*a[9],c=a[4]*a[10]-a[6]*a[8],d=a[4]*a[9]-a[5]*a[8],e=a[1]*a[10]-a[2]*a[9],f=a[0]*a[10]-a[2]*a[8],g=a[0]*a[9]-a[1]*a[8],h=a[1]*a[6]-a[2]*a[5],i=a[0]*a[6]-a[2]*a[4],j=a[0]*a[5]-a[1]*a[4],k=a[0]*b-a[1]*c+a[2]*d,l=1/k,m=[l*b,-l*e,l*h,0,-l*c,l*f,-l*i,0,l*d,-l*g,l*j,0,0,0,0,1];return m[12]=-a[12]*m[0]-a[13]*m[4]-a[14]*m[8],m[13]=-a[12]*m[1]-a[13]*m[5]-a[14]*m[9],m[14]=-a[12]*m[2]-a[13]*m[6]-a[14]*m[10],m},g.transpose=function(a){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]]},g.interpret=function(a){var b=[a[0],a[1],a[2]],c=f(b[0]),h=e(b),i=[b[0]+c*h,b[1],b[2]],j=2/d(i);if(j>=1/0)return{translate:g.getTranslate(a),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];k[0]=1-j*i[0]*i[0],k[5]=1-j*i[1]*i[1],k[10]=1-j*i[2]*i[2],k[1]=-j*i[0]*i[1],k[2]=-j*i[0]*i[2],k[6]=-j*i[1]*i[2],k[4]=k[1],k[8]=k[2],k[9]=k[6];var l=g.multiply(k,a),m=[l[5],l[6]],n=f(m[0]),o=e(m),p=[m[0]+n*o,m[1]],q=2/d(p),r=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];r[5]=1-q*p[0]*p[0],r[10]=1-q*p[1]*p[1],r[6]=-q*p[0]*p[1],r[9]=r[6];var s=g.multiply(r,k),t=g.multiply(s,a),u=g.scale(t[0]<0?-1:1,t[5]<0?-1:1,t[10]<0?-1:1);t=g.multiply(t,u),s=g.multiply(u,s);var v={};return v.translate=g.getTranslate(a),v.rotate=[Math.atan2(-s[6],s[10]),Math.asin(s[2]),Math.atan2(-s[1],s[0])],v.rotate[0]||(v.rotate[0]=0,v.rotate[2]=Math.atan2(s[4],s[5])),v.scale=[t[0],t[5],t[10]],v.skew=[Math.atan2(t[9],v.scale[2]),Math.atan2(t[8],v.scale[2]),Math.atan2(t[4],v.scale[0])],Math.abs(v.rotate[0])+Math.abs(v.rotate[2])>1.5*Math.PI&&(v.rotate[1]=Math.PI-v.rotate[1],v.rotate[1]>Math.PI&&(v.rotate[1]-=2*Math.PI),v.rotate[1]<-Math.PI&&(v.rotate[1]+=2*Math.PI),v.rotate[0]<0?v.rotate[0]+=Math.PI:v.rotate[0]-=Math.PI,v.rotate[2]<0?v.rotate[2]+=Math.PI:v.rotate[2]-=Math.PI),v},g.average=function(a,b,c){c=void 0===c?.5:c;for(var d=g.interpret(a),e=g.interpret(b),f={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},h=0;3>h;h++)f.translate[h]=(1-c)*d.translate[h]+c*e.translate[h],f.rotate[h]=(1-c)*d.rotate[h]+c*e.rotate[h],f.scale[h]=(1-c)*d.scale[h]+c*e.scale[h],f.skew[h]=(1-c)*d.skew[h]+c*e.skew[h];return g.build(f)},g.build=function(a){var b=g.scale(a.scale[0],a.scale[1],a.scale[2]),c=g.skew(a.skew[0],a.skew[1],a.skew[2]),d=g.rotate(a.rotate[0],a.rotate[1],a.rotate[2]);return g.thenMove(g.multiply(g.multiply(d,c),b),a.translate)},g.equals=function(a,b){return!g.notEquals(a,b)},g.notEquals=function(a,b){return a===b?!1:!(a&&b)||a[12]!==b[12]||a[13]!==b[13]||a[14]!==b[14]||a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[4]!==b[4]||a[5]!==b[5]||a[6]!==b[6]||a[8]!==b[8]||a[9]!==b[9]||a[10]!==b[10]},g.normalizeRotation=function(a){var b=a.slice(0);for((b[0]===.5*Math.PI||b[0]===.5*-Math.PI)&&(b[0]=-b[0],b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]>.5*Math.PI&&(b[0]=b[0]-Math.PI,b[1]=Math.PI-b[1],b[2]-=Math.PI),b[0]<.5*-Math.PI&&(b[0]=b[0]+Math.PI,b[1]=-Math.PI-b[1],b[2]-=Math.PI);b[1]<-Math.PI;)b[1]+=2*Math.PI;for(;b[1]>=Math.PI;)b[1]-=2*Math.PI;for(;b[2]<-Math.PI;)b[2]+=2*Math.PI;for(;b[2]>=Math.PI;)b[2]-=2*Math.PI;return b},g.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],g.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],c.exports=g}),define(function(a,b,c){function d(a){this._node=new g,this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.options=h.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a)}var e=a("./EventHandler"),f=a("./OptionsManager"),g=a("./RenderNode"),h=a("../utilities/Utility");d.DEFAULT_OPTIONS={},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.setOptions=function(a){this._optionsManager.patch(a)},d.prototype.add=function(){return this._node.add.apply(this._node,arguments)},d.prototype._add=d.prototype.add,d.prototype.render=function(){return this._node.render()},d.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},c.exports=d}),define(function(a,b,c){function d(a){a||(a=[]),a instanceof Array&&(a={array:a}),this._=null,this.index=a.index||0,a.array?this._=new this.constructor.Backing(a.array):a._&&(this._=a._),this.index===this._.firstIndex&&(this._.firstNode=this),this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),void 0!==a.loop&&(this._.loop=a.loop),void 0!==a.trackSize&&(this._.trackSize=a.trackSize),this._previousNode=null,this._nextNode=null}d.Backing=function(a){this.array=a,this.firstIndex=0,this.loop=!1,this.firstNode=null,this.lastNode=null,this.cumulativeSizes=[[0,0]],this.sizeDirty=!0,this.trackSize=!1},d.Backing.prototype.getValue=function(a){var b=a-this.firstIndex;return 0>b||b>=this.array.length?null:this.array[b]},d.Backing.prototype.setValue=function(a,b){this.array[a-this.firstIndex]=b},d.Backing.prototype.getSize=function(a){return this.cumulativeSizes[a]},d.Backing.prototype.calculateSize=function(a){a=a||this.array.length;for(var b=[0,0],c=0;a>c;c++){var d=this.array[c].getSize();if(!d)return void 0;void 0!==b[0]&&(void 0===d[0]?b[0]=void 0:b[0]+=d[0]),void 0!==b[1]&&(void 0===d[1]?b[1]=void 0:b[1]+=d[1]),this.cumulativeSizes[c+1]=b.slice()}return this.sizeDirty=!1,b},d.Backing.prototype.reindex=function(a,b,c){if(this.array[0]){for(var d=0,e=this.firstIndex,f=c-b,g=this.firstNode;a-1>e;)g=g.getNext(),e++;var h=g;for(d=0;b>d;d++)g=g.getNext(),g&&(g._previousNode=h);var i=g?g.getNext():null;for(h._nextNode=null,g=h,d=0;c>d;d++)g=g.getNext();if(e+=c,g!==i&&(g._nextNode=i,i&&(i._previousNode=g)),i)for(g=i,e++;g&&e<this.array.length+this.firstIndex;)g._nextNode?g.index+=f:g.index=e,g=g.getNext(),e++;this.trackSize&&(this.sizeDirty=!0)}},d.prototype.getPrevious=function(){var a=this._.array.length;return a?this.index===this._.firstIndex?this._.loop?(this._previousNode=this._.lastNode||new this.constructor({_:this._,index:this._.firstIndex+a-1}),this._previousNode._nextNode=this):this._previousNode=null:this._previousNode||(this._previousNode=new this.constructor({_:this._,index:this.index-1}),this._previousNode._nextNode=this):this._previousNode=null,this._previousNode},d.prototype.getNext=function(){var a=this._.array.length;return a?this.index===this._.firstIndex+a-1?this._.loop?(this._nextNode=this._.firstNode||new this.constructor({_:this._,index:this._.firstIndex}),this._nextNode._previousNode=this):this._nextNode=null:this._nextNode||(this._nextNode=new this.constructor({_:this._,index:this.index+1}),this._nextNode._previousNode=this):this._nextNode=null,this._nextNode},d.prototype.indexOf=function(a){return this._.array.indexOf(a)},d.prototype.getIndex=function(){return this.index},d.prototype.toString=function(){return""+this.index},d.prototype.unshift=function(){this._.array.unshift.apply(this._.array,arguments),this._.firstIndex-=arguments.length,this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.push=function(){this._.array.push.apply(this._.array,arguments),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.splice=function(a,b){var c=Array.prototype.slice.call(arguments,2);this._.array.splice.apply(this._.array,[a-this._.firstIndex,b].concat(c)),this._.reindex(a,b,c.length)},d.prototype.swap=function(a){var b=a.get(),c=this.get();this._.setValue(this.index,b),this._.setValue(a.index,c);var d=this._previousNode,e=this._nextNode,f=this.index,g=a._previousNode,h=a._nextNode,i=a.index;this.index=i,this._previousNode=g===this?a:g,this._previousNode&&(this._previousNode._nextNode=this),this._nextNode=h===this?a:h,this._nextNode&&(this._nextNode._previousNode=this),a.index=f,a._previousNode=d===a?this:d,a._previousNode&&(a._previousNode._nextNode=a),a._nextNode=e===a?this:e,a._nextNode&&(a._nextNode._previousNode=a),this.index===this._.firstIndex?this._.firstNode=this:this.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=this),a.index===this._.firstIndex?this._.firstNode=a:a.index===this._.firstIndex+this._.array.length-1&&(this._.lastNode=a),this._.trackSize&&(this._.sizeDirty=!0)},d.prototype.get=function(){return this._.getValue(this.index)},d.prototype.getSize=function(){var a=this.get();return a?a.getSize():null},d.prototype.render=function(){this._.trackSize&&this._.sizeDirty&&this._.calculateSize();var a=this.get();return a?a.render.apply(a,arguments):null},c.exports=d}),define(function(a,b,c){function d(a,b){void 0===b&&(b="update"),this._state=a&&a.get&&a.set?a:new g(a||0),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.on(b,e.bind(this))}function e(a){var b=a.delta,c=this.get();if(b.constructor===c.constructor){var d=b instanceof Array?[c[0]+b[0],c[1]+b[1]]:c+b;this.set(d)}}var f=a("../core/EventHandler"),g=a("../transitions/Transitionable");d.prototype.get=function(){return this._state.get()},d.prototype.set=function(a){this._state.set(a)},c.exports=d}),define(function(){function a(a){window.addEventListener(a,function(a){return a.stopPropagation(),!1},!0)}var b="ontouchstart"in window;b&&(a("mousedown"),a("mousemove"),a("mouseup"),a("mouseleave"))}),define(function(){!function(){if(window.CustomEvent){var a=300,b=500,c={},d={},e=Date.now;window.addEventListener("touchstart",function(a){for(var b=e(),d=0;d<a.changedTouches.length;d++){var f=a.changedTouches[d];c[f.identifier]=b}}),window.addEventListener("touchmove",function(a){for(var b=0;b<a.changedTouches.length;b++){var d=a.changedTouches[b];delete c[d.identifier]}}),window.addEventListener("touchend",function(b){for(var f=e(),g=0;g<b.changedTouches.length;g++){var h=b.changedTouches[g],i=c[h.identifier];if(i&&a>f-i){var j=new window.CustomEvent("click",{bubbles:!0,detail:h});d[f]=b,b.target.dispatchEvent(j)}delete c[h.identifier]}}),window.addEventListener("click",function(a){var c=e();for(var f in d){var g=d[f];b>c-f?a instanceof window.MouseEvent&&a.target===g.target&&a.stopPropagation():delete d[f]}},!0)}}()}),define(function(a,b,c){function d(a,b){this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._syncs={},a&&this.addSync(a),b&&this.setOptions(b)}function e(a,b){g[a]&&(this._syncs[a]=new g[a](b),this.pipeSync(a))}var f=a("../core/EventHandler");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DIRECTION_Z=2;var g={};d.register=function(a){for(var b in a)if(g[b]){if(g[b]!==a[b])throw new Error("Conflicting sync classes for key: "+b)}else g[b]=a[b]},d.prototype.setOptions=function(a){for(var b in this._syncs)this._syncs[b].setOptions(a)},d.prototype.pipeSync=function(a){var b=this._syncs[a];this._eventInput.pipe(b),b.pipe(this._eventOutput)},d.prototype.unpipeSync=function(a){var b=this._syncs[a];this._eventInput.unpipe(b),b.unpipe(this._eventOutput)},d.prototype.addSync=function(a){if(a instanceof Array)for(var b=0;b<a.length;b++)e.call(this,a[b]);else if(a instanceof Object)for(var c in a)e.call(this,c,a[c])},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventInput=new j,this._eventOutput=new j,j.setInputHandler(this,this._eventInput),j.setOutputHandler(this,this._eventOutput),this._eventInput.on("mousedown",e.bind(this)),this._eventInput.on("mousemove",f.bind(this)),this._eventInput.on("mouseup",g.bind(this)),this.options.propogate?this._eventInput.on("mouseleave",h.bind(this)):this._eventInput.on("mouseleave",g.bind(this)),this.options.clickThreshold&&window.addEventListener("click",function(a){Math.sqrt(Math.pow(this._displacement[0],2)+Math.pow(this._displacement[1],2))>this.options.clickThreshold&&a.stopPropagation()}.bind(this),!0),this._payload={delta:null,position:null,velocity:null,clientX:0,clientY:0,offsetX:0,offsetY:0},this._positionHistory=[],this._position=null,this._down=!1,this._moved=!1,this._displacement=[0,0],this._documentActive=!1}function e(a){var b,c;this.options.preventDefault&&a.preventDefault();var d=a.clientX,e=a.clientY,f=Date.now();this._down=!0,this._move=!1,void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]),this.options.clickThreshold&&(this._displacement=[0,0]);var g=this._payload;g.delta=b,g.position=this._position,g.velocity=c,g.clientX=d,g.clientY=e,g.offsetX=a.offsetX,g.offsetY=a.offsetY,this._positionHistory.push({position:g.position.slice?g.position.slice(0):g.position,clientPosition:[d,e],timestamp:f}),this._eventOutput.emit("start",g),this._documentActive=!1}function f(a){if(0!==this._positionHistory.length){var b=i.call(this,a);this._eventOutput.emit("update",b),this._move=!0}}function g(a){if(this._down){var b=i.call(this,a);this._eventOutput.emit("end",b),this._down=!1,this._move=!1,this._positionHistory=[]}}function h(){if(this._down&&this._move&&!this._documentActive){var a=f.bind(this),b=function(c){g.call(this,c),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}.bind(this);document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),this._documentActive=!0}}function i(a){var b,c,e=this._payload,f=this.options.scale,g=a.clientX,h=a.clientY,i=Date.now(),j=this._positionHistory[this._positionHistory.length-1],k=g*f-j.clientPosition[0],n=h*f-j.clientPosition[1];this.options.rails&&(Math.abs(k)>Math.abs(n)?n=0:k=0),this.options.direction===d.DIRECTION_X?(c=k,this._position+=c):this.options.direction===d.DIRECTION_Y?(c=n,this._position+=c):(c=[k,n],this._position[0]+=k,this._position[1]+=n),this.options.clickThreshold!==!1&&(this._displacement[0]+=k,this._displacement[1]+=n),e.delta=c,e.position=this._position,e.clientX=g,e.clientY=h,e.offsetX=a.offsetX,e.offsetY=a.offsetY,this._positionHistory.length===this.options.velocitySampleLength&&this._positionHistory.shift(),this._positionHistory.push({position:e.position.slice?e.position.slice(0):e.position,clientPosition:[g,h],timestamp:i});var o=l.getTimeHistoryPosition(this._positionHistory,this.options.timeSampleDuration),p=Math.max(i-o.timestamp,m);return b=void 0!==this.options.direction?f*(this._position-o.position)/p:[f*(this._position[0]-o.position[0])/p,f*(this._position[1]-o.position[1])/p],e.velocity=b,e}var j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={clickThreshold:void 0,direction:void 0,rails:!1,scale:1,propogate:!0,velocitySampleLength:10,timeSampleDuration:400,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define(function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._displacement=0,this._previousDistance=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._previousDistance=e.calculateDistance(this.posA,this.posB),this._displacement=0,this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._dist,center:e.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=e.calculateDistance(this.posA,this.posB),c=e.calculateCenter(this.posA,this.posB),d=this.options.scale,f=d*(b-this._previousDistance),g=f/a;this._previousDistance=b,this._displacement+=f,this._eventOutput.emit("update",{delta:f,velocity:g,distance:b,displacement:this._displacement,center:c,touches:[this.touchAId,this.touchBId]})},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define(function(a,b,c){function d(a){e.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),this._angle=0,this._previousAngle=0}var e=a("./TwoFingerSync"),f=a("../core/OptionsManager");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._angle=0,this._previousAngle=e.calculateAngle(this.posA,this.posB);var b=e.calculateCenter(this.posA,this.posB);this._eventOutput.emit("start",{count:a.touches.length,angle:this._angle,center:b,touches:[this.touchAId,this.touchBId]})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=e.calculateAngle(this.posA,this.posB),d=e.calculateCenter(this.posA,this.posB),f=b*(c-this._previousAngle),g=f/a;this._angle+=f,this._eventOutput.emit("update",{delta:f,velocity:g,angle:this._angle,center:d,touches:[this.touchAId,this.touchBId]}),this._previousAngle=c},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define(function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._scaleFactor=1,this._startDist=0,this._eventInput.on("pipe",e.bind(this))}function e(){this.touchAId=void 0,this.touchBId=void 0}var f=a("./TwoFingerSync"),g=a("../core/OptionsManager");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={scale:1},d.prototype._startUpdate=function(a){this._scaleFactor=1,this._startDist=f.calculateDistance(this.posA,this.posB),this._eventOutput.emit("start",{count:a.touches.length,touches:[this.touchAId,this.touchBId],distance:this._startDist,center:f.calculateCenter(this.posA,this.posB)})},d.prototype._moveUpdate=function(a){var b=this.options.scale,c=f.calculateDistance(this.posA,this.posB),d=f.calculateCenter(this.posA,this.posB),e=(c-this._startDist)/this._startDist,g=Math.max(1+b*e,0),h=(g-this._scaleFactor)/a;this._eventOutput.emit("update",{delta:e,scale:g,velocity:h,distance:c,center:d,touches:[this.touchAId,this.touchBId]}),this._scaleFactor=g},d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._payload={delta:null,position:null,velocity:null,slip:!0},this._eventInput=new g,this._eventOutput=new g,g.setInputHandler(this,this._eventInput),g.setOutputHandler(this,this._eventOutput),this._position=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._prevVel=void 0,this._eventInput.on("mousewheel",f.bind(this)),this._eventInput.on("wheel",f.bind(this)),this._inProgress=!1,this._loopBound=!1}function e(){if(this._inProgress&&k()-this._prevTime>this.options.stallTime){this._inProgress=!1;var a=Math.abs(this._prevVel)>=this.options.minimumEndSpeed?this._prevVel:0,b=this._payload;b.position=this._position,b.velocity=a,b.slip=!0,this._eventOutput.emit("end",b)}}function f(a){this.options.preventDefault&&a.preventDefault(),this._inProgress||(this._inProgress=!0,this._position=void 0===this.options.direction?[0,0]:0,q=this._payload,q.slip=!0,q.position=this._position,q.clientX=a.clientX,q.clientY=a.clientY,q.offsetX=a.offsetX,q.offsetY=a.offsetY,this._eventOutput.emit("start",q),this._loopBound||(h.on("prerender",e.bind(this)),this._loopBound=!0));var b=k(),c=this._prevTime||b,f=void 0!==a.wheelDeltaX?a.wheelDeltaX:-a.deltaX,g=void 0!==a.wheelDeltaY?a.wheelDeltaY:-a.deltaY;1===a.deltaMode&&(f*=this.options.lineHeight,g*=this.options.lineHeight),this.options.rails&&(Math.abs(f)>Math.abs(g)?g=0:f=0);var i,l,m=Math.max(b-c,j),n=f/m,o=g/m,p=this.options.scale;this.options.direction===d.DIRECTION_X?(l=p*f,i=p*n,this._position+=l):this.options.direction===d.DIRECTION_Y?(l=p*g,i=p*o,this._position+=l):(l=[p*f,p*g],i=[p*n,p*o],this._position[0]+=l[0],this._position[1]+=l[1]);var q=this._payload;q.delta=l,q.velocity=i,q.position=this._position,q.slip=!0,this._eventOutput.emit("update",q),this._prevTime=b,this._prevVel=i}var g=a("../core/EventHandler"),h=a("../core/Engine"),i=a("../core/OptionsManager");d.DEFAULT_OPTIONS={direction:void 0,minimumEndSpeed:1/0,rails:!1,scale:1,stallTime:50,lineHeight:40,preventDefault:!0},d.DIRECTION_X=0,d.DIRECTION_Y=1;var j=8,k=Date.now;d.prototype.getOptions=function(){return this.options},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},c.exports=d}),define(function(a,b,c){c.exports={getTimeHistoryPosition:function(a,b){for(var c,d,e,f=a.length-1,g=f,h=!0,i=0;h;){if(d=a[g],0>g)return c;if(d&&c&&(e=c.timestamp-d.timestamp,i+=e,i>=b))return h=!1,d;g--,c=d}}}}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._eventOutput=new j,this._touchTracker=new i({touchLimit:this.options.touchLimit}),j.setOutputHandler(this,this._eventOutput),j.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",e.bind(this)),this._touchTracker.on("trackmove",f.bind(this)),this._touchTracker.on("trackend",h.bind(this)),this._payload={delta:null,position:null,velocity:null,clientX:void 0,clientY:void 0,count:0,touch:void 0},this._position=null}function e(a){var b,c;void 0!==this.options.direction?(this._position=0,b=0,c=0):(this._position=[0,0],b=[0,0],c=[0,0]);var d=this._payload;d.delta=c,d.position=this._position,d.velocity=b,d.clientX=a.x,d.clientY=a.y,d.count=a.count,d.touch=a.identifier,this._eventOutput.emit("start",d)}function f(a){g.call(this,a)}function g(a){var b=a.history,c=b[b.length-1],e=l.getTimeHistoryPosition(b,this.options.timeSampleDuration),f=e.timestamp,g=c.timestamp,h=c.x-e.x,i=c.y-e.y,j=c.x-f,k=c.y-f;this.options.rails&&(Math.abs(h)>Math.abs(i)?i=0:h=0,Math.abs(j)>Math.abs(k)?k=0:j=0);var n,o,p=Math.max(g-f,m),q=j/p,r=k/p,s=this.options.scale;this.options.direction===d.DIRECTION_X?(o=s*h,n=s*q,this._position+=o):this.options.direction===d.DIRECTION_Y?(o=s*i,n=s*r,this._position+=o):(o=[s*h,s*i],n=[s*q,s*r],this._position[0]+=o[0],this._position[1]+=o[1]);var t=this._payload;t.delta=o,t.velocity=n,t.position=this._position,t.clientX=a.x,t.clientY=a.y,t.count=a.count,t.touch=a.identifier,this._eventOutput.emit("update",t)}function h(a){g.call(this,a),this._payload.count=a.count,this._eventOutput.emit("end",this._payload)}var i=a("./TouchTracker"),j=a("../core/EventHandler"),k=a("../core/OptionsManager"),l=a("./SyncUtils");d.DEFAULT_OPTIONS={direction:void 0,rails:!1,touchLimit:1,velocitySampleLength:10,scale:1,timeSampleDuration:400},d.DIRECTION_X=0,d.DIRECTION_Y=1;var m=8;d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(){return this.options},c.exports=d}),define(function(a,b,c){function d(a,b,c){return{x:a.clientX,y:a.clientY,identifier:a.identifier,origin:b.origin,timestamp:k(),count:b.touches.length,history:c}}function e(a){if(!(a.touches.length>this.touchLimit)){this.isTouched=!0;for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=d(c,a,null);this.eventOutput.emit("trackstart",e),this.selective||this.touchHistory[c.identifier]||this.track(e)}}}function f(a){if(!(a.touches.length>this.touchLimit))for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackmove",f)}}}function g(a){if(this.isTouched){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b],e=this.touchHistory[c.identifier];if(e){var f=d(c,a,e);this.touchHistory[c.identifier].push(f),this.eventOutput.emit("trackend",f),delete this.touchHistory[c.identifier]}}this.isTouched=!1}}function h(){for(var a in this.touchHistory){var b=this.touchHistory[a];this.eventOutput.emit("trackend",{touch:b[b.length-1].touch,timestamp:Date.now(),count:0,history:b}),delete this.touchHistory[a]}}function i(a){this.selective=a.selective,this.touchLimit=a.touchLimit||1,this.touchHistory={},this.eventInput=new j,this.eventOutput=new j,j.setInputHandler(this,this.eventInput),j.setOutputHandler(this,this.eventOutput),this.eventInput.on("touchstart",e.bind(this)),this.eventInput.on("touchmove",f.bind(this)),this.eventInput.on("touchend",g.bind(this)),this.eventInput.on("touchcancel",g.bind(this)),this.eventInput.on("unpipe",h.bind(this)),this.isTouched=!1}var j=a("../core/EventHandler"),k=Date.now;i.prototype.track=function(a){this.touchHistory[a.identifier]=[a]},c.exports=i}),define(function(a,b,c){function d(){this._eventInput=new e,this._eventOutput=new e,e.setInputHandler(this,this._eventInput),e.setOutputHandler(this,this._eventOutput),this.touchAEnabled=!1,this.touchAId=0,this.posA=null,this.timestampA=0,this.touchBEnabled=!1,this.touchBId=0,this.posB=null,this.timestampB=0,this._eventInput.on("touchstart",this.handleStart.bind(this)),this._eventInput.on("touchmove",this.handleMove.bind(this)),this._eventInput.on("touchend",this.handleEnd.bind(this)),this._eventInput.on("touchcancel",this.handleEnd.bind(this))}var e=a("../core/EventHandler");d.calculateAngle=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.atan2(d,c)},d.calculateDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},d.calculateCenter=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};var f=Date.now;d.prototype.handleStart=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];this.touchAEnabled?this.touchBEnabled||(this.touchBId=c.identifier,this.touchBEnabled=!0,this.posB=[c.pageX,c.pageY],this.timestampB=f(),this._startUpdate(a)):(this.touchAId=c.identifier,this.touchAEnabled=!0,this.posA=[c.pageX,c.pageY],this.timestampA=f())}},d.prototype.handleMove=function(a){if(this.touchAEnabled&&this.touchBEnabled){for(var b,c=this.timestampA,d=this.timestampB,e=0;e<a.changedTouches.length;e++){var g=a.changedTouches[e];g.identifier===this.touchAId?(this.posA=[g.pageX,g.pageY],this.timestampA=f(),b=this.timestampA-c):g.identifier===this.touchBId&&(this.posB=[g.pageX,g.pageY],this.timestampB=f(),b=this.timestampB-d)}b&&this._moveUpdate(b)}},d.prototype.handleEnd=function(a){for(var b=0;b<a.changedTouches.length;b++){var c=a.changedTouches[b];(c.identifier===this.touchAId||c.identifier===this.touchBId)&&(this.touchAEnabled&&this.touchBEnabled&&this._eventOutput.emit("end",{touches:[this.touchAId,this.touchBId],angle:this._angle}),this.touchAEnabled=!1,this.touchAId=0,this.touchBEnabled=!1,this.touchBId=0)}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._positionState=new k([0,0]),this._differential=[0,0],this._active=!0,this.sync=new n(["mouse","touch"],{scale:this.options.scale}),this.eventOutput=new l,l.setInputHandler(this,this.sync),l.setOutputHandler(this,this.eventOutput),i.call(this)}function e(a){var b=this.options,c=b.projection,d=b.snapX,e=b.snapY,f=c&q.x?a[0]:0,g=c&q.y?a[1]:0;return d>0&&(f-=f%d),e>0&&(g-=g%e),[f,g]}function f(){this._active&&(this._positionState.isActive()&&this._positionState.halt(),this.eventOutput.emit("start",{position:this.getPosition()}))}function g(a){if(this._active){var b=this.options;this._differential=a.position;var c=e.call(this,this._differential);this._differential[0]-=c[0],this._differential[1]-=c[1];var d=this.getPosition();if(d[0]+=c[0],d[1]+=c[1],b.xRange){var f=[b.xRange[0]+.5*b.snapX,b.xRange[1]-.5*b.snapX];d[0]=r(d[0],f)}if(b.yRange){var g=[b.yRange[0]+.5*b.snapY,b.yRange[1]-.5*b.snapY];d[1]=r(d[1],g)}this.eventOutput.emit("update",{position:d})}}function h(){this._active&&this.eventOutput.emit("end",{position:this.getPosition()})}function i(){this.sync.on("start",f.bind(this)),this.sync.on("update",g.bind(this)),this.sync.on("end",h.bind(this))}var j=a("../core/Transform"),k=a("../transitions/Transitionable"),l=a("../core/EventHandler"),m=a("../math/Utilities"),n=a("../inputs/GenericSync"),o=a("../inputs/MouseSync"),p=a("../inputs/TouchSync");n.register({mouse:o,touch:p});var q={x:1,y:2};d.DIRECTION_X=q.x,d.DIRECTION_Y=q.y;var r=m.clamp;d.DEFAULT_OPTIONS={projection:q.x|q.y,scale:1,xRange:null,yRange:null,snapX:0,snapY:0,transition:{duration:0}},d.prototype.setOptions=function(a){var b=this.options;if(void 0!==a.projection){var c=a.projection;this.options.projection=0,["x","y"].forEach(function(a){-1!==c.indexOf(a)&&(b.projection|=q[a])})}void 0!==a.scale&&(b.scale=a.scale,this.sync.setOptions({scale:a.scale})),void 0!==a.xRange&&(b.xRange=a.xRange),void 0!==a.yRange&&(b.yRange=a.yRange),void 0!==a.snapX&&(b.snapX=a.snapX),void 0!==a.snapY&&(b.snapY=a.snapY)},d.prototype.getPosition=function(){return this._positionState.get()},d.prototype.setRelativePosition=function(a,b,c){var d=this.getPosition(),e=[d[0]+a[0],d[1]+a[1]];this.setPosition(e,b,c)},d.prototype.setPosition=function(a,b,c){this._positionState.isActive()&&this._positionState.halt(),this._positionState.set(a,b,c)},d.prototype.activate=function(){this._active=!0},d.prototype.deactivate=function(){this._active=!1},d.prototype.toggle=function(){this._active=!this._active},d.prototype.modify=function(a){var b=this.getPosition();return{transform:j.translate(b[0],b[1]),target:a}},c.exports=d}),define(function(a,b,c){function d(a,b){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new f(this.options),a&&this.setOptions(a),b||(b=0),this.transitionHelper=new e(b)}var e=a("../transitions/Transitionable"),f=a("../core/OptionsManager");d.DEFAULT_OPTIONS={cull:!1,transition:!0,pulseInTransition:!0,pulseOutTransition:!0},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b){a=a||this.options.transition,this.set(1,a,b)},d.prototype.hide=function(a,b){a=a||this.options.transition,this.set(0,a,b)},d.prototype.set=function(a,b,c){this.halt(),this.transitionHelper.set(a,b,c)},d.prototype.halt=function(){this.transitionHelper.halt()},d.prototype.isVisible=function(){return this.transitionHelper.get()>0},d.prototype.modify=function(a){var b=this.transitionHelper.get();
return this.options.cull&&!b?void 0:{opacity:b,target:a}},c.exports=d}),define(function(a,b,c){function d(){this._chain=[],arguments.length&&this.addModifier.apply(this,arguments)}d.prototype.addModifier=function(){Array.prototype.push.apply(this._chain,arguments)},d.prototype.removeModifier=function(a){var b=this._chain.indexOf(a);0>b||this._chain.splice(b,1)},d.prototype.modify=function(a){for(var b=this._chain,c=a,d=0;d<b.length;d++)c=b[d].modify(c);return c},c.exports=d}),define(function(a,b,c){function d(a){this._transformState=new h(f.identity),this._opacityState=new g(1),this._originState=new g([0,0]),this._alignState=new g([0,0]),this._sizeState=new g([0,0]),this._proportionsState=new g([0,0]),this._modifier=new e({transform:this._transformState,opacity:this._opacityState,origin:null,align:null,size:null,proportions:null}),this._hasOrigin=!1,this._hasAlign=!1,this._hasSize=!1,this._hasProportions=!1,a&&(a.transform&&this.setTransform(a.transform),void 0!==a.opacity&&this.setOpacity(a.opacity),a.origin&&this.setOrigin(a.origin),a.align&&this.setAlign(a.align),a.size&&this.setSize(a.size),a.proportions&&this.setProportions(a.proportions))}var e=a("../core/Modifier"),f=a("../core/Transform"),g=a("../transitions/Transitionable"),h=a("../transitions/TransitionableTransform");d.prototype.setTransform=function(a,b,c){return this._transformState.set(a,b,c),this},d.prototype.setOpacity=function(a,b,c){return this._opacityState.set(a,b,c),this},d.prototype.setOrigin=function(a,b,c){return null===a?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(a,b,c),this)},d.prototype.setAlign=function(a,b,c){return null===a?(this._hasAlign&&(this._modifier.alignFrom(null),this._hasAlign=!1),this):(this._hasAlign||(this._hasAlign=!0,this._modifier.alignFrom(this._alignState)),this._alignState.set(a,b,c),this)},d.prototype.setSize=function(a,b,c){return null===a?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(a,b,c),this)},d.prototype.setProportions=function(a,b,c){return null===a?(this._hasProportions&&(this._modifier.proportionsFrom(null),this._hasProportions=!1),this):(this._hasProportions||(this._hasProportions=!0,this._modifier.proportionsFrom(this._proportionsState)),this._proportionsState.set(a,b,c),this)},d.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._alignState.halt(),this._sizeState.halt(),this._proportionsState.halt()},d.prototype.getTransform=function(){return this._transformState.get()},d.prototype.getFinalTransform=function(){return this._transformState.getFinal()},d.prototype.getOpacity=function(){return this._opacityState.get()},d.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},d.prototype.getAlign=function(){return this._hasAlign?this._alignState.get():null},d.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},d.prototype.getProportions=function(){return this._hasProportions?this._proportionsState.get():null},d.prototype.modify=function(a){return this._modifier.modify(a)},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._particles=[],this._bodies=[],this._agentData={},this._forces=[],this._constraints=[],this._buffer=0,this._prevTime=w(),this._isSleeping=!1,this._eventHandler=null,this._currAgentId=0,this._hasBodies=!1,this._eventHandler=null}function e(a){return a.applyForce?this._forces:a.applyConstraint?this._constraints:void 0}function f(a,b,c){return void 0===b&&(b=this.getParticlesAndBodies()),b instanceof Array||(b=[b]),a.on("change",this.wake.bind(this)),this._agentData[this._currAgentId]={agent:a,id:this._currAgentId,targets:b,source:c},e.call(this,a).push(this._currAgentId),this._currAgentId++}function g(a){return this._agentData[a]}function h(a){var b=g.call(this,this._forces[a]);b.agent.applyForce(b.targets,b.source)}function i(){for(var a=this._forces.length-1;a>-1;a--)h.call(this,a)}function j(a,b){var c=this._agentData[this._constraints[a]];return c.agent.applyConstraint(c.targets,c.source,b)}function k(a){for(var b=0;b<this.options.constraintSteps;){for(var c=this._constraints.length-1;c>-1;c--)j.call(this,c,a);b++}}function l(a,b){a.integrateVelocity(b),this.options.velocityCap&&a.velocity.cap(this.options.velocityCap).put(a.velocity)}function m(a,b){a.integrateAngularMomentum(b),a.updateAngularVelocity(),this.options.angularVelocityCap&&a.angularVelocity.cap(this.options.angularVelocityCap).put(a.angularVelocity)}function n(a,b){a.integrateOrientation(b)}function o(a,b){a.integratePosition(b),a.emit(x.update,a)}function p(a){i.call(this,a),this.forEach(l,a),this.forEachBody(m,a),k.call(this,a),this.forEachBody(n,a),this.forEach(o,a)}function q(){var a=0,b=0;return this.forEach(function(c){b=c.getEnergy(),a+=b}),a}function r(){var a=0;for(var b in this._agentData)a+=this.getAgentEnergy(b);return a}var s=a("../core/EventHandler"),t=17,u=1e3/120,v=17,w=Date.now,x={start:"start",update:"update",end:"end"};d.DEFAULT_OPTIONS={constraintSteps:1,sleepTolerance:1e-7,velocityCap:void 0,angularVelocityCap:void 0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]&&(this.options[b]=a[b])},d.prototype.addBody=function(a){return a._engine=this,a.isBody?(this._bodies.push(a),this._hasBodies=!0):this._particles.push(a),a.on("start",this.wake.bind(this)),a},d.prototype.removeBody=function(a){var b=a.isBody?this._bodies:this._particles,c=b.indexOf(a);if(c>-1){for(var d in this._agentData)this._agentData.hasOwnProperty(d)&&this.detachFrom(this._agentData[d].id,a);b.splice(c,1)}0===this.getBodies().length&&(this._hasBodies=!1)},d.prototype.attach=function(a,b,c){if(this.wake(),a instanceof Array){for(var d=[],e=0;e<a.length;e++)d[e]=f.call(this,a[e],b,c);return d}return f.call(this,a,b,c)},d.prototype.attachTo=function(a,b){g.call(this,a).targets.push(b)},d.prototype.detach=function(a){var b=this.getAgent(a),c=e.call(this,b),d=c.indexOf(a);c.splice(d,1),delete this._agentData[a]},d.prototype.detachFrom=function(a,b){var c=g.call(this,a);if(c.source===b)this.detach(a);else{var d=c.targets,e=d.indexOf(b);e>-1&&d.splice(e,1)}},d.prototype.detachAll=function(){this._agentData={},this._forces=[],this._constraints=[],this._currAgentId=0},d.prototype.getAgent=function(a){return g.call(this,a).agent},d.prototype.getParticles=function(){return this._particles},d.prototype.getBodies=function(){return this._bodies},d.prototype.getParticlesAndBodies=function(){return this.getParticles().concat(this.getBodies())},d.prototype.forEachParticle=function(a,b){for(var c=this.getParticles(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEachBody=function(a,b){if(this._hasBodies)for(var c=this.getBodies(),d=0,e=c.length;e>d;d++)a.call(this,c[d],b)},d.prototype.forEach=function(a,b){this.forEachParticle(a,b),this.forEachBody(a,b)},d.prototype.getAgentEnergy=function(a){var b=g.call(this,a);return b.agent.getEnergy(b.targets,b.source)},d.prototype.getEnergy=function(){return q.call(this)+r.call(this)},d.prototype.step=function(){if(!this.isSleeping()){var a=w(),b=a-this._prevTime;this._prevTime=a,u>b||(b>v&&(b=v),p.call(this,t),this.emit(x.update,this),this.getEnergy()<this.options.sleepTolerance&&this.sleep())}},d.prototype.isSleeping=function(){return this._isSleeping},d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.forEach(function(a){a.sleep()}),this.emit(x.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this._prevTime=w(),this.emit(x.start,this),this._isSleeping=!1)},d.prototype.emit=function(a,b){null!==this._eventHandler&&this._eventHandler.emit(a,b)},d.prototype.on=function(a,b){null===this._eventHandler&&(this._eventHandler=new s),this._eventHandler.on(a,b)},c.exports=d}),define(function(a,b,c){function d(a){a&&a.canvasSize&&(this._canvasSize=a.canvasSize),e.apply(this,arguments),this._canvasSize||(this._canvasSize=this.getSize()),this._backBuffer=document.createElement("canvas"),this._canvasSize&&(this._backBuffer.width=this._canvasSize[0],this._backBuffer.height=this._canvasSize[1]),this._contextId=void 0}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="canvas",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(){},d.prototype.deploy=function(a){this._canvasSize&&(a.width=this._canvasSize[0],a.height=this._canvasSize[1]),"2d"===this._contextId&&(a.getContext(this._contextId).drawImage(this._backBuffer,0,0),this._backBuffer.width=0,this._backBuffer.height=0)},d.prototype.recall=function(a){this.getSize();this._backBuffer.width=a.width,this._backBuffer.height=a.height,"2d"===this._contextId&&(this._backBuffer.getContext(this._contextId).drawImage(a,0,0),a.width=0,a.height=0)},d.prototype.getContext=function(a){return this._contextId=a,this._currentTarget?this._currentTarget.getContext(a):this._backBuffer.getContext(a)},d.prototype.setSize=function(a,b){e.prototype.setSize.apply(this,arguments),b&&(this._canvasSize=[b[0],b[1]]),this._currentTarget&&(this._currentTarget.width=this._canvasSize[0],this._currentTarget.height=this._canvasSize[1])},c.exports=d}),define(function(a,b,c){function d(a){e.call(this,a),this._container=document.createElement("div"),this._container.classList.add("famous-group"),this._container.classList.add("famous-container-group"),this._shouldRecalculateSize=!1,this.context=new f(this._container),this.setContent(this._container)}var e=a("../core/Surface"),f=a("../core/Context");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="div",d.prototype.elementClass="famous-surface",d.prototype.add=function(){return this.context.add.apply(this.context,arguments)},d.prototype.render=function(){return this._sizeDirty&&(this._shouldRecalculateSize=!0),e.prototype.render.apply(this,arguments)},d.prototype.deploy=function(){return this._shouldRecalculateSize=!0,e.prototype.deploy.apply(this,arguments)},d.prototype.commit=function(){var a=this._size?[this._size[0],this._size[1]]:null,b=e.prototype.commit.apply(this,arguments);return(this._shouldRecalculateSize||a&&(this._size[0]!==a[0]||this._size[1]!==a[1]))&&(this.context.setSize(),this._shouldRecalculateSize=!1),this.context.update(),b},c.exports=d}),define(function(a,b,c){function d(a){a&&(this._method=a.method||""),e.apply(this,arguments)}var e=a("./ContainerSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="form",d.prototype.deploy=function(a){return this._method&&(a.method=this._method),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define(function(a,b,c){function d(){this._imageUrl=void 0,e.apply(this,arguments)}var e=a("../core/Surface"),f=[],g=[],h=[],i=!0;d.enableCache=function(){i=!0},d.disableCache=function(){i=!1},d.clearCache=function(){f=[],g=[],h=[]},d.getCache=function(){return{urlCache:f,countCache:g,nodeCache:g}},d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="img",d.prototype.elementClass="famous-surface",d.prototype.setContent=function(a){var b=f.indexOf(this._imageUrl);-1!==b&&(1===g[b]?(f.splice(b,1),g.splice(b,1),h.splice(b,1)):g[b]--),b=f.indexOf(a),-1===b?(f.push(a),g.push(1)):g[b]++,this._imageUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){var b=f.indexOf(this._imageUrl);if(void 0===h[b]&&i){var c=new Image;c.src=this._imageUrl||"",h[b]=c}a.src=this._imageUrl||""},d.prototype.recall=function(a){a.src=""},c.exports=d}),define(function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._type=a.type||"text",this._name=a.name||"",e.apply(this,arguments),this.on("click",this.focus.bind(this)),window.addEventListener("click",function(a){a.target!==this._currentTarget&&this.blur()}.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="input",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.setType=function(a){return this._type=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),a.value=this._value,a.type=this._type,a.name=this._name},c.exports=d}),define(function(a,b,c){function d(a){e.apply(this,arguments),this._type="submit",a&&a.onClick&&this.setOnClick(a.onClick)}var e=a("./InputSurface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setOnClick=function(a){this.onClick=a},d.prototype.deploy=function(a){this.onclick&&(a.onClick=this.onClick),e.prototype.deploy.apply(this,arguments)},c.exports=d}),define(function(a,b,c){function d(a){this._placeholder=a.placeholder||"",this._value=a.value||"",this._name=a.name||"",this._wrap=a.wrap||"",this._cols=a.cols||"",this._rows=a.rows||"",e.apply(this,arguments),this.on("click",this.focus.bind(this))}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.elementType="textarea",d.prototype.elementClass="famous-surface",d.prototype.setPlaceholder=function(a){return this._placeholder=a,this._contentDirty=!0,this},d.prototype.focus=function(){return this._currentTarget&&this._currentTarget.focus(),this},d.prototype.blur=function(){return this._currentTarget&&this._currentTarget.blur(),this},d.prototype.setValue=function(a){return this._value=a,this._contentDirty=!0,this},d.prototype.getValue=function(){return this._currentTarget?this._currentTarget.value:this._value},d.prototype.setName=function(a){return this._name=a,this._contentDirty=!0,this},d.prototype.getName=function(){return this._name},d.prototype.setWrap=function(a){return this._wrap=a,this._contentDirty=!0,this},d.prototype.setColumns=function(a){return this._cols=a,this._contentDirty=!0,this},d.prototype.setRows=function(a){return this._rows=a,this._contentDirty=!0,this},d.prototype.deploy=function(a){""!==this._placeholder&&(a.placeholder=this._placeholder),""!==this._value&&(a.value=this._value),""!==this._name&&(a.name=this._name),""!==this._wrap&&(a.wrap=this._wrap),""!==this._cols&&(a.cols=this._cols),""!==this._rows&&(a.rows=this._rows)},c.exports=d}),define(function(a,b,c){function d(a){e.apply(this,arguments),this._videoUrl=void 0,this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a)}var e=a("../core/Surface");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={autoplay:!1},d.prototype.elementType="video",d.prototype.elementClass="famous-surface",d.prototype.setOptions=function(a){a.size&&this.setSize(a.size),a.classes&&this.setClasses(a.classes),a.properties&&this.setProperties(a.properties),a.autoplay&&(this.options.autoplay=a.autoplay),a.src&&(this._videoUrl=a.src,this._contentDirty=!0)},d.prototype.setContent=function(a){this._videoUrl=a,this._contentDirty=!0},d.prototype.deploy=function(a){a.src=this._videoUrl,a.autoplay=this.options.autoplay},d.prototype.recall=function(a){a.src=""},c.exports=d}),define(function(a,b,c){function d(a){this._map=a||null,this._cachedOutput=null,this._cachedInput=Number.NaN}d.create=function(a){var b=new d(a);return b.get.bind(b)},d.prototype.get=function(a){return a!==this._cachedInput&&(this._cachedInput=a,this._cachedOutput=this._map(a)),this._cachedOutput},c.exports=d}),define(function(a,b,c){var d={inQuad:function(a){return a*a},outQuad:function(a){return-(a-=1)*a+1},inOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},inQuart:function(a){return a*a*a*a},outQuart:function(a){return-(--a*a*a*a-1)},inOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return--a*a*a*a*a+1},inOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},outExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},inOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},inCirc:function(a){return-(Math.sqrt(1-a*a)-1)},outCirc:function(a){return Math.sqrt(1- --a*a)},inOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},inElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)))},outElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1===a?1:(c||(c=.3),b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/c)+1)},inOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2===(a/=.5)?1:(c||(c=.3*1.5),b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/c)*.5+1)},inBack:function(a,b){return void 0===b&&(b=1.70158),a*a*((b+1)*a-b)},outBack:function(a,b){return void 0===b&&(b=1.70158),--a*a*((b+1)*a+b)+1},inOutBack:function(a,b){return void 0===b&&(b=1.70158),(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},inBounce:function(a){return 1-d.outBounce(1-a)},outBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},inOutBounce:function(a){return.5>a?.5*d.inBounce(2*a):.5*d.outBounce(2*a-1)+.5}};c.exports=d}),define(function(a,b,c){function d(a){this.method=a,this._instances=[],this.state=[]}var e=a("../utilities/Utility");d.SUPPORTS_MULTIPLE=!0,d.prototype.get=function(){for(var a=0;a<this._instances.length;a++)this.state[a]=this._instances[a].get();return this.state},d.prototype.set=function(a,b,c){for(var d=e.after(a.length,c),f=0;f<a.length;f++)this._instances[f]||(this._instances[f]=new this.method),this._instances[f].set(a[f],b,d)},d.prototype.reset=function(a){for(var b=0;b<a.length;b++)this._instances[b]||(this._instances[b]=new this.method),this._instances[b].reset(a[b])},c.exports=d}),define(function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=1,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.spring=new s({anchor:this.endState}),this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(a){this.endState.set(a),f.call(this)}function h(){this.PE.wake()}function i(){this.PE.sleep()}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),k.call(this,a.velocity)}function p(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(j.call(this,this.endState),k.call(this,[0,0,0]),i.call(this))}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/constraints/Snap"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:100,dampingRatio:.2,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),g.call(this,a),b&&k.call(this,b),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return p.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,h.call(this),o.call(this,b),g.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define(function(a,b,c){function d(a){a=a||0,this.endState=new t(a),this.initState=new t,this._dimensions=void 0,this._restTolerance=1e-10,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.spring=new s({anchor:this.endState}),this.particle=new r,this.PE.addBody(this.particle),this.PE.attach(this.spring,this.particle)}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(a){this.particle.setPosition(a)}function g(a){this.particle.setVelocity(a)}function h(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function i(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function j(a){this._callback=a}function k(){this.PE.wake()}function l(){this.PE.sleep()}function m(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else e.call(this)<this._absRestTolerance&&(f.call(this,this.endState),g.call(this,[0,0,0]),l.call(this))}function n(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),a.period<150&&(a.period=150,console.warn("The period of a SpringTransition is capped at 150 ms. Use a SnapTransition for faster transitions")),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),g.call(this,a.velocity)}function o(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function p(a){this.endState.set(a),o.call(this)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),f.call(this,a),p.call(this,a),b&&g.call(this,b),j.call(this,void 0)},d.prototype.getVelocity=function(){return i.call(this)},d.prototype.setVelocity=function(a){this.call(this,g(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return m.call(this),h.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,k.call(this),n.call(this,b),p.call(this,a),void j.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define(function(a,b,c){function d(a){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(a)}function e(){if(this._callback){var a=this._callback;this._callback=void 0,a()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var b=null,c=this.currentAction[0],d=this.currentAction[1];d instanceof Object&&d.method?(b=d.method,"string"==typeof b&&(b=h[b])):b=g,this._currentMethod!==b&&(this._engineInstance=!(c instanceof Object)||b.SUPPORTS_MULTIPLE===!0||c.length<=b.SUPPORTS_MULTIPLE?new b:new f(b),this._currentMethod=b),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(d.velocity=this.velocity),this._engineInstance.set(c,d,e.bind(this))}var f=a("./MultipleTransition"),g=a("./TweenTransition"),h={};d.register=function(a){var b=!0;for(var c in a)d.registerMethod(c,a[c])||(b=!1);return b},d.registerMethod=function(a,b){return a in h?!1:(h[a]=b,!0)},d.unregisterMethod=function(a){return a in h?(delete h[a],!0):!1},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),c&&c(),this;var d=[a,b];return this.actionQueue.push(d),this.callbackQueue.push(c),this.currentAction||e.call(this),this},d.prototype.reset=function(a,b){this._currentMethod=null,this._engineInstance=null,this._callback=void 0,this.state=a,this.velocity=b,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},d.prototype.delay=function(a,b){this.set(this.get(),{duration:a,curve:function(){return 0}},b)},d.prototype.get=function(a){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(a)),this.state},d.prototype.isActive=function(){return!!this.currentAction},d.prototype.halt=function(){return this.set(this.get())},c.exports=d}),define(function(a,b,c){function d(a){this._final=h.identity.slice(),this._finalTranslate=[0,0,0],this._finalRotate=[0,0,0],this._finalSkew=[0,0,0],this._finalScale=[1,1,1],this.translate=new g(this._finalTranslate),this.rotate=new g(this._finalRotate),this.skew=new g(this._finalSkew),this.scale=new g(this._finalScale),a&&this.set(a)}function e(){return h.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}function f(){return h.build({translate:this._finalTranslate,rotate:this._finalRotate,skew:this._finalSkew,scale:this._finalScale})}var g=a("./Transitionable"),h=a("../core/Transform"),i=a("../utilities/Utility");d.prototype.setTranslate=function(a,b,c){return this._finalTranslate=a,this._final=f.call(this),this.translate.set(a,b,c),this},d.prototype.setScale=function(a,b,c){return this._finalScale=a,this._final=f.call(this),this.scale.set(a,b,c),this},d.prototype.setRotate=function(a,b,c){return this._finalRotate=a,this._final=f.call(this),this.rotate.set(a,b,c),this},d.prototype.setSkew=function(a,b,c){return this._finalSkew=a,this._final=f.call(this),this.skew.set(a,b,c),this},d.prototype.set=function(a,b,c){var d=h.interpret(a);this._finalTranslate=d.translate,this._finalRotate=d.rotate,this._finalSkew=d.skew,this._finalScale=d.scale,this._final=a;var e=c?i.after(4,c):null;return this.translate.set(d.translate,b,e),this.rotate.set(d.rotate,b,e),this.skew.set(d.skew,b,e),this.scale.set(d.scale,b,e),this},d.prototype.setDefaultTransition=function(a){this.translate.setDefault(a),this.rotate.setDefault(a),this.skew.setDefault(a),this.scale.setDefault(a)},d.prototype.get=function(){return this.isActive()?e.call(this):this._final},d.prototype.getFinal=function(){return this._final},d.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},d.prototype.halt=function(){return this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt(),this._final=this.get(),this._finalTranslate=this.translate.get(),this._finalRotate=this.rotate.get(),this._finalSkew=this.skew.get(),this._finalScale=this.scale.get(),this},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function e(a,b,c){return(1-c)*a+c*b}function f(a){return a instanceof Object?a instanceof Array?a.slice(0):Object.create(a):a}function g(a,b){var c={curve:b.curve};return b.duration&&(c.duration=b.duration),b.speed&&(c.speed=b.speed),a instanceof Object&&(void 0!==a.duration&&(c.duration=a.duration),a.curve&&(c.curve=a.curve),a.speed&&(c.speed=a.speed)),"string"==typeof c.curve&&(c.curve=d.getCurve(c.curve)),c}function h(a,b,c,d,e){var f,g=1e-7,h=(c(e)-c(e-g))/g;if(a instanceof Array){f=[];for(var i=0;i<a.length;i++)f[i]="number"==typeof a[i]?h*(a[i]-b[i])/d:0}else f=h*(a-b)/d;return f}function i(a,b,c){var d;if(a instanceof Array){d=[];for(var f=0;f<a.length;f++)d[f]="number"==typeof a[f]?e(a[f],b[f],c):a[f]}else d=e(a,b,c);return d}d.Curves={linear:function(a){return a},easeIn:function(a){return a*a},easeOut:function(a){return a*(2-a)},easeInOut:function(a){return.5>=a?2*a*a:-2*a*a+4*a-1},easeOutBounce:function(a){return a*(3-2*a)},spring:function(a){return(1-a)*Math.sin(6*Math.PI*a)+a}},d.SUPPORTS_MULTIPLE=!0,d.DEFAULT_OPTIONS={curve:d.Curves.linear,duration:500,speed:0};var j={};d.registerCurve=function(a,b){return j[a]?!1:(j[a]=b,!0)},d.unregisterCurve=function(a){return j[a]?(delete j[a],!0):!1},d.getCurve=function(a){var b=j[a];if(void 0!==b)return b;throw new Error("curve not registered")},d.getCurves=function(){return j},d.prototype.setOptions=function(a){void 0!==a.curve&&(this.options.curve=a.curve),void 0!==a.duration&&(this.options.duration=a.duration),void 0!==a.speed&&(this.options.speed=a.speed)},d.prototype.set=function(a,b,c){if(!b)return this.reset(a),void(c&&c());if(this._startValue=f(this.get()),b=g(b,this.options),b.speed){var d=this._startValue;if(d instanceof Object){var e=0;for(var h in d)e+=(a[h]-d[h])*(a[h]-d[h]);b.duration=Math.sqrt(e)/b.speed}else b.duration=Math.abs(a-d)/b.speed}this._startTime=Date.now(),this._endValue=f(a),this._startVelocity=f(b.velocity),this._duration=b.duration,this._curve=b.curve,this._active=!0,this._callback=c},d.prototype.reset=function(a,b){if(this._callback){var c=this._callback;this._callback=void 0,c()}this.state=f(a),this.velocity=f(b),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},d.prototype.getVelocity=function(){return this.velocity},d.prototype.get=function(a){return this.update(a),this.state},d.prototype.update=function(a){if(this._active){if(a||(a=Date.now()),!(this._updateTime>=a)){this._updateTime=a;var b=a-this._startTime;if(b>=this._duration)this.state=this._endValue,this.velocity=h(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>b)this.state=this._startValue,this.velocity=this._startVelocity;else{var c=b/this._duration;this.state=i(this._startValue,this._endValue,this._curve(c)),this.velocity=h(this.state,this._startValue,this._curve,this._duration,c)}}}else if(this._callback){var d=this._callback;this._callback=void 0,d()}},d.prototype.isActive=function(){return this._active},d.prototype.halt=function(){this.reset(this.get())},d.registerCurve("linear",d.Curves.linear),d.registerCurve("easeIn",d.Curves.easeIn),d.registerCurve("easeOut",d.Curves.easeOut),d.registerCurve("easeInOut",d.Curves.easeInOut),d.registerCurve("easeOutBounce",d.Curves.easeOutBounce),d.registerCurve("spring",d.Curves.spring),d.customCurve=function(a,b){return a=a||0,b=b||0,function(c){return a*c+(-2*a-b+3)*c*c+(a+b-2)*c*c*c}},c.exports=d}),define(function(a,b,c){function d(a){a=a||0,this.endState=new u(a),this.initState=new u,this.spring=new s({anchor:this.endState}),this.wall=new t,this._restTolerance=1e-10,this._dimensions=1,this._absRestTolerance=this._restTolerance,this._callback=void 0,this.PE=new q,this.particle=new r,this.PE.addBody(this.particle),this.PE.attach([this.wall,this.spring],this.particle)
}function e(){return this.particle.getEnergy()+this.spring.getEnergy([this.particle])}function f(){var a=this.endState.sub(this.initState).normSquared();this._absRestTolerance=0===a?this._restTolerance:this._restTolerance*a}function g(){this.PE.wake()}function h(){this.PE.sleep()}function i(a){this.endState.set(a);var b=this.endState.sub(this.initState).norm();this.wall.setOptions({distance:this.endState.norm(),normal:0===b?this.particle.velocity.normalize(-1):this.endState.sub(this.initState).normalize(-1)}),f.call(this)}function j(a){this.particle.position.set(a)}function k(a){this.particle.velocity.set(a)}function l(){return 0===this._dimensions?this.particle.getPosition1D():this.particle.getPosition()}function m(){return 0===this._dimensions?this.particle.getVelocity1D():this.particle.getVelocity()}function n(a){this._callback=a}function o(){if(this.PE.isSleeping()){if(this._callback){var a=this._callback;this._callback=void 0,a()}}else{var b=e.call(this);b<this._absRestTolerance&&(h.call(this),j.call(this,this.endState),k.call(this,[0,0,0]))}}function p(a){var b=d.DEFAULT_OPTIONS;void 0===a.period&&(a.period=b.period),void 0===a.dampingRatio&&(a.dampingRatio=b.dampingRatio),void 0===a.velocity&&(a.velocity=b.velocity),void 0===a.restitution&&(a.restitution=b.restitution),void 0===a.drift&&(a.drift=t.DEFAULT_OPTIONS.drift),void 0===a.slop&&(a.slop=t.DEFAULT_OPTIONS.slop),this.spring.setOptions({period:a.period,dampingRatio:a.dampingRatio}),this.wall.setOptions({restitution:a.restitution,drift:a.drift,slop:a.slop}),k.call(this,a.velocity)}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Spring"),t=a("../physics/constraints/Wall"),u=a("../math/Vector");d.SUPPORTS_MULTIPLE=3,d.DEFAULT_OPTIONS={period:300,dampingRatio:.5,velocity:0,restitution:.5},d.prototype.reset=function(a,b){this._dimensions=a instanceof Array?a.length:0,this.initState.set(a),j.call(this,a),b&&k.call(this,b),i.call(this,a),n.call(this,void 0)},d.prototype.getVelocity=function(){return m.call(this)},d.prototype.setVelocity=function(a){this.call(this,k(a))},d.prototype.isActive=function(){return!this.PE.isSleeping()},d.prototype.halt=function(){this.set(this.get())},d.prototype.get=function(){return o.call(this),l.call(this)},d.prototype.set=function(a,b,c){return b?(this._dimensions=a instanceof Array?a.length:0,g.call(this),p.call(this,b),i.call(this,a),void n.call(this,c)):(this.reset(a),void(c&&c()))},c.exports=d}),define(function(a,b,c){function d(a){return this.values=a||[[1,0,0],[0,1,0],[0,0,1]],this}var e=a("./Vector"),f=new d,g=new e;d.prototype.get=function(){return this.values},d.prototype.set=function(a){this.values=a},d.prototype.vectorMultiply=function(a){var b=this.get(),c=a.x,d=a.y,e=a.z,f=b[0],h=b[1],i=b[2],j=f[0],k=f[1],l=f[2],m=h[0],n=h[1],o=h[2],p=i[0],q=i[1],r=i[2];return g.setXYZ(j*c+k*d+l*e,m*c+n*d+o*e,p*c+q*d+r*e)},d.prototype.multiply=function(a){for(var b=this.get(),c=[[]],d=0;3>d;d++){c[d]=[];for(var e=0;3>e;e++){for(var g=0,h=0;3>h;h++)g+=b[d][h]*a[h][e];c[d][e]=g}}return f.set(c)},d.prototype.transpose=function(){for(var a=[],b=this.get(),c=0;3>c;c++)for(var d=0;3>d;d++)a[c][d]=b[d][c];return f.set(a)},d.prototype.clone=function(){for(var a=this.get(),b=[],c=0;3>c;c++)b[c]=a[c].slice();return new d(b)},c.exports=d}),define(function(a,b,c){function d(a,b,c,d){return 1===arguments.length?this.set(a):(this.w=void 0!==a?a:1,this.x=void 0!==b?b:0,this.y=void 0!==c?c:0,this.z=void 0!==d?d:0),this}var e=a("./Matrix"),f=new d(1,0,0,0);d.prototype.add=function(a){return f.setWXYZ(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return f.setWXYZ(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.scalarDivide=function(a){return this.scalarMultiply(1/a)},d.prototype.scalarMultiply=function(a){return f.setWXYZ(this.w*a,this.x*a,this.y*a,this.z*a)},d.prototype.multiply=function(a){var b=this.x,c=this.y,d=this.z,e=this.w,g=a.x,h=a.y,i=a.z,j=a.w||0;return f.setWXYZ(e*j-b*g-c*h-d*i,b*j+g*e+h*d-c*i,c*j+h*e+b*i-g*d,d*j+i*e+g*c-b*h)};var g=new d(1,0,0,0);d.prototype.rotateVector=function(a){return g.set(this.conj()),f.set(this.multiply(a).multiply(g))},d.prototype.inverse=function(){return f.set(this.conj().scalarDivide(this.normSquared()))},d.prototype.negate=function(){return this.scalarMultiply(-1)},d.prototype.conj=function(){return f.setWXYZ(this.w,-this.x,-this.y,-this.z)},d.prototype.normalize=function(a){return a=void 0===a?1:a,this.scalarDivide(a*this.norm())},d.prototype.makeFromAngleAndAxis=function(a,b){var c=b.normalize(),d=.5*a,e=-Math.sin(d);return this.x=e*c.x,this.y=e*c.y,this.z=e*c.z,this.w=Math.cos(d),this},d.prototype.setWXYZ=function(a,b,c,d){return f.clear(),this.w=a,this.x=b,this.y=c,this.z=d,this},d.prototype.set=function(a){return a instanceof Array?(this.w=0,this.x=a[0],this.y=a[1],this.z=a[2]):(this.w=a.w,this.x=a.x,this.y=a.y,this.z=a.z),this!==f&&f.clear(),this},d.prototype.put=function(a){a.set(f)},d.prototype.clone=function(){return new d(this)},d.prototype.clear=function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},d.prototype.isEqual=function(a){return a.w===this.w&&a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.dot=function(a){return this.w*a.w+this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.getTransform=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return[1-2*c*c-2*d*d,2*b*c-2*d*e,2*b*d+2*c*e,0,2*b*c+2*d*e,1-2*b*b-2*d*d,2*c*d-2*b*e,0,2*b*d-2*c*e,2*c*d+2*b*e,1-2*b*b-2*c*c,0,0,0,0,1]};var h=new e;d.prototype.getMatrix=function(){var a=this.normalize(1),b=a.x,c=a.y,d=a.z,e=a.w;return h.set([[1-2*c*c-2*d*d,2*b*c+2*d*e,2*b*d-2*c*e],[2*b*c-2*d*e,1-2*b*b-2*d*d,2*c*d+2*b*e],[2*b*d+2*c*e,2*c*d-2*b*e,1-2*b*b-2*c*c]])};var i=1e-5;d.prototype.slerp=function(a,b){var c,d,e,g,h;return d=this.dot(a),1-d>i?(c=Math.acos(d),e=Math.sin(c),g=Math.sin((1-b)*c)/e,h=Math.sin(b*c)/e):(g=1-b,h=b),f.set(this.scalarMultiply(g/h).add(a).multiply(h))},c.exports=d}),define(function(a,b,c){function d(a,b){return a+f()*(b-a)}function e(a,b){return a+f()*(b-a+1)>>0}var f=Math.random,g={};g.integer=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var d=[],f=0;c>f;f++)d.push(e(a,b));return d}return e(a,b)},g.range=function(a,b,c){if(a=void 0!==a?a:0,b=void 0!==b?b:1,void 0!==c){for(var e=[],f=0;c>f;f++)e.push(d(a,b));return e}return d(a,b)},g.sign=function(a){return a=void 0!==a?a:.5,f()<a?1:-1},g.bool=function(a){return a=void 0!==a?a:.5,f()<a},c.exports=g}),define(function(a,b,c){var d={};d.clamp=function(a,b){return Math.max(Math.min(a,b[1]),b[0])},d.length=function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c]*a[c];return Math.sqrt(b)},c.exports=d}),define(function(a,b,c){function d(a,b,c){return 1===arguments.length&&void 0!==a?this.set(a):(this.x=a||0,this.y=b||0,this.z=c||0),this}function e(a,b,c){return this.x=a,this.y=b,this.z=c,this}function f(a){return e.call(this,a[0],a[1],a[2]||0)}function g(a){return e.call(this,a.x,a.y,a.z)}function h(a){return e.call(this,a,0,0)}var i=new d(0,0,0);d.prototype.add=function(a){return e.call(i,this.x+a.x,this.y+a.y,this.z+a.z)},d.prototype.sub=function(a){return e.call(i,this.x-a.x,this.y-a.y,this.z-a.z)},d.prototype.mult=function(a){return e.call(i,a*this.x,a*this.y,a*this.z)},d.prototype.div=function(a){return this.mult(1/a)},d.prototype.cross=function(a){var b=this.x,c=this.y,d=this.z,f=a.x,g=a.y,h=a.z;return e.call(i,d*g-c*h,b*h-d*f,c*f-b*g)},d.prototype.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},d.prototype.rotateX=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b,c*f-d*g,c*g+d*f)},d.prototype.rotateY=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,d*g+b*f,c,d*f-b*g)},d.prototype.rotateZ=function(a){var b=this.x,c=this.y,d=this.z,f=Math.cos(a),g=Math.sin(a);return e.call(i,b*f-c*g,b*g+c*f,d)},d.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},d.prototype.normSquared=function(){return this.dot(this)},d.prototype.norm=function(){return Math.sqrt(this.normSquared())},d.prototype.normalize=function(a){0===arguments.length&&(a=1);var b=this.norm();return b>1e-7?g.call(i,this.mult(a/b)):e.call(i,a,0,0)},d.prototype.clone=function(){return new d(this)},d.prototype.isZero=function(){return!(this.x||this.y||this.z)},d.prototype.set=function(a){return a instanceof Array?f.call(this,a):"number"==typeof a?h.call(this,a):g.call(this,a)},d.prototype.setXYZ=function(){return e.apply(this,arguments)},d.prototype.set1D=function(a){return h.call(this,a)},d.prototype.put=function(a){this===i?g.call(a,i):g.call(a,this)},d.prototype.clear=function(){return e.call(this,0,0,0)},d.prototype.cap=function j(j){if(1/0===j)return g.call(i,this);var a=this.norm();return a>j?g.call(i,this.mult(j/a)):g.call(i,this)},d.prototype.project=function(a){return a.mult(this.dot(a))},d.prototype.reflectAcross=function(a){return a.normalize().put(a),g(i,this.sub(this.project(a).mult(2)))},d.prototype.get=function(){return[this.x,this.y,this.z]},d.prototype.get1D=function(){return this.x},c.exports=d}),define(function(a,b,c){var d={0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:97,b:98,c:99,d:100,e:101,f:102,g:103,h:104,i:105,j:106,k:107,l:108,m:109,n:110,o:111,p:112,q:113,r:114,s:115,t:116,u:117,v:118,w:119,x:120,y:121,z:122,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ENTER:13,LEFT_ARROW:37,RIGHT_ARROW:39,UP_ARROW:38,DOWN_ARROW:40,SPACE:32,SHIFT:16,TAB:9};c.exports=d}),define(function(a,b,c){function d(a){return k.on(l,a),a}function e(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),k.removeListener(l,e))};return d(e)}function f(a,b){var c=m(),e=function(){var d=m();d-c>=b&&(a.apply(this,arguments),c=m())};return d(e)}function g(a,b){if(void 0===b)return void 0;var c=function(){b--,0>=b&&(a.apply(this,arguments),i(c))};return d(c)}function h(a,b){b=b||1;var c=b,e=function(){b--,0>=b&&(a.apply(this,arguments),b=c)};return d(e)}function i(a){k.removeListener(l,a)}function j(a,b){var c,d,f,g,h;return function(){d=this,h=arguments,f=m();var j=function(){var i=m-f;b>i?c=e(j,b-i):(c=null,g=a.apply(d,h))};return i(c),c=e(j,b),g}}var k=a("../core/Engine"),l="prerender",m=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};c.exports={setTimeout:e,setInterval:f,debounce:j,after:g,every:h,clear:i}}),define(function(a,b,c){var d={};d.Direction={X:0,Y:1,Z:2},d.after=function(a,b){var c=a;return function(){c--,0===c&&b.apply(this,arguments)}},d.loadURL=function(a,b){var c=new XMLHttpRequest;c.onreadystatechange=function(){4===this.readyState&&b&&b(this.responseText)},c.open("GET",a),c.send()},d.createDocumentFragmentFromHTML=function(a){var b=document.createElement("div");b.innerHTML=a;for(var c=document.createDocumentFragment();b.hasChildNodes();)c.appendChild(b.firstChild);return c},d.clone=function(a){var b;if("object"==typeof a){b=a instanceof Array?[]:{};for(var c in a)if("object"==typeof a[c]&&null!==a[c])if(a[c]instanceof Array){b[c]=new Array(a[c].length);for(var e=0;e<a[c].length;e++)b[c][e]=d.clone(a[c][e])}else b[c]=d.clone(a[c]);else b[c]=a[c]}else b=a;return b},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this._eventInput=new f,this._eventOutput=new f,f.setInputHandler(this,this._eventInput),f.setOutputHandler(this,this._eventOutput),this._id=e.register(this)}var e=a("../core/Entity"),f=(a("../core/Transform"),a("../core/EventHandler")),g=a("../core/OptionsManager");d.DEFAULT_OPTIONS={},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.getOptions=function(a){return this._optionsManager.getOptions(a)},d.prototype.render=function(){return this._id},d.prototype.commit=function(){},c.exports=d}),define(function(a,b,c){function d(){k.apply(this,arguments),this.state=new i(0),this._isOpen=!1,this.setOutputFunction(function(a,b,c){var d=e.call(this),f=this.options.direction===j.Direction.X?g.translate(d*b,0,.001*(d-1)*b):g.translate(0,d*b,.001*(d-1)*b),h=a.render();if(this.options.stackRotation){var i=this.options.stackRotation*c*(1-d);h={transform:g.rotateZ(i),origin:[.5,.5],target:h}}return{transform:f,size:a.getSize(),target:h}})}function e(a){return a?this._isOpen?1:0:this.state.get()}function f(a,b,c){this.state.halt(),this.state.set(a,b,c)}var g=a("../core/Transform"),h=a("../core/OptionsManager"),i=a("../transitions/Transitionable"),j=a("../utilities/Utility"),k=a("./SequentialLayout");d.prototype=Object.create(k.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=h.patch(k.DEFAULT_OPTIONS,{transition:{curve:"easeOutBounce",duration:500},stackRotation:0}),d.prototype.getSize=function(){var a=k.prototype.getSize.apply(this,arguments),b=this._items?this._items.get().getSize():[0,0];b||(b=[0,0]);var c=e.call(this),d=1-c;return[b[0]*d+a[0]*c,b[1]*d+a[1]*c]},d.prototype.isOpen=function(){return this._isOpen},d.prototype.open=function(a){this._isOpen=!0,f.call(this,1,this.options.transition,a)},d.prototype.close=function(a){this._isOpen=!1,f.call(this,0,this.options.transition,a)},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new l(this.options),a&&this.setOptions(a),this._position=new m(0),this._direction=e(this.options.side),this._orientation=f(this.options.side),this._isOpen=!1,this._cachedLength=0,this.drawer=new j,this.content=new j,this._eventInput=new n,this._eventOutput=new n,n.setInputHandler(this,this._eventInput),n.setOutputHandler(this,this._eventOutput),this._eventInput.on("update",h.bind(this)),this._eventInput.on("end",i.bind(this))}function e(a){var b=d.SIDES;return a===b.LEFT||a===b.RIGHT?o:p}function f(a){var b=d.SIDES;return a===b.LEFT||a===b.TOP?1:-1}function g(a){var b,c=this.options;if(c.drawerLength)b=c.drawerLength;else{var d=a.getSize();b=d?d[this._direction]:c.drawerLength}return this._orientation*b}function h(a){var b,c,d=this.getPosition()+a.delta;this._cachedLength=g.call(this,this.drawer),1===this._orientation?(b=0,c=this._cachedLength):(b=this._cachedLength,c=0),d>c?d=c:b>d&&(d=b),this.setPosition(d)}function i(a){var b=a.velocity,c=this._orientation*this.getPosition(),d=this.options,e=this._orientation*this._cachedLength,f=d.positionThreshold||e/2,g=d.velocityThreshold;if(d.transition instanceof Object&&(d.transition.velocity=a.velocity),0===c)return void(this._isOpen=!1);if(c===e)return void(this._isOpen=!0);var h=Math.abs(b)>g||!this._isOpen&&c>f||this._isOpen&&f>c;h?this.toggle():this.reset()}var j=a("../core/RenderNode"),k=a("../core/Transform"),l=a("../core/OptionsManager"),m=a("../transitions/Transitionable"),n=a("../core/EventHandler"),o=0,p=1;d.SIDES={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},d.DEFAULT_OPTIONS={side:d.SIDES.LEFT,drawerLength:0,velocityThreshold:0,positionThreshold:0,transition:!0},d.prototype.setOptions=function(a){this._optionsManager.setOptions(a),void 0!==a.side&&(this._direction=e(a.side),this._orientation=f(a.side))},d.prototype.open=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this._cachedLength=g.call(this,this.drawer),this.setPosition(this._cachedLength,a,b),this._isOpen||(this._isOpen=!0,this._eventOutput.emit("open"))},d.prototype.close=function(a,b){a instanceof Function&&(b=a),void 0===a&&(a=this.options.transition),this.setPosition(0,a,b),this._isOpen&&(this._isOpen=!1,this._eventOutput.emit("close"))},d.prototype.setPosition=function(a,b,c){this._position.isActive()&&this._position.halt(),this._position.set(a,b,c)},d.prototype.getPosition=function(){return this._position.get()},d.prototype.setProgress=function(a,b,c){return this._position.set(a*this._cachedLength,b,c)},d.prototype.getProgress=function(){return this._position.get()/this._cachedLength},d.prototype.toggle=function(a){this._isOpen?this.close(a):this.open(a)},d.prototype.reset=function(a){this._isOpen?this.open(a):this.close(a)},d.prototype.isOpen=function(){return this._isOpen},d.prototype.render=function(){var a=this.getPosition();(!this._isOpen&&0>a&&1===this._orientation||a>0&&-1===this._orientation)&&(a=0,this.setPosition(a));var b=this._direction===o?k.translate(a,0,0):k.translate(0,a,0);return[{transform:k.behind,target:this.drawer.render()},{transform:b,target:this.content.render()}]},c.exports=d}),define(function(a,b,c){function d(a){this._currentTarget=null,this._size=[void 0,void 0],this._controller=new j(a),this._controller.inTransformFrom(f.create(e.bind(this,1e-4))),this._controller.outTransformFrom(f.create(e.bind(this,-1e-4))),this._eventInput=new h,h.setInputHandler(this,this._eventInput),this._entityId=g.register(this),a&&this.setOptions(a)}function e(a,b){return i.translate(this._size[0]*(1-b),0,a*(1-b))}var f=a("../transitions/CachedMap"),g=a("../core/Entity"),h=a("../core/EventHandler"),i=a("../core/Transform"),j=a("./RenderController");d.prototype.show=function(a){this._currentTarget&&this._eventInput.unpipe(this._currentTarget),this._currentTarget=a,this._currentTarget&&this._currentTarget.trigger&&this._eventInput.pipe(this._currentTarget),this._controller.show.apply(this._controller,arguments)},d.prototype.setOptions=function(a){this._controller.setOptions(a)},d.prototype.render=function(){return this._entityId},d.prototype.commit=function(a){return this._size[0]=a.size[0],this._size[1]=a.size[1],{transform:a.transform,opacity:a.opacity,origin:a.origin,size:a.size,target:this._controller.render()}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new i(this.options),a&&this.setOptions(a),this.id=g.register(this),this._ratios=new k(this.options.ratios),this._nodes=[],this._size=[0,0],this._cachedDirection=null,this._cachedLengths=[],this._cachedTransforms=null,this._ratiosDirty=!1,this._eventOutput=new j,j.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var e,f,g,i,j=0,k=b,l=0;for(this._cachedLengths=[],this._cachedTransforms=[],i=0;i<a.length;i++)f=a[i],g=this._nodes[i],"number"!=typeof f?k-=g.getSize()[c]||0:l+=f;for(i=0;i<a.length;i++)g=this._nodes[i],f=a[i],b="number"==typeof f?k*f/l:g.getSize()[c],e=c===d.DIRECTION_X?h.translate(j,0,0):h.translate(0,j,0),this._cachedTransforms.push(e),this._cachedLengths.push(b),j+=b}function f(a,b){for(var c=0;c<a.length;c++)if("number"!=typeof a[c]&&this._nodes[c].getSize()[b]!==this._cachedLengths[c])return!0;return!1}var g=a("../core/Entity"),h=a("../core/Transform"),i=a("../core/OptionsManager"),j=a("../core/EventHandler"),k=a("../transitions/Transitionable");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_X,transition:!1,ratios:[]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){if(this._nodes=a,0===this._ratios.get().length){for(var b=[],c=0;c<this._nodes.length;c++)b.push(1);this.setRatios(b)}},d.prototype.setRatios=function(a,b,c){void 0===b&&(b=this.options.transition);var d=this._ratios;0===d.get().length&&(b=void 0),d.isActive()&&d.halt(),d.set(a,b,c),this._ratiosDirty=!0},d.prototype.getSize=function(){return this._size},d.prototype.commit=function(a){var b,c=a.size,d=a.transform,g=a.origin,i=a.opacity,j=this._ratios.get(),k=this.options.direction,l=c[k];(l!==this._size[k]||this._ratiosDirty||this._ratios.isActive()||k!==this._cachedDirection||f.call(this,j,k))&&(e.call(this,j,l,k),l!==this._size[k]&&(this._size[0]=c[0],this._size[1]=c[1]),k!==this._cachedDirection&&(this._cachedDirection=k),this._ratiosDirty&&(this._ratiosDirty=!1));for(var m=[],n=0;n<j.length;n++)b=[void 0,void 0],l=this._cachedLengths[n],b[k]=l,m.push({transform:this._cachedTransforms[n],size:b,target:this._nodes[n].render()});return c&&0!==g[0]&&0!==g[1]&&(d=h.moveThen([-c[0]*g[0],-c[1]*g[1],0],d)),{transform:d,size:c,opacity:i,target:m}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new g(this.options),a&&this.setOptions(a),this.angle=new f(0),this.frontNode=void 0,this.backNode=void 0,this.flipped=!1}var e=a("../core/Transform"),f=a("../transitions/Transitionable"),g=(a("../core/RenderNode"),a("../core/OptionsManager"));d.DIRECTION_X=0,d.DIRECTION_Y=1;var h=1;d.DEFAULT_OPTIONS={transition:!0,direction:d.DIRECTION_X},d.prototype.flip=function(a,b){var c=this.flipped?0:Math.PI;this.setAngle(c,a,b),this.flipped=!this.flipped},d.prototype.setAngle=function(a,b,c){void 0===b&&(b=this.options.transition),this.angle.isActive()&&this.angle.halt(),this.angle.set(a,b,c)},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.setFront=function(a){this.frontNode=a},d.prototype.setBack=function(a){this.backNode=a},d.prototype.render=function(){var a,b,c=this.angle.get();this.options.direction===d.DIRECTION_X?(a=e.rotateY(c),b=e.rotateY(c+Math.PI)):(a=e.rotateX(c),b=e.rotateX(c+Math.PI));var f=[];return this.frontNode&&f.push({transform:a,target:this.frontNode.render()}),this.backNode&&f.push({transform:e.moveThen([0,0,h],b),target:this.backNode.render()}),f},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new m(this.options),a&&this.setOptions(a),this.id=h.register(this),this._modifiers=[],this._states=[],this._contextSizeCache=[0,0],this._dimensionsCache=[0,0],this._activeCount=0,this._eventOutput=new k,k.setOutputHandler(this,this._eventOutput)}function e(a,b,c){var d=[a[0],a[1]];d[0]-=this.options.gutterSize[0]*(b-1),d[1]-=this.options.gutterSize[1]*(c-1);for(var e,h=Math.round(d[1]/c),i=Math.round(d[0]/b),j=0,k=0,l=0;c>l;l++){e=0;for(var m=0;b>m;m++)void 0===this._modifiers[k]?f.call(this,k,[i,h],[e,j,0],1):g.call(this,k,[i,h],[e,j,0],1),k++,e+=i+this.options.gutterSize[0];j+=h+this.options.gutterSize[1]}for(this._dimensionsCache=[this.options.dimensions[0],this.options.dimensions[1]],this._contextSizeCache=[a[0],a[1]],this._activeCount=c*b,l=this._activeCount;l<this._modifiers.length;l++)g.call(this,l,[Math.round(i),Math.round(h)],[0,0],0);this._eventOutput.emit("reflow")}function f(a,b,c,d){var e={transform:new o(i.translate.apply(null,c)),opacity:new n(d),size:new n(b)},f=new l({transform:e.transform,opacity:e.opacity,size:e.size});this._states[a]=e,this._modifiers[a]=f}function g(a,b,c,d){var e=this._states[a],f=e.size,g=e.opacity,h=e.transform,i=this.options.transition;h.halt(),g.halt(),f.halt(),h.setTranslate(c,i),f.set(b,i),g.set(d,i)}var h=a("../core/Entity"),i=(a("../core/RenderNode"),a("../core/Transform")),j=a("../core/ViewSequence"),k=a("../core/EventHandler"),l=a("../core/Modifier"),m=a("../core/OptionsManager"),n=a("../transitions/Transitionable"),o=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={dimensions:[1,1],transition:!1,gutterSize:[0,0]},d.prototype.render=function(){return this.id},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new j(a)),this.sequence=a},d.prototype.getSize=function(){return this._contextSizeCache},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,f=a.size,g=this.options.dimensions[0],h=this.options.dimensions[1];(f[0]!==this._contextSizeCache[0]||f[1]!==this._contextSizeCache[1]||g!==this._dimensionsCache[0]||h!==this._dimensionsCache[1])&&e.call(this,f,g,h);for(var j=this.sequence,k=[],l=0;j&&l<this._modifiers.length;){var m=j.get(),n=this._modifiers[l];l>=this._activeCount&&this._states[l].opacity.isActive()&&(this._modifiers.splice(l,1),this._states.splice(l,1)),m&&k.push(n.modify({origin:d,target:m.render()})),j=j.getNext(),l++}return f&&(b=i.moveThen([-f[0]*d[0],-f[1]*d[1],0],b)),{transform:b,opacity:c,size:f,target:k}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this.setOptions(a),this._entityId=h.register(this),this.header=new i,this.footer=new i,this.content=new i}function e(a,b){var c=a.getSize();return c?c[this.options.direction]:b}function f(a){return this.options.direction===d.DIRECTION_X?j.translate(a,0,0):j.translate(0,a,0)}function g(a,b){return this.options.direction===d.DIRECTION_X?[a,b[1]]:[b[0],a]}var h=a("../core/Entity"),i=a("../core/RenderNode"),j=a("../core/Transform"),k=a("../core/OptionsManager");d.DIRECTION_X=0,d.DIRECTION_Y=1,d.DEFAULT_OPTIONS={direction:d.DIRECTION_Y,headerSize:void 0,footerSize:void 0,defaultHeaderSize:0,defaultFooterSize:0},d.prototype.render=function(){return this._entityId},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.commit=function(a){var b=a.transform,c=a.origin,d=a.size,h=a.opacity,i=void 0!==this.options.headerSize?this.options.headerSize:e.call(this,this.header,this.options.defaultHeaderSize),k=void 0!==this.options.footerSize?this.options.footerSize:e.call(this,this.footer,this.options.defaultFooterSize),l=d[this.options.direction]-i-k;d&&(b=j.moveThen([-d[0]*c[0],-d[1]*c[1],0],b));var m=[{size:g.call(this,i,d),target:this.header.render()},{transform:f.call(this,i),size:g.call(this,l,d),target:this.content.render()},{transform:f.call(this,i+l),size:g.call(this,k,d),target:this.footer.render()}];return{transform:b,opacity:h,size:d,target:m}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new i(this.options),a&&this.setOptions(a),this._showing=!1,this.nodes=[],this.transforms=[],this.states=[]}var e=a("../core/Transform"),f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../utilities/Utility"),i=a("../core/OptionsManager"),j=a("../transitions/Transitionable"),k=a("../transitions/TransitionableTransform");d.DEFAULT_OPTIONS={inTransform:e.scale(.001,.001,.001),inOpacity:0,inOrigin:[.5,.5],inAlign:[.5,.5],outTransform:e.scale(.001,.001,.001),outOpacity:0,outOrigin:[.5,.5],outAlign:[.5,.5],showTransform:e.identity,showOpacity:1,showOrigin:[.5,.5],showAlign:[.5,.5],inTransition:!0,outTransition:!0,overlap:!1},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=void 0),this._showing){if(!this.options.overlap)return this.hide(this.show.bind(this,a,b,c));this.hide()}this._showing=!0;var d={transform:new k(this.options.inTransform),origin:new j(this.options.inOrigin),align:new j(this.options.inAlign),opacity:new j(this.options.inOpacity)},e=new f({transform:d.transform,opacity:d.opacity,origin:d.origin,align:d.align}),i=new g;i.add(e).add(a),this.nodes.push(i),this.states.push(d),this.transforms.push(e);var l=c?h.after(3,c):void 0;b||(b=this.options.inTransition),d.transform.set(this.options.showTransform,b,l),d.opacity.set(this.options.showOpacity,b,l),d.origin.set(this.options.showOrigin,b,l),d.align.set(this.options.showAlign,b,l)},d.prototype.hide=function(a,b){if(this._showing){this._showing=!1,a instanceof Function&&(b=a,a=void 0);var c=this.nodes[this.nodes.length-1],d=this.transforms[this.transforms.length-1],e=this.states[this.states.length-1],f=h.after(3,function(){this.nodes.splice(this.nodes.indexOf(c),1),this.states.splice(this.states.indexOf(e),1),this.transforms.splice(this.transforms.indexOf(d),1),b&&b.call(this)}.bind(this));a||(a=this.options.outTransition),e.transform.set(this.options.outTransform,a,f),e.opacity.set(this.options.outOpacity,a,f),e.origin.set(this.options.outOrigin,a,f),e.align.set(this.options.outAlign,a,f)}},d.prototype.render=function(){for(var a=[],b=0;b<this.nodes.length;b++)a.push(this.nodes[b].render());return a},c.exports=d}),define(function(a,b,c){function d(){j.apply(this,arguments),this._showing=-1,this._outgoingRenderables=[],this._nextRenderable=null,this._renderables=[],this._nodes=[],this._modifiers=[],this._states=[],this.inTransformMap=d.DefaultMap.transform,this.inOpacityMap=d.DefaultMap.opacity,this.inOriginMap=d.DefaultMap.origin,this.inAlignMap=d.DefaultMap.align,this.outTransformMap=d.DefaultMap.transform,this.outOpacityMap=d.DefaultMap.opacity,this.outOriginMap=d.DefaultMap.origin,this.outAlignMap=d.DefaultMap.align,this._output=[]}function e(a,b){return a(b.get())}var f=a("../core/Modifier"),g=a("../core/RenderNode"),h=a("../core/Transform"),i=a("../transitions/Transitionable"),j=a("../core/View");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={inTransition:!0,outTransition:!0,overlap:!0},d.DefaultMap={transform:function(){return h.identity},opacity:function(a){return a},origin:null,align:null},d.prototype.inTransformFrom=function(a){if(a instanceof Function)this.inTransformMap=a;else{if(!a||!a.get)throw new Error("inTransformFrom takes only function or getter object");this.inTransformMap=a.get.bind(a)}return this},d.prototype.inOpacityFrom=function(a){if(a instanceof Function)this.inOpacityMap=a;else{if(!a||!a.get)throw new Error("inOpacityFrom takes only function or getter object");this.inOpacityMap=a.get.bind(a)}return this},d.prototype.inOriginFrom=function(a){if(a instanceof Function)this.inOriginMap=a;else{if(!a||!a.get)throw new Error("inOriginFrom takes only function or getter object");this.inOriginMap=a.get.bind(a)}return this},d.prototype.inAlignFrom=function(a){if(a instanceof Function)this.inAlignMap=a;else{if(!a||!a.get)throw new Error("inAlignFrom takes only function or getter object");this.inAlignMap=a.get.bind(a)}return this},d.prototype.outTransformFrom=function(a){if(a instanceof Function)this.outTransformMap=a;else{if(!a||!a.get)throw new Error("outTransformFrom takes only function or getter object");this.outTransformMap=a.get.bind(a)}return this},d.prototype.outOpacityFrom=function(a){if(a instanceof Function)this.outOpacityMap=a;else{if(!a||!a.get)throw new Error("outOpacityFrom takes only function or getter object");this.outOpacityMap=a.get.bind(a)}return this},d.prototype.outOriginFrom=function(a){if(a instanceof Function)this.outOriginMap=a;else{if(!a||!a.get)throw new Error("outOriginFrom takes only function or getter object");this.outOriginMap=a.get.bind(a)}return this},d.prototype.outAlignFrom=function(a){if(a instanceof Function)this.outAlignMap=a;else{if(!a||!a.get)throw new Error("outAlignFrom takes only function or getter object");this.outAlignMap=a.get.bind(a)}return this},d.prototype.show=function(a,b,c){if(!a)return this.hide(c);if(b instanceof Function&&(c=b,b=null),this._showing>=0){if(!this.options.overlap)return void(this._nextRenderable?this._nextRenderable=a:(this._nextRenderable=a,this.hide(function(){this._nextRenderable===a&&this.show(this._nextRenderable,c),this._nextRenderable=null})));this.hide()}var d=null,h=this._renderables.indexOf(a);if(h>=0){this._showing=h,d=this._states[h],d.halt();var j=this._outgoingRenderables.indexOf(a);j>=0&&this._outgoingRenderables.splice(j,1)}else{d=new i(0);var k=new f({transform:this.inTransformMap?e.bind(this,this.inTransformMap,d):null,opacity:this.inOpacityMap?e.bind(this,this.inOpacityMap,d):null,origin:this.inOriginMap?e.bind(this,this.inOriginMap,d):null,align:this.inAlignMap?e.bind(this,this.inAlignMap,d):null}),l=new g;l.add(k).add(a),this._showing=this._nodes.length,this._nodes.push(l),this._modifiers.push(k),this._states.push(d),this._renderables.push(a)}b||(b=this.options.inTransition),d.set(1,b,c)},d.prototype.hide=function(a,b){if(!(this._showing<0)){var c=this._showing;this._showing=-1,a instanceof Function&&(b=a,a=void 0);var d=this._nodes[c],f=this._modifiers[c],g=this._states[c],h=this._renderables[c];
f.transformFrom(this.outTransformMap?e.bind(this,this.outTransformMap,g):null),f.opacityFrom(this.outOpacityMap?e.bind(this,this.outOpacityMap,g):null),f.originFrom(this.outOriginMap?e.bind(this,this.outOriginMap,g):null),f.alignFrom(this.outAlignMap?e.bind(this,this.outAlignMap,g):null),this._outgoingRenderables.indexOf(h)<0&&this._outgoingRenderables.push(h),a||(a=this.options.outTransition),g.halt(),g.set(0,a,function(a,c,d,e){if(this._outgoingRenderables.indexOf(e)>=0){var f=this._nodes.indexOf(a);this._nodes.splice(f,1),this._modifiers.splice(f,1),this._states.splice(f,1),this._renderables.splice(f,1),this._outgoingRenderables.splice(this._outgoingRenderables.indexOf(e),1),this._showing>=f&&this._showing--}b&&b.call(this)}.bind(this,d,f,g,h))}},d.prototype.render=function(){var a=this._output;a.length>this._nodes.length&&a.splice(this._nodes.length);for(var b=0;b<this._nodes.length;b++)a[b]=this._nodes[b].render();return a},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new h(this.options),a&&this.setOptions(a),this.container=new e(this.options.container),this.scrollview=new g(this.options.scrollview),this.container.add(this.scrollview),this._eventInput=new f,f.setInputHandler(this,this._eventInput),this._eventInput.pipe(this.scrollview),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.container.pipe(this._eventOutput),this.scrollview.pipe(this._eventOutput)}var e=a("../surfaces/ContainerSurface"),f=a("../core/EventHandler"),g=a("./Scrollview"),h=(a("../utilities/Utility"),a("../core/OptionsManager"));d.DEFAULT_OPTIONS={container:{properties:{overflow:"hidden"}},scrollview:{}},d.prototype.setOptions=function(a){return this._optionsManager.setOptions(a)},d.prototype.sequenceFrom=function(){return this.scrollview.sequenceFrom.apply(this.scrollview,arguments)},d.prototype.getSize=function(){return this.container.getSize.apply(this.container,arguments)},d.prototype.render=function(){return this.container.render()},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),this._optionsManager=new k(this.options),a&&this._optionsManager.setOptions(a),this._node=null,this._position=0,this._positionOffset=0,this._positionGetter=null,this._outputFunction=null,this._masterOutputFunction=null,this.outputFrom(),this._onEdge=0,this.group=new j,this.group.add({render:h.bind(this)}),this._entityId=i.register(this),this._size=[void 0,void 0],this._contextSize=[void 0,void 0],this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput)}function e(a){a||(a=this._contextSize);var b=this.options.direction;return void 0===a[b]?this._contextSize[b]:a[b]}function f(a,b,c){var d=a.getSize?a.getSize():this._contextSize,f=this._outputFunction(b);return c.push({transform:f,target:a.render()}),e.call(this,d)}function g(){return void 0!==this.options.clipSize?this.options.clipSize:this._contextSize[this.options.direction]>this.getCumulativeSize()[this.options.direction]?e.call(this,this.getCumulativeSize()):e.call(this,this._contextSize)}function h(){for(var a=null,b=this._position,c=[],d=-this._positionOffset,h=g.call(this),i=this._node;i&&d-b<h+this.options.margin;)d+=f.call(this,i,d,c),i=i.getNext?i.getNext():null;var j=this._node,k=e.call(this,j.getSize());if(h>d){for(;j&&h>k;)j=j.getPrevious(),j&&(k+=e.call(this,j.getSize()));for(j=this._node;j&&h>k;)j=j.getNext(),j&&(k+=e.call(this,j.getSize()))}for(!i&&h-p>d-b?1!==this._onEdge&&(this._onEdge=1,this._eventOutput.emit("onEdge",{position:d-h})):!this._node.getPrevious()&&-p>b?-1!==this._onEdge&&(this._onEdge=-1,this._eventOutput.emit("onEdge",{position:0})):0!==this._onEdge&&(this._onEdge=0,this._eventOutput.emit("offEdge")),i=this._node&&this._node.getPrevious?this._node.getPrevious():null,d=-this._positionOffset,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));i&&d-b>-(h+this.options.margin);)f.call(this,i,d,c),i=i.getPrevious?i.getPrevious():null,i&&(a=i.getSize?i.getSize():this._contextSize,d-=e.call(this,a));return c}var i=a("../core/Entity"),j=a("../core/Group"),k=a("../core/OptionsManager"),l=a("../core/Transform"),m=a("../utilities/Utility"),n=a("../core/ViewSequence"),o=a("../core/EventHandler");d.DEFAULT_OPTIONS={direction:m.Direction.Y,margin:0,clipSize:void 0,groupScroll:!1};var p=0;d.prototype.getCumulativeSize=function(a){return void 0===a&&(a=this._node._.cumulativeSizes.length-1),this._node._.getSize(a)},d.prototype.setOptions=function(a){a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.group.pipe(this._eventOutput):this.group.unpipe(this._eventOutput)),this._optionsManager.setOptions(a)},d.prototype.onEdge=function(){return this._onEdge},d.prototype.outputFrom=function(a,b){a||(a=function(a){return this.options.direction===m.Direction.X?l.translate(a,0):l.translate(0,a)}.bind(this),b||(b=a)),this._outputFunction=a,this._masterOutputFunction=b?b:function(b){return l.inverse(a(-b))}},d.prototype.positionFrom=function(a){a instanceof Function?this._positionGetter=a:a&&a.get?this._positionGetter=a.get.bind(a):(this._positionGetter=null,this._position=a),this._positionGetter&&(this._position=this._positionGetter.call(this))},d.prototype.sequenceFrom=function(a){a instanceof Array&&(a=new n({array:a})),this._node=a,this._positionOffset=0},d.prototype.getSize=function(a){return a?this._contextSize:this._size},d.prototype.render=function(){return this._node?(this._positionGetter&&(this._position=this._positionGetter.call(this)),this._entityId):null},d.prototype.commit=function(a){var b=a.transform,c=a.opacity,d=a.origin,e=a.size;this.options.clipSize||e[0]===this._contextSize[0]&&e[1]===this._contextSize[1]||(this._onEdge=0,this._contextSize[0]=e[0],this._contextSize[1]=e[1],this.options.direction===m.Direction.X?(this._size[0]=g.call(this),this._size[1]=void 0):(this._size[0]=void 0,this._size[1]=g.call(this)));var f=this._masterOutputFunction(-this._position);return{transform:l.multiply(b,f),size:e,opacity:c,origin:d,target:this.group.render()}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this._optionsManager=new v(this.options),this._scroller=new x(this.options),this.sync=new z(["scroll","touch"],{direction:this.options.direction,scale:this.options.syncScale,rails:this.options.rails,preventDefault:void 0!==this.options.preventDefault?this.options.preventDefault:this.options.direction!==y.Direction.Y}),this._physicsEngine=new q,this._particle=new r,this._physicsEngine.addBody(this._particle),this.spring=new t({anchor:[0,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),this.drag=new s({forceFunction:s.FORCE_FUNCTIONS.QUADRATIC,strength:this.options.drag}),this.friction=new s({forceFunction:s.FORCE_FUNCTIONS.LINEAR,strength:this.options.friction}),this._node=null,this._touchCount=0,this._springState=C.NONE,this._onEdge=D.NONE,this._pageSpringPosition=0,this._edgeSpringPosition=0,this._touchVelocity=0,this._earlyEnd=!1,this._needsPaginationCheck=!1,this._displacement=0,this._totalShift=0,this._cachedIndex=0,this._scroller.positionFrom(this.getPosition.bind(this)),this._eventInput=new u,this._eventOutput=new u,this._eventInput.pipe(this.sync),this.sync.pipe(this._eventInput),u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),h.call(this),a&&this.setOptions(a)}function e(a){this._touchCount=a.count,void 0===a.count&&(this._touchCount=1),j.call(this),this.setVelocity(0),this._touchVelocity=0,this._earlyEnd=!1}function f(a){var b=-a.velocity,c=-a.delta;if(this._onEdge!==D.NONE&&a.slip&&(0>b&&this._onEdge===D.TOP||b>0&&this._onEdge===D.BOTTOM?this._earlyEnd||(g.call(this,a),this._earlyEnd=!0):this._earlyEnd&&Math.abs(b)>Math.abs(this.getVelocity())&&e.call(this,a)),!this._earlyEnd){if(this._touchVelocity=b,a.slip){var d=this.options.speedLimit;-d>b?b=-d:b>d&&(b=d),this.setVelocity(b);var f=16*d;c>f?c=f:-f>c&&(c=-f)}this.setPosition(this.getPosition()+c),this._displacement+=c,this._springState===C.NONE&&o.call(this)}}function g(a){if(this._touchCount=a.count||0,!this._touchCount){j.call(this),this._onEdge!==D.NONE&&n.call(this,this._edgeSpringPosition,C.EDGE),i.call(this);var b=-a.velocity,c=this.options.speedLimit;a.slip&&(c*=this.options.edgeGrip),-c>b?b=-c:b>c&&(b=c),this.setVelocity(b),this._touchVelocity=0,this._needsPaginationCheck=!0}}function h(){this._eventInput.bindThis(this),this._eventInput.on("start",e),this._eventInput.on("update",f),this._eventInput.on("end",g),this._eventInput.on("resize",function(){this._node._.calculateSize()}.bind(this)),this._scroller.on("onEdge",function(a){this._edgeSpringPosition=a.position,l.call(this,this._scroller.onEdge()),this._eventOutput.emit("onEdge")}.bind(this)),this._scroller.on("offEdge",function(){this.sync.setOptions({scale:this.options.syncScale}),this._onEdge=this._scroller.onEdge(),this._eventOutput.emit("offEdge")}.bind(this)),this._particle.on("update",function(a){this._springState===C.NONE&&o.call(this),this._displacement=a.position.x-this._totalShift}.bind(this)),this._particle.on("end",function(){(!this.options.paginated||this.options.paginated&&this._springState!==C.NONE)&&this._eventOutput.emit("settle")}.bind(this))}function i(){this._springState?this._physicsEngine.attach([this.spring],this._particle):this._physicsEngine.attach([this.drag,this.friction],this._particle)}function j(){this._springState=C.NONE,this._physicsEngine.detachAll()}function k(a){var b=this.options.direction,c=a.getSize();return c?c[b]:this._scroller.getSize()[b]}function l(a){this.sync.setOptions({scale:this.options.edgeGrip}),this._onEdge=a,this._touchCount||this._springState===C.EDGE||n.call(this,this._edgeSpringPosition,C.EDGE),this._springState&&Math.abs(this.getVelocity())<.001&&(j.call(this),i.call(this))}function m(){if(!this._touchCount&&this._springState!==C.EDGE){var a=this.getVelocity();if(!(Math.abs(a)>=this.options.pageStopSpeed)){var b=this.getPosition(),c=Math.abs(a)>this.options.pageSwitchSpeed,d=k.call(this,this._node),e=b>.5*d,f=a>0,g=0>a;this._needsPaginationCheck=!1,e&&!c||c&&f?this.goToNextPage():c&&g?this.goToPreviousPage():n.call(this,0,C.PAGE)}}}function n(a,b){var c;b===C.EDGE?(this._edgeSpringPosition=a,c={anchor:[this._edgeSpringPosition,0,0],period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}):b===C.PAGE&&(this._pageSpringPosition=a,c={anchor:[this._pageSpringPosition,0,0],period:this.options.pagePeriod,dampingRatio:this.options.pageDamp}),this.spring.setOptions(c),b&&!this._springState&&(j.call(this),this._springState=b,i.call(this)),this._springState=b}function o(){var a=0,b=this.getPosition();b+=(0>b?-.5:.5)>>0;for(var c=k.call(this,this._node),d=this._node.getNext();a+b>=c&&d;)a-=c,this._scroller.sequenceFrom(d),this._node=d,d=this._node.getNext(),c=k.call(this,this._node);for(var e,f=this._node.getPrevious();0>=a+b&&f;)e=k.call(this,f),this._scroller.sequenceFrom(f),this._node=f,a+=e,f=this._node.getPrevious();a&&p.call(this,a),this._node&&(this._node.index!==this._cachedIndex?this.getPosition()<.5*c&&(this._cachedIndex=this._node.index,this._eventOutput.emit("pageChange",{direction:-1,index:this._cachedIndex})):this.getPosition()>.5*c&&(this._cachedIndex=this._node.index+1,this._eventOutput.emit("pageChange",{direction:1,index:this._cachedIndex})))}function p(a){this._edgeSpringPosition+=a,this._pageSpringPosition+=a,this.setPosition(this.getPosition()+a),this._totalShift+=a,this._springState===C.EDGE?this.spring.setOptions({anchor:[this._edgeSpringPosition,0,0]}):this._springState===C.PAGE&&this.spring.setOptions({anchor:[this._pageSpringPosition,0,0]})}var q=a("../physics/PhysicsEngine"),r=a("../physics/bodies/Particle"),s=a("../physics/forces/Drag"),t=a("../physics/forces/Spring"),u=a("../core/EventHandler"),v=a("../core/OptionsManager"),w=a("../core/ViewSequence"),x=a("../views/Scroller"),y=a("../utilities/Utility"),z=a("../inputs/GenericSync"),A=a("../inputs/ScrollSync"),B=a("../inputs/TouchSync");z.register({scroll:A,touch:B});var C={NONE:0,EDGE:1,PAGE:2},D={TOP:-1,NONE:0,BOTTOM:1};d.DEFAULT_OPTIONS={direction:y.Direction.Y,rails:!0,friction:.005,drag:1e-4,edgeGrip:.2,edgePeriod:300,edgeDamp:1,margin:1e3,paginated:!1,pagePeriod:500,pageDamp:.8,pageStopSpeed:10,pageSwitchSpeed:.5,speedLimit:5,groupScroll:!1,syncScale:1},d.prototype.getCurrentIndex=function(){return this._node.index},d.prototype.goToPreviousPage=function(){if(!this._node||this._onEdge===D.TOP)return null;if(this.getPosition()>1&&this._springState===C.NONE)return n.call(this,0,C.PAGE),this._node;var a=this._node.getPrevious();if(a){var b=k.call(this,a);this._scroller.sequenceFrom(a),this._node=a,p.call(this,b),n.call(this,0,C.PAGE)}return a},d.prototype.goToNextPage=function(){if(!this._node||this._onEdge===D.BOTTOM)return null;var a=this._node.getNext();if(a){var b=k.call(this,this._node);this._scroller.sequenceFrom(a),this._node=a,p.call(this,-b),n.call(this,0,C.PAGE)}return a},d.prototype.goToPage=function(a){var b,c=this.getCurrentIndex();if(c>a)for(b=0;c-a>b;b++)this.goToPreviousPage();if(a>c)for(b=0;a-c>b;b++)this.goToNextPage()},d.prototype.outputFrom=function(){return this._scroller.outputFrom.apply(this._scroller,arguments)},d.prototype.getPosition=function(){return this._particle.getPosition1D()},d.prototype.getAbsolutePosition=function(){return this._scroller.getCumulativeSize(this.getCurrentIndex())[this.options.direction]+this.getPosition()},d.prototype.getOffset=d.prototype.getPosition,d.prototype.setPosition=function(a){this._particle.setPosition1D(a)},d.prototype.setOffset=d.prototype.setPosition,d.prototype.getVelocity=function(){return this._touchCount?this._touchVelocity:this._particle.getVelocity1D()},d.prototype.setVelocity=function(a){this._particle.setVelocity1D(a)},d.prototype.setOptions=function(a){void 0!==a.direction&&("x"===a.direction?a.direction=y.Direction.X:"y"===a.direction&&(a.direction=y.Direction.Y)),a.groupScroll!==this.options.groupScroll&&(a.groupScroll?this.subscribe(this._scroller):this.unsubscribe(this._scroller)),this._optionsManager.setOptions(a),this._scroller.setOptions(a),void 0!==a.drag&&this.drag.setOptions({strength:this.options.drag}),void 0!==a.friction&&this.friction.setOptions({strength:this.options.friction}),(void 0!==a.edgePeriod||void 0!==a.edgeDamp)&&this.spring.setOptions({period:this.options.edgePeriod,dampingRatio:this.options.edgeDamp}),(a.rails||void 0!==a.direction||void 0!==a.syncScale||a.preventDefault)&&this.sync.setOptions({rails:this.options.rails,direction:this.options.direction===y.Direction.X?z.DIRECTION_X:z.DIRECTION_Y,scale:this.options.syncScale,preventDefault:this.options.preventDefault})},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new w({array:a,trackSize:!0})),this._node=a,this._scroller.sequenceFrom(a)},d.prototype.getSize=function(){return this._scroller.getSize.apply(this._scroller,arguments)},d.prototype.render=function(){return this.options.paginated&&this._needsPaginationCheck&&m.call(this),this._scroller.render()},c.exports=d}),define(function(a,b,c){function d(a){this._items=null,this._size=null,this._outputFunction=d.DEFAULT_OUTPUT_FUNCTION,this.options=i.clone(this.constructor.DEFAULT_OPTIONS||d.DEFAULT_OPTIONS),this.optionsManager=new e(this.options),this.id=f.register(this),this.cachedSize=[void 0,void 0],a&&this.setOptions(a)}var e=a("../core/OptionsManager"),f=a("../core/Entity"),g=a("../core/Transform"),h=a("../core/ViewSequence"),i=a("../utilities/Utility");d.DEFAULT_OPTIONS={direction:i.Direction.Y,itemSpacing:0},d.DEFAULT_OUTPUT_FUNCTION=function(a,b){var c=this.options.direction===i.Direction.X?g.translate(b,0):g.translate(0,b);return{size:this.cachedSize,transform:c,target:a.render()}},d.prototype.getSize=function(){return this._size||this.render(),this._size},d.prototype.sequenceFrom=function(a){return a instanceof Array&&(a=new h(a)),this._items=a,this},d.prototype.setOptions=function(){return this.optionsManager.setOptions.apply(this.optionsManager,arguments),this},d.prototype.setOutputFunction=function(a){return this._outputFunction=a,this},d.prototype.render=function(){return this.id},d.prototype.commit=function(a){var b=0,c=1^this.options.direction,d=this._items,e=null,f=[],g={},h=[],i=0;for(this._size=[0,0],this.cachedSize=a.size;d&&(e=d.get());)e.getSize&&(f=e.getSize()),g=this._outputFunction.call(this,e,b,i++),h.push(g),f&&(f[this.options.direction]&&(b+=f[this.options.direction]),f[c]>this._size[c]&&(this._size[c]=f[c]),0===f[c]&&(this._size[c]=void 0)),d=d.getNext(),this.options.itemSpacing&&d&&(b+=this.options.itemSpacing);return this._size[this.options.direction]=b,{transform:a.transform,origin:a.origin,size:this.getSize(),target:h}},c.exports=d}),define(function(a,b,c){function d(){h.apply(this,arguments),this.title=new f({classes:this.options.classes,content:this.options.content}),this.back=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.backContent}),this.back.on("click",function(){this._eventOutput.emit("back",{})}.bind(this)),this.more=new f({size:[this.options.size[1],this.options.size[1]],classes:this.options.classes,content:this.options.moreContent}),this.more.on("click",function(){this._eventOutput.emit("more",{})}.bind(this)),this.layout=new e({id:"master",size:this.options.size,target:[{transform:g.inFront,origin:[0,.5],align:[0,.5],target:this.back},{origin:[.5,.5],align:[.5,.5],target:this.title},{transform:g.inFront,origin:[1,.5],align:[1,.5],target:this.more}]}),this._add(this.layout),this._optionsManager.on("change",function(a){var b=a.id,c=a.value;"size"===b?(this.layout.id.master.setSize(c),this.title.setSize(c),this.back.setSize([c[1],c[1]]),this.more.setSize([c[1],c[1]])):"backClasses"===b?this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}):"backContent"===b?this.back.setContent(this.options.backContent):"classes"===b?(this.title.setOptions({classes:this.options.classes}),this.back.setOptions({classes:this.options.classes.concat(this.options.backClasses)}),this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)})):"content"===b?this.setContent(this.options.content):"moreClasses"===b?this.more.setOptions({classes:this.options.classes.concat(this.options.moreClasses)}):"moreContent"===b&&this.more.setContent(this.options.content)}.bind(this))}var e=a("../core/Scene"),f=a("../core/Surface"),g=a("../core/Transform"),h=a("../core/View");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={size:[void 0,50],backClasses:["back"],backContent:"&#x25c0;",classes:["navigation"],content:"",moreClasses:["more"],moreContent:"&#x271a;"},d.prototype.setContent=function(a){return this.title.setContent(a)},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),this.optionsManager=new k(this.options),a&&this.setOptions(a),this.indicator=new g({size:this.options.indicatorSize,classes:["slider-back"]}),this.label=new f({size:this.options.labelSize,content:this.options.label,properties:{pointerEvents:"none"},classes:["slider-label"]}),this.eventOutput=new i,this.eventInput=new i,i.setInputHandler(this,this.eventInput),i.setOutputHandler(this,this.eventOutput);var b=(this.options.range[1]-this.options.range[0])/this.options.indicatorSize[0];this.sync=new n(["mouse","touch"],{scale:b,direction:n.DIRECTION_X}),this.indicator.pipe(this.sync),this.sync.pipe(this),this.eventInput.on("update",function(a){this.set(a.position)}.bind(this)),this._drawPos=0,e.call(this)}function e(){this.label.setContent(this.options.label+'<span style="float: right">'+this.get().toFixed(this.options.precision)+"</span>")}var f=a("../core/Surface"),g=a("../surfaces/CanvasSurface"),h=a("../core/Transform"),i=a("../core/EventHandler"),j=a("../math/Utilities"),k=a("../core/OptionsManager"),l=a("../inputs/MouseSync"),m=a("../inputs/TouchSync"),n=a("../inputs/GenericSync");n.register({mouse:l,touch:m}),d.DEFAULT_OPTIONS={size:[200,60],indicatorSize:[200,30],labelSize:[200,30],range:[0,1],precision:2,value:0,label:"",fillColor:"rgba(170, 170, 170, 1)"},d.prototype.setOptions=function(a){return this.optionsManager.setOptions(a)},d.prototype.get=function(){return this.options.value},d.prototype.set=function(a){a!==this.options.value&&(this.options.value=j.clamp(a,this.options.range),e.call(this),this.eventOutput.emit("change",{value:a}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){var a=this.options.range,b=Math.floor((this.get()-a[0])/(a[1]-a[0])*this.options.indicatorSize[0]);if(b<this._drawPos)this.indicator.getContext("2d").clearRect(b,0,this._drawPos-b+1,this.options.indicatorSize[1]);else if(b>this._drawPos){var c=this.indicator.getContext("2d");c.fillStyle=this.options.fillColor,c.fillRect(this._drawPos-1,0,b-this._drawPos+1,this.options.indicatorSize[1])}return this._drawPos=b,{size:this.options.size,target:[{origin:[0,0],target:this.indicator.render()},{transform:h.translate(0,0,1),origin:[0,0],target:this.label.render()}]}},c.exports=d}),define(function(a,b,c){function d(){h.apply(this,arguments),this.layout=new i,this.buttons=[],this._buttonIds={},this._buttonCallbacks={},this.layout.sequenceFrom(this.buttons),this._add(this.layout),this._optionsManager.on("change",e.bind(this))}function e(a){var b=a.id,c=a.value;if("direction"===b)this.layout.setOptions({dimensions:f.call(this.buttons.length,this.options.direction)});else if("buttons"===b)for(var d in this.buttons)this.buttons[d].setOptions(c);else if("sections"===b)for(var e in this.options.sections)this.defineSection(e,this.options.sections[e])}function f(a,b){return b===g.Direction.X?[a,1]:[1,a]}var g=a("../utilities/Utility"),h=a("../core/View"),i=a("../views/GridLayout"),j=a("./ToggleButton");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={sections:[],widget:j,size:[void 0,50],direction:g.Direction.X,buttons:{toggleMode:j.ON}},d.prototype.defineSection=function(a,b){var c,d=this._buttonIds[a];if(void 0===d){d=this.buttons.length,this._buttonIds[a]=d;var e=this.options.widget;c=new e,this.buttons[d]=c,this.layout.setOptions({dimensions:f(this.buttons.length,this.options.direction)})}else c=this.buttons[d],c.unbind("select",this._buttonCallbacks[a]);this.options.buttons&&c.setOptions(this.options.buttons),c.setOptions(b),this._buttonCallbacks[a]=this.select.bind(this,a),c.on("select",this._buttonCallbacks[a])},d.prototype.select=function(a){var b=this._buttonIds[a];this.buttons[b]&&this.buttons[b].isSelected()?this._eventOutput.emit("select",{id:a}):this.buttons[b]&&this.buttons[b].select();for(var c=0;c<this.buttons.length;c++)c!==b&&this.buttons[c].deselect()},c.exports=d}),define(function(a,b,c){function d(a){this.options={content:["",""],offClasses:["off"],onClasses:["on"],size:void 0,outTransition:{curve:"easeInOut",duration:300},inTransition:{curve:"easeInOut",duration:300},toggleMode:d.TOGGLE,crossfade:!0},this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput),this.offSurface=new e,this.offSurface.on("click",function(){this.options.toggleMode!==d.OFF&&this.select()}.bind(this)),this.offSurface.pipe(this._eventOutput),this.onSurface=new e,this.onSurface.on("click",function(){this.options.toggleMode!==d.ON&&this.deselect()}.bind(this)),this.onSurface.pipe(this._eventOutput),this.arbiter=new g({overlap:this.options.crossfade}),this.deselect(),a&&this.setOptions(a)}var e=a("../core/Surface"),f=a("../core/EventHandler"),g=a("../views/RenderController");d.OFF=0,d.ON=1,d.TOGGLE=2,d.prototype.select=function(a){this.selected=!0,this.arbiter.show(this.onSurface,this.options.inTransition),a||this._eventOutput.emit("select")},d.prototype.deselect=function(a){this.selected=!1,this.arbiter.show(this.offSurface,this.options.outTransition),a||this._eventOutput.emit("deselect")},d.prototype.isSelected=function(){return this.selected},d.prototype.setOptions=function(a){void 0!==a.content&&(a.content instanceof Array||(a.content=[a.content,a.content]),this.options.content=a.content,this.offSurface.setContent(this.options.content[0]),this.onSurface.setContent(this.options.content[1])),a.offClasses&&(this.options.offClasses=a.offClasses,this.offSurface.setClasses(this.options.offClasses)),a.onClasses&&(this.options.onClasses=a.onClasses,this.onSurface.setClasses(this.options.onClasses)),void 0!==a.size&&(this.options.size=a.size,this.onSurface.setSize(this.options.size),this.offSurface.setSize(this.options.size)),void 0!==a.toggleMode&&(this.options.toggleMode=a.toggleMode),void 0!==a.outTransition&&(this.options.outTransition=a.outTransition),void 0!==a.inTransition&&(this.options.inTransition=a.inTransition),void 0!==a.crossfade&&(this.options.crossfade=a.crossfade,this.arbiter.setOptions({overlap:this.options.crossfade}))},d.prototype.getSize=function(){return this.options.size},d.prototype.render=function(){return this.arbiter.render()},c.exports=d}),define(function(a,b,c){function d(a){this.dispatchers={},this.currMode=void 0,this.setMode(a)}var e=a("../core/EventHandler");d.prototype.setMode=function(a){if(a!==this.currMode){var b=this.currMode;this.dispatchers[this.currMode]&&this.dispatchers[this.currMode].trigger("unpipe"),this.currMode=a,this.dispatchers[a]&&this.dispatchers[a].emit("pipe"),this.emit("change",{from:b,to:a})}},d.prototype.forMode=function(a){return this.dispatchers[a]||(this.dispatchers[a]=new e),this.dispatchers[a]},d.prototype.emit=function(a,b){if(void 0===this.currMode)return!1;b||(b={});var c=this.dispatchers[this.currMode];return c?c.trigger(a,b):void 0},c.exports=d}),define(function(a,b,c){function d(a){e.call(this),this._condition=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.emit=function(a,b){return this._condition(a,b)?e.prototype.emit.apply(this,arguments):void 0},d.prototype.trigger=d.prototype.emit,c.exports=d}),define(function(a,b,c){function d(a){e.call(this),this._mappingFunction=a}var e=a("../core/EventHandler");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.subscribe=null,d.prototype.unsubscribe=null,d.prototype.emit=function(a,b){var c=this._mappingFunction.apply(this,arguments);c&&c.emit instanceof Function&&c.emit(a,b)},d.prototype.trigger=d.prototype.emit,c.exports=d}),define(function(a,b,c){function d(a){e.call(this,a),a=a||{},this.orientation=new h,this.angularVelocity=new g,this.angularMomentum=new g,this.torque=new g,a.orientation&&this.orientation.set(a.orientation),a.angularVelocity&&this.angularVelocity.set(a.angularVelocity),a.angularMomentum&&this.angularMomentum.set(a.angularMomentum),a.torque&&this.torque.set(a.torque),this.angularVelocity.w=0,this.setMomentsOfInertia(),this.pWorld=new g}var e=a("./Particle"),f=a("../../core/Transform"),g=a("../../math/Vector"),h=a("../../math/Quaternion"),i=a("../../math/Matrix"),j=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.DEFAULT_OPTIONS.orientation=[0,0,0,1],d.DEFAULT_OPTIONS.angularVelocity=[0,0,0],d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isBody=!0,d.prototype.setMass=function(){e.prototype.setMass.apply(this,arguments),this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){this.inertia=new i,this.inverseInertia=new i},d.prototype.updateAngularVelocity=function(){this.angularVelocity.set(this.inverseInertia.vectorMultiply(this.angularMomentum))},d.prototype.toWorldCoordinates=function(a){return this.pWorld.set(this.orientation.rotateVector(a))},d.prototype.getEnergy=function(){return e.prototype.getEnergy.call(this)+.5*this.inertia.vectorMultiply(this.angularVelocity).dot(this.angularVelocity)},d.prototype.reset=function(a,b,c,d){e.prototype.reset.call(this,a,b),this.angularVelocity.clear(),this.setOrientation(c||[1,0,0,0]),this.setAngularMomentum(d||[0,0,0])},d.prototype.setOrientation=function(a){this.orientation.set(a)},d.prototype.setAngularVelocity=function(a){this.wake(),this.angularVelocity.set(a)},d.prototype.setAngularMomentum=function(a){this.wake(),this.angularMomentum.set(a)},d.prototype.applyForce=function(a,b){e.prototype.applyForce.call(this,a),void 0!==b&&this.applyTorque(b.cross(a))},d.prototype.applyTorque=function(a){this.wake(),this.torque.set(this.torque.add(a))},d.prototype.getTransform=function(){return f.thenMove(this.orientation.getTransform(),f.getTranslate(e.prototype.getTransform.call(this)))},d.prototype._integrate=function(a){e.prototype._integrate.call(this,a),this.integrateAngularMomentum(a),this.updateAngularVelocity(a),this.integrateOrientation(a)},d.prototype.integrateAngularMomentum=function(a){j.integrateAngularMomentum(this,a)},d.prototype.integrateOrientation=function(a){j.integrateOrientation(this,a)},c.exports=d}),define(function(a,b,c){function d(a){a=a||{},this.setRadius(a.radius||0),e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setRadius=function(a){this.radius=a,this.size=[2*this.radius,2*this.radius],this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.radius;this.inertia=new f([[.25*a*b*b,0,0],[0,.25*a*b*b,0],[0,0,.5*a*b*b]]),this.inverseInertia=new f([[4/(a*b*b),0,0],[0,4/(a*b*b),0],[0,0,2/(a*b*b)]])},c.exports=d}),define(function(a,b,c){function d(a){a=a||{};var b=d.DEFAULT_OPTIONS;this.position=new f,this.velocity=new f,this.force=new f,this._engine=null,this._isSleeping=!0,this._eventOutput=null,this.mass=void 0!==a.mass?a.mass:b.mass,this.inverseMass=1/this.mass,this.setPosition(a.position||b.position),this.setVelocity(a.velocity||b.velocity),this.force.set(a.force||[0,0,0]),this.transform=g.identity.slice(),this._spec={size:[!0,!0],target:{transform:this.transform,origin:[.5,.5],target:null}}}function e(){this._eventOutput=new h,this._eventOutput.bindThis(this),h.setOutputHandler(this,this._eventOutput)}var f=a("../../math/Vector"),g=a("../../core/Transform"),h=a("../../core/EventHandler"),i=a("../integrators/SymplecticEuler");d.DEFAULT_OPTIONS={position:[0,0,0],velocity:[0,0,0],mass:1};var j={start:"start",update:"update",end:"end"},k=Date.now;d.prototype.isBody=!1,d.prototype.isActive=function(){return!this._isSleeping},d.prototype.sleep=function(){this._isSleeping||(this.emit(j.end,this),this._isSleeping=!0)},d.prototype.wake=function(){this._isSleeping&&(this.emit(j.start,this),this._isSleeping=!1,this._prevTime=k(),this._engine&&this._engine.wake())},d.prototype.setPosition=function(a){this.position.set(a)},d.prototype.setPosition1D=function(a){this.position.x=a},d.prototype.getPosition=function(){return this._engine.step(),this.position.get()},d.prototype.getPosition1D=function(){return this._engine.step(),this.position.x},d.prototype.setVelocity=function(a){this.velocity.set(a),(0!==a[0]||0!==a[1]||0!==a[2])&&this.wake()},d.prototype.setVelocity1D=function(a){this.velocity.x=a,0!==a&&this.wake()},d.prototype.getVelocity=function(){return this.velocity.get()},d.prototype.setForce=function(a){this.force.set(a),this.wake()},d.prototype.getVelocity1D=function(){return this.velocity.x},d.prototype.setMass=function(a){this.mass=a,this.inverseMass=1/a},d.prototype.getMass=function(){return this.mass},d.prototype.reset=function(a,b){this.setPosition(a||[0,0,0]),this.setVelocity(b||[0,0,0])},d.prototype.applyForce=function(a){a.isZero()||(this.force.add(a).put(this.force),this.wake())},d.prototype.applyImpulse=function(a){if(!a.isZero()){var b=this.velocity;b.add(a.mult(this.inverseMass)).put(b)}},d.prototype.integrateVelocity=function(a){i.integrateVelocity(this,a)},d.prototype.integratePosition=function(a){i.integratePosition(this,a)},d.prototype._integrate=function(a){this.integrateVelocity(a),this.integratePosition(a)},d.prototype.getEnergy=function(){return.5*this.mass*this.velocity.normSquared()
},d.prototype.getTransform=function(){this._engine.step();var a=this.position,b=this.transform;return b[12]=a.x,b[13]=a.y,b[14]=a.z,b},d.prototype.modify=function(a){var b=this._spec.target;return b.transform=this.getTransform(),b.target=a,this._spec},d.prototype.emit=function(a,b){this._eventOutput&&this._eventOutput.emit(a,b)},d.prototype.on=function(){return e.call(this),this.on.apply(this,arguments)},d.prototype.removeListener=function(){return e.call(this),this.removeListener.apply(this,arguments)},d.prototype.pipe=function(){return e.call(this),this.pipe.apply(this,arguments)},d.prototype.unpipe=function(){return e.call(this),this.unpipe.apply(this,arguments)},c.exports=d}),define(function(a,b,c){function d(a){a=a||{},this.size=a.size||[0,0],e.call(this,a)}var e=a("./Body"),f=a("../../math/Matrix");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setSize=function(a){this.size=a,this.setMomentsOfInertia()},d.prototype.setMomentsOfInertia=function(){var a=this.mass,b=this.size[0],c=this.size[1];this.inertia=new f([[a*c*c/12,0,0],[0,a*b*b/12,0],[0,0,a*(b*b+c*c)/12]]),this.inverseInertia=new f([[12/(a*c*c),0,0],[0,12/(a*b*b),0],[0,0,12/(a*(b*b+c*c))]])},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.normal=new f,this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){if(void 0!==b)for(var d=b.velocity,e=b.position,f=b.inverseMass,g=b.radius,h=this.options,i=h.drift,j=-h.slop,k=h.restitution,l=this.normal,m=this.pDiff,n=this.vDiff,o=this.impulse1,p=this.impulse2,q=0;q<a.length;q++){var r=a[q];if(r!==b){var s=r.velocity,t=r.position,u=r.inverseMass,v=r.radius;m.set(t.sub(e)),n.set(s.sub(d));var w=m.norm(),x=w-(g+v),y=1/(f+u),z=0;if(0>x){if(l.set(m.normalize()),this._eventOutput){var A={target:r,source:b,overlap:x,normal:l};this._eventOutput.emit("preCollision",A),this._eventOutput.emit("collision",A)}var B=j>=x?((1+k)*l.dot(n)+i/c*(x-j))/(z+c/y):(1+k)*l.dot(n)/(z+c/y);l.mult(c*B).put(o),o.mult(-1).put(p),b.applyImpulse(o),r.applyImpulse(p),this._eventOutput&&this._eventOutput.emit("postCollision",A)}}}},c.exports=d}),define(function(a,b,c){function d(){this.options=this.options||{},this._eventOutput=new e,e.setOutputHandler(this,this._eventOutput)}var e=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyConstraint=function(){},d.prototype.getEnergy=function(){return 0},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d;var g=1e-7,h=Math.PI;d.DEFAULT_OPTIONS={equation:function(){return 0},plane:function(a,b,c){return c},period:0,dampingRatio:0},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.impulse,f=this.J,i=d.equation,j=d.plane,k=d.dampingRatio,l=d.period,m=0;m<a.length;m++){var n,o,p=a[m],q=p.velocity,r=p.position,s=p.mass;if(0===l)n=0,o=1;else{var t=4*s*h*k/l,u=4*s*h*h/(l*l);n=1/(t+c*u),o=c*u/(t+c*u)}var v=r.x,w=r.y,x=r.z,y=i(v,w,x),z=(i(v+g,r,r)-y)/g,A=(i(v,w+g,r)-y)/g,B=(i(v,w,r+g)-y)/g,C=j(v,w,x),D=(j(v+g,w,x)-C)/g,E=(j(v,w+g,x)-C)/g,F=(j(v,w,x+g)-C)/g;f.setXYZ(z+D,A+E,B+F);var G=o/c*(y+C),H=-(f.dot(q)+G)/(n+c*f.normSquared()/s);e.set(f.mult(c*H)),p.applyImpulse(e)}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.impulse=new f,this.normal=new f,this.diffP=new f,this.diffV=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={anchor:null,length:0,minLength:0,period:0,dampingRatio:0};var g=Math.PI;d.prototype.setOptions=function(a){a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),void 0!==a.minLength&&(this.options.minLength=a.minLength)},d.prototype.setAnchor=function(a){this.options.anchor||(this.options.anchor=new f),this.options.anchor.set(a)},d.prototype.applyConstraint=function(a,b,c){var d,e,f=this.normal,h=this.diffP,i=this.diffV,j=this.impulse,k=this.options,l=k.dampingRatio,m=k.period,n=k.minLength;if(b){var o=b.velocity;d=b.position,e=b.inverseMass}else d=this.options.anchor,e=0;for(var p=this.options.length,q=0;q<a.length;q++){var r=a[q],s=r.velocity,t=r.position,u=r.inverseMass;h.set(t.sub(d)),f.set(h.normalize());var v=h.norm()-p;if(Math.abs(v)<n)return;i.set(b?s.sub(o):s);var w,x,y=1/(u+e);if(0===m)w=0,x=1;else{var z=4*y*g*l/m,A=4*y*g*g/(m*m);w=1/(z+c*A),x=c*A/(z+c*A)}var B=x/c*v,C=-(f.dot(i)+B)/(w+c/y);j.set(f.mult(c*C)),r.applyImpulse(j),b&&b.applyImpulse(j.mult(-1))}},c.exports=d}),define(function(a,b,c){function d(a){e.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.pDiff=new f,this.vDiff=new f,this.impulse1=new f,this.impulse2=new f}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,anchor:void 0};var g=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof f&&(this.options.anchor=a.anchor),a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor))),void 0!==a.length&&(this.options.length=a.length),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.period&&(this.options.period=a.period),e.prototype.setOptions.call(this,a)},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=c.anchor||b.position,f=Math.pow(2*g/c.period,2),h=0,i=0;i<a.length;i++){var j=a[i],k=e.sub(j.position).norm()-d;h+=.5*f*k*k}return h},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options,e=this.pDiff,f=this.vDiff,h=this.impulse1,i=this.impulse2,j=d.length,k=d.anchor||b.position,l=d.period,m=d.dampingRatio,n=0;n<a.length;n++){var o=a[n],p=o.position,q=o.velocity,r=o.mass,s=o.inverseMass;e.set(p.sub(k));var t,u=e.norm()-j;if(b){var v=b.inverseMass,w=b.velocity;f.set(q.sub(w)),t=1/(s+v)}else f.set(q),t=r;var x,y;if(0===this.options.period)x=0,y=1;else{var z=4*t*g*g/(l*l),A=4*t*g*m/l;y=c*z/(A+c*z),x=1/(A+c*z)}var B=y/c*u;e.normalize(-B).sub(f).mult(c/(x+c/t)).put(h),o.applyImpulse(h),b&&(h.mult(-1).put(i),b.applyImpulse(i))}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.J=new f,this.impulse=new f,e.call(this)}var e=a("./Constraint"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS={equation:void 0,period:0,dampingRatio:0};var g=1e-7,h=Math.PI;d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},d.prototype.applyConstraint=function(a,b,c){for(var d=this.impulse,e=this.J,f=this.options,i=f.equation,j=f.dampingRatio,k=f.period,l=0;l<a.length;l++){var m,n,o=a[l],p=o.velocity,q=o.position,r=o.mass;if(0===k)m=0,n=1;else{var s=4*r*h*j/k,t=4*r*h*h/(k*k);m=1/(s+c*t),n=c*t/(s+c*t)}var u=q.x,v=q.y,w=q.z,x=i(u,v,w),y=(i(u+g,q,q)-x)/g,z=(i(u,v+g,q)-x)/g,A=(i(u,v,q+g)-x)/g;e.setXYZ(y,z,A);var B=n/c*x,C=-(e.dot(p)+B)/(m+c*e.normSquared()/r);d.set(e.mult(c*C)),o.applyImpulse(d)}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.diff=new j,this.impulse=new j,i.call(this)}function e(a,b){return b.dot(a)}function f(a){var b=this.options.normal,c=this.options.distance;return a.dot(b)+c}function g(a,b,c){var e=a.position,f=a.velocity,g=a.mass,h=this.options.normal,i=this.options.onContact,j=this.options.restitution,k=this.impulse,l=this.options.drift,m=-this.options.slop,n=0;if(this._eventOutput){var o={particle:a,wall:this,overlap:b,normal:h};this._eventOutput.emit("preCollision",o),this._eventOutput.emit("collision",o)}switch(i){case d.ON_CONTACT.REFLECT:var p=m>b?-((1+j)*h.dot(f)+l/c*(b-m))/(g*c+n):-((1+j)*h.dot(f))/(g*c+n);k.set(h.mult(c*p)),a.applyImpulse(k),a.setPosition(e.add(h.mult(-b)))}this._eventOutput&&this._eventOutput.emit("postCollision",o)}function h(a,b){var c=this.options.onContact,e=a.position,f=this.options.normal;c===d.ON_CONTACT.REFLECT&&a.setPosition(e.add(f.mult(-b)))}var i=a("./Constraint"),j=a("../../math/Vector");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.ON_CONTACT={REFLECT:0,SILENT:1},d.DEFAULT_OPTIONS={restitution:.5,drift:.5,slop:0,normal:[1,0,0],distance:0,onContact:d.ON_CONTACT.REFLECT},d.prototype.setOptions=function(a){void 0!==a.normal&&(a.normal instanceof j&&(this.options.normal=a.normal.clone()),a.normal instanceof Array&&(this.options.normal=new j(a.normal))),void 0!==a.restitution&&(this.options.restitution=a.restitution),void 0!==a.drift&&(this.options.drift=a.drift),void 0!==a.slop&&(this.options.slop=a.slop),void 0!==a.distance&&(this.options.distance=a.distance),void 0!==a.onContact&&(this.options.onContact=a.onContact)},d.prototype.applyConstraint=function(a,b,c){for(var d=this.options.normal,i=0;i<a.length;i++){var j=a[i],k=j.position,l=j.velocity,m=j.radius||0,n=f.call(this,k.add(d.mult(-m))),o=e.call(this,d,l);0>=n&&(0>o?g.call(this,j,n,c):h.call(this,j,n,c))}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),f.call(this,a.sides||this.options.sides),h.call(this)}function e(a,b,c){var e,f=d.SIDES;switch(parseInt(a)){case f.LEFT:e=b[0]*c[0];break;case f.TOP:e=b[1]*c[1];break;case f.FRONT:e=b[2]*c[2];break;case f.RIGHT:e=b[0]*(1-c[0]);break;case f.BOTTOM:e=b[1]*(1-c[1]);break;case f.BACK:e=b[2]*(1-c[2])}return e}function f(a){this.components={};for(var b=this.components,c=0;c<a.length;c++){var d=a[c];b[c]=new i({normal:k[d].clone(),distance:e(d,this.options.size,this.options.origin)})}}function g(a){this.forEach(function(b){b.setOptions(a)});for(var b in a)this.options[b]=a[b]}var h=a("./Constraint"),i=a("./Wall"),j=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.ON_CONTACT=i.ON_CONTACT,d.SIDES={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5,TWO_DIMENSIONAL:[0,1,2,3],THREE_DIMENSIONAL:[0,1,2,3,4,5]},d.DEFAULT_OPTIONS={sides:d.SIDES.TWO_DIMENSIONAL,size:[window.innerWidth,window.innerHeight,0],origin:[.5,.5,.5],drift:.5,slop:0,restitution:.5,onContact:d.ON_CONTACT.REFLECT};var k={0:new j(1,0,0),1:new j(-1,0,0),2:new j(0,1,0),3:new j(0,-1,0),4:new j(0,0,1),5:new j(0,0,-1)};d.prototype.setOptions=function(a){var b=!1;void 0!==a.restitution&&g.call(this,{restitution:a.restitution}),void 0!==a.drift&&g.call(this,{drift:a.drift}),void 0!==a.slop&&g.call(this,{slop:a.slop}),void 0!==a.onContact&&g.call(this,{onContact:a.onContact}),void 0!==a.size&&(b=!0),void 0!==a.sides&&(this.options.sides=a.sides),void 0!==a.origin&&(b=!0),b&&this.setSize(a.size,a.origin)},d.prototype.setSize=function(a,b){b=b||this.options.origin,b.length<3&&(b[2]=.5),this.forEach(function(c,d){var f=e(d,a,b);c.setOptions({distance:f})}),this.options.size=a,this.options.origin=b},d.prototype.applyConstraint=function(a,b,c){this.forEach(function(d){d.applyConstraint(a,b,c)})},d.prototype.forEach=function(a){var b=this.options.sides;for(var c in this.sides)a(b[c],c)},d.prototype.rotateZ=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateZ(a).put(c)})},d.prototype.rotateX=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateX(a).put(c)})},d.prototype.rotateY=function(a){this.forEach(function(b){var c=b.options.normal;c.rotateY(a).put(c)})},d.prototype.reset=function(){var a=this.options.sides;for(var b in a){var c=this.components[b];c.options.normal.set(k[b])}},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),e.call(this)}var e=a("./Force");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.DEFAULT_OPTIONS={strength:.01,forceFunction:d.FORCE_FUNCTIONS.LINEAR},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.velocity).mult(-d).put(f),c.applyForce(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define(function(a,b,c){function d(a){this.force=new e(a),this._eventOutput=new f,f.setOutputHandler(this,this._eventOutput)}var e=a("../../math/Vector"),f=a("../../core/EventHandler");d.prototype.setOptions=function(a){this._eventOutput.emit("change",a)},d.prototype.applyForce=function(a){for(var b=a.length;b--;)a[b].applyForce(this.force)},d.prototype.getEnergy=function(){return 0},c.exports=d}),define(function(a,b,c){function d(a){this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new f,e.call(this)}var e=a("./Force"),f=a("../../math/Vector");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DECAY_FUNCTIONS={LINEAR:function(a,b){return Math.max(1-1/b*a,0)},MORSE:function(a,b){var c=0===b?100:b,d=a+c*(1-Math.log(2));return Math.max(1-Math.pow(1-Math.exp(d/c-1),2),0)},INVERSE:function(a,b){return 1/(1-b+a)},GRAVITY:function(a,b){return 1/(1-b+a*a)}},d.DEFAULT_OPTIONS={strength:1,anchor:void 0,range:[0,1/0],cutoff:0,cap:1/0,decayFunction:d.DECAY_FUNCTIONS.GRAVITY},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof f&&(this.options.anchor=a.anchor.position),a.anchor instanceof Array&&(this.options.anchor=new f(a.anchor)),delete a.anchor);for(var b in a)this.options[b]=a[b]},d.prototype.applyForce=function(a,b){var c=this.options,d=this.force,e=this.disp,f=c.strength,g=c.anchor||b.position,h=c.cap,i=c.cutoff,j=c.range[0],k=c.range[1],l=c.decayFunction;if(0!==f)for(var m,n,o,p,q=a.length;q--;)m=a[q],m!==b&&(n=m.mass,o=m.position,e.set(o.sub(g)),p=e.norm(),k>p&&p>j&&(d.set(e.normalize(f*n*l(p,i)).cap(h)),m.applyForce(d)))},c.exports=d}),define(function(a,b,c){function d(a){e.call(this,a)}var e=a("./Drag");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=e.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=e.FORCE_FUNCTIONS,d.FORCE_FUNCTIONS={LINEAR:function(a){return a},QUADRATIC:function(a){return a.mult(a.norm())}},d.prototype.applyForce=function(a){var b,c,d=this.options.strength,e=this.options.forceFunction,f=this.force;for(b=0;b<a.length;b++)c=a[b],e(c.angularVelocity).mult(-100*d).put(f),c.applyTorque(f)},d.prototype.setOptions=function(a){for(var b in a)this.options[b]=a[b]},c.exports=d}),define(function(a,b,c){function d(a){i.call(this,a)}function e(){var a=this.options;a.stiffness=Math.pow(2*k/a.period,2)}function f(){var a=this.options;a.damping=4*k*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("./Spring"),j=a("../../math/Quaternion");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.DEFAULT_OPTIONS=i.DEFAULT_OPTIONS,d.FORCE_FUNCTIONS=i.FORCE_FUNCTIONS;var k=Math.PI;d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor instanceof j&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new j(a.anchor))),void 0!==a.period&&(this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a){var b,c,d,e,f=this.force,g=this.options,h=this.disp,i=g.stiffness,j=g.damping,k=g.length,l=g.anchor,m=g.forceFunction,n=g.maxLength;for(b=0;b<a.length;b++){if(c=a[b],h.set(l.sub(c.orientation)),d=h.norm()-k,0===d)return;e=c.mass,i*=e,j*=e,f.set(h.normalize(i*m(d,n))),j&&f.add(c.angularVelocity.mult(-j)).put(f),c.applyTorque(f)}},d.prototype.getEnergy=function(a){for(var b=this.options,c=b.length,d=b.anchor,e=b.stiffness,f=0,g=0;g<a.length;g++){var h=a[g],i=d.sub(h.orientation).norm()-c;f+=.5*e*i*i}return f},c.exports=d}),define(function(a,b,c){function d(a){h.call(this),this.options=Object.create(this.constructor.DEFAULT_OPTIONS),a&&this.setOptions(a),this.disp=new i(0,0,0),g.call(this)}function e(){var a=this.options;a.stiffness=Math.pow(2*j/a.period,2)}function f(){var a=this.options;a.damping=4*j*a.dampingRatio/a.period}function g(){e.call(this),f.call(this)}var h=a("./Force"),i=a("../../math/Vector");d.prototype=Object.create(h.prototype),d.prototype.constructor=d;var j=Math.PI,k=150;d.FORCE_FUNCTIONS={FENE:function(a,b){var c=.99*b,d=Math.max(Math.min(a,c),-c);return d/(1-d*d/(b*b))},HOOK:function(a){return a}},d.DEFAULT_OPTIONS={period:300,dampingRatio:.1,length:0,maxLength:1/0,anchor:void 0,forceFunction:d.FORCE_FUNCTIONS.HOOK},d.prototype.setOptions=function(a){void 0!==a.anchor&&(a.anchor.position instanceof i&&(this.options.anchor=a.anchor.position),a.anchor instanceof i&&(this.options.anchor=a.anchor),a.anchor instanceof Array&&(this.options.anchor=new i(a.anchor))),void 0!==a.period&&(a.period<k&&(a.period=k,console.warn("The period of a SpringTransition is capped at "+k+" ms. Use a SnapTransition for faster transitions")),this.options.period=a.period),void 0!==a.dampingRatio&&(this.options.dampingRatio=a.dampingRatio),void 0!==a.length&&(this.options.length=a.length),void 0!==a.forceFunction&&(this.options.forceFunction=a.forceFunction),void 0!==a.maxLength&&(this.options.maxLength=a.maxLength),g.call(this),h.prototype.setOptions.call(this,a)},d.prototype.applyForce=function(a,b){var c,d,e,f,g,h,i=this.force,j=this.disp,k=this.options,l=k.stiffness,m=k.damping,n=k.length,o=k.maxLength,p=k.anchor||b.position,q=k.forceFunction;for(c=0;c<a.length;c++){if(d=a[c],e=d.position,f=d.velocity,p.sub(e).put(j),g=j.norm()-n,0===g)return;h=d.mass,l*=h,m*=h,j.normalize(l*q(g,o)).put(i),m&&(b?i.add(f.sub(b.velocity).mult(-m)).put(i):i.add(f.mult(-m)).put(i)),d.applyForce(i),b&&b.applyForce(i.mult(-1))}},d.prototype.getEnergy=function(a,b){for(var c=this.options,d=c.length,e=b?b.position:c.anchor,f=c.stiffness,g=0,h=0;h<a.length;h++){var i=a[h],j=e.sub(i.position).norm()-d;g+=.5*f*j*j}return g},c.exports=d}),define(function(a,b,c){function d(a){f.call(this),this.options=Object.create(d.DEFAULT_OPTIONS),a&&this.setOptions(a),this.evaluation=new g}function e(a){var b=d.FIELDS;switch(a){case b.CONSTANT:this.options.direction?this.options.direction instanceof Array&&(this.options.direction=new g(this.options.direction)):this.options.direction=new g(0,1,0);break;case b.POINT_ATTRACTOR:this.options.position?this.options.position instanceof Array&&(this.options.position=new g(this.options.position)):this.options.position=new g(0,0,0)}}var f=a("./Force"),g=a("../../math/Vector");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.FIELDS={CONSTANT:function(a,b){b.direction.put(this.evaluation)},LINEAR:function(a){a.put(this.evaluation)},RADIAL:function(a){a.mult(-1).put(this.evaluation)},POINT_ATTRACTOR:function(a,b){b.position.sub(a).put(this.evaluation)}},d.DEFAULT_OPTIONS={strength:.01,field:d.FIELDS.CONSTANT},d.prototype.setOptions=function(a){void 0!==a.strength&&(this.options.strength=a.strength),void 0!==a.direction&&(this.options.direction=a.direction),void 0!==a.field&&(this.options.field=a.field,e.call(this,this.options.field))},d.prototype.applyForce=function(a){var b,c,d=this.force,e=this.options.strength,f=this.options.field;for(b=0;b<a.length;b++)c=a[b],f.call(this,c.position,this.options),this.evaluation.mult(c.mass*e).put(d),c.applyForce(d)},d.prototype.getEnergy=function(a){var b,c,e=this.options.field,f=d.FIELDS,g=0;switch(e){case f.CONSTANT:g=a.length*this.options.direction.norm();break;case f.RADIAL:for(b=0;b<a.length;b++)c=a[b],g+=c.position.norm();break;case f.POINT_ATTRACTOR:for(b=0;b<a.length;b++)c=a[b],g+=c.position.sub(this.options.position).norm()}return g*=this.options.strength},c.exports=d}),define(function(a,b,c){var d={};d.integrateVelocity=function(a,b){var c=a.velocity,d=a.inverseMass,e=a.force;e.isZero()||(c.add(e.mult(b*d)).put(c),e.clear())},d.integratePosition=function(a,b){var c=a.position,d=a.velocity;c.add(d.mult(b)).put(c)},d.integrateAngularMomentum=function(a,b){var c=a.angularMomentum,d=a.torque;d.isZero()||(c.add(d.mult(b)).put(c),d.clear())},d.integrateOrientation=function(a,b){var c=a.orientation,d=a.angularVelocity;d.isZero()||c.add(c.multiply(d).scalarMultiply(.5*b)).put(c)},c.exports=d}),"undefined"==typeof document||"classList"in document.createElement("a")||!function(a){"use strict";var b="classList",c="prototype",d=(a.HTMLElement||a.Element)[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.className),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.className=this.toString()}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(a){a+="",-1===i(this,a)&&(this.push(a),this._updateClassName())},k.remove=function(a){a+="";var b=i(this,a);-1!==b&&(this.splice(b,1),this._updateClassName())},k.toggle=function(a){a+="",-1===i(this,a)?this.add(a):this.remove(a)},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}(self),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(function(){a(+new Date)},1e3/60)});var requirejs,require,define;!function(global){function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){(c||!hasProp(a,e))&&(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c;for(b=0;b<a.length;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(0===b||1==b&&".."===a[2]||".."===a[b-1])continue;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=c&&c.split("/"),r=x.map,s=r&&r["*"];if(a&&(a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),"."===a[0].charAt(0)&&q&&(p=q.slice(0,q.length-1),a=p.concat(a)),b(a),a=a.join("/")),d&&r&&(q||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),q)for(i=q.length;i>0;i-=1)if(f=getOwn(r,q.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(b.shift(),u.require.undef(a),u.makeRequire(null,{skipMap:!0})([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):-1===a.indexOf("!")?c(a,l,e):a:(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(apsp.apply(B,[B.length,0].concat(globalDefQueue)),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(g){a=g}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad&&req.onResourceLoad(u,this.map,this.depMaps)),l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(l){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+l,l,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;
if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&i(a,"error",bind(this,this.errback))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=x.shim,c={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){c[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,c){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),b[c]=a}),x.shim=b),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+x.urlArgs):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);return e(b.id)?void 0:j(makeError("scripterror","Script error for: "+b.id,a,[b.id]))}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.15",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a){var b=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return b.type=a.scriptType||"text/javascript",b.charset="utf-8",b.async=!0,b},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define(function(a){var b=a("famous/core/Engine"),c=a("famous/events/EventArbiter");b.createContext();var d={A:"A",B:"B"},e=new c(d.A),f=e.forMode(d.A);f.on("my_event",function(){alert("AHandler")});var g=e.forMode(d.B);g.on("my_event",function(){alert("BHandler")});var h="A";b.on("click",function(){e.emit("my_event",{data:123}),h="A"===h?"B":"A",e.setMode(h)})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/EventHandler"),d=a("famous/events/EventFilter");b.createContext();var e=new c,f=new c,g=new d(function(a,b){return b&&"ALERT!"===b.msg});e.pipe(g).pipe(f),f.on("A",function(a){alert("piped message: "+a.msg)});var h="ALERT!";b.on("click",function(){e.trigger("A",{msg:h}),h="ALERT!"===h?"chickenDogStar":"ALERT!"})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/EventHandler"),d=a("famous/events/EventFilter");b.createContext();var e=new c,f=new c,g=new d(function(a,b){return b&&"ALERT!"===b.msg});f.subscribe(g),g.subscribe(e),f.on("A",function(a){alert("subscribed message: "+a.msg)});var h="ALERT!";b.on("click",function(){e.trigger("A",{msg:h}),h="ALERT!"===h?"chickenDogStar":"ALERT!"})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/math/Matrix"),d=a("famous/math/Vector"),e=a("famous/core/Surface"),f=b.createContext(),g=new c([[.707,-.707,0],[.707,.707,0],[0,0,1]]),h=new d(1,0,0),i=g.vectorMultiply(h),j=new e({size:[200,200],classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});j.setContent("["+i.get()+"]"),f.add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/EventHandler"),d=a("famous/events/EventMapper");b.createContext();var e=new c,f=new c,g=new c,h=new d(function(a,b){return b&&"x"===b.direction?f:g});e.pipe(h),f.on("A",function(a){alert("B direction : "+a.direction)}),g.on("A",function(a){alert("C direction : "+a.direction)});var i="x";b.on("click",function(){e.trigger("A",{direction:i}),i="x"===i?"y":"x"})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/math/Random"),d=a("famous/core/Surface"),e=b.createContext(),f=new d({size:[200,200],classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),g=c.bool();f.setContent(g?"Heads":"Tails"),e.add(f),b.on("click",function(){f.setContent(c.bool()?"Heads":"Tails")})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/math/Matrix"),d=a("famous/math/Vector"),e=a("famous/core/Surface"),f=b.createContext(),g=new c([[.707,-.707,0],[.707,.707,0],[0,0,1]]),h=new d(1,0,0),i=g.vectorMultiply(h),j=new e({size:[200,200],classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});j.setContent("["+i.get()+"]"),f.add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=b.createContext(),e=new c({size:[void 0,200],content:"Hello World",classes:["red-bg"],properties:{textAlign:"center"}});d.add(e),b.on("resize",function(){e.setContent("dimensions:<br>width : "+window.innerWidth+"px <br>height: "+window.innerHeight+"px")}),b.on("click",function(a){e.setContent("click position:<br>x :"+a.clientX+"px <br>y :"+a.clientY+"px")}),b.nextTick(function(){e.setContent("Try resizing the device/window or clicking somewhere!")})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/math/Quaternion"),g=b.createContext(),h=new f(Math.PI/3,.5,.5,0),i=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),j=new d;j.transformFrom(function(){return k?e.identity:h.getTransform()}),g.add(new d({origin:[.5,.5],align:[.5,.5]})).add(j).add(i);var k=!0;b.on("click",function(){k=k?!1:!0})}),define(function(a){function b(a,b,c){function h(a){var b=new d({size:a.size,content:a.content,classes:a.classes,properties:a.properties}),c=new e({transform:a.transform});i.add(c).add(b)}var i=new g;return h({size:[a,b],content:"<h2>Hello World, let's get friendly.</h2><p>Isn't it awesome that you can scroll this scroller while the cube is moving?</p>",classes:["red-bg"],properties:{lineHeight:"25px",textSize:"20px",textAlign:"center",overflow:"auto"},transform:f.translate(0,0,c/2)}),h({size:[a,b],content:"G'bye world, Good to know you :D",properties:{lineHeight:b+"px",textAlign:"center",backgroundColor:"#ccc",fontSize:"18px",overflow:"hidden",color:"#777"},transform:f.multiply(f.translate(0,0,-c/2),f.multiply(f.rotateZ(Math.PI),f.rotateX(Math.PI)))}),h({size:[a,c],content:"I'm on Top! Just a shimmy and a shake",properties:{lineHeight:c+"px",textAlign:"center",backgroundColor:"#0cf",overflow:"hidden",color:"#666"},transform:f.multiply(f.translate(0,-b/2,0),f.rotateX(Math.PI/2))}),h({size:[a,c],content:"I'm the bottom!",properties:{lineHeight:c+"px",textAlign:"center",backgroundColor:"#fc0",overflow:"hidden",color:"#777"},transform:f.multiply(f.translate(0,b/2,0),f.multiply(f.rotateX(-Math.PI/2),f.rotateZ(Math.PI)))}),h({size:[c,b],content:"I'm the Left! I'm content",properties:{lineHeight:b+"px",textAlign:"center",backgroundColor:"#f0c",overflow:"hidden",color:"#777"},transform:f.multiply(f.translate(-a/2,0,0),f.rotateY(-Math.PI/2))}),h({size:[c,b],content:"I'm always Right!",properties:{lineHeight:b+"px",textAlign:"center",backgroundColor:"#c0f",overflow:"hidden",color:"#777"},transform:f.multiply(f.translate(a/2,0,0),f.rotateY(Math.PI/2))}),i}var c=a("famous/core/Engine"),d=a("famous/core/Surface"),e=a("famous/core/Modifier"),f=a("famous/core/Transform"),g=a("famous/core/RenderNode"),h=a("famous/math/Quaternion"),i=c.createContext(),j=new h(1,0,0,0),k=new h(185,1,1,1),l=new e({origin:[.5,.5],align:[.5,.5]});l.transformFrom(function(){return j.getTransform()}),i.add(l).add(b(260,260,260)),c.on("prerender",function(){j=j.multiply(k)}),c.on("click",function(){var a=2*Math.random()-1,b=2*Math.random()-1,c=2*Math.random()-1;k=new h(185,a,b,c)})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=document.createElement("div");d.id="test",document.body.appendChild(d);var e=b.createContext(d),f=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=b.createContext(),e=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});d.add(e)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext();f.setPerspective(200);var g=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),h=new d({align:[.5,.5],origin:[.5,.5],transform:e.rotateX(Math.PI/4)});f.add(h).add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/EventHandler"),d=a("famous/core/Surface"),e=b.createContext(),f=new d({size:[200,200],content:"Click Me",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),g=new c;f.pipe(g),g.on("click",function(){alert("Click from the event handler")}),e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/EventHandler"),d=a("famous/core/Surface"),e=b.createContext(),f=new d({size:[200,200],content:"Click Me",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),g=new c;f.pipe(g),g.on("click",function(){g.trigger("triggeredEvent",{data:"I am the data"})}),g.on("triggeredEvent",function(a){alert(a.data)}),e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=b.createContext(),f=[[.5,.5],[0,0],[.5,0],[1,0],[0,.5],[1,.5],[0,1],[.5,1],[1,1]],g=0,h=new d({align:function(){return f[g]}}),i=new c({size:[void 0,void 0],properties:{border:"2px solid black"}}),j=new c({size:[100,100],content:"[.5, .5]",classes:["red-bg"],properties:{lineHeight:"100px",textAlign:"center"}}),k=e.add(new d({align:[.5,.5],origin:[.5,.5],size:[300,300]}));k.add(i),k.add(h).add(j),b.on("click",function(){g=++g%f.length,j.setContent(f[g])})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({transform:e.rotateZ(.7),align:[.5,.5],origin:[.5,.5]}),h=new d({transform:e.translate(200,0,0)}),i=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"200px"}}),j=new c({size:[50,50],content:"Small",classes:["grey-bg"],properties:{textAlign:"center",lineHeight:"50px"}}),k=f.add(g);k.add(i),k.add(h).add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({transform:e.translate(200,0,-1)}),h=new d({transform:e.rotateZ(.7)}),i=new c({size:[200,200],content:"Translate then rotate",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"200px"}}),j=new d({transform:e.rotateZ(.7)}),k=new d({transform:e.translate(200,0,0)}),l=new c({size:[200,200],content:"Rotate then translate",classes:["grey-bg"],properties:{textAlign:"center",lineHeight:"200px"}});f.add(g).add(h).add(i),f.add(j).add(k).add(l)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({transform:e.translate(50,50,0)}),h=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});f.add(g).add(h)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({opacity:.5}),h=new d({transform:e.translate(100,0,0),opacity:.25}),i=new c({size:[100,100],content:"Half",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),j=new c({size:[100,100],content:".125 Opacity",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),k=f.add(g);k.add(i),k.add(h).add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=b.createContext(),f=[[0,0],[.5,0],[1,0],[0,.5],[.5,.5],[1,.5],[0,1],[.5,1],[1,1]],g=0,h=new d({origin:function(){return f[g]}}),i=new c({size:[100,100],content:"[0, 0]",classes:["red-bg"],properties:{lineHeight:"100px",textAlign:"center"}}),j=e.add(new d({align:[.5,.5]}));j.add(new d({origin:[.5,.5]})).add(new c({size:[4,4],properties:{backgroundColor:"black"}})),j.add(h).add(i),b.on("click",function(){g=++g%f.length,i.setContent(f[g])})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=(a("famous/core/Transform"),b.createContext()),f=new d({size:[200,200]}),g=new c({size:[void 0,void 0],classes:["grey-bg"],properties:{lineHeight:"200px",textAlign:"center"}});e.add(f).add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Scene"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({id:"root",opacity:1,target:[{transform:e.translate(10,10),target:{id:"foo"}},{transform:[{rotateZ:.1},{scale:[.5,.5,1]}],origin:[.5,.5],align:[.5,.5],target:{id:"bar"}}]}),h=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}}),i=new c({size:[200,200],content:"Secondary",classes:["grey-bg"],properties:{lineHeight:"200px",textAlign:"center"}});g.id.foo.add(h),g.id.bar.add(i),f.add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=b.createContext(),e=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});d.add(e)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=b.createContext(),e=new c({size:[!0,!0],content:"Hello World",classes:["red-bg"]});d.add(e)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/View"),d=a("famous/core/Surface"),e=a("famous/core/Modifier"),f=a("famous/core/Transform"),g=b.createContext(),h=new c,i=new d({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});i.pipe(h),h._eventInput.on("click",function(){alert("Primary Surface Clicked")});var j=new c,k=new e({transform:f.thenMove(f.rotateZ(.25*Math.PI),[200,100,1])}),l=new d({size:[200,200],content:"Secondary",classes:["grey-bg"],properties:{lineHeight:"200px",textAlign:"center"}});l.pipe(j),j._eventInput.on("click",function(){alert("Secondary Surface Clicked")}),h._add(i),j._add(k).add(l),g.add(h),g.add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/GenericSync"),d=a("famous/inputs/MouseSync"),e=a("famous/inputs/TouchSync"),f=a("famous/inputs/ScrollSync"),g=a("famous/core/Surface"),h=a("famous/inputs/Accumulator"),i=b.createContext(),j=0,k=[0,0];c.register({mouse:d,touch:e,scroll:f});var l=new h(k),m=new c(["mouse","touch","scroll"]);b.pipe(m),m.pipe(l);var n=function(){return"<div>Update Count: "+j+"</div><div>Accumulated distance: "+l.get()+"</div>"},o=new g({size:[void 0,void 0],classes:["grey-bg"],content:n()});m.on("start",function(){l.set(k),o.setContent(n())}),m.on("update",function(){j++,o.setContent(n())}),i.add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/GenericSync"),d=a("famous/inputs/MouseSync"),e=a("famous/inputs/TouchSync"),f=a("famous/inputs/ScrollSync"),g=a("famous/core/Surface"),h=b.createContext(),i=0,j=0,k=0,l=[0,0],m=[0,0];c.register({mouse:d,touch:e,scroll:f});var n=new c(["mouse","touch","scroll"]);b.pipe(n);var o=function(){return"<div>Start Count: "+i+"</div><div>End Count: "+k+"</div><div>Update Count: "+j+"</div><div>Delta: "+l+"</div><div>Distance from start: "+m+"</div>"},p=new g({size:[void 0,void 0],classes:["grey-bg"],content:o()});n.on("start",function(){i++,m=[0,0],p.setContent(o())}),n.on("update",function(a){j++,m=a.position,l=a.delta,p.setContent(o())}),n.on("end",function(){k++,p.setContent(o())}),h.add(p)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/GenericSync"),d=a("famous/inputs/MouseSync"),e=a("famous/inputs/TouchSync"),f=a("famous/inputs/ScrollSync"),g=a("famous/core/Surface"),h=a("famous/inputs/Accumulator"),i=b.createContext(),j=0,k=0;c.register({mouse:d,touch:e,scroll:f});var l=new h(k),m=new c({mouse:{direction:c.DIRECTION_X,scale:2},touch:{direction:c.DIRECTION_Y},scroll:{direction:c.DIRECTION_Y}});b.pipe(m),m.pipe(l);var n=function(){return"<div>Update Count: "+j+"</div><div>Accumulated distance: "+l.get()+"</div>"},o=new g({size:[void 0,void 0],classes:["grey-bg"],content:n()});m.on("start",function(){l.set(k),o.setContent(n())}),m.on("update",function(){j++,o.setContent(n())}),i.add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/inputs/PinchSync"),e=b.createContext(),f=0,g=0,h=0,i="",j=0,k=0,l=0,m=new d;b.pipe(m);var n=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Pinch Direction: "+i+"</div><div>Delta: "+k.toFixed(3)+"</div><div>Separation Distance: "+j.toFixed(3)+"</div><div>Separation Displacement: "+l.toFixed(3)+"</div>"},o=new c({size:[void 0,void 0],classes:["grey-bg"],content:n()});m.on("start",function(){f++,o.setContent(n())}),m.on("update",function(a){g++,j=a.distance,i=a.velocity>0?"Expanding":"Contracting",l=a.displacement,k=a.delta,o.setContent(n())}),m.on("end",function(){h++,o.setContent(n())}),e.add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/MouseSync"),d=a("famous/core/Surface"),e=a("famous/inputs/Accumulator"),f=b.createContext(),g=0,h=0,i=0,j=[h,i],k=new c,l=new e(j);b.pipe(k),k.pipe(l);var m=function(){return"<div>Update Count: "+g+"</div><div>Accumulated distance: "+l.get()+"</div>"},n=new d({size:[void 0,void 0],classes:["grey-bg"],content:m()});k.on("start",function(){l.set([h,i]),n.setContent(m())}),k.on("update",function(){g++,n.setContent(m())}),f.add(n)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/MouseSync"),d=a("famous/core/Surface"),e=b.createContext(),f=0,g=0,h=0,i=[0,0],j=[0,0],k=new c;b.pipe(k);var l=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Delta: "+i+"</div><div>Distance from start: "+j+"</div>"},m=new d({size:[void 0,void 0],classes:["grey-bg"],content:l()});k.on("start",function(){f++,j=[0,0],m.setContent(l())}),k.on("update",function(a){g++,j=a.position,i=a.delta,m.setContent(l())}),k.on("end",function(){h++,m.setContent(l())}),e.add(m)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/MouseSync"),d=a("famous/core/Surface"),e=b.createContext(),f=0,g=0,h=0,i=0,j=0,k=0,l=[j,k],m=new c({direction:c.DIRECTION_X});b.pipe(m);var n=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Delta: "+i+"</div><div>Distance from start: "+l+"</div>"},o=new d({size:[void 0,void 0],classes:["grey-bg"],content:n()});m.on("start",function(){f++,l=[j,k],o.setContent(n())}),m.on("update",function(a){g++,l[0]=a.position,i=a.delta,o.setContent(n())}),m.on("end",function(){h++,o.setContent(n())}),e.add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/inputs/RotateSync"),e=b.createContext(),f=0,g=0,h=0,i="",j=0,k=0,l=new d;b.pipe(l);var m=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Direction: "+i+"</div><div>Delta: "+k.toFixed(3)+"</div><div>Angle: "+j.toFixed(3)+"</div>"},n=new c({size:[void 0,void 0],classes:["grey-bg"],content:m()});l.on("start",function(){f++,j=0,n.setContent(m())}),l.on("update",function(a){g++,i=a.velocity>0?"Clockwise":"Counter-Clockwise",j=a.angle,k=a.delta,n.setContent(m())}),l.on("end",function(){h++,n.setContent(m())}),e.add(n)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/inputs/ScaleSync"),e=b.createContext(),f=0,g=0,h=0,i="",j=1,k=new d;b.pipe(k);var l=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Scale factor: "+j.toFixed(3)+"</div><div>Scale Direction: "+i+"</div>"},m=new c({size:[void 0,void 0],classes:["grey-bg"],content:l()});k.on("start",function(){f++,m.setContent(l())}),k.on("update",function(a){g++,i=a.velocity>0?"Growing":"Shrinking",j=a.scale,m.setContent(l())}),k.on("end",function(){h++,m.setContent(l())}),e.add(m)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/inputs/ScrollSync"),e=b.createContext(),f=0,g=0,h=0,i=[0,0],j=[0,0],k=new d;b.pipe(k);var l=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Delta: "+i+"</div><div>Position: "+j+"</div>"},m=new c({size:[void 0,void 0],classes:["grey-bg"],content:l()});k.on("start",function(){f++,m.setContent(l())}),k.on("update",function(a){g++,j=a.position,i=a.delta,m.setContent(l())}),k.on("end",function(){h++,m.setContent(l())}),e.add(m)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/TouchSync"),d=a("famous/core/Surface"),e=a("famous/inputs/Accumulator"),f=b.createContext(),g=0,h=0,i=0,j=[h,i],c=new c,k=new e(j);b.pipe(c),c.pipe(k);var l=function(){return"<div>Update Count: "+g+"</div><div>Accumulated distance: "+k.get()+"</div>"},m=new d({size:[void 0,void 0],classes:["grey-bg"],content:l()});c.on("start",function(){k.set([h,i]),m.setContent(l())}),c.on("update",function(){g++,m.setContent(l())}),f.add(m)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/TouchSync"),d=a("famous/core/Surface"),e=b.createContext(),f=0,g=0,h=0,i=[0,0],j=[0,0],k=new c(function(){return j});b.pipe(k);var l=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Delta: "+i+"</div><div>Distance from start: "+j+"</div>"},m=new d({size:[void 0,void 0],classes:["grey-bg"],content:l()});k.on("start",function(){f++,j=[0,0],m.setContent(l())}),k.on("update",function(a){g++,j=a.position,i=a.delta,m.setContent(l())}),k.on("end",function(){h++,m.setContent(l())}),e.add(m)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/inputs/TouchSync"),d=a("famous/core/Surface"),e=b.createContext(),f=0,g=0,h=0,i=0,j=0,k=0,l=[j,k],m=new c({direction:c.DIRECTION_Y});b.pipe(m);var n=function(){return"<div>Start Count: "+f+"</div><div>End Count: "+h+"</div><div>Update Count: "+g+"</div><div>Delta: "+i+"</div><div>Distance from start: "+l+"</div>"},o=new d({size:[void 0,void 0],classes:["grey-bg"],content:n()});m.on("start",function(){f++,l=[j,k],o.setContent(n())}),m.on("update",function(a){g++,l[1]=a.position,i=a.delta,o.setContent(n())}),m.on("end",function(){h++,o.setContent(n())}),e.add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=(a("famous/core/Transform"),a("famous/modifiers/Draggable")),f=b.createContext(),g=new c({size:[481,481],classes:["graph"]}),h=new e({snapX:40,snapY:40,xRange:[-220,220],yRange:[-220,220]}),i=new c({size:[40,40],content:"drag",classes:["red-bg"],properties:{lineHeight:"40px",textAlign:"center",cursor:"pointer"}});h.subscribe(i);var j=f.add(new d({align:[.5,.5],origin:[.5,.5]}));j.add(g),j.add(h).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=b.createContext(),g=new d({transform:e.rotateZ(Math.PI/4)}),h=new c({size:[200,200],content:"Hello World",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});f.add(g).add(h)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/core/Surface"),e=a("famous/core/Transform"),f=a("famous/modifiers/ModifierChain"),g=b.createContext(),h=new f,i=new c({align:[.5,.5],origin:[.5,.5]}),j=new c({transform:e.translate(0,100,0)}),k=new d({size:[200,200],content:"Click me to remove the center align/origin modifier",classes:["red-bg"],properties:{textAlign:"center"}});h.addModifier(i),h.addModifier(j),g.add(h).add(k),k.on("click",function(){h.removeModifier(i),k.setContent("Success!")})}),define(function(a){for(var b,c=a("famous/core/Engine"),d=a("famous/core/Surface"),e=a("famous/core/Modifier"),f=a("famous/surfaces/ContainerSurface"),g=a("famous/views/Scrollview"),h=c.createContext(),i=new f({size:[400,400],properties:{overflow:"hidden"}}),j=[],k=new g,l=0;100>l;l++)b=new d({size:[void 0,50],content:"I am surface: "+(l+1),classes:["red-bg"],properties:{textAlign:"center",lineHeight:"50px"}}),b.pipe(k),j.push(b);k.sequenceFrom(j),i.add(k),h.add(new e({align:[.5,.5],origin:[.5,.5]})).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Transform"),e=a("famous/modifiers/StateModifier"),f=b.createContext(),g=new c({size:[100,100],properties:{backgroundColor:"#fa5c4f",lineHeight:"100px",textAlign:"center",color:"#eee"},content:"Click Me"}),h=new e({origin:[.5,.5],align:[.5,.5]});f.add(h).add(g),b.on("click",function(){h.halt(),h.setTransform(d.rotateZ(Math.random()*Math.PI/2),{curve:"easeOut",duration:5e3})})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/surfaces/InputSurface"),e=b.createContext(),f=new d({size:[200,200],name:"inputSurface",placeholder:"Type text here",value:"",type:"text"});e.add(new c({align:[.5,.5],origin:[.5,.5]})).add(f)}),define(function(a){function b(a){l.setTransform(f.translate(100,-240,0)),l.setTransform(f.translate(100,0,0),{curve:a,duration:1e3})}var c=a("famous/core/Engine"),d=a("famous/core/Surface"),e=a("famous/core/Modifier"),f=a("famous/core/Transform"),g=(a("famous/transitions/Transitionable"),a("famous/transitions/Easing")),h=a("famous/surfaces/ContainerSurface"),i=a("famous/views/Scrollview"),j=c.createContext(),k=new d({size:[100,100],classes:["red-bg"]}),l=new e({align:[.5,.5],origin:[.5,.5],transform:f.translate(100,-240,0)});
j.add(l).add(k);var m=[];for(var n in g){var k=new d({size:[200,40],content:"<h3>"+n+"</h3>",properties:{color:"#3cf",cursor:"pointer"}});m.push(k),k.on("click",b.bind(null,g[n]))}var o=new h({size:[200,480],properties:{overflow:"hidden",border:"1px solid rgba(255,255,255, .8)",borderRadius:"10px 0px 0px 10px"}}),p=new i({clipSize:460});p.sequenceFrom(m),o.pipe(p),o.add(new e({transform:f.translate(20,0,0)})).add(p),j.add(new e({align:[.5,.5],origin:[.5,.5],transform:f.translate(-240,0,0)})).add(o)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/transitions/Transitionable"),g=a("famous/transitions/SnapTransition"),h=b.createContext(),i=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),j=new d({align:[.5,.5],origin:[.5,.5],transform:e.translate(0,-240,0)}),k=new d({transform:e.rotateX(.2)});f.registerMethod("snap",g);var l={method:"snap",period:1e3,dampingRatio:.3,velocity:0};i.on("click",function(){j.setTransform(e.translate(0,0,0),l)}),h.add(j).add(k).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/transitions/Transitionable"),g=a("famous/transitions/SpringTransition"),h=b.createContext(),i=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),j=new d({align:[.5,.5],origin:[.5,.5],transform:e.translate(0,-240,0)});f.registerMethod("spring",g);var k={method:"spring",period:1e3,dampingRatio:.1,velocity:0};i.on("click",function(){j.setTransform(e.translate(0,0,0),k)}),h.add(j).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/surfaces/ImageSurface"),e=b.createContext(),f=new d({size:[200,200]});f.setContent("http://code.famo.us/assets/famous.jpg"),e.add(new c({align:[.5,.5],origin:[.5,.5]})).add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/transitions/TransitionableTransform"),f=b.createContext(),g=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),h=new e,i=new d({align:[.5,.5],origin:[.5,.5],transform:h});g.on("click",function(){h.setScale([3,3,1],{duration:3e3})}),f.add(i).add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=(a("famous/utilities/Timer"),a("famous/transitions/Transitionable")),g=b.createContext(),h=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),i=100,j=new f(-i),k=new d({align:[.5,.5],origin:[.5,.5]});k.transformFrom(function(){return e.translate(j.get(),0,0)}),h.on("click",function(){j.set(i,{curve:"easeInOut",duration:1e3})}),g.add(k).add(h)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/transitions/Transitionable"),g=a("famous/transitions/WallTransition"),h=b.createContext(),i=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),j=new d({align:[.5,.5],origin:[.5,.5],transform:e.translate(0,-240,0)});f.registerMethod("wall",g);var k={method:"wall",period:1e3,dampingRatio:0,velocity:0,restitution:.5};i.on("click",function(){j.setTransform(e.translate(0,0,0),k)}),h.add(j).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/transitions/Transitionable"),g=a("famous/transitions/TweenTransition"),h=b.createContext(),i=new c({size:[100,100],content:"Click Me",classes:["red-bg"],properties:{textAlign:"center",lineHeight:"100px"}}),j=new d({align:[.5,.5],origin:[.5,.5],transform:e.translate(0,0,0)});f.registerMethod("tween",g);var k=new f(1);j.opacityFrom(function(){return k.get()});var l={method:"tween",curve:"easeInOut",duration:1500};i.on("click",function(){k.set(0,l)}),h.add(j).add(i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/utilities/Utility"),d=a("famous/core/Surface"),e=a("famous/modifiers/StateModifier"),f=new d({size:[void 0,100],properties:{backgroundColor:"#fa5c4f",lineHeight:"100px",textAlign:"center",color:"#eee"},content:"Take only the 5th click into account."}),g=new e({origin:[0,0],align:[0,0]}),h=b.createContext();h.add(g).add(f);var i=c.after(5,function(){alert("Was called on 5th try")});b.on("click",i)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/utilities/KeyCodes"),f=b.createContext(),g=new c({size:[200,200],content:"press keys",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});f.add(new d({align:[.5,.5],origin:[.5,.5]})).add(g),b.on("keypress",function(a){g.setContent(a.charCode>=e[0]&&a.charCode<=e[9]?"you hit a number":"not a number")})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/utilities/Timer"),f=b.createContext(),g=new c({size:[void 0,200],content:"this function has not been run",classes:["red-bg"],properties:{lineHeight:"200px",textAlign:"center"}});f.add(new d({align:[.5,.5],origin:[.5,.5]})).add(g),e.after(function(){g.setContent("this function was run after 200 Engine ticks")},200)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/utilities/Timer"),f=b.createContext(),g=0,h=new c({size:[500,500],content:"this function has run "+g+" time(s) and will stop after 3",classes:["red-bg"],properties:{lineHeight:"500px",textAlign:"center"}});f.add(new d({align:[.5,.5],origin:[.5,.5]})).add(h);var i=function(){h.setContent("this function has run "+ ++g+" time(s) and will stop after 1 second")};b.on("prerender",i),e.setTimeout(function(){e.clear(i)},1e3)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/core/Surface"),e=a("famous/utilities/Timer"),f=b.createContext(),g=0,h=new d({size:[void 0,void 0],content:"this function will run every 100 engine ticks",classes:["red-bg"],properties:{lineHeight:"500px",textAlign:"center"}});f.add(new c({align:[.5,.5],origin:[.5,.5]})).add(h),e.every(function(){h.setContent("this function has run "+ ++g+" time(s)")},100)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/core/Surface"),e=a("famous/utilities/Timer"),f=b.createContext(),g=0,h=new d({size:[500,500],content:"this function will run every second",classes:["red-bg"],properties:{lineHeight:"500px",textAlign:"center"}});f.add(new c({origin:[.5,.5],align:[.5,.5]})).add(h),e.setInterval(function(){h.setContent("this function has run "+ ++g+" time(s)")},1e3)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/utilities/Timer"),f=b.createContext(),g=new c({size:[500,500],content:"Initial State",classes:["red-bg"],properties:{lineHeight:"500px",textAlign:"center"}});f.add(new d({origin:[.5,.5],align:[.5,.5]})).add(g),e.setTimeout(function(){g.setContent("this function was run after 1000 milliseconds")},1e3)}),define(function(a){var b=a("famous/core/Engine"),c=(a("famous/core/Transform"),a("famous/core/Modifier")),d=a("famous/core/Surface"),e=a("famous/transitions/Transitionable"),f=a("famous/views/Deck"),g=(a("famous/views/GridLayout"),a("famous/transitions/SpringTransition"));e.registerMethod("spring",g);var h=b.createContext(),i=[],j=new f({itemSpacing:10,transition:{method:"spring",period:300,dampingRatio:.5},stackRotation:.02});j.sequenceFrom(i);for(var k=0;5>k;k++){var l=new d({size:[100,200],classes:["test"],properties:{backgroundColor:"hsla("+15*(5*k+k)%360+", 60%, 50%, 0.8)"},content:k});l.on("click",function(){j.toggle()}),i.push(l)}var m=new c({origin:[.5,.5],align:[.5,.5]});h.add(m).add(j)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/EdgeSwapper"),e=b.createContext(),f=new d,g=new c({size:[void 0,void 0],content:"Primary",classes:["red-bg"],properties:{lineHeight:window.innerHeight+"px",textAlign:"center"}}),h=new c({size:[void 0,void 0],content:"Secondary",classes:["grey-bg"],properties:{lineHeight:window.innerHeight+"px",textAlign:"center"}});e.add(f),f.show(g);var i=!0;b.on("click",function(){i?(f.show(h),i=!1):(f.show(g),i=!0)})}),define(function(a){for(var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=(a("famous/core/Modifier"),a("famous/views/FlexibleLayout")),e=b.createContext(),f=["rgba(256, 0, 0, .7)","rgba(0, 256, 0, .7)","rgba(0, 0, 256, .7)","rgba(256, 0, 0, .7)","rgba(0, 256, 0, .7)","rgba(0, 0, 256, .7)","rgba(256, 0, 0, .7)","rgba(0, 256, 0, .7)","rgba(0, 0, 256, .7)"],g=[1,!0,1,!0,1,!0,1,!0],h=new d({ratios:g}),i=[],j=1;8>=j;j++)size=j%2===0?[10,void 0]:[void 0,void 0],i.push(new c({size:size,properties:{backgroundColor:f[j-1]}}));h.sequenceFrom(i);var k=[4,!0,1,!0,0,!0,7,!0],l=!1;b.on("click",function(){var a=l?g:k;h.setRatios(a,{curve:"easeOut",duration:500}),l=!l}),e.add(h)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/Flipper"),e=a("famous/core/Modifier"),f=b.createContext();f.setPerspective(500);var g=new d,h=new c({size:[200,200],content:"front",properties:{background:"red",lineHeight:"200px",textAlign:"center"}}),i=new c({size:[200,200],content:"back",properties:{background:"blue",color:"white",lineHeight:"200px",textAlign:"center"}});g.setFront(h),g.setBack(i);var j=new e({align:[.5,.5],origin:[.5,.5]});f.add(j).add(g);var k=!1;b.on("click",function(){var a=k?0:Math.PI;g.setAngle(a,{curve:"easeOutBounce",duration:500}),k=!k})}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/HeaderFooterLayout"),e=b.createContext(),f=new d({headerSize:100,footerSize:50});f.header.add(new c({size:[void 0,100],content:"Header",classes:["red-bg"],properties:{lineHeight:"100px",textAlign:"center"}})),f.content.add(new c({size:[void 0,void 0],content:"Content",classes:["grey-bg"],properties:{lineHeight:window.innerHeight-150+"px",textAlign:"center"}})),f.footer.add(new c({size:[void 0,50],content:"Footer",classes:["red-bg"],properties:{lineHeight:"50px",textAlign:"center"}})),e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/core/Transform"),f=a("famous/views/HeaderFooterLayout"),g=b.createContext(),h=new f({headerSize:100,footerSize:50});h.header.add(new c({size:[void 0,100],content:"Header",classes:["red-bg"],properties:{lineHeight:"100px",textAlign:"center"}})),h.content.add(new c({size:[void 0,void 0],content:"Content",classes:["grey-bg"],properties:{lineHeight:"150px",textAlign:"center"}})),h.footer.add(new c({size:[void 0,50],content:"Footer",classes:["red-bg"],properties:{lineHeight:"50px",textAlign:"center"}})),g.add(new d({transform:e.rotateZ(.7),size:[300,300],origin:[.5,.5],align:[.5,.5]})).add(h)}),define(function(a){for(var b=a("famous/core/Engine"),c=a("famous/core/Modifier"),d=a("famous/core/Surface"),e=a("famous/views/RenderController"),f=b.createContext(),g=new e,h=[],i=0,j=0;10>j;j++)h.push(new d({content:"Surface: "+(j+1),size:[200,200],properties:{backgroundColor:"hsl("+360*j/10+", 100%, 50%)",lineHeight:"200px",textAlign:"center"}}));g.show(h[0]),b.on("click",function(){var a=(i++ +1)%h.length;this.show(h[a])}.bind(g)),f.add(new c({origin:[.5,.5],align:[.5,.5]})).add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/GridLayout"),e=b.createContext(),f=new d({dimensions:[4,2]}),g=[];f.sequenceFrom(g);for(var h=0;8>h;h++)g.push(new c({content:"I am panel "+(h+1),size:[void 0,void 0],properties:{backgroundColor:"hsl("+360*h/8+", 100%, 50%)",color:"black",lineHeight:window.innerHeight/2+"px",textAlign:"center"}}));e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/core/Modifier"),e=a("famous/views/GridLayout"),f=b.createContext(),g=new e({dimensions:[4,2]}),h=[];g.sequenceFrom(h);for(var i=0;8>i;i++)h.push(new c({content:"I am panel "+(i+1),size:[void 0,100],properties:{backgroundColor:"hsl("+360*i/8+", 100%, 50%)",color:"black",lineHeight:"100px",textAlign:"center"}}));f.add(new d({size:[400,200],origin:[.5,.5],align:[.5,.5]})).add(g)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/Scrollview"),e=b.createContext(),f=new d,g=[];f.sequenceFrom(g);for(var h,i=0;40>i;i++)h=new c({content:"Surface: "+(i+1),size:[void 0,200],properties:{backgroundColor:"hsl("+360*i/40+", 100%, 50%)",lineHeight:"200px",textAlign:"center"}}),h.pipe(f),g.push(h);e.add(f)}),define(function(a){var b=a("famous/core/Engine"),c=a("famous/core/Surface"),d=a("famous/views/SequentialLayout"),e=b.createContext(),f=new d({direction:1}),g=[];f.sequenceFrom(g);for(var h=0;10>h;h++)g.push(new c({content:"Surface: "+(h+1),size:[void 0,window.innerHeight/10],properties:{backgroundColor:"hsl("+360*h/10+", 100%, 50%)",lineHeight:window.innerHeight/10+"px",textAlign:"center"}}));e.add(f)});
